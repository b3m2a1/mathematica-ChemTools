Notebook[{

Cell[CellGroupData[{
Cell["Psi4", "CodeSection",
 CellChangeTimes->{{3.693961885121663*^9, 
  3.693961886480135*^9}},ExpressionUUID->"26d53c5e-0b95-4f6a-8a46-\
423519d52add"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Defaults\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693961994657549*^9, 
  3.693961996247883*^9}},ExpressionUUID->"90266dd8-60d5-44e7-8254-\
5538f9ce76fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Psi4", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The default Psi4 instance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$Psi4Dir", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Directory for the default Psi4 instance\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693961935300873*^9, 3.693961962496724*^9}, {
  3.715082814833576*^9, 3.715082821770565*^9}, {3.7155494745179768`*^9, 
  3.715549483733835*^9}},ExpressionUUID->"a27b6e04-5c8e-4aad-a688-\
a640a0a7c600"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Build\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6993124633860207`*^9, 
  3.6993124641859818`*^9}},ExpressionUUID->"d2ca90ec-a618-48b6-972d-\
ee6863463443"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Build", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Gets and compiles the Psi4 system if necessary\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.699312465043376*^9, 3.699312481873575*^9}, {
  3.715082826440138*^9, 3.715082830146467*^9}, {3.715549486854135*^9, 
  3.7155494926183367`*^9}},ExpressionUUID->"c2699bb0-00c3-44f6-8730-\
f02b29f7f746"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Objects\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693961990265358*^9, 
  3.6939619975210733`*^9}},ExpressionUUID->"6b1032d2-f5b7-4895-ae5d-\
80f8a8da5c5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4", "::", "usage"}], "=", "\"\<A psi4 instance\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Input", "::", "usage"}], "=", 
   "\"\<An association configuring a Psi4 run\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Output", "::", "usage"}], "=", 
   "\"\<An association with Psi4 output\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Data", "::", "usage"}], "=", 
   "\"\<An association of Psi4 data\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.69396199923332*^9, 3.6939620573989887`*^9}, {
  3.715082836182705*^9, 3.7150828399623823`*^9}, {3.715549496157415*^9, 
  3.715549501325944*^9}},ExpressionUUID->"68761625-1ee7-4fca-ae46-\
4fa04490abf6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Calls and Config\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693962072863469*^9, 3.693962073366178*^9}, {
  3.693962122596884*^9, 
  3.69396212767703*^9}},ExpressionUUID->"68c5466f-5066-4a6f-b6a7-\
d39c785cc099"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Call", "::", "usage"}], "=", 
   "\"\<Basic Psi4 call on either an association or a file / directory\>\""}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$Psi4ConfigMap", "::", "usage"}], "=", 
   "\"\<Maps options names to Psi4 names\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$Psi4ConfigChoices", "::", "usage"}], "=", 
   "\"\<Helpful dict of option choices\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Compile", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Overloads the private ToPython symbolic converter to create Psi4 \
ready structures\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Molecule", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Turns atoms / positions into a molecule string for a Psi4 input \
file\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Config", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Configures a 'set' block for a psi4 input file from option \
names\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Function", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Configures a Psi4 function call\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GridFile", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Configures a grid file string ready for psi4\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Configures an input file string ready for psi4\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4ConfigureCall", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Preps an input file + other info ready for psi4\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6939620768649063`*^9, 3.6939621191125727`*^9}, {
  3.715082844357786*^9, 3.715082882348387*^9}, {3.715549505271353*^9, 
  3.715549510902293*^9}},ExpressionUUID->"c803d7ff-a4df-440d-bce3-\
57685fd54cee"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Utils\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7150844199406433`*^9, 
  3.715084420627038*^9}},ExpressionUUID->"0cb48a99-4bb1-488d-a0ec-\
f230967cd112"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4UtilsAutoGrid", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4UtilsAutoScan", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4DataParseGeometry", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.715084426355235*^9, 3.715084443091291*^9}, 
   3.7150951615423937`*^9, 3.715172159809011*^9, {3.715549464927452*^9, 
   3.7155494709177227`*^9}, {3.715552096315691*^9, 
   3.715552099296544*^9}},ExpressionUUID->"745d0046-abf0-4db8-b6f6-\
b6452c79611b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Basics\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694298464478581*^9, 
  3.694298472160975*^9}},ExpressionUUID->"a6bb22d1-5662-4664-a3c4-\
c76c8ad542b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GeometryOptimize", "::", "usage"}], "=", 
   "\"\<Basic geometry optimization\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GeometryInfo", "::", "usage"}], "=", 
   "\"\<Gathers basic psi4 structural info\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Property", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Formats a basic call to property\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Scan", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Performs a function in a scan\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6942984695628433`*^9, 3.6942984808974867`*^9}, {
  3.69431447025918*^9, 3.694314482047296*^9}, {3.699842700805201*^9, 
  3.699842746440404*^9}, {3.715082861375654*^9, 3.715082864530299*^9}, {
  3.715549518021366*^9, 
  3.7155495234530077`*^9}},ExpressionUUID->"ce8651de-77e4-4840-aaf7-\
ac574df96c4e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Energies\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.715084361693137*^9, 
  3.7150843629479847`*^9}},ExpressionUUID->"f356923f-37ef-406c-8217-\
86029c50883b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Energy", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4EnergyScan", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7150843639842663`*^9, 3.715084377900008*^9}, {
  3.7155495265975122`*^9, 
  3.7155495312605963`*^9}},ExpressionUUID->"9b005040-7dc3-49f0-a603-\
6fdb85c8ec34"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OneElectronProperty\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.693962436056636*^9},ExpressionUUID->"8542ea40-9f21-40d4-b2f7-\
4dac54486057"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronProperty", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Calls oeprop. To be subclassed\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronElectrostaticPotential", "::", "usage"}], "=", 
   "\n", "\t", "\"\<Calls oeprop electrostatic potential\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronDipoleMoment", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Gets oeprop dipole moments\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693962438251705*^9, 3.6939624829497557`*^9}, {
  3.694182960273785*^9, 3.694182989950341*^9}, {3.7150828683115396`*^9, 
  3.715082874156868*^9}, {3.715549534293466*^9, 
  3.7155495388208427`*^9}},ExpressionUUID->"6bd80491-1f8a-4e67-9ffc-\
056297a69cd7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CubeProperty\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693962486958399*^9, 
  3.693962494207932*^9}},ExpressionUUID->"13d3c425-9fe5-4629-a606-\
d82f2acb84b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeProperty", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Calls cubeprop to generate a cubefile for a given property\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeOrbitals", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Generates orbitals with cubeprop\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeElectronDensity", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Calculates electron density with cubeprop\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeElectrostaticPotential", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Calculates electrostatic potential with cubeprop\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693962495858246*^9, 3.6939625727317247`*^9}, {
  3.715082888904003*^9, 3.7150828922817297`*^9}, {3.715549543469268*^9, 
  3.715549548642433*^9}},ExpressionUUID->"ffbcf0d3-7bfe-43b7-9b45-\
318fc0ea6349"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"1dd86495-2959-4d70-9b80-\
8d90521ab1c9"],

Cell[BoxData[
 RowBox[{"PyToolsLoad", "[", "]"}]], "CodeInput",
 CellChangeTimes->{{3.715551319564178*^9, 3.71555133834473*^9}, 
   3.7323949747089243`*^9},ExpressionUUID->"0e441802-d53a-4a41-b4f0-\
a766f4473811"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FindPsi4\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"32ba07db-327d-4921-9f79-725d6b7a5759"],

Cell[BoxData[
 RowBox[{"$Psi4Path", "=", "\n", "\t", 
  RowBox[{"{", "\n", "\t\t", 
   RowBox[{"$ChemExtensionsApp", ",", "\n", "\t\t", "$ChemExtensionsDev"}], 
   "\n", "\t\t", 
   "}"}]}]], \
"CodeInput",ExpressionUUID->"87859e84-903f-487b-8300-2a75c6692ac5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindPsi4", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"StringTrim", "@", "\n", "\t\t\t", 
     RowBox[{"RunProcess", "[", "\t\t\t", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$OperatingSystem", "\[Equal]", "\"\<Windows\>\""}], ",", 
           " ", "\"\<where\>\"", ",", " ", "\"\<which\>\""}], "]"}], ",", 
         " ", "\"\<psi4\>\""}], "}"}], ",", "\n", "\t", "\t", "\t", "\t", 
       "\"\<StandardOutput\>\""}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", 
    "\t\t", 
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"psi4_String", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "#", "]"}], ">", "0"}], "&&", 
           RowBox[{"FileExistsQ", "[", "#", "]"}], "&&", 
           RowBox[{"psi4Q", "[", 
            RowBox[{"Nest", "[", 
             RowBox[{"DirectoryName", ",", " ", "#", ",", " ", "2"}], "]"}], 
            "]"}]}], "&"}], ")"}]}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"Nest", "[", 
        RowBox[{"DirectoryName", ",", " ", "psi4", ",", " ", "2"}], "]"}]}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"_", ":>", "\n", "\t\t\t\t", 
       RowBox[{"SelectFirst", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<*psi*\>\"", ",", "\n", "\t\t\t\t\t\t", "$Psi4Path"}], 
          "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", "psi4Q", ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"ChemExtensionDir", "[", "\"\<psi4\>\"", "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"5129cfea-5f43-42c5-9711-8a1eedf33976"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]$Psi4Dir\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"77e7c884-2516-4378-8fed-aa8c155810c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Psi4Dir", ":=", 
   RowBox[{"$Psi4Dir", "=", 
    RowBox[{"FindPsi4", "[", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$Psi4", ":=", 
   RowBox[{"Psi4", "@", "$Psi4Dir"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"23e5410a-7ecd-46ec-9fd7-5a09d7d05af0"]\

}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Build and Make\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692855868894841*^9, 
  3.692855870927044*^9}},ExpressionUUID->"fd47a100-e59e-4dca-a432-\
db590ea384b7"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4Download\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"c5080d8b-e543-457e-8344-1b028dd41b84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"psi4Download", "[", 
    RowBox[{"parentDir_", "?", "DirectoryQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"RunInTerminal", "[", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "\"\<git\>\"", ",", "\"\<clone\>\"", ",", "\"\<--recursive\>\"", ",", 
      "\n", "\t\t", "\"\<https://github.com/psi4/psi4.git\>\"", ",", "\n", 
      "\t\t", 
      RowBox[{"ExpandFileName", "@", 
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"{", 
         RowBox[{"parentDir", ",", "\"\<psi4\>\""}], "}"}]}]}]}], "\n", 
     "\t\t", "}"}], "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"ed251be3-5bbe-47a1-b569-877bf318f082"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4DirInittedQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"b8a8c4cd-4af3-4037-9ad1-ac055631c4e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4DirInittedQ", "[", "parentDir_", "]"}], ":=", "\n", "\t", 
  RowBox[{"DirectoryQ", "@", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{"parentDir", ",", " ", "\"\<psi4\>\""}], 
     "}"}]}]}]}]], \
"CodeInput",ExpressionUUID->"d01152a8-4bd4-4580-8e56-8f7b73d082a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4NoBinQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"dced52b7-45ee-4a71-9d3c-6a3bc4775e2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4HasBinQ", "[", "parentDir_", "]"}], ":=", "\n", "\t", 
  RowBox[{"FileExistsQ", "@", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
     "parentDir", ",", " ", "\"\<psi4\>\"", ",", " ", "\"\<bin\>\"", ",", 
      " ", "\"\<psi4\>\""}], 
     "}"}]}]}]}]], \
"CodeInput",ExpressionUUID->"8c59b2ae-4d04-446d-be8d-403e92df2923"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4NoBuildDirQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"87b62cbd-9869-4ebb-a197-ab723f938af7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4NoBuildDirQ", "[", "parentDir_", "]"}], ":=", "\n", "\t", 
  RowBox[{"!", 
   RowBox[{"DirectoryQ", "@", 
    RowBox[{"FileNameJoin", "@", 
     RowBox[{"{", 
      RowBox[{
      "parentDir", ",", " ", "\"\<psi4\>\"", ",", " ", "\"\<objdir\>\""}], 
      "}"}]}]}]}]}]], \
"CodeInput",ExpressionUUID->"f69959d5-4eca-49b1-9a4e-05808de9e81b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4BuildObjDir\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"bc80db38-5b4b-43db-9b05-8d284ca85280"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4BuildObjDir", "[", "parentDir_", "]"}], ":=", "\n", "\t", 
  RowBox[{"ExpandFileName", "@", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{"parentDir", ",", "\"\<psi4\>\"", ",", "\"\<objdir\>\""}], 
     "}"}]}]}]}]], \
"CodeInput",ExpressionUUID->"969bf5d5-36d2-466d-99b3-fbb98c449d5c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4BuildUnstagedQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"a05fb478-1e20-4403-b5ae-297cca1abb05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4BuildUnfinishedQ", "[", "parentDir_", "]"}], ":=", "\n", "\t", 
  
  RowBox[{"!", 
   RowBox[{"DirectoryQ", "@", "\n", "\t\t\t", 
    RowBox[{"FileNameJoin", "@", 
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{
      "parentDir", ",", "\n", "\t\t\t\t", "\"\<psi4\>\"", ",", 
       "\"\<objdir\>\"", ",", "\"\<stage\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"FileNameTake", "[", 
        RowBox[{
         RowBox[{"ExpandFileName", "@", "parentDir"}], ",", "1"}], "]"}]}], 
      "\n", "\t\t\t\t", 
      "}"}]}]}]}]}]], \
"CodeInput",ExpressionUUID->"88b6d7f3-934a-4892-bf5b-db75dea719a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4Build\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"70ba03b9-3245-4913-8576-cbe62959b26f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Build", "::", "nodir"}], "=", 
   "\"\<Directory `` not found\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"psi4Build", "[", 
    RowBox[{"parentDir_", "?", "DirectoryQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"psi4DirInittedQ", "@", "parentDir"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"psi4HasBinQ", "@", "parentDir"}], ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"{", 
             RowBox[{
             "parentDir", ",", " ", "\"\<psi4\>\"", ",", " ", "\"\<bin\>\""}],
              "}"}]}], "}"}]}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"AbsoluteTiming", "@", "\n", "\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"psi4NoBuildDirQ", "@", "parentDir"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"RunInTerminal", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"CMakeBinary", "[", "]"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "\"\<-H.\>\"", ",", "\"\<-Bobjdir\>\"", 
                 ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t", 
                 RowBox[{
                 "\"\<-DCMAKE_INSTALL_PREFIX=\>\"", "<>", "\n", "\t", "\t", 
                  "\t", "\t", "\t", "\t", "\t\t\t", 
                  RowBox[{"ExpandFileName", "@", 
                   RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", 
                    RowBox[{"parentDir", ",", " ", "\"\<psi4\>\""}], 
                    "}"}]}]}]}]}], "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                "}"}], ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t", 
               RowBox[{"ProcessEnvironment", "\[Rule]", 
                RowBox[{"<|", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t", 
                 RowBox[{
                 "\"\<PATH\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"StringRiffle", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Environment", "[", "\"\<PATH\>\"", "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ExpandFileName", "@", 
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", 
                    RowBox[{"parentDir", ",", " ", "\"\<psi4\>\""}], 
                    "}"}]}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", "\"\<:\>\""}], "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                 "|>"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"ProcessDirectory", "\[Rule]", 
                RowBox[{"ExpandFileName", "@", 
                 RowBox[{"FileNameJoin", "@", 
                  RowBox[{"{", 
                   RowBox[{"parentDir", ",", "\"\<psi4\>\""}], "}"}]}]}]}]}], 
              "\n", "\t", "\t", "\t", "\t\t\t\t", "]"}]}], "\n", "\t", "\t", 
            "\t", "\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"psi4BuildUnfinishedQ", "[", "parentDir", "]"}], ",", 
             "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"RunInTerminal", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<make\>\"", ",", 
                  "\"\<-j`getconf _NPROCESSORS_ONLN`\>\""}], "}"}], ",", "\n",
                 "\t\t\t\t\t\t\t", 
                RowBox[{"ProcessDirectory", "\[Rule]", 
                 RowBox[{"psi4BuildObjDir", "[", "parentDir", "]"}]}]}], "\n",
                "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t", 
              RowBox[{"RunInTerminal", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<make\>\"", ",", "\"\<install\>\""}], "}"}], ",",
                 "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"ProcessDirectory", "\[Rule]", 
                 RowBox[{"psi4BuildObjDir", "[", "parentDir", "]"}]}]}], "\n",
                "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}], ",",
            "\n", "\t\t\t\t\t", 
           RowBox[{"With", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{"psi4", "=", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
               "ExpandFileName", "@", "\n", "\t", "\t", "\t", "\t", 
                "\t\t\t\t", 
                RowBox[{"FileNameJoin", "@", 
                 RowBox[{"{", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                  "parentDir", ",", " ", "\"\<psi4\>\"", ",", " ", 
                   "\"\<objdir\>\"", ",", " ", "\"\<stage\>\"", ",", "\n", 
                   "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{"ExpandFileName", "@", "parentDir"}], ",", " ", 
                   "\"\<psi4\>\""}], "\n", "\t", "\t", "\t", "\t", 
                  "\t\t\t\t\t", "}"}]}]}]}], "\n", "\t", "\t", "\t", 
              "\t\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"DirectoryQ", "@", "psi4"}], ",", "\n", "\t", "\t", 
               "\t", "\t\t\t\t", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"DirectoryQ", "@", 
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "parentDir", ",", " ", "\"\<psi4\>\"", ",", " ", 
                    "\"\<dist\>\""}], "}"}]}]}]}], ",", "\n", "\t", "\t", 
                  "\t", "\t\t\t\t\t", 
                  RowBox[{"CreateDirectory", "@", 
                   RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "parentDir", ",", " ", "\"\<psi4\>\"", ",", " ", 
                    "\"\<dist\>\""}], "}"}]}]}]}], "\n", "\t", "\t", "\t", 
                 "\t\t\t\t\t", "]"}], ";", "\n", "\t", "\t", "\t", "\t\t\t\t", 
                RowBox[{
                "CopyDirectory", "[", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"psi4", ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{"FileNameJoin", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    "parentDir", ",", " ", "\"\<psi4\>\"", ",", " ", 
                    "\"\<dist\>\"", ",", " ", "\"\<psi4\>\""}], "}"}]}]}], 
                 "\n", "\t", "\t", "\t", "\t\t\t\t\t", "]"}]}]}], "\n", "\t", 
              "\t", "\t", "\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
          "\n", "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "]"}], "//", "\n", 
      "\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "@", 
           RowBox[{"Last", "@", "#"}]}], "=!=", "Null"}], ",", "\n", "\t", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"$Psi4BuildLogs", "=", 
           RowBox[{"Last", "@", "#"}]}], ";", "\n", "\t", "\t\t\t", 
          RowBox[{"TemplateApply", "[", 
           RowBox[{
           "\"\<Built to `pkg`. Took `time`.\>\"", ",", "\n", "\t", "\t", 
            "\t\t\t\t", 
            RowBox[{"<|", "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"\"\<time\>\"", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"UnitConvert", "[", 
                RowBox[{
                 RowBox[{"Quantity", "[", 
                  RowBox[{
                   RowBox[{"First", "@", "#"}], ",", "\"\<Seconds\>\""}], 
                  "]"}], ",", "\"\<Minutes\>\""}], "]"}]}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"\"\<pkg\>\"", "\[Rule]", 
               RowBox[{"Last", "@", 
                RowBox[{"Last", "@", "#"}]}]}]}], "\n", "\t", "\t\t\t\t\t\t", 
             "|>"}]}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"PackageRaiseException", "[", 
          RowBox[{
          "\"\<Psi4Build\>\"", ",", "\n", "\t\t\t\t\t", 
           "\"\<Failed to build Psi4 to ``\>\"", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"\"\<MessageParameters\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"{", 
               RowBox[{"parentDir", ",", "\"\<psi4\>\""}], "}"}]}], "}"}]}]}],
           "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], "&"}]}], ",",
      "\n", "\t\t", 
     RowBox[{"PackageRaiseException", "[", 
      RowBox[{
      "\"\<Psi4Build\>\"", ",", "\n", "\t\t\t", 
       "\"\<Failed to download psi4 to ``\>\"", ",", "\n", "\t\t\t", 
       RowBox[{"\"\<MessageParameters\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"{", 
           RowBox[{"parentDir", ",", "\"\<psi4\>\""}], "}"}]}], "}"}]}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"491b4349-0c56-40ef-80cc-785607930fa2"]\

}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Psi4Build\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"57d1e45e-6a2b-4cb1-8e80-b903dc68e328"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Build", "[", 
    RowBox[{"parentDir_", "?", "DirectoryQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"PackageExceptionBlock", "[", "\"\<Psi4Build\>\"", "]"}], "@", 
    "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"$OperatingSystem", "\[Equal]", "\"\<Windows\>\""}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"PackageRaiseException", "[", 
       RowBox[{
       "\"\<Psi4Build\>\"", ",", "\n", "\t\t\t\t", 
        "\"\<psi4 is designed for Unix systems only\>\""}], "\n", "\t\t\t\t", 
       "]"}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"FileNameJoin", "@", 
            RowBox[{"{", 
             RowBox[{"parentDir", ",", " ", "\"\<psi4\>\""}], "}"}]}]}]}], 
         ",", "\n", "\t", "\t", "\t\t", 
         RowBox[{"psi4Download", "@", "parentDir"}]}], "\n", "\t", "\t", 
        "\t\t", "]"}], ";", "\n", "\t", "\t", "\t", 
       RowBox[{"psi4Build", "@", "parentDir"}]}]}], "\n", "\t\t\t", "]"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Build", "[", 
    RowBox[{"Optional", "[", 
     RowBox[{"Automatic", ",", " ", "Automatic"}], "]"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Psi4Build", "[", 
    RowBox[{"DirectoryName", "[", "$Psi4Dir", "]"}], "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"07afcbb0-2faf-40a4-a912-a79af50c6619"]\

}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Utilities\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6929673000074253`*^9, 
  3.692967306797037*^9}},ExpressionUUID->"7cd03c96-d584-4846-99f5-\
9340d3d03a4f"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]bin\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"89903538-42eb-4ba5-bb11-2cc6e9ad22dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psiBin", "[", "d_String", "]"}], ":=", 
  RowBox[{"FileNameJoin", "@", 
   RowBox[{"{", 
    RowBox[{"d", ",", "\"\<bin\>\"", ",", "\"\<psi4\>\""}], 
    "}"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.692967380157936*^9, 
  3.6929673899787188`*^9}},ExpressionUUID->"7bcd8eb8-5a24-4cf0-8f67-\
005bcc2c85eb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Q\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"f95ef2d5-53a4-4ec1-b505-3a598863353f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"psi4Q", "[", "d_String", "]"}], ":=", "\n", "\t", 
   RowBox[{"FileExistsQ", "@", 
    RowBox[{"psiBin", "@", "d"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"psi4Q", "[", "_", "]"}], ":=", "\n", "\t", "False"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.69296730924701*^9, 
  3.69296739556249*^9}},ExpressionUUID->"437eaa33-100d-4f72-a73f-82ce7d4f8fbc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]AutoGrid\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694178248672617*^9, 
  3.694178252439054*^9}},ExpressionUUID->"ac09d119-e595-4558-8cf9-\
8b3830534889"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4UtilsAutoGrid", "[", "\n", "\t", 
    RowBox[{"atomset_List", ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{
      "xpoints_Integer", ",", "ypoints_Integer", ",", "zpoints_Integer"}], 
      "}"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<Sphere\>\"", "|", "\"\<Grid\>\""}], ":", "\"\<Grid\>\""}], 
     ",", "\n", "\t", 
     RowBox[{"props___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cbs", "=", 
       RowBox[{"ChemUtilsCoordinateBounds", "[", "atomset", "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Molecules\>\"", "->", "atomset"}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Grid\>\"", "->", "\n", "\t\t\t\t", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\n", "\t", 
          "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"Subdivide", "[", 
               RowBox[{
                RowBox[{"cbs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "xpoints"}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"f_", ",", "l_"}], "}"}], "\[RuleDelayed]", "f"}], 
              ",", "1"}], "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"Subdivide", "[", 
               RowBox[{
                RowBox[{"cbs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "ypoints"}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"f_", ",", "l_"}], "}"}], "\[RuleDelayed]", "f"}], 
              ",", "1"}], "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"Subdivide", "[", 
               RowBox[{
                RowBox[{"cbs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "zpoints"}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"f_", ",", "l_"}], "}"}], "\[RuleDelayed]", "f"}], 
              ",", "1"}], "]"}]}], "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", 
       "\n", "\t\t\t", "props"}], "\n", "\t\t\t", "|>"}]}], "\t", "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4UtilsAutoGrid", "[", "\n", "\t", 
    RowBox[{"atomset_List", ",", "\n", "\t", 
     RowBox[{"atMostPoints", ":", "_Integer", ":", "27"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<Sphere\>\"", "|", "\"\<Grid\>\""}], ":", "\"\<Grid\>\""}], 
     ",", "\n", "\t", 
     RowBox[{"props___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"xp", "=", 
        RowBox[{"Floor", "@", 
         RowBox[{"Power", "[", 
          RowBox[{"atMostPoints", ",", 
           RowBox[{"1", "/", "3"}]}], "]"}]}]}], ",", "\n", "\t\t", 
       RowBox[{"yp", "=", 
        RowBox[{"Floor", "@", 
         RowBox[{"Power", "[", 
          RowBox[{"atMostPoints", ",", 
           RowBox[{"1", "/", "3"}]}], "]"}]}]}], ",", "\n", "\t\t", 
       RowBox[{"zp", "=", 
        RowBox[{"Floor", "@", 
         RowBox[{"Power", "[", 
          RowBox[{"atMostPoints", ",", 
           RowBox[{"1", "/", "3"}]}], "]"}]}]}]}], "\n", "\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"Psi4UtilsAutoGrid", "[", 
      RowBox[{"atomset", ",", 
       RowBox[{"{", 
        RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}], ",", "props"}], "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694178255279222*^9, 3.6941783145115356`*^9}, {
  3.695139037620151*^9, 3.695139037624641*^9}, {3.695139687573566*^9, 
  3.69513969195632*^9}, {3.71035327819347*^9, 3.710353281984528*^9}, {
  3.710353709238289*^9, 3.710353773209277*^9}, {3.715083122249922*^9, 
  3.715083124662291*^9}, {3.715175911607781*^9, 3.715175946322373*^9}, {
  3.715175989141238*^9, 3.715175991481223*^9}, {3.715176037155026*^9, 
  3.715176037347982*^9}},ExpressionUUID->"126e1f1e-b780-4766-bd5d-\
06d69b4a913a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Scan Specs\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7151757010549183`*^9, 
  3.7151757092855453`*^9}},ExpressionUUID->"29ca8244-2d89-4bc5-b031-\
3b06d14de185"],

Cell[BoxData[
 RowBox[{"Psi4UtilsCoordinateScanGrid", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.715179463141954*^9, 
  3.715179463956929*^9}},ExpressionUUID->"4f33a315-f3f1-456d-88fa-\
6cd178a26f8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Psi4UtilsCoordinateScanGrid", "[", "\n", "\t", 
   RowBox[{"coordinateBounds_", ",", "\n", "\t", 
    RowBox[{"divs", ":", 
     RowBox[{"{", 
      RowBox[{"Repeated", "[", 
       RowBox[{
        RowBox[{"_", "\[Rule]", "_"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], "}"}]}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"Map", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"divs", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", " ", "2"}], "]"}], "]"}], ",", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"i_", "?", "NumericQ"}], ":>", "\n", "\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"divs", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", "\n", "\t\t\t\t\t", 
            
            RowBox[{"Sequence", "@@", 
             RowBox[{"coordinateBounds", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Subtract", ",", 
               RowBox[{"Reverse", "[", 
                RowBox[{"coordinateBounds", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "]"}], "/", "i"}]}],
            "\n", "\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"{", "s_List", "}"}], ":>", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"divs", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", "s"}], "}"}]}], ",",
          "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s_", ",", "e_", ",", "i_"}], "}"}], ":>", "\n", 
          "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"e", "-", "s"}], "]"}], ">", "0"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"divs", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", "s", "}"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"divs", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t", "s", ",", "\n", "\t", "\t\t\t\t\t", "e", ",", 
              "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"e", "-", "s"}], ")"}], "/", "i"}]}], "\n", 
             "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", 
        "\t\t\t", "}"}]}], "]"}], "&"}], ",", "\n", "\t\t", 
    RowBox[{"Range", "[", "3", "]"}]}], "\n", "\t\t", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Psi4UtilsCoordinateScanGrid", "[", "\n", "\t", 
   RowBox[{"coordinateBounds_", ",", "\n", "\t", 
    RowBox[{"divs", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"Psi4UtilsCoordinateScanGrid", "[", "\n", "\t\t", 
   RowBox[{"coordinateBounds", ",", "\n", "\t\t", 
    RowBox[{"Map", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<pyVar_\>\"", "<>", 
         RowBox[{"ToString", "[", "#", "]"}]}], "->", 
        RowBox[{"divs", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"Range", "[", "3", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
   "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.715175626481308*^9, 3.715175678407198*^9}, 
   3.715175963552574*^9, {3.715178426985427*^9, 3.7151785974478703`*^9}, {
   3.715178696615028*^9, 3.7151787145214443`*^9}, {3.715178775787318*^9, 
   3.7151788905637627`*^9}, {3.7151852782987127`*^9, 3.715185316016686*^9}, {
   3.715185392961897*^9, 
   3.715185397561475*^9}},ExpressionUUID->"b93fef34-69d0-435f-b385-\
52d11fbd4951"],

Cell[BoxData[
 RowBox[{"Psi4UtilsCoordinateScanSphere", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{
  3.71517947036049*^9},ExpressionUUID->"e8c25dfa-875a-4cdd-934a-97aa5f4883dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4UtilsCoordinateScanSphere", "[", "\n", "\t", 
    RowBox[{"coordinateBounds_", ",", "\n", "\t", 
     RowBox[{"divs", ":", 
      RowBox[{"{", 
       RowBox[{"Repeated", "[", 
        RowBox[{
         RowBox[{"_", "\[Rule]", "_"}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], "}"}]}]}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"Reverse", "@", 
           RowBox[{"MinMax", "[", 
            RowBox[{"Flatten", "@", "coordinateBounds"}], "]"}]}]}], ")"}], 
        "/", "2."}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Map", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"divs", "[", 
           RowBox[{"[", 
            RowBox[{"#", ",", " ", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", "\n", "\t", "\t\t\t", 
           RowBox[{
            RowBox[{"i_Integer", ":>", "\n", "\t", "\t\t\t\t", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"divs", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", "\n", "\t", 
               "\t\t\t\t\t", 
               RowBox[{"Switch", "[", 
                RowBox[{
                "#", ",", "\n", "\t", "\t\t\t\t\t\t", "1", ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{".00001", ",", 
                    RowBox[{"r", "/", "100"}]}], "}"}]}], ",", " ", "r", ",", 
                    " ", 
                    RowBox[{"r", "/", "i"}]}], "}"}]}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t", "2", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", "360", ",", " ", 
                    RowBox[{"360", "/", "i"}]}], "}"}]}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t", "3", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", "180", ",", " ", 
                    RowBox[{"180", "/", "i"}]}], "}"}]}]}], "\n", 
                "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "}"}]}], ",",
             "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"{", "s_List", "}"}], ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"divs", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", "s"}], "}"}]}], 
            ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"s_", ",", "e_", ",", "i_"}], "}"}], ":>", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"e", "-", "s"}], "]"}], ">", "0"}], "||", 
                RowBox[{"i", "\[Equal]", "0"}]}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"divs", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"{", "s", "}"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
               
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"divs", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", "\n", "\t", 
                 "\t", "\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"IntegerQ", "@", "s"}]}], ",", 
                   RowBox[{"N", "@", "s"}], ",", "s"}], "]"}], ",", "\n", 
                 "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"IntegerQ", "@", "e"}]}], ",", 
                   RowBox[{"N", "@", "e"}], ",", "e"}], "]"}], ",", "\n", 
                 "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"IntegerQ", "@", "#"}]}], ",", 
                    RowBox[{"N", "@", "#"}], ",", "#"}], "]"}], "&"}], "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"e", "-", "s"}], ")"}], "/", "i"}], "]"}]}], "\n",
                 "\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], 
           "\n", "\t\t\t\t", "}"}]}], "]"}], "&"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"Range", "[", "3", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4UtilsCoordinateScanSphere", "[", "\n", "\t", 
   RowBox[{"coordinateBounds_", ",", "\n", "\t", 
    RowBox[{"divs", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"Psi4UtilsCoordinateScanSphere", "[", "\n", "\t\t", 
   RowBox[{"coordinateBounds", ",", "\n", "\t\t", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<pyVar_\>\"", "<>", 
         RowBox[{"ToString", "[", "#", "]"}]}], "\[Rule]", 
        RowBox[{"divs", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", 
      RowBox[{"Range", "[", "3", "]"}]}], "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.715175683070771*^9, 3.715175855940531*^9}, {
   3.7151759530672197`*^9, 3.7151759594331017`*^9}, {3.715176062537629*^9, 
   3.715176080512054*^9}, {3.71517813963382*^9, 3.715178162192219*^9}, {
   3.7151787217094603`*^9, 3.7151787565833178`*^9}, {3.71517890656065*^9, 
   3.71517916601598*^9}, {3.715179218031993*^9, 3.715179237112458*^9}, 
   3.715179355703506*^9, {3.7151853278226137`*^9, 3.7151853865156927`*^9}, {
   3.715190946762693*^9, 3.715190951998251*^9}, {3.7151934035924187`*^9, 
   3.71519341781909*^9}},ExpressionUUID->"f1e94df6-74a9-4ae7-af0c-\
035fccd0e1a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]AutoScan\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.715082987604414*^9, 
  3.715082988722891*^9}},ExpressionUUID->"a33b4e3c-43e6-4858-ac13-\
e4aebbc772b7"],

Cell[BoxData[{
 RowBox[{"psi4ScanSpecBasePat", "=", "\n", "\t", 
  RowBox[{
   RowBox[{"_", "?", "NumericQ"}], "|", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "?", "NumericQ"}], ",", 
     RowBox[{"_", "?", "NumericQ"}], ",", 
     RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
   RowBox[{"{", "_List", "}"}]}]}], "\n", 
 RowBox[{"psi4ScanSpecPat", "=", "\n", "\t", 
  RowBox[{"psi4ScanSpecBasePat", "|", "\n", "\t\t", 
   RowBox[{"(", 
    RowBox[{"_", "\[Rule]", "psi4ScanSpecBasePat"}], ")"}]}]}]}], "CodeInput",
 
 CellChangeTimes->{{3.715179246269958*^9, 3.715179294957068*^9}, {
  3.715185775831932*^9, 
  3.715185800455275*^9}},ExpressionUUID->"5dc05069-a574-4c65-9414-\
4dd777019f2e"],

Cell[BoxData[
 RowBox[{"Psi4UtilsAutoScan", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.715179474838615*^9, 
  3.7151794755660152`*^9}},ExpressionUUID->"be884dab-0916-4bf5-a0e3-\
82337bd52826"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4UtilsAutoScan", "[", "\n", "\t", 
    RowBox[{"atomset_List", ",", "\n", "\t", 
     RowBox[{"pts", ":", 
      RowBox[{"{", 
       RowBox[{"Repeated", "[", 
        RowBox[{"psi4ScanSpecPat", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<Sphere\>\"", "|", "\"\<Cube\>\""}], ":", "\"\<Cube\>\""}], 
     ",", "\n", "\t", 
     RowBox[{"props___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"cbs", "=", "\n", "\t\t\t\t", 
       RowBox[{"ChemUtilsCoordinateBounds", "@", "\n", "\t\t\t\t\t", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"atomset", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Except", "[", 
           RowBox[{"{", 
            RowBox[{"_", ",", 
             RowBox[{"{", 
              RowBox[{"__", "?", "NumericQ"}], "}"}]}], "}"}], "]"}]}], "\n", 
         "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{"props", ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Molecules\>\"", "->", "atomset"}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Scan\>\"", "->", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mode", "===", "\"\<Sphere\>\""}], ",", "\n", "\t\t\t\t\t", 
          
          RowBox[{"Psi4UtilsCoordinateScanSphere", "[", 
           RowBox[{"cbs", ",", "pts"}], "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Psi4UtilsCoordinateScanGrid", "[", 
           RowBox[{"cbs", ",", "pts"}], "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mode", "===", "\"\<Sphere\>\""}], ",", "\n", "\t\t\t\t", 
         RowBox[{"\"\<ScanCoordinatesPre\>\"", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"scanf", "=", 
              RowBox[{"Lookup", "[", 
               RowBox[{
                RowBox[{"{", "props", "}"}], ",", 
                "\"\<ScanCoordinatesPre\>\"", ",", "Identity"}], "]"}]}], 
             "}"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"scanf", "===", "Identity"}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"PyFromSphericalCoordinates", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", "#2", ",", "#3"}], "}"}], "]"}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
              "PyFromSphericalCoordinates", "@", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"PyStar", "[", 
                RowBox[{
                 RowBox[{"PyCall", "[", "scanf", "]"}], "[", 
                 RowBox[{"#", ",", "#2", ",", "#3"}], "]"}], "]"}]}]}], "\n", 
             "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
         "\n", "\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
      "\t\t\t", "|>"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4UtilsAutoScan", "[", "\n", "\t", 
    RowBox[{"atomset_List", ",", "\n", "\t", 
     RowBox[{"atMostPoints", ":", "_Integer", ":", "27"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<Sphere\>\"", "|", "\"\<Grid\>\""}], ":", "\"\<Grid\>\""}], 
     ",", "\n", "\t", 
     RowBox[{"props___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"xp", "=", 
        RowBox[{"Floor", "@", 
         RowBox[{"Power", "[", 
          RowBox[{"atMostPoints", ",", 
           RowBox[{"1", "/", "3"}]}], "]"}]}]}], ",", "\n", "\t\t", 
       RowBox[{"yp", "=", 
        RowBox[{"Floor", "@", 
         RowBox[{"Power", "[", 
          RowBox[{"atMostPoints", ",", 
           RowBox[{"1", "/", "3"}]}], "]"}]}]}], ",", "\n", "\t\t", 
       RowBox[{"zp", "=", 
        RowBox[{"Floor", "@", 
         RowBox[{"Power", "[", 
          RowBox[{"atMostPoints", ",", 
           RowBox[{"1", "/", "3"}]}], "]"}]}]}]}], "\n", "\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"Psi4UtilsAutoScan", "[", 
      RowBox[{"atomset", ",", 
       RowBox[{"{", 
        RowBox[{"xp", ",", "yp", ",", "zp"}], "}"}], ",", "mode", ",", 
       "props"}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJwdx2kow3EAh/GlLMcbaVKuNrYschY2NbXaiy1imGxauTYyNNZoL5hSwnKU
I9dIXogXW63k3BSFWrxZa7xAkoRRwyxrxO/7f/H06WE1aavUYTQaLZkEM0Su
hi+LV9i9f9UORYl8PVyqUc7Aov7nBViZVrAI7wfiVqBss/UAGiTVbshzBjxQ
oHNkBYh0uZvywxFRDbNjvbUwSi5TQuO4hXJq8rYRMjeWmyDLr+yACpupE9rL
RgpCxFP6IR8esm7EMN/MlMATdWE5lHLzKmAK+7wZdpWmtsDfEs0j0+oV/g2v
+WGXYygEze2N4Sxi0vFcLEzQPDCgkzt4AU3FZy74I4+/hGExPVfwc9I4nUoM
2PjzULC7swdr6NF26t1SSRrxKYcjgzzVYh30v/Wp4JFYoYEq+7YOXo/1qtjE
3EtfG7QY1r/TiYrZ1yAlZ/Quk6gPWilFjMgX6NnQeuFq/YQPvlu2KP8BYQH/
qg==
  "],ExpressionUUID->"db3386c1-89a9-47aa-8f51-5e5df448bff4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Formatting\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692965246994623*^9, 3.692965248593052*^9}, {
  3.692966496188196*^9, 
  3.692966497379972*^9}},ExpressionUUID->"850efd71-5800-4e47-b513-\
0a4082f5c81b"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Images\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693153358787324*^9, 
  3.693153360283251*^9}},ExpressionUUID->"df8f43e7-3971-4da0-a8b1-\
c4823d99919e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$psi4RunIcon", "=", "\n", "\t", 
   RowBox[{"Import", "@", 
    RowBox[{"PackageFilePath", "[", 
     RowBox[{
     "\"\<Resources\>\"", ",", " ", "\"\<Icons\>\"", ",", " ", 
      "\"\<Psi4RunIcon.png\>\""}], "]"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"90a0bd2f-b343-4c91-85ee-59b8244aa251"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$psi4PNG", "=", "\n", "\t", 
   RowBox[{"Image", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Import", "@", 
      RowBox[{"PackageFilePath", "[", 
       RowBox[{
       "\"\<Resources\>\"", ",", " ", "\"\<Icons\>\"", ",", " ", 
        "\"\<Psi4Icon.png\>\""}], "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"ImageSize", "\[Rule]", "32"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"f5adecb5-ca22-4bd5-9116-49ed3c62ff72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$psi4InIcon", "=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bg", "=", 
        RowBox[{"GrayLevel", "@", ".9"}]}], ",", 
       RowBox[{"bd", "=", 
        RowBox[{"GrayLevel", "@", ".8"}]}], ",", 
       RowBox[{"X", "=", "1.15"}], ",", 
       RowBox[{"ys", "=", ".25"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Graphics", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"bg", ",", "\n", "\t\t\t\t", 
         RowBox[{"EdgeForm", "@", "bd"}], ",", "\n", "\t", "\t", "\t\t", 
         RowBox[{"Polygon", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", "ys"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "ys"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1", "-", "ys"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", 
              RowBox[{"1", "-", "ys"}]}], "}"}]}], "}"}]}], ",", "\n", "\t", 
         "\t", "\t", "\t", 
         RowBox[{"Inset", "[", 
          RowBox[{"$psi4PNG", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "-", ".1"}], ",", "1"}], "}"}]}], "]"}]}], "\n", 
        "\t", "\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"X", "+", ".05"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"ImageSize", "\[Rule]", "32"}]}], "\n", "\t", "\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"2a5825f4-0c1e-4f14-bccd-0a834eaaccf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$psi4OutIcon", "=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bg", "=", 
        RowBox[{"GrayLevel", "@", ".9"}]}], ",", 
       RowBox[{"bd", "=", 
        RowBox[{"GrayLevel", "@", ".8"}]}], ",", 
       RowBox[{"X", "=", "1.15"}], ",", 
       RowBox[{"ys", "=", ".25"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Graphics", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"bg", ",", "\n", "\t\t\t\t", 
         RowBox[{"EdgeForm", "@", "bd"}], ",", "\n", "\t", "\t", "\t\t", 
         RowBox[{"Polygon", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", ".5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", "ys"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "ys"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", 
              RowBox[{"1", "-", "ys"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"X", "/", "2"}], ",", 
              RowBox[{"1", "-", "ys"}]}], "}"}]}], "}"}]}], ",", "\n", "\t", 
         "\t", "\t", "\t", 
         RowBox[{"Inset", "[", 
          RowBox[{"$psi4PNG", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "-", ".1"}], ",", "1"}], "}"}]}], "]"}]}], "\n", 
        "\t", "\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"X", "+", ".05"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"ImageSize", "\[Rule]", "32"}]}], "\n", "\t", "\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"b05cb6f0-4096-4c90-94f7-cc1d42a4534e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Functions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693153352595378*^9, 
  3.693153354187955*^9}},ExpressionUUID->"98cc44a7-990c-445b-8234-\
127928867d79"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sysOpen", "[", "f_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "$OperatingSystem", ",", "\n", "\t\t", "\"\<MacOSX\>\"", ",", "\n", 
     "\t\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", "\n", "\t\t\t\t", 
         RowBox[{"RunProcess", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<open\>\"", ",", "\"\<-a\>\"", ",", "\"\<TextWrangler\>\"", 
            ",", "f"}], "}"}], "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", "\"\<ExitCode\>\"", "]"}], "=!=", "0"}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"RunProcess", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<open\>\"", ",", "\"\<-t\>\"", ",", "f"}], "}"}], 
          "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
     "\n", "\t\t", "\"\<Windows\>\"", ",", "\n", "\t\t\t", 
     RowBox[{"RunProcess", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<start\>\"", ",", "f"}], "}"}], "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.693152834933683*^9, 3.693152853183111*^9}, {
  3.711069966420233*^9, 3.711069967145714*^9}, {3.715138595772977*^9, 
  3.715138597987545*^9}},ExpressionUUID->"22ba6577-f228-4d4e-b603-\
281cf7985345"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"openTMP", "[", 
    RowBox[{"f_", ",", "s_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"opf", "=", "\n", "\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmp", "=", 
           RowBox[{"OpenWrite", "@", 
            RowBox[{"FileNameJoin", "@", 
             RowBox[{"{", 
              RowBox[{"$TemporaryDirectory", ",", "f"}], "}"}]}]}]}], "}"}], 
         ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"WriteString", "[", 
           RowBox[{"tmp", ",", "s"}], "]"}], ";", "\n", "\t\t\t", 
          RowBox[{"Close", "@", "tmp"}]}]}], "\n", "\t\t\t", "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"sysOpen", "@", "opf"}], ";", "\n", "\t\t", 
      RowBox[{"RunScheduledTask", "[", 
       RowBox[{
        RowBox[{"DeleteFile", "@", "opf"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6931527264576073`*^9, 3.693152793152426*^9}, {
   3.6931528412692327`*^9, 3.693152859619852*^9}, 3.6931535006571617`*^9, {
   3.693153611530348*^9, 
   3.693153648478475*^9}},ExpressionUUID->"2ee9e345-5c67-4aca-b02b-\
8160ab6f9845"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Psi4\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693151495841394*^9, 3.69315149835962*^9}, {
  3.693152051047428*^9, 
  3.693152060318205*^9}},ExpressionUUID->"586a3fa0-0c2d-4816-8b26-\
52ace0f4599c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"Psi4", "[", 
     RowBox[{"dir_", "?", "psi4Q"}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"RawBoxes", "@", 
    RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t", 
     RowBox[{"\"\<Psi4\>\"", ",", "\n", "\t\t", 
      RowBox[{"Psi4", "[", "dir", "]"}], ",", "\n", "\t\t", "$psi4PNG", ",", 
      "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{"\"\<Directory: \>\"", ",", "\n", "\t\t\t\t", 
           RowBox[{"Button", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Mouseover", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"FileNameTake", "@", "dir"}], ",", 
                 "\"\<Hyperlink\>\""}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"FileNameTake", "@", "dir"}], ",", 
                 "\"\<HyperlinkActive\>\""}], "]"}]}], "\n", "\t\t\t\t\t\t", 
              "]"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"SystemOpen", "@", 
              RowBox[{"ExpandFileName", "@", "dir"}]}], ",", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}]}], "\n", 
            "\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
         "StandardForm"}], "]"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{"\"\<Program: \>\"", ",", "\n", "\t\t\t\t", 
           RowBox[{"Button", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Mouseover", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<psi4\>\"", ",", "\"\<Hyperlink\>\""}], "]"}], 
               ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<psi4\>\"", ",", "\"\<HyperlinkActive\>\""}], 
                "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"SystemOpen", "@", 
              RowBox[{"ExpandFileName", "@", 
               RowBox[{"FileNameJoin", "@", 
                RowBox[{"{", 
                 RowBox[{"dir", ",", "\"\<bin\>\""}], "}"}]}]}]}], ",", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}]}], "\n", 
            "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", 
         "\t\t\t\t", "StandardForm"}], "]"}], "\n", "\t\t\t", "}"}], ",", 
      "\n", "\t\t", "StandardForm"}], "\n", "\t\t", "]"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6929664661002073`*^9, 3.6929664831793613`*^9}, {
  3.692966517368729*^9, 3.692966526323897*^9}, {3.69296664115803*^9, 
  3.6929667398964167`*^9}, {3.692966801754175*^9, 3.692966848107757*^9}, {
  3.692966903356329*^9, 3.692966911252255*^9}, {3.692966970600522*^9, 
  3.692967236667138*^9}, {3.6929673439201508`*^9, 
  3.692967363430346*^9}},ExpressionUUID->"dc7db16a-3d12-4d77-9c6d-\
c0dd85b50b19"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Data\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693151518103704*^9, 
  3.69315151859925*^9}},ExpressionUUID->"d9cf521b-a0dd-4fbb-b10c-\
839575c5524a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"Psi4Data", "[", "a_Association", "]"}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"RawBoxes", "@", 
    RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t", 
     RowBox[{"\"\<Psi4Data\>\"", ",", "\n", "\t\t", 
      RowBox[{"Psi4Data", "[", "a", "]"}], ",", "\n", "\t\t", "$psi4Icon", 
      ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Items: \>\"", ",", 
           RowBox[{"Length", "@", "a"}]}], "}"}], ",", "StandardForm"}], 
        "]"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"{", " ", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"BoxForm`MakeSummaryItem", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Keys: \>\"", ",", 
            RowBox[{"Keys", "@", "a"}]}], "}"}], ",", "StandardForm"}], "]"}],
         ",", "\n", "\t\t\t", 
        RowBox[{"BoxForm`MakeSummaryItem", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Iterations: \>\"", ",", 
            RowBox[{"Max", "@", 
             RowBox[{"(", 
              RowBox[{"Length", "/@", "a"}], ")"}]}]}], "}"}], ",", 
          "StandardForm"}], "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t",
       "StandardForm"}], "\n", "\t\t", "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692965251708507*^9, 3.692965274313457*^9}, {
   3.692965309091094*^9, 3.69296534680018*^9}, {3.692966345672112*^9, 
   3.69296638328082*^9}, {3.692966916772027*^9, 3.692966917436957*^9}, 
   3.6929669746983757`*^9, 3.6929670182337418`*^9, {3.692968936101445*^9, 
   3.692968991443451*^9}},ExpressionUUID->"9cb01bb9-1b8f-4724-bde2-\
b892d5a8feeb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Input\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693151528551778*^9, 
  3.693151530303112*^9}},ExpressionUUID->"d61445d5-b805-4ea2-b087-\
3725d99d4681"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{"Psi4Input", "[", "a_Association", "]"}], "]"}], ":=", "\n", "\t", 
  
  RowBox[{"RawBoxes", "@", 
   RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t", 
    RowBox[{"\"\<Psi4Input\>\"", ",", "\n", "\t\t", 
     RowBox[{"Psi4Input", "[", "a", "]"}], ",", "\n", "\t\t", "$psi4InIcon", 
     ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"BoxForm`MakeSummaryItem", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<Main: \>\"", ",", "\n", "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"t", "=", 
               RowBox[{"a", "[", 
                RowBox[{"\"\<Input\>\"", ",", "\"\<input.dat\>\""}], "]"}]}], 
              ",", " ", 
              RowBox[{"ct", "=", 
               RowBox[{"Context", "@", "Psi4Input"}]}]}], "}"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Button", "[", 
             RowBox[{
              RowBox[{"Mouseover", "[", 
               RowBox[{"\"\<input.dat\>\"", ",", 
                RowBox[{"Style", "[", 
                 RowBox[{
                 "\"\<input.dat\>\"", ",", "\"\<HyperlinkActive\>\""}], 
                 "]"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Get", "[", 
                RowBox[{"StringTrim", "[", "ct", "]"}], "]"}], ";", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"openTMP", "[", 
                RowBox[{"\"\<input.dat\>\"", ",", "t"}], "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "}"}], ",",
         "\n", "\t\t\t\t", "StandardForm"}], "]"}], "\n", "\t\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"a", "[", "\"\<Directory\>\"", "]"}], ",", "\n", "\t\t\t\t", 
         
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"s_String", "?", "DirectoryQ"}], "\[RuleDelayed]", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"BoxForm`MakeSummaryItem", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<Directory: \>\"", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Button", "[", 
                 RowBox[{
                  RowBox[{"Mouseover", "[", 
                   RowBox[{
                    RowBox[{"FileNameTake", "@", "s"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "s"}], ",", 
                    "\"\<HyperlinkActive\>\""}], "]"}]}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"SystemOpen", "@", "s"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], ",", 
                  "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                 "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", 
              "\t\t\t\t\t\t\t", "StandardForm"}], "]"}]}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"_", "\[Rule]", "Nothing"}]}], "\n", "\t\t\t\t\t", "}"}]}],
         "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"o", "=", 
            RowBox[{"KeyDrop", "[", 
             RowBox[{
              RowBox[{"a", "[", "\"\<Input\>\"", "]"}], ",", 
              "\"\<input.dat\>\""}], "]"}]}], ",", " ", 
           RowBox[{"ct", "=", 
            RowBox[{"Context", "@", "Psi4Input"}]}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "o"}], ">", "0"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"BoxForm`MakeSummaryItem", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{"\"\<Other Inputs:\>\"", ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Normal", "@", "o"}], ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"f_", "\[Rule]", "t_"}], ")"}], ":>", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Button", "[", 
                   RowBox[{
                    RowBox[{"Mouseover", "[", 
                    RowBox[{"\"\<input.dat\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<input.dat\>\"", ",", "\"\<HyperlinkActive\>\""}], 
                    "]"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Get", "[", 
                    RowBox[{"StringTrim", "[", 
                    RowBox[{"ct", ",", " ", "\"\<Private`\>\""}], "]"}], 
                    "]"}], ";", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"openTMP", "[", 
                    RowBox[{"f", ",", "t"}], "]"}]}], ",", "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                   "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t", "1"}], "]"}]}], "\n", "\t\t\t\t\t\t", 
              "}"}], ",", "\n", "\t\t\t\t\t\t", "StandardForm"}], "]"}], ",", 
           "\n", "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", "]"}]}], "\n",
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Output Files:\>\"", ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{"a", ",", "\"\<Output\>\"", ",", "\"\<output.dat\>\""}], 
            "]"}]}], "}"}], ",", "\n", "\t\t\t\t", "StandardForm"}], "]"}]}], 
      "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", "StandardForm"}], "\n", 
    "\t\t", "]"}]}]}]], \
"CodeInput",ExpressionUUID->"7e7df792-556b-4ffa-8153-e87446d5194f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Output\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693151503047731*^9, 
  3.693151503879587*^9}},ExpressionUUID->"74722145-a9a9-465f-b56d-\
48902c0598f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"Psi4Output", "[", "a_Association", "]"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"RawBoxes", "@", 
    RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t", 
     RowBox[{"\"\<Psi4Output\>\"", ",", "\n", "\t\t", 
      RowBox[{"Psi4Output", "[", "a", "]"}], ",", "\n", "\t\t", 
      "$psi4OutIcon", ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Exit code: \>\"", ",", 
           RowBox[{"a", "[", "\"\<ExitCode\>\"", "]"}]}], "}"}], ",", 
         "StandardForm"}], "]"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "@", 
            RowBox[{"a", "[", "\"\<StandardOutput\>\"", "]"}]}], ">", "0"}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"Mouseover", "[", 
             RowBox[{"\"\<Output Messages\>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<Output Messages\>\"", ",", "\"\<HyperlinkActive\>\""}], 
               "]"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t", 
            RowBox[{"CreateDialog", "[", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Framed", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Pane", "[", 
                 RowBox[{
                  RowBox[{"a", "[", "\"\<StandardOutput\>\"", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", 
                    RowBox[{"{", 
                    RowBox[{"150", ",", "500"}], "}"}]}], "}"}], ",", 
                  RowBox[{"Scrollbars", "\[Rule]", "Automatic"}]}], "]"}], 
                ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Deployed", "\[Rule]", "False"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Selectable", "\[Rule]", "True"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"WindowClickSelect", "\[Rule]", "True"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"WindowTitle", "\[Rule]", "\"\<Standard Output\>\""}]}],
              "\n", "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t", 
            RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], ",", "\n", 
            "\t", "\t\t\t\t", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], "\n", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "Nothing"}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "@", 
            RowBox[{"a", "[", "\"\<StandardError\>\"", "]"}]}], ">", "0"}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"Mouseover", "[", 
             RowBox[{"\"\<Error Messages\>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<Error Messages\>\"", ",", "\"\<HyperlinkActive\>\""}], 
               "]"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t", 
            RowBox[{"CreateDialog", "[", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Framed", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Pane", "[", 
                 RowBox[{
                  RowBox[{"a", "[", "\"\<StandardError\>\"", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", 
                    RowBox[{"{", 
                    RowBox[{"150", ",", "500"}], "}"}]}], "}"}], ",", 
                  RowBox[{"Scrollbars", "\[Rule]", "Automatic"}]}], "]"}], 
                ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Deployed", "\[Rule]", "False"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Selectable", "\[Rule]", "True"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"WindowClickSelect", "\[Rule]", "True"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"WindowTitle", "\[Rule]", "\"\<Standard Error\>\""}]}], 
             "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], ",", "\n", 
            "\t", "\t\t\t\t", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], "\n", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "Nothing"}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyMemberQ", "[", 
           RowBox[{"a", ",", "\"\<InputFiles\>\""}], "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"BoxForm`MakeSummaryItem", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{"\"\<Input files:\>\"", ",", "\n", "\t\t\t\t\t", 
              RowBox[{"Column", "@", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Normal", "@", 
                  RowBox[{"a", "[", "\"\<InputFiles\>\"", "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"f_", "\[Rule]", "t_"}], ")"}], "\[RuleDelayed]", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ct", "=", 
                    RowBox[{"Context", "@", "Psi4Input"}]}], "}"}], ",", "\n",
                     "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Mouseover", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"f", ",", "\"\<HyperlinkActive\>\""}], "]"}]}], 
                    "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Get", "[", "ct", "]"}], ";", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"openTMP", "[", 
                    RowBox[{"f", ",", "t"}], "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"f_", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ct", "=", 
                    RowBox[{"Context", "@", "Psi4Input"}]}], "}"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Button", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Mouseover", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "f"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "f"}], ",", 
                    "\"\<HyperlinkActive\>\""}], "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Get", "[", "ct", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"sysOpen", "@", "f"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                  "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                 "1"}], "]"}]}]}], "\n", "\t", "\t\t\t\t\t", "}"}], ",", "\n",
             "\t", "\t\t\t\t\t", "StandardForm"}], "\n", "\t", "\t\t\t\t\t", 
           "]"}], ",", "\n", "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyMemberQ", "[", 
           RowBox[{"a", ",", "\"\<OutputFiles\>\""}], "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"BoxForm`MakeSummaryItem", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{"\"\<Output files:\>\"", ",", "\n", "\t\t\t\t\t", 
              RowBox[{"Column", "@", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Normal", "@", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{"a", ",", "\"\<OutputFiles\>\"", ",", 
                    RowBox[{"<|", "|>"}]}], "]"}]}], ",", "\n", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"f_", "\[Rule]", "t_"}], ")"}], "\[RuleDelayed]", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Mouseover", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"f", ",", "\"\<HyperlinkActive\>\""}], "]"}]}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"openTMP", "[", 
                    RowBox[{"f", ",", "t"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                   "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"f_", ":>", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Button", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Mouseover", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "f"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "f"}], ",", 
                    "\"\<HyperlinkActive\>\""}], "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"sysOpen", "@", "f"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BaseStyle", "\[Rule]", "\"\<Hyperlink\>\""}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                  "\t", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t", "1"}], "]"}]}]}], "\n", "\t", "\t\t\t\t\t", 
             "}"}], ",", "\n", "\t", "\t\t\t\t\t", "StandardForm"}], "\n", 
           "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", "Nothing"}], 
         "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
      "\t\t", "StandardForm"}], "\n", "\t\t", "]"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"5f0db930-2871-4e66-92fd-4e8734d3e8c1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OOP\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692966500635858*^9, 3.692966508107526*^9}, {
  3.6939629408773527`*^9, 
  3.6939629412518578`*^9}},ExpressionUUID->"a7550417-508e-4ba3-9003-\
33b197079146"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Directory\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692968879042531*^9, 
  3.6929688802412558`*^9}},ExpressionUUID->"b886397e-c3bc-4b13-a7a4-\
96c8dd3db4a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psi4", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Directory", "@", 
     RowBox[{"Psi4", "[", 
      RowBox[{"d_", "?", "psi4Q"}], "]"}]}], "]"}], ":=", "d"}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.69296743818198*^9, 
  3.692967477448659*^9}},ExpressionUUID->"d0b86919-ab7f-4acf-94e1-\
2090f822a206"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Part\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69296891101613*^9, 
  3.6929689118079367`*^9}},ExpressionUUID->"550b48e2-3bec-4ad4-88ea-\
0b5f1c1b5565"],

Cell[BoxData[
 RowBox[{"Psi4Data", "/:", 
  RowBox[{"HoldPattern", "[", 
   RowBox[{
    RowBox[{"Psi4Data", "[", "a_Association", "]"}], "[", "p__", "]"}], "]"}],
   ":=", "\n", "\t", 
  RowBox[{"psi4DataLookup", "[", 
   RowBox[{"a", ",", "p"}], "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.692968921147296*^9, 3.6929689278171883`*^9}, {
  3.692968999003723*^9, 
  3.692969045217135*^9}},ExpressionUUID->"90415e63-9fbb-4314-83c7-\
8559e9effceb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Run\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69296740927454*^9, 3.692967409617097*^9}, 
   3.6929689149267693`*^9},ExpressionUUID->"ee693065-d8e3-4bdf-98f8-\
462a04afd173"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Psi4", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4", "[", 
      RowBox[{"d_", "?", "psi4Q"}], "]"}], "[", 
     RowBox[{
      RowBox[{"data", ":", 
       RowBox[{
        RowBox[{"_String", "?", "FileExistsQ"}], "|", "_Association"}]}], ",",
       "params___"}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4Call", "[", 
    RowBox[{
     RowBox[{"Psi4", "[", "d", "]"}], ",", "data", ",", "params"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4", "[", 
      RowBox[{"d_", "?", "psi4Q"}], "]"}], "[", 
     RowBox[{"Psi4Input", "[", 
      RowBox[{"data_Association", ",", "params___"}], "]"}], "]"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"Psi4", "[", "d", "]"}], "[", 
    RowBox[{"data", ",", "params"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692999177231955*^9, 3.692999196475589*^9}, {
  3.692999230450234*^9, 3.692999305810388*^9}, {3.6931535371251297`*^9, 
  3.693153575311805*^9}},ExpressionUUID->"ffa589ba-ee4f-4beb-9ffc-\
3f6481ccd301"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Output\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693153269987072*^9, 
  3.693153270777945*^9}},ExpressionUUID->"2df97cec-20ef-4571-a310-\
ab464568fde3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Psi4Output", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4Output", "[", "a_Association", "]"}], "[", "k_String", 
     "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"a", ",", "k", ",", "\n", "\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{"a", ",", "\"\<OutputFiles\>\"", ",", 
           RowBox[{"<|", "|>"}]}], "]"}], ",", "k"}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"_Missing", ":>", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{"a", ",", "\"\<InputFiles\>\"", ",", 
            RowBox[{"<|", "|>"}]}], "]"}], ",", "k"}], "]"}]}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4Output", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4Output", "[", "a_Association", "]"}], "[", 
     RowBox[{"main_String", ",", "sub__String"}], "]"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"_List", "|", "_Association"}], "\[RuleDelayed]", 
         RowBox[{"Lookup", "[", 
          RowBox[{"#", ",", "#2"}], "]"}]}]}], "]"}], "&"}], ",", "a", ",", 
     RowBox[{"{", 
      RowBox[{"main", ",", "sub"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4Output", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4Output", "[", "a_Association", "]"}], "[", 
     RowBox[{"keys", ":", 
      RowBox[{"{", "__", "}"}]}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"Psi4Output", "[", "a", "]"}], "/@", "keys"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693004259879985*^9, 3.6930043110160637`*^9}, {
  3.69300742277423*^9, 3.693007441522953*^9}, {3.693007520028956*^9, 
  3.693007555283811*^9}, {3.693007599687323*^9, 3.6930076326571417`*^9}, {
  3.69300769434801*^9, 3.693007856583354*^9}, {3.693007887003888*^9, 
  3.6930078888814163`*^9}, {3.693015725382782*^9, 3.6930157420148897`*^9}, {
  3.693016162257225*^9, 3.693016187593889*^9}, {3.693016237966221*^9, 
  3.693016257396866*^9}},ExpressionUUID->"cbd737db-f0e0-4975-9d08-\
69f243c16ce1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Input\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69315327290559*^9, 
  3.693153273609663*^9}},ExpressionUUID->"846d1432-6ab1-4911-9c2c-\
26136f0d2701"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Psi4Input", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4Input", "[", "a_Association", "]"}], "[", "k_String", "]"}],
     "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"a", ",", "k", ",", "\n", "\t\t", 
     RowBox[{"Lookup", "[", 
      RowBox[{
       RowBox[{"a", "[", "\"\<Input\>\"", "]"}], ",", "k"}], "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4Input", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4Input", "[", "a_Association", "]"}], "[", 
     RowBox[{"main_String", ",", "sub__String"}], "]"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"_List", "|", "_Association"}], "\[RuleDelayed]", 
         RowBox[{"Lookup", "[", 
          RowBox[{"#", ",", "#2"}], "]"}]}]}], "]"}], "&"}], ",", "a", ",", 
     RowBox[{"{", 
      RowBox[{"main", ",", "sub"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4Input", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4Input", "[", "a_Association", "]"}], "[", 
     RowBox[{"keys", ":", 
      RowBox[{"{", "__", "}"}]}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"Psi4Output", "[", "a", "]"}], "/@", "keys"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4Input", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Psi4InputFile", "@", 
     RowBox[{"Psi4Input", "[", "a_Association", "]"}]}], "]"}], ":=", "\n", 
   "\t\t", 
   RowBox[{
    RowBox[{"Psi4Input", "[", "a", "]"}], "[", "\"\<input.dat\>\"", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693004259879985*^9, 3.6930043110160637`*^9}, {
  3.69300742277423*^9, 3.693007441522953*^9}, {3.693007520028956*^9, 
  3.693007555283811*^9}, {3.693007599687323*^9, 3.6930076326571417`*^9}, {
  3.69300769434801*^9, 3.693007856583354*^9}, {3.693007887003888*^9, 
  3.6930078888814163`*^9}, {3.693015725382782*^9, 3.6930157420148897`*^9}, {
  3.693016162257225*^9, 3.693016187593889*^9}, {3.693016237966221*^9, 
  3.693016257396866*^9}, {3.693153283588587*^9, 3.693153336574712*^9}, {
  3.69984459014419*^9, 
  3.699844615294157*^9}},ExpressionUUID->"1b3718f9-e1f9-4e8d-8dfb-\
cfac168840b8"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Run\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693150115183556*^9, 
  3.693150115686316*^9}},ExpressionUUID->"2a46f2be-92ce-4805-8028-\
304681698fce"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Call basic\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693150124583231*^9, 
  3.693150127853693*^9}},ExpressionUUID->"267a0fb2-7b83-4f8f-825e-\
6d04620bc3b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Call", "[", 
    RowBox[{
     RowBox[{"psi4Binary_String", "?", "FileExistsQ"}], ",", "\n", "\t", 
     RowBox[{"file_String", "?", "FileExistsQ"}], ",", "\n", "\t", 
     RowBox[{"output", ":", 
      RowBox[{"_String", "|", "_Alternatives", "|", "_StringExpression"}], 
      ":", "\"\<output.dat\>\""}], ",", "\n", "\t", 
     RowBox[{"processFunction", ":", 
      RowBox[{"RunProcess", "|", "RunInTerminal"}], ":", "RunProcess"}]}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", "=", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"DirectoryQ", "@", "file"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"ExpandFileName", "@", "file"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"ExpandFileName", "@", 
          RowBox[{"DirectoryName", "@", "file"}]}]}], "]"}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", "\n", "\t\t\t", 
         RowBox[{"processFunction", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DirectoryQ", "@", "file"}], ",", "\"\<psi4\>\"", ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"\"\<psi4\>\"", ",", 
               RowBox[{"FileNameTake", "@", "file"}]}], "}"}]}], "]"}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{"ProcessEnvironment", "\[Rule]", 
            RowBox[{"<|", "\n", "\t\t\t\t\t", 
             RowBox[{"\"\<PATH\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
              RowBox[{"StringJoin", "@", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"ExpandFileName", "@", 
                  RowBox[{"FileNameTake", "[", 
                   RowBox[{"psi4Binary", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t", "\"\<:\>\"", ",", "\n", "\t", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"Environment", "[", "\"\<PATH\>\"", "]"}]}], "\n", 
                "\t\t\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t\t", "|>"}]}], 
           ",", "\n", "\t\t\t\t", 
           RowBox[{"ProcessDirectory", "\[Rule]", "d"}]}], "\n", "\t\t\t\t", 
          "]"}]}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Psi4Output", "@", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", "\"\<ExitCode\>\"", "]"}], "===", "0"}], ",", 
          "\n", "\t\t\t\t\t", 
          RowBox[{"Merge", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"<|", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"\"\<InputFiles\>\"", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"<|", 
                   RowBox[{
                    RowBox[{"FileNameTake", "@", "file"}], "\[Rule]", 
                    RowBox[{"ExpandFileName", "@", "file"}]}], "|>"}], 
                  ")"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"\"\<OutputFiles\>\"", "\[Rule]", 
                 RowBox[{"FileNames", "[", 
                  RowBox[{"output", ",", "d"}], "]"}]}]}], "\n", 
               "\t\t\t\t\t\t\t", "|>"}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", 
            "\n", "\t\t\t\t\t\t", "First"}], "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Append", "[", 
           RowBox[{"r", ",", 
            RowBox[{"\"\<InputFiles\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"FileNameTake", "@", "file"}], "\[Rule]", 
                RowBox[{"ExpandFileName", "@", "file"}]}], "|>"}], ")"}]}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"06a4d31a-d242-4d1c-890b-762cef6f0783"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Terminal Call\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693150131005999*^9, 
  3.693150132989728*^9}},ExpressionUUID->"c124afea-918e-40e9-a336-\
fd4f748106a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psi4TerminalCall", "[", 
   RowBox[{
    RowBox[{"psi4Binary_String", "?", "FileExistsQ"}], ",", "p___"}], "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Psi4TerminalCall", "[", 
   RowBox[{"psi4Binary", ",", "p"}], "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.692979026786462*^9, 3.692979033891878*^9}, {
  3.692979117674308*^9, 3.692979128341078*^9}, {3.692979171178884*^9, 
  3.692979173281068*^9}, {3.692979262725944*^9, 3.692979281951123*^9}, {
  3.692980692968923*^9, 3.6929806937853193`*^9}, {3.692980727580234*^9, 
  3.6929807407766867`*^9}, {3.693002454348894*^9, 
  3.693002459065254*^9}},ExpressionUUID->"61403050-003b-42f5-bf2b-\
00a021db9c31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Call", "[", 
    RowBox[{
     RowBox[{"Psi4", "[", 
      RowBox[{"d_String", "?", "DirectoryQ"}], "]"}], ",", "\n", "\t", 
     "a___"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4Call", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"{", 
       RowBox[{"d", ",", "\"\<bin\>\"", ",", "\"\<psi4\>\""}], "}"}]}], ",", 
     "a"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4TerminalCall", "[", 
   RowBox[{
    RowBox[{"Psi4", "[", 
     RowBox[{"d_String", "?", "DirectoryQ"}], "]"}], ",", "\n", "\t", 
    "a___"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"Psi4TerminalCall", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "@", 
     RowBox[{"{", 
      RowBox[{"d", ",", "\"\<bin\>\"", ",", "\"\<psi4\>\""}], "}"}]}], ",", 
    "a"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.692979198559244*^9, 3.692979248790083*^9}, {
  3.692979538990425*^9, 
  3.692979542566208*^9}},ExpressionUUID->"5ed263cc-2999-4ed2-b8ac-\
ca30d0faa3b1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Association call\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6931501415096893`*^9, 
  3.693150144045289*^9}},ExpressionUUID->"364c6f31-1759-4372-9a82-\
8e0621dcd60c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Call", "[", 
    RowBox[{"psi4Binary_", ",", "\n", "\t", 
     RowBox[{
      RowBox[{"a_Association", "?", 
       RowBox[{"(", 
        RowBox[{"KeyMemberQ", "@", "\"\<Input\>\""}], ")"}]}], "|", 
      RowBox[{"Psi4Input", "[", 
       RowBox[{"a_Association", "?", 
        RowBox[{"(", 
         RowBox[{"KeyMemberQ", "@", "\"\<Input\>\""}], ")"}]}], "]"}]}], ",", 
     "\n", "\t", 
     RowBox[{"dir", ":", 
      RowBox[{
       RowBox[{"_String", "?", "DirectoryQ"}], "|", "Automatic"}], ":", 
      "Automatic"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"inputFiles", "=", 
        RowBox[{"a", "[", "\"\<Input\>\"", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"outputPattern", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{"a", ",", "\"\<Output\>\"", ",", "\"\<output.dat\>\""}], 
           "]"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"o_Association", "\[RuleDelayed]", 
             RowBox[{"Alternatives", "@@", 
              RowBox[{"Keys", "@", "o"}]}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"Except", "[", 
              RowBox[{
              "_String", "|", "_Alternatives", "|", "_StringExpressions"}], 
              "]"}], ":>", "\n", "\t\t\t\t\t", "\"\<output.dat\>\""}]}], "\n",
            "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"postProcessing", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{"a", ",", "\"\<Output\>\"", ",", "Identity"}], "]"}], ",", 
          
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{
             "_String", "|", "_StringExpression", "|", "_Alternatives"}], "->",
              "\n", "\t\t\t\t\t", "Identity"}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"l", ":", 
              RowBox[{"(", 
               RowBox[{"_List", "|", "_Rule"}], ")"}]}], "\[RuleDelayed]", 
             RowBox[{"Association", "@", "l"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"e", ":", 
              RowBox[{"Except", "[", "_Association", "]"}]}], ":>", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"<|", 
              RowBox[{"\"\<output.dat\>\"", "\[Rule]", "e"}], "|>"}]}]}], 
           "\n", "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"directory", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"dir", ",", "\n", "\t\t\t\t", 
          RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"a", "[", "\"\<Directory\>\"", "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Except", "[", 
               RowBox[{"_String", "?", "DirectoryQ"}], "]"}], ":>", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"CreateDirectory", "@", 
               RowBox[{"FileNameJoin", "@", 
                RowBox[{"{", 
                 RowBox[{"$TemporaryDirectory", ",", 
                  RowBox[{"CreateUUID", "[", "\"\<psi4-\>\"", "]"}]}], 
                 "}"}]}]}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
         "\t\t\t\t\t\t", "]"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"KeyValueMap", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"f", "=", 
             RowBox[{"OpenWrite", "@", 
              RowBox[{"FileNameJoin", "@", 
               RowBox[{"{", 
                RowBox[{"directory", ",", "#"}], "}"}]}]}]}], "}"}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"WriteString", "[", 
             RowBox[{"f", ",", "#2"}], "]"}], ";", "\n", "\t\t\t\t", 
            RowBox[{"Close", "@", "f"}]}]}], "\n", "\t\t\t\t", "]"}], "&"}], 
        ",", "\n", "\t\t\t", "inputFiles"}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", "=", 
          RowBox[{"Psi4Call", "[", 
           RowBox[{"psi4Binary", ",", "directory", ",", "outputPattern"}], 
           "]"}]}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"out", "=", "\n", "\t\t\t\t", 
            RowBox[{"Psi4Output", "@", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{
               RowBox[{"First", "@", "r"}], ",", 
               RowBox[{"{", "\n", "\t", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<InputFiles\>\"", "\[Rule]", 
                  RowBox[{"a", "[", "\"\<Input\>\"", "]"}]}], ",", "\n", "\t",
                  "\t\t\t\t", 
                 RowBox[{"\"\<GeneratedFiles\>\"", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", 
                    RowBox[{"directory", ",", "#"}], "}"}]}], "&"}], "/@", 
                    RowBox[{"Keys", "@", 
                    RowBox[{"a", "[", "\"\<Input\>\"", "]"}]}]}], ")"}]}], 
                 ",", "\n", "\t", "\t\t\t\t", 
                 RowBox[{
                 "\"\<OutputFiles\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"post", "=", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"postProcessing", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"l", ":", 
                    RowBox[{"_Association", "|", "_List"}]}], 
                    "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "@", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Normal", "@", 
                    RowBox[{"Append", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"KeyMap", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{"StringMatchQ", "[", "#", "]"}], ")"}]}], "&"}], 
                    ",", 
                    RowBox[{"Association", "@", "l"}]}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "\[Rule]", "Identity"}]}], "]"}]}]}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"e_", "\[RuleDelayed]", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"_", "\[Rule]", "e"}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FileExistsQ", "@", "#"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"fn", "=", 
                    RowBox[{"FileNameTake", "@", "#"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"fn", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"post", "[", "fn", "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Import", "[", 
                    RowBox[{"#", ",", "\"\<Text\>\""}], "]"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "Nothing"}], "]"}], "&"}], "/@", 
                    RowBox[{"r", "[", "\"\<OutputFiles\>\"", "]"}]}], "//", 
                    "\n", "\t\t\t\t\t\t\t\t", "Association"}]}], "\n", 
                   "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], 
              "]"}]}]}], "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dir", "===", "Automatic"}], "&&", 
              RowBox[{"!", 
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"a", "[", "\"\<Directory\>\"", "]"}], ",", 
                 RowBox[{"_String", "?", "DirectoryQ"}]}], "]"}]}]}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{"DeleteDirectory", "[", 
              RowBox[{"directory", ",", 
               RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], 
            "]"}], ";", "\n", "\t\t\t\t", "out"}]}], "\n", "\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Call", "[", 
    RowBox[{"psi4Binary_", ",", "\n", "\t", 
     RowBox[{"a_Association", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Not", "@*", "KeyMemberQ"}], "@", "\"\<Input\>\""}], ")"}]}], 
     ",", "\n", "\t", 
     RowBox[{"dir", ":", 
      RowBox[{
       RowBox[{"_String", "?", "DirectoryQ"}], "|", "Automatic"}], ":", 
      "Automatic"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4Call", "[", 
    RowBox[{"psi4Binary", ",", 
     RowBox[{"<|", 
      RowBox[{"\"\<Input\>\"", "\[Rule]", "a"}], "|>"}], ",", "dir"}], 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6929986356291323`*^9, 3.6929989640332117`*^9}, 
   3.692999028793222*^9, {3.6929990631747513`*^9, 3.69299908794005*^9}, {
   3.692999316915667*^9, 3.6929993672837543`*^9}, {3.6930011670473547`*^9, 
   3.6930011690361137`*^9}, {3.693001304920959*^9, 3.693001311872476*^9}, {
   3.693001365778755*^9, 3.693001401576145*^9}, {3.693004119469804*^9, 
   3.6930041215324383`*^9}, {3.693005044719336*^9, 3.6930050489030323`*^9}, {
   3.693007184115821*^9, 3.693007195529395*^9}, {3.693015670670237*^9, 
   3.6930156963885527`*^9}, {3.693078320653098*^9, 3.693078352784865*^9}, {
   3.693083232034741*^9, 3.693083280283194*^9}, {3.69308332555451*^9, 
   3.6930833396841803`*^9}, {3.6930843243551893`*^9, 
   3.6930843331750193`*^9}, {3.693084382454586*^9, 3.693084393384138*^9}, {
   3.6930897840709887`*^9, 3.693089807053351*^9}, {3.693114664414809*^9, 
   3.693114677860951*^9}, {3.693153396185628*^9, 3.693153411102181*^9}, {
   3.69418091778957*^9, 3.694181002582818*^9}, {3.694181045169599*^9, 
   3.694181237358156*^9}, {3.694181311591406*^9, 3.6941813432062607`*^9}, {
   3.694181406857053*^9, 3.6941814079280243`*^9}, {3.69418145891847*^9, 
   3.6941814955262747`*^9}, {3.694308104106441*^9, 
   3.694308202478932*^9}},ExpressionUUID->"7ab99484-90af-4e2a-ab10-\
b32655cc6611"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Configuration\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692966509587455*^9, 3.692966510043098*^9}, {
  3.693150150857099*^9, 
  3.6931501526613007`*^9}},ExpressionUUID->"cc103ca5-6079-4436-965c-\
ab58149b78c5"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Params\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693048611609318*^9, 
  3.693048612736112*^9}},ExpressionUUID->"518ed9af-f3c1-4f85-8f3b-\
eb43bbcd147b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Psi4ConfigMap", "=", 
   RowBox[{"<|", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<BasisSet\>\"", "\[Rule]", "\"\<basis\>\""}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<SCFType\>\"", "\[Rule]", "\"\<scf_type\>\""}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<DFTBasisSet\>\"", "\[Rule]", "\"\<df_basis\>\""}], ",", 
     "\n", "\t", 
     RowBox[{
     "\"\<DFTSelfConsistentBasisSet\>\"", "\[Rule]", "\"\<df_basis_scf\>\""}],
      ",", "\n", "\t", 
     RowBox[{"\"\<ReturnWavefunction\>\"", "\[Rule]", "\"\<return_wfn\>\""}], 
     ",", "\n", "\t", 
     RowBox[{"\"\<Properties\>\"", "\[Rule]", "\"\<properties\>\""}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<GridProperties\>\"", "\[Rule]", "\"\<grid_props\>\""}], ",",
      "\n", "\t", 
     RowBox[{"\"\<CubePropTasks\>\"", "\[Rule]", "\"\<cubeprop_tasks\>\""}], 
     ",", "\n", "\t", 
     RowBox[{
     "\"\<CubePropOrbitals\>\"", "\[Rule]", "\"\<cubeprop_orbitals\>\""}]}], 
    "\n", "\t", "|>"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692978264833816*^9, 3.692978272523366*^9}, {
  3.692997749384306*^9, 3.692997765156515*^9}, {3.69304863087523*^9, 
  3.693048632411683*^9}, {3.693072914469996*^9, 3.693072934271037*^9}, {
  3.6930759054807177`*^9, 3.693075911077876*^9}, {3.693077301311976*^9, 
  3.6930773464845543`*^9}, {3.693078003184422*^9, 3.693078011957576*^9}, {
  3.6930801298424187`*^9, 3.693080138512209*^9}, {3.693117189215307*^9, 
  3.693117224076021*^9}},ExpressionUUID->"57e34a70-3560-46c7-b0a3-\
6d7f0a0c2200"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Psi4ConfigChoices", "=", 
   RowBox[{"<|", "\n", "\t", 
    RowBox[{"\"\<CubePropTasks\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<orbitals\>\"", ",", "\"\<density\>\"", ",", 
       "\"\<basis_functions\>\"", ",", "\"\<esp\>\""}], "}"}]}], "\n", "\t", 
    "|>"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69297867397479*^9, 3.6929786815341454`*^9}, {
  3.693108581391696*^9, 
  3.693108682564967*^9}},ExpressionUUID->"dc551008-1d7c-462e-98ca-\
34e684357021"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Utils\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69513916874918*^9, 
  3.695139169445302*^9}},ExpressionUUID->"cd6b4226-d57f-40f3-aa27-\
ad30b7c3a652"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4DeCamelCase", "[", "s_", "]"}], ":=", "\n", "\t", 
  RowBox[{"ToLowerCase", "@", "\n", "\t\t", 
   RowBox[{"StringReplace", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"s", "/.", "$Psi4ConfigMap"}], ",", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"e_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"LetterQ", "@", "#"}], "&&", 
           RowBox[{"LowerCaseQ", "@", "#"}]}], "&"}], ")"}]}], "~~", "\n", 
       "\t", "\t\t\t", 
       RowBox[{"l_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"LetterQ", "@", "#"}], "&&", 
           RowBox[{"!", 
            RowBox[{"LowerCaseQ", "@", "#"}]}]}], "&"}], ")"}]}]}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{"e", "<>", "\"\<_\>\"", "<>", "l"}], ")"}]}]}], "\n", "\t", 
    "\t\t", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.710182815761672*^9, 3.710182859585845*^9}, {
  3.710182903989966*^9, 
  3.710182913860298*^9}},ExpressionUUID->"45f5ae89-05bd-46b3-a6b8-\
60e0a86cf7cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Psi4Compile\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"0ee4831b-ade8-4844-8b7d-112ecb849d69"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Compile", "[", "expr_", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"e", "=", 
       RowBox[{"expr", "/.", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k_String", "\[Rule]", "v_"}], ")"}], ":>", "\n", 
         "\t\t\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"psi4DeCamelCase", "[", "k", "]"}], "\[Rule]", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{"v", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"s", ":", 
                 RowBox[{"{", "__String", "}"}]}], "\[RuleDelayed]", 
                RowBox[{"Map", "[", 
                 RowBox[{"PyString", ",", " ", "s"}], "]"}]}], ",", " ", 
               RowBox[{"s_String", "\[RuleDelayed]", 
                RowBox[{"PyString", "[", "s", "]"}]}]}], "}"}]}], "]"}]}], 
          ")"}]}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"ToPython", "[", "e", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"3720487c-02cb-4715-b7d5-caefd800af48"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Molecule\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"7185c34e-60f6-4433-9cce-f60dd589a2c6"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]psi4MolSpec\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"cb9c78f5-ff66-4f2d-a2ae-93d0a8237203"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"psi4MolSpec", "[", 
    RowBox[{"els_", ",", "mode_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PyRow", "[", 
       RowBox[{"#", ",", " ", "\"\< \>\""}], "]"}], "&"}], "/@", 
     RowBox[{"Switch", "[", 
      RowBox[{"mode", ",", "\n", "\t\t", "Automatic", ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"els", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_String", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", "_String"}], ",", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", "_String"}], ",", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", "_String"}]}], "}"}]}],
               "}"}], ".."}], "}"}]}], "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Flatten", "/@", "els"}], ",", "\n", "\t\t\t\t", "els"}], 
        "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t", "\"\<MolTable\>\"", ",", 
       "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"els", ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_String", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", "_String"}], ",", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", "_String"}], ",", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", "_String"}]}], "}"}]}],
               "\n", "\t\t\t\t", "}"}], ".."}], "}"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"Flatten", "/@", "els"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"ChemFormatsZMatrixToMol", "@", "els"}]}]}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t", "\"\<ZMatrix\>\"", ",", "\n", 
       "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"els", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_String", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"_", "?", "NumericQ"}], ",", 
                 RowBox[{"_", "?", "NumericQ"}], ",", 
                 RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], ".."}], 
            "}"}]}], "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"ChemFormatsMolToZMatrix", "@", "els"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"Flatten", "/@", "els"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
      "\t\t", "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"\"\<Invisible\>\"", "\[Rule]", "\"\<X\>\""}], "}"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"3a9204aa-cc96-41f1-b692-6276cdb1ac52"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]$Psi4MolSpecs\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"ec22156c-25c8-4bee-b7de-66d31e680637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Psi4MolSpecs", "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "\"\<mol\>\""}], ",", "\n", "\t", 
     RowBox[{"2", "\[Rule]", "\"\<dimer\>\""}], ",", "\n", "\t", 
     RowBox[{"3", "\[Rule]", "\"\<trimer\>\""}], ",", "\n", "\t", 
     RowBox[{"4", "\[Rule]", "\"\<tetramer\>\""}], ",", "\n", "\t", 
     RowBox[{"s_String", "\[RuleDelayed]", "s"}], ",", "\n", "\t", 
     RowBox[{"_", "\[Rule]", "\"\<\>\""}]}], "\n", "\t", "}"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.699832871494594*^9, 3.699832886344132*^9}, 
   3.699832935030493*^9, {3.699841244872251*^9, 3.699841269637525*^9}, {
   3.7150956175095778`*^9, 3.715095628964003*^9}, {3.7151396606154747`*^9, 
   3.715139679457735*^9}, {3.715194047424768*^9, 3.7151940481434402`*^9}, {
   3.715199962009596*^9, 
   3.715200018279828*^9}},ExpressionUUID->"000a60b6-087e-466e-a9c0-\
7d0e44d9b62b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Patterns\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"b56634c1-d707-4bbc-b3ac-a3ca4cb82e54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"atomCoordPat", "=", 
   RowBox[{
    RowBox[{"_", "?", "NumericQ"}], "|", "_String", "|", "_Slot"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"molBasePattern", "=", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_String", ",", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", 
          RowBox[{"atomCoordPat", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "}"}]}], "}"}], ".."}], "}"}], 
    "|", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_String", ",", 
        RowBox[{
         RowBox[{"(", "atomCoordPat", ")"}], "..."}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_String", ",", 
         RowBox[{"atomCoordPat", ".."}]}], "}"}], "..."}]}], "}"}]}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.71106496620639*^9, 3.711065031456609*^9}, {
  3.715096206314183*^9, 3.715096261623375*^9}, {3.715096355521757*^9, 
  3.715096385148954*^9}},ExpressionUUID->"3a71f736-55a7-4207-8191-\
c336289d2b60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"molBlockPattern", "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"molBasePattern", ".."}], "\n", "\t\t", "}"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.71106496620639*^9, 3.711065035324099*^9}, {
  3.7110650720224113`*^9, 3.711065086489493*^9}, {3.711065125065846*^9, 
  3.711065127184351*^9}},ExpressionUUID->"fcfc4d79-f4bd-4a4d-b0b6-\
197a49201e5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"molPattern", "=", "\n", "\t", 
   RowBox[{
    RowBox[{"molBlockPattern", "|", "_String"}], "->", "molBlockPattern"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.711065140014414*^9, 3.711065143882745*^9}, {
  3.711068660015233*^9, 3.711068660284658*^9}, {3.711068826340499*^9, 
  3.711068827113545*^9}},ExpressionUUID->"a4dfc680-eb8f-4190-8409-\
e8d473a2a935"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Psi4Molecule\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"1db496e0-2d1d-407e-97b7-ca04db94aac5"],

Cell[BoxData[
 RowBox[{"Psi4Molecule", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.7110688863197393`*^9, 
  3.71106888710911*^9}},ExpressionUUID->"c1326717-7e2f-40f1-b65d-\
8dadabe93657"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Molecule", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"name", ":", 
      RowBox[{"_String", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"els", ":", "molBlockPattern"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<MolTable\>\"", "|", "\"\<ZMatrix\>\"", "|", "Automatic"}], 
      ":", "Automatic"}], ",", "\n", "\t", "ops___String"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{
    RowBox[{"PyBlock", "[", 
     RowBox[{"\"\<molecule \>\"", "<>", 
      RowBox[{"Replace", "[", 
       RowBox[{"name", ",", 
        RowBox[{"Automatic", ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", "els"}], "/.", "$Psi4MolSpecs"}], ")"}]}]}],
        "]"}], "<>", "\"\< {\>\""}], "]"}], "[", "\n", "\t\t", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Riffle", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"psi4MolSpec", "[", 
            RowBox[{"#", ",", "mode"}], "]"}], "&"}], "/@", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"els", ",", 
            RowBox[{
             RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
             RowBox[{"\"\<pyVar_\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}]}]}]}], "]"}]}], "\n", 
         "\t\t\t\t\t", ",", "\n", "\t\t\t\t", "\"\<--\>\""}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "ops", ",", "\n", "\t\t\t", 
       "\"\<}\>\""}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Molecule", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"els", ":", "molBasePattern"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<MolTable\>\"", "|", "\"\<ZMatrix\>\"", "|", "Automatic"}], 
      ":", "Automatic"}], ",", "\n", "\t", "ops___String"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Psi4Molecule", "[", 
    RowBox[{
     RowBox[{"{", "els", "}"}], ",", "mode", ",", "ops"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Molecule", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"els", ":", 
      RowBox[{"(", 
       RowBox[{"_String", "->", "molBasePattern"}], ")"}]}], ",", "\n", "\t", 
     
     RowBox[{"mode", ":", 
      RowBox[{"\"\<MolTable\>\"", "|", "\"\<ZMatrix\>\"", "|", "Automatic"}], 
      ":", "Automatic"}], ",", "\n", "\t", "ops___String"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Psi4Molecule", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", "els", "]"}], "->", 
      RowBox[{"{", 
       RowBox[{"Last", "@", "els"}], "}"}]}], ",", "mode", ",", "ops"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Molecule", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"mol", ":", "molPattern"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<MolTable\>\"", "|", "\"\<ZMatrix\>\"", "|", "Automatic"}], 
      ":", "Automatic"}], ",", "\n", "\t", "ops___String"}], "\n", "\t", 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"ListQ", "@", "mol"}]}], ",", "\n", "\t\t", 
     RowBox[{"Psi4Molecule", "[", 
      RowBox[{
       RowBox[{"mol", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"mol", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "mode", ",", "ops"}], "]"}], ",",
      "\n", "\t\t", 
     RowBox[{"Psi4Molecule", "[", 
      RowBox[{"Automatic", ",", "mol", ",", "mode", ",", "ops"}], "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6997426934146214`*^9, 3.6997428274185534`*^9}, {
   3.699742874888379*^9, 3.699742885520944*^9}, 3.699742956521595*^9, {
   3.699832645768272*^9, 3.699832667953079*^9}, {3.6998327021505833`*^9, 
   3.69983286600749*^9}, {3.699832899376214*^9, 3.699832901478125*^9}, {
   3.699832937144034*^9, 3.699832965468265*^9}, {3.699833002881303*^9, 
   3.699833022165906*^9}, 3.699833169681548*^9, {3.699837981294073*^9, 
   3.6998379862297783`*^9}, 3.6998390815827703`*^9, {3.699839295303322*^9, 
   3.699839341628388*^9}, {3.699841132235854*^9, 3.699841165830677*^9}, {
   3.699841292481916*^9, 3.699841359173121*^9}, {3.699841539998706*^9, 
   3.6998415776371117`*^9}, {3.710187233582123*^9, 3.71018723734648*^9}, 
   3.711064964802391*^9, 3.711065088379078*^9, {3.711065129586794*^9, 
   3.711065155525093*^9}, {3.7110651869109917`*^9, 3.711065271088409*^9}, 
   3.711068636112843*^9, {3.711068676150573*^9, 3.7110686767967873`*^9}, {
   3.711068842369378*^9, 3.711068882695846*^9}, {3.71509618795497*^9, 
   3.715096196632011*^9}, {3.715096307226687*^9, 
   3.7150963351228228`*^9}},ExpressionUUID->"48f6d9f7-a8e4-4fc9-a144-\
e2b3ce2fbbfb"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Config\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69297824181181*^9, 3.692978245555888*^9}, 
   3.693084481060738*^9},ExpressionUUID->"bc0ae2a6-12be-454e-aa5d-\
44f2a1a9cd4b"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]$psi4Config\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"3847d5a6-aadc-4b3a-9de1-e6148b2586cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$psi4ConfigBlockHeader", "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$psi4ConfigBlockRiffle", "=", "\"\< \>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$Psi4ConfigBlockHeader", "=", "Automatic"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$Psi4ConfigBlockRiffle", "=", "Automatic"}], 
  ";"}]}], "CodeInput",ExpressionUUID->"349eb30d-b946-4a52-bf10-7722ab26f687"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Psi4Config\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"4a846928-3499-4328-a875-1fae0a4aceaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Config", "[", "props_List", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ps", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"props", ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k_String", "\[Rule]", "v_"}], ")"}], ":>", "\n", 
          "\t\t\t\t", 
          RowBox[{"PyRow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"psi4DeCamelCase", "[", "k", "]"}], ",", "v"}], "}"}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"$Psi4ConfigBlockRiffle", ",", 
              RowBox[{
              "Automatic", "\[RuleDelayed]", "$psi4ConfigBlockRiffle"}]}], 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", "1"}],
         "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Which", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Flatten", "@", "props"}]}], ">", "1"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{
        RowBox[{"PyBlock", "[", 
         RowBox[{"\"\<set \>\"", "<>", "\n", "\t\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"$Psi4ConfigBlockHeader", ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{
            "Automatic", "\[RuleDelayed]", "$psi4ConfigBlockHeader"}]}], "\n",
            "\t\t\t\t\t\t", "]"}], "<>", "\"\< {\>\""}], "]"}], "[", "\n", 
        "\t\t\t\t\t", 
        RowBox[{"Append", "[", 
         RowBox[{"ps", ",", "\"\<}\>\""}], "]"}], "\n", "\t", "\t\t\t\t", 
        "]"}], ",", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Flatten", "@", "props"}]}], ">", "0"}], ",", "\n", "\t", 
       "\t\t\t", 
       RowBox[{"PyRow", "[", "\n", "\t", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<set \>\"", "<>", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{"$Psi4ConfigBlockHeader", ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
               "Automatic", "\[RuleDelayed]", "$psi4ConfigBlockHeader"}]}], 
              "\n", "\t\t\t\t\t\t\t\t", "]"}], "<>", "\"\< {\>\""}], ",", 
            "\n", "\t\t\t\t\t\t", "ps", ",", "\n", "\t\t\t\t\t\t", 
            "\"\<}\>\""}], "}"}]}], ",", "\n", "\t\t\t\t\t", "\"\< \>\""}], 
        "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t", "True", ",", "\n",
        "\t\t\t\t", "Nothing"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Config", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4Config", "@", 
    RowBox[{"Normal", "@", "a"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Config", "[", "r_Rule", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{"r", ",", 
       RowBox[{"_", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"_", "?", "OptionQ"}], ")"}]}]}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"$Psi4ConfigBlockHeader", "=", "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"$Psi4ConfigBlockHeader", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Automatic", ":>", 
             RowBox[{"psi4DeCamelCase", "[", 
              RowBox[{
               RowBox[{"First", "@", "r"}], "/.", 
               "$Psi4GeometryParametersMap"}], "]"}]}]}], "\n", "\t\t\t\t\t", 
           "]"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"$Psi4ConfigBlockRiffle", "=", "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"$Psi4ConfigBlockRiffle", ",", " ", 
            RowBox[{"Automatic", "\[RuleDelayed]", "\"\<\>\""}]}], "]"}]}]}], 
        "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Psi4Config", "[", 
        RowBox[{"Last", "@", "r"}], "]"}]}], "\n", "\t\t\t", "]"}], ",", "\n",
      "\t\t", 
     RowBox[{"Psi4Config", "@", 
      RowBox[{"{", "r", "}"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"8ac4efa8-130f-4d99-ba35-4878df20b68e"]\

}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Function\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693071400012295*^9, 
  3.693071401097715*^9}},ExpressionUUID->"450fecc7-f632-44a6-960b-\
bbaf79870721"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "Psi4Function"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Call\>\"", "\[Rule]", "\"\<Required\>\""}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<Arguments\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<KeyWordArguments\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<AssignTo\>\"", "\[Rule]", "None"}]}], "\n", "\t\t", "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4Function", "//", "Clear"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Function", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ops", "=", 
       RowBox[{"Options", "@", "Psi4Function"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"components", "=", "\n", "\t", "\t\t", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeySelect", "[", 
              RowBox[{"a", ",", 
               RowBox[{
                RowBox[{"KeyMemberQ", "[", 
                 RowBox[{"ops", ",", "#"}], "]"}], "&"}]}], "]"}], ",", 
             "ops"}], "}"}], ",", "First"}], "]"}]}], "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"components", ",", "\"\<Function\>\""}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"Psi4Function", "[", 
          RowBox[{"components", "[", "\"\<Function\>\"", "]"}], "]"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"function", "=", 
              RowBox[{"components", "[", "\"\<Call\>\"", "]"}]}], ",", "\n", 
             "\t", "\t", "\t\t\t", 
             RowBox[{"args", "=", 
              RowBox[{"components", "[", "\"\<Arguments\>\"", "]"}]}], ",", 
             "\n", "\t", "\t", "\t\t\t", 
             RowBox[{"kwargs", "=", 
              RowBox[{"components", "[", "\"\<KeyWordArguments\>\"", "]"}]}], 
             ",", "\n", "\t", "\t", "\t\t\t", 
             RowBox[{"assignment", "=", 
              RowBox[{"components", "[", "\"\<AssignTo\>\"", "]"}]}]}], "\n", 
            "\t", "\t", "\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"assignment", "===", "None"}], ",", "\n", "\t", 
              "\t\t\t\t\t", "Identity", ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"PyAssign", "[", 
                RowBox[{"assignment", ",", " ", "#"}], "]"}], "&"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}], "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"PyCall", "[", "function", "]"}], "@@", "\n", "\t", 
             "\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"{", 
                 RowBox[{"args", ",", "kwargs"}], "}"}]}], ",", 
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"s_String", "\[RuleDelayed]", 
                  RowBox[{"PyString", "[", "s", "]"}]}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k_", "\[Rule]", "s_String"}], ")"}], ":>", "\n", 
                  "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"k", "\[Rule]", 
                   RowBox[{"PyString", "[", "s", "]"}]}]}]}], "\n", "\t", 
                "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", "1"}],
               "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Function", "[", 
    RowBox[{"r", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], "]"}],
    ":=", "\n", "\t", 
   RowBox[{"Psi4Function", "@", 
    RowBox[{"Association", "@", "r"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Psi4Function", "[", "s_String", "]"}], "[", "args___", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Psi4Function", "[", 
    RowBox[{"<|", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\"\<Call\>\"", "\[Rule]", "s"}], ",", "\n", "\t\t", 
      RowBox[{"\"\<Arguments\>\"", "\[Rule]", "\n", "\t\t\t", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "args", "}"}], ",", 
         RowBox[{"Except", "[", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}]}], "]"}]}], ",", "\n",
       "\t\t", 
      RowBox[{"\"\<KeyWordArguments\>\"", "->", "\n", "\t\t\t", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "args", "}"}], ",", 
         RowBox[{"_Rule", "|", "_RuleDelayed"}]}], "]"}]}]}], "\n", "\t\t", 
     "|>"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"Psi4Function", "[", 
      RowBox[{"a_", "->", "s_String"}], "]"}], "[", "args___", "]"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Psi4Function", "[", 
    RowBox[{"<|", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\"\<AssignTo\>\"", "\[Rule]", "a"}], ",", "\n", "\t\t", 
      RowBox[{"\"\<Call\>\"", "\[Rule]", "s"}], ",", "\n", "\t\t", 
      RowBox[{"\"\<Arguments\>\"", "\[Rule]", "\n", "\t\t\t", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "args", "}"}], ",", 
         RowBox[{"Except", "[", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}]}], "]"}]}], ",", "\n",
       "\t\t", 
      RowBox[{"\"\<KeyWordArguments\>\"", "->", "\n", "\t\t\t", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "args", "}"}], ",", 
         RowBox[{"_Rule", "|", "_RuleDelayed"}]}], "]"}]}]}], "\n", "\t\t", 
     "|>"}], "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"93ba5e3e-9e24-424e-bd41-6bf3a2b9234c"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GridFile\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693075765735037*^9, 
  3.693075767783001*^9}},ExpressionUUID->"32dd3041-aca1-4f57-98cb-\
bba6f67a95d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GridFile", "[", "grid_List", "]"}], ":=", "\n", "\t", 
   RowBox[{"StringJoin", "@", "\n", "\t\t", 
    RowBox[{"Riffle", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Riffle", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Psi4Compile", "/@", "\n", "\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v_", ",", "_"}], "}"}], "\[RuleDelayed]", "v"}], ",", 
             "1"}], "]"}]}], ",", "\"\< \>\""}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"1.", "grid"}], ")"}]}], ",", "\n", "\t\t\t", "\"\<\\n\>\""}],
      "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.693075769466588*^9, 3.693075785936019*^9}, {
   3.693079151055627*^9, 3.693079180586245*^9}, 3.6951390376605263`*^9, 
   3.699368572924429*^9, {3.699368607386321*^9, 3.699368608837113*^9}, 
   3.699368762450842*^9, {3.699737958140339*^9, 
   3.6997379608847446`*^9}},ExpressionUUID->"573d57c6-ed03-4186-8089-\
ec0cf4446296"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]InputFile\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693071662854579*^9, 
  3.693071664471057*^9}},ExpressionUUID->"14188ab3-2879-43bd-bf34-\
ee99d0a2642d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "::", "typerr"}], "=", "\n", "\t", 
   "\"\<Expected Head `` for parameter ``\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.693087423101701*^9, 3.693087442173048*^9}, 
   3.694179875308338*^9},ExpressionUUID->"be529aff-a584-481f-87c4-\
436acc702036"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "::", "nomol"}], "=", "\n", "\t", 
   "\"\<No molecules provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "::", "molfmt"}], "=", "\n", "\t", 
   "\"\<Couldn't format molecules ``\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "::", "nostr"}], "=", "\n", "\t", 
   "\"\<Arguments `` are not strings\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694179847924803*^9, 3.694179882565151*^9}, {
  3.699741363604003*^9, 3.699741412078866*^9}, {3.699838072800054*^9, 
  3.69983810040513*^9}},ExpressionUUID->"b38bc909-ecad-45a4-bf8e-\
9ad10127f02d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Psi4InputFile", "//", "Clear"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4InputFile", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Header\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<MolHeader\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Molecules\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<MoleculeOptions\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<MolFooter\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ConfigHeader\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Configuration\>\"", "\[Rule]", 
      RowBox[{"<|", "|>"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ConfigFooter\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<FunctionHeader\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Function\>\"", "\[Rule]", 
      RowBox[{"<|", "|>"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<FunctionFooter\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Footer\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<BlockSeparator\>\"", "\[Rule]", 
      RowBox[{"(", "\"\<\\n\>\"", ")"}]}]}], "\n", "\t\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "[", "\n", "\t", 
    RowBox[{"a_Association", "?", 
     RowBox[{"(", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{"#", ",", "\"\<Molecules\>\""}], "]"}], "\n", "\t\t\t", "&&", 
        RowBox[{"(", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"KeyMemberQ", "[", 
           RowBox[{"#", ",", "\"\<Function\>\""}], "]"}], "||", "\n", 
          "\t\t\t", 
          RowBox[{"KeyMemberQ", "[", 
           RowBox[{"#", ",", "\"\<Call\>\""}], "]"}]}], "\n", "\t\t\t", 
         ")"}]}], "&"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ops", "=", 
       RowBox[{"Association", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Options", "@", "Psi4InputFile"}], ",", 
          RowBox[{"Options", "@", "Psi4Function"}]}], "]"}]}]}], "}"}], ",", 
     "\n", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"components", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeySelect", "[", 
              RowBox[{"a", ",", 
               RowBox[{
                RowBox[{"KeyMemberQ", "[", 
                 RowBox[{"ops", ",", "#"}], "]"}], "&"}]}], "]"}], ",", 
             "ops"}], "}"}], ",", "First"}], "]"}]}], "}"}], ",", "\n", 
       "\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"header", "=", 
            RowBox[{"components", "[", "\"\<Header\>\"", "]"}]}], ",", "\n", 
           "\t\t\t", 
           RowBox[{"molHead", "=", 
            RowBox[{"components", "[", "\"\<MolHeader\>\"", "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"mols", "=", 
            RowBox[{"components", "[", "\"\<Molecules\>\"", "]"}]}], ",", 
           RowBox[{"molKw", "=", 
            RowBox[{"components", "[", "\"\<MoleculeOptions\>\"", "]"}]}], 
           ",", "\n", "\t\t\t", 
           RowBox[{"molFoot", "=", 
            RowBox[{"components", "[", "\"\<MolFooter\>\"", "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"confHead", "=", 
            RowBox[{"components", "[", "\"\<ConfigHeader\>\"", "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"conf", "=", 
            RowBox[{"components", "[", "\"\<Configuration\>\"", "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"confFoot", "=", 
            RowBox[{"components", "[", "\"\<ConfigFooter\>\"", "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"funcHead", "=", 
            RowBox[{"components", "[", "\"\<FunctionHeader\>\"", "]"}]}], ",",
            "\n", "\t\t\t", 
           RowBox[{"func", "=", 
            RowBox[{"components", "[", "\"\<Function\>\"", "]"}]}], ",", "\n",
            "\t\t\t", 
           RowBox[{"funcFoot", "=", 
            RowBox[{"components", "[", "\"\<FunctionFooter\>\"", "]"}]}], ",",
            "\n", "\t\t\t", 
           RowBox[{"footer", "=", 
            RowBox[{"components", "[", "\"\<Footer\>\"", "]"}]}], ",", "\n", 
           "\t\t\t", 
           RowBox[{"sep", "=", 
            RowBox[{
             RowBox[{"ToString", "@", 
              RowBox[{"components", "[", "\"\<BlockSeparator\>\"", "]"}]}], 
             "<>", "\"\<\\n\>\""}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"Psi4Compile", "@", 
          RowBox[{"PyColumn", "@", "\n", "\t\t\t\t", 
           RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{
              "header", ",", "\n", "\t\t\t\t\t\t", "molHead", ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{"mols", ",", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "}"}], ":>", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    RowBox[{
                    RowBox[{"Psi4InputFile", "::", "nomol"}], ",", "mols"}], 
                    "]"}], ";", "\n", "\t", "\t\t\t\t\t\t\t", "$Failed"}], 
                    "\n", "\t", "\t\t\t\t\t\t\t", ")"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"m", ":", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_", "\[Rule]", "_List"}], ")"}], "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], 
                    "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], 
                    "}"}], ",", "___"}], "}"}]}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Psi4Molecule", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Normal", "@", "molKw"}]}]}], "]"}]}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t", 
                   RowBox[{"None", "\[Rule]", "Nothing"}]}], "\n", "\t", 
                  "\t\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
               "molFoot", ",", "\n", "\t\t\t\t\t\t", "confHead", ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{"conf", ",", 
                 RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "_Association", "|", "_Rule", "|", "_RuleDelayed", "|", 
                    RowBox[{"{", "__Rule", "}"}]}], ")"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Psi4Config", "@", "conf"}]}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "}"}], "|", "None", "|", "Nothing"}], 
                    "\[Rule]", "Nothing"}]}], "\n", "\t", "\t\t\t\t\t\t", 
                  "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", "confFoot", ",", 
               "\n", "\t\t\t\t\t\t", "funcHead", ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{"func", ",", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"_String", "?", 
                    RowBox[{"(", 
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"WordCharacter", "|", "\"\<_\>\""}], ")"}], 
                    ".."}], "]"}], ")"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Psi4Function", "@", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Merge", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"\"\<Call\>\"", "\[Rule]", "func"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FilterRules", "[", 
                    RowBox[{"components", ",", 
                    RowBox[{"Options", "@", "Psi4Function"}]}], "]"}]}], "\n",
                     "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t\t", "First"}], "]"}]}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    "_Association", "|", "_Rule", "|", "_RuleDelayed", "|", 
                    RowBox[{"{", "__Rule", "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Psi4Function", "@", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Merge", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"func", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FilterRules", "[", 
                    RowBox[{"components", ",", 
                    RowBox[{"Options", "@", "Psi4Function"}]}], "]"}]}], "\n",
                     "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t\t", "First"}], "]"}]}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", "}"}], "\[Rule]", "\n", "\t\t\t\t\t\t\t\t", 
                    "Nothing"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "]"}], 
               ",", "\n", "\t\t\t\t\t\t", "funcFoot", ",", "\n", 
               "\t\t\t\t\t\t", "footer"}], "\n", "\t\t\t\t\t\t", "}"}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"\"\<\>\"", "|", "None"}], "\[Rule]", "Nothing"}], ",", 
             "\n", "\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t", "]"}]}]}]}], "\n",
         "\t\t", "]"}]}], "\n", "\t", "]"}]}], "\n", "\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "[", 
    RowBox[{"r", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}], "|", 
       "_Rule", "|", "_RuleDelayed"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4InputFile", "@", 
    RowBox[{"Association", "@", "r"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "[", 
    RowBox[{"r", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}]}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Psi4InputFile", "@", 
    RowBox[{"<|", "r", "|>"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6930729967333603`*^9, 3.693073071085166*^9}, 
   3.693073473407238*^9, {3.693073576132299*^9, 3.693073638467156*^9}, {
   3.69307379893822*^9, 3.693073805804408*^9}, {3.693074098074958*^9, 
   3.6930741810848923`*^9}, {3.693074244129656*^9, 3.693074442358204*^9}, {
   3.6930744791665363`*^9, 3.693074519934967*^9}, {3.6930745919767027`*^9, 
   3.693074697556196*^9}, {3.693074731256528*^9, 3.69307476910643*^9}, 
   3.693074986786542*^9, {3.693075112672186*^9, 3.693075137870352*^9}, {
   3.6930752003676157`*^9, 3.693075352455522*^9}, {3.693075413434486*^9, 
   3.6930754260994453`*^9}, {3.693075550098068*^9, 3.693075551979472*^9}, 
   3.693075669823327*^9, {3.693075701529705*^9, 3.693075717165593*^9}, {
   3.693076553981435*^9, 3.693076584629092*^9}, {3.6930766683200274`*^9, 
   3.693076669639002*^9}, {3.693076737394554*^9, 3.693076815090631*^9}, {
   3.693076944555634*^9, 3.693076945306664*^9}, {3.6930770257755423`*^9, 
   3.693077027020844*^9}, {3.693078141329776*^9, 3.6930781616778297`*^9}, {
   3.69307869067094*^9, 3.693078692107587*^9}, {3.6930870163380737`*^9, 
   3.6930871157734413`*^9}, {3.693087152874736*^9, 3.6930876048367577`*^9}, {
   3.6930876351860113`*^9, 3.693087808105798*^9}, {3.6930878487352457`*^9, 
   3.693087860787592*^9}, {3.693088042117652*^9, 3.6930880548533278`*^9}, {
   3.693088187014256*^9, 3.6930882930001793`*^9}, {3.693088407493599*^9, 
   3.693088446798192*^9}, {3.693088742737091*^9, 3.69308888714228*^9}, {
   3.693090750477022*^9, 3.693090758592688*^9}, {3.693090814765135*^9, 
   3.6930908223136177`*^9}, {3.693091254564062*^9, 3.693091259512765*^9}, {
   3.693091411638445*^9, 3.693091413100067*^9}, {3.693091667157078*^9, 
   3.693091682523725*^9}, {3.693091760859807*^9, 3.6930918222494373`*^9}, {
   3.693092352558576*^9, 3.69309236227074*^9}, {3.6930925233515863`*^9, 
   3.693092627788476*^9}, {3.693092786740687*^9, 3.693092793596127*^9}, {
   3.6930936833503*^9, 3.6930936897399683`*^9}, {3.693093798840981*^9, 
   3.693093826372204*^9}, {3.693093879201356*^9, 3.693093915226054*^9}, {
   3.693141030200037*^9, 3.693141140185413*^9}, 3.69410082311082*^9, {
   3.6941798009638968`*^9, 3.694179841365466*^9}, {3.6941798878633537`*^9, 
   3.694179895332759*^9}, {3.699368823911833*^9, 3.699368824643813*^9}, {
   3.699738486617131*^9, 3.699738488756447*^9}, {3.6997413521332912`*^9, 
   3.6997413524677877`*^9}, {3.699741418804872*^9, 3.6997414388247623`*^9}, {
   3.69983429267414*^9, 3.699834298893005*^9}, {3.699834347085884*^9, 
   3.699834456775231*^9}, {3.699834499479889*^9, 3.699834796066134*^9}, {
   3.699834868521152*^9, 3.699835021132041*^9}, {3.6998351803302317`*^9, 
   3.699835209663968*^9}, {3.699835254126989*^9, 3.6998352743473177`*^9}, {
   3.699835316605062*^9, 3.699835412651812*^9}, {3.69983545034697*^9, 
   3.6998355025804873`*^9}, {3.69983553300563*^9, 3.699835647155106*^9}, {
   3.6998357652525167`*^9, 3.699835879751071*^9}, {3.699837591930264*^9, 
   3.699837601832787*^9}, {3.699837709919042*^9, 3.699837745739484*^9}, {
   3.699838058674855*^9, 3.699838059104887*^9}, {3.69984139828028*^9, 
   3.6998414253992233`*^9}, {3.7101868493517847`*^9, 
   3.710186859792097*^9}},ExpressionUUID->"fad9a215-9eb5-4226-94b5-\
590f9dc8852e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4InputFile", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"h", ":", 
      RowBox[{"_String", "|", "None"}], ":", "\"\<Psi4 input.dat file\>\""}], 
     ",", "\n", "\t", 
     RowBox[{"mh", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"m", ":", "\n", "\t\t", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], 
           "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], 
             ",", "___"}], "}"}]}], ")"}]}], ")"}], "|", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], ",", 
         "___"}], "}"}], "|", "_String", "|", "\n", "\t\t", 
       RowBox[{"_", "?", "SymbolicPythonQ"}]}]}], ",", "\n", "\t", 
     RowBox[{"ch", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"c", ":", 
      RowBox[{
       RowBox[{"{", "___Rule", "}"}], "|", "_Association", "|", "_String", 
       "|", 
       RowBox[{"_", "?", "SymbolicPythonQ"}]}]}], ",", "\n", "\t", 
     RowBox[{"fh", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"f", ":", 
      RowBox[{
       RowBox[{"{", "__Rule", "}"}], "|", "_Association", "|", "_String", "|", 
       RowBox[{"_", "?", "SymbolicPythonQ"}]}]}], ",", "\n", "\t", 
     RowBox[{"ft", ":", 
      RowBox[{"_String", "|", "None"}], ":", 
      "\"\<Configured with the ChemTools suite for Mathematica\>\""}], ",", 
     "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Psi4InputFile", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Header\>\"", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"h", ",", "\n", "\t\t\t\t", 
        RowBox[{"s_String", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
         RowBox[{"PyColumn", "[", 
          RowBox[{"PyComment", "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}]}], "\n", 
       "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<MolHeader\>\"", "->", "mh"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Molecules\>\"", "\[Rule]", "m"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ConfigHeader\>\"", "\[Rule]", "ch"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Configuration\>\"", "\[Rule]", "c"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<FunctionHeader\>\"", "\[Rule]", "fh"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Function\>\"", "\[Rule]", "f"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Footer\>\"", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"ft", ",", "\n", "\t\t\t\t", 
        RowBox[{"s_String", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
         RowBox[{"PyColumn", "[", 
          RowBox[{"PyComment", "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}]}], "\n", 
       "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}],
   ";"}]], "CodeInput",
 CellChangeTimes->{{3.699835905249304*^9, 3.699835990983642*^9}, {
   3.699836486627717*^9, 3.699836489785487*^9}, {3.699836871355678*^9, 
   3.699837040370017*^9}, {3.6998370794943438`*^9, 3.699837106538579*^9}, {
   3.699837242368507*^9, 3.699837429137833*^9}, 3.699837692855278*^9, {
   3.6998377793120127`*^9, 3.699837786222653*^9}, {3.699837828658372*^9, 
   3.699837928336007*^9}, {3.699838278311501*^9, 3.699838284899756*^9}, {
   3.699841447569881*^9, 
   3.699841473033044*^9}},ExpressionUUID->"1bb015e5-de6d-4dba-a63c-\
be736268b89b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ConfigureCall\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693089358630898*^9, 3.693089377086607*^9}, {
  3.693090315410153*^9, 
  3.6930903177167807`*^9}},ExpressionUUID->"3d9a25f4-09f5-4ed2-a83c-\
79439954474a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4ConfigureCall", "]"}], "=", "\n", "\t", 
   RowBox[{"Normal", "@", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "Psi4InputFile"}], ",", "\n", "\t\t", 
        RowBox[{"<|", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"\"\<InputString\>\"", "\[Rule]", "None"}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"\"\<Input\>\"", "\[Rule]", 
           RowBox[{"<|", "|>"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Output\>\"", "\[Rule]", "\"\<output.dat\>\""}], ",", 
          "\n", "\t\t\t", 
          RowBox[{"\"\<Directory\>\"", "\[Rule]", "Automatic"}]}], "\n", 
         "\t\t\t", "|>"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", "Last"}],
      "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4ConfigureCall", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ops", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"Options", "@", "Psi4ConfigureCall"}], "]"}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"components", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "ops"}], "}"}], ",", "First"}], "]"}]}], "}"}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"components", "[", "\"\<InputString\>\"", "]"}], ",", "\n",
            "\t\t\t\t\t", 
           RowBox[{"None", ":>", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Psi4InputFile", "@", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{"components", ",", "\n", "\t", "\t", "\t\t\t\t\t\t", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Options", "@", "Psi4InputFile"}], ",", 
                 RowBox[{"Options", "@", "Psi4Function"}]}], "]"}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t\t\t", "]"}], ",",
          "\n", "\t\t\t\t", 
         RowBox[{"inp_String", ":>", "\n", "\t\t\t\t\t", 
          RowBox[{"Psi4Input", "@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"<|", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
             "\"\<Input\>\"", "->", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"components", "[", "\"\<Input\>\"", "]"}], ",", 
                  "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"<|", 
                   RowBox[{"\"\<input.dat\>\"", "\[Rule]", "inp"}], "|>"}]}], 
                 "\n", "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t\t", "First"}], "\n", "\t\t\t\t\t\t\t\t\t", 
               "]"}]}], ",", "\n", "\t", "\t", "\t", "\t\t\t\t", 
             RowBox[{"\"\<Output\>\"", "\[Rule]", 
              RowBox[{"components", "[", "\"\<Output\>\"", "]"}]}], ",", "\n",
              "\t", "\t", "\t", "\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"components", "[", "\"\<Directory\>\"", "]"}], ",", 
               RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Except", "[", 
                   RowBox[{"_String", "?", "DirectoryQ"}], "]"}], "\[Rule]", 
                  "Nothing"}], ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"e_", "\[RuleDelayed]", 
                  RowBox[{"\"\<Directory\>\"", "\[Rule]", "e"}]}]}], "\n", 
                "\t", "\t", "\t", "\t\t\t\t\t", "}"}]}], "]"}]}], "\n", 
            "\t\t\t\t\t\t\t", "|>"}]}]}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n",
       "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4ConfigureCall", "[", 
    RowBox[{"r", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}], "|", 
       "_Rule", "|", "_RuleDelayed"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4ConfigureCall", "@", 
    RowBox[{"Association", "@", "r"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4ConfigureCall", "[", 
    RowBox[{"r", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}]}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Psi4ConfigureCall", "@", 
    RowBox[{"Association", "[", "r", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4ConfigureCall", "[", 
    RowBox[{"s_String", ",", 
     RowBox[{"r", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}]}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Psi4ConfigureCall", "[", 
    RowBox[{
     RowBox[{"\"\<InputString\>\"", "\[Rule]", "s"}], ",", "r"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4ConfigureCall", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"h", ":", 
      RowBox[{"_String", "|", "None"}], ":", "\"\<Psi4 input.dat file\>\""}], 
     ",", "\n", "\t", 
     RowBox[{"mh", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"m", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], 
           "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], 
             ",", "___"}], "}"}]}], ")"}]}], ")"}], "|", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_String", ",", "___"}], "}"}], ",", "___"}], "}"}], ",", 
         "___"}], "}"}], "|", "_String", "|", "\n", "\t\t", 
       RowBox[{"_", "?", "SymbolicPythonQ"}]}]}], ",", "\n", "\t", 
     RowBox[{"ch", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"c", ":", 
      RowBox[{
       RowBox[{"{", "___Rule", "}"}], "|", "_Association", "|", "_String", 
       "|", 
       RowBox[{"_", "?", "SymbolicPythonQ"}]}]}], ",", "\n", "\t", 
     RowBox[{"fh", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"f", ":", 
      RowBox[{
       RowBox[{"{", "__Rule", "}"}], "|", "_Association", "|", "_String", "|", 
       RowBox[{"_", "?", "SymbolicPythonQ"}]}]}], ",", "\n", "\t", 
     RowBox[{"ft", ":", 
      RowBox[{"_String", "|", "None"}], ":", 
      "\"\<Configured with the ChemTools suite for Mathematica\>\""}], ",", 
     "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}]}]}], "\n", "\t",
     "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4ConfigureCall", "[", "\n", "\t\t", 
    RowBox[{"ops", ",", "\n", "\t\t", 
     RowBox[{"\"\<Header\>\"", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"h", ",", "\n", "\t\t\t\t", 
        RowBox[{"s_String", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
         RowBox[{"PyColumn", "[", 
          RowBox[{"PyComment", "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}]}], "\n", 
       "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<MolHeader\>\"", "->", "mh"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Molecules\>\"", "\[Rule]", "m"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ConfigHeader\>\"", "\[Rule]", "ch"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Configuration\>\"", "\[Rule]", "c"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<FunctionHeader\>\"", "\[Rule]", "fh"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Function\>\"", "\[Rule]", "f"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Footer\>\"", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"ft", ",", "\n", "\t\t\t\t", 
        RowBox[{"s_String", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
         RowBox[{"PyColumn", "[", 
          RowBox[{"PyComment", "/@", 
           RowBox[{"StringSplit", "[", 
            RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}]}], "\n", 
       "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693089347888525*^9, 3.693089500764721*^9}, {
   3.693089649681706*^9, 3.693089751767046*^9}, {3.6930899494426823`*^9, 
   3.693089950663863*^9}, {3.693090065818264*^9, 3.693090293613192*^9}, {
   3.6930912267915*^9, 3.693091239784769*^9}, {3.693092653532401*^9, 
   3.6930927069318657`*^9}, {3.6930936260927563`*^9, 3.69309365477925*^9}, 
   3.693094161973629*^9, {3.6931533698967*^9, 3.693153374610503*^9}, {
   3.694179916216898*^9, 3.694179981149695*^9}, {3.694180603918707*^9, 
   3.694180640707163*^9}, 3.69418069418543*^9, {3.699838419184003*^9, 
   3.699838435566648*^9}, {3.6998386628322697`*^9, 3.699838681595899*^9}, {
   3.699842460808257*^9, 3.6998425274579697`*^9}, 3.699842590158111*^9, {
   3.699844541572798*^9, 3.699844542528867*^9}, {3.710186814408271*^9, 
   3.710186824275959*^9}, 
   3.7101877707713823`*^9},ExpressionUUID->"769becd1-20e7-4a61-8f9c-\
5b56c38bfa6c"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Geometry\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6942978334729347`*^9, 
  3.694297834887697*^9}},ExpressionUUID->"9b357354-d202-4707-9f73-\
6977b3371065"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Parameters\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694314232324614*^9, 
  3.694314234435837*^9}},ExpressionUUID->"c868d525-31fd-4794-9e37-\
ee8939d67073"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Psi4GeometryParametersMap", "=", 
   RowBox[{"<|", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<OptimizationType\>\"", "\[Rule]", "\"\<opt_type\>\""}], ",",
      "\n", "\t", 
     RowBox[{"\"\<StepType\>\"", "\[Rule]", "\"\<step_type\>\""}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<MaxIterations\>\"", "\[Rule]", "\"\<geom_maxiter\>\""}], 
     ",", "\n", "\t", 
     RowBox[{
     "\"\<ConvergenceCriterion\>\"", "\[Rule]", "\"\<g_convergence\>\""}], 
     ",", "\n", "\t", 
     RowBox[{
     "\"\<HessianComputationInterval\>\"", "\[Rule]", 
      "\"\<full_hess_every\>\""}], ",", "\n", "\t", 
     RowBox[{
     "\"\<InternalCoordinatesOnly\>\"", "\[Rule]", 
      "\"\<intcos_generate_exit\>\""}], ",", "\n", "\t", 
     RowBox[{
     "\"\<OptimizationParameters\>\"", "\[Rule]", "\"\<optking\>\""}]}], "\n",
     "\t", "|>"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694297917770994*^9, 3.694297948786628*^9}, 
   3.6942980934114656`*^9, {3.694298239346674*^9, 3.6942983578365183`*^9}, {
   3.71518413183114*^9, 
   3.715184136795781*^9}},ExpressionUUID->"43b84d6c-282e-4bd0-b500-\
60240708f5e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FrozenArgs\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7151828208481493`*^9, 3.715182822416278*^9}, {
  3.7151829571382847`*^9, 
  3.715182958343237*^9}},ExpressionUUID->"f810d03f-f5ef-4edd-8481-\
c95782083d5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4AtomArgToNum", "[", 
   RowBox[{"mList_", ",", "a_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Which", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"a", "<", "0"}], ",", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"Length", "[", "mList", "]"}], "+", "a"}], ",", "\n", "\t\t", 
    RowBox[{"MatchQ", "[", 
     RowBox[{"a", ",", "_String"}], "]"}], ",", "\n", "\t\t\t", 
    RowBox[{"First", "@", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{"FirstPosition", "[", 
       RowBox[{"mList", ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "__"}], "}"}], ",", "$Failed", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"MatchQ", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"_String", ",", "_"}], "}"}]}], "]"}], ",", "\n", "\t\t\t", 
    RowBox[{"First", "@", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"mList", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "__"}], "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"a", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ",", "\n", "\t\t", 
    "True", ",", "\n", "\t\t\t", "a"}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.715183025940281*^9, 3.715183042440218*^9}, 
   3.715183249752472*^9, {3.715185952768319*^9, 
   3.715186111772718*^9}},ExpressionUUID->"2802724a-8e74-482b-a290-\
95f28b9a2b8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4GeometryFrozenSettingPrep", "[", "l_", "]"}], ":=", "\n", "\t", 
  RowBox[{"ToPython", "@", 
   RowBox[{
    RowBox[{"PyCall", "[", 
     RowBox[{"PyDot", "[", 
      RowBox[{
       RowBox[{"PyString", "@", "\"\<\\\\n\>\""}], ",", "\"\<join\>\""}], 
      "]"}], "]"}], "[", "l", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.715188380289912*^9, 3.715188410612048*^9}, {
   3.715188614653171*^9, 3.715188711482905*^9}, 
   3.715189074365842*^9},ExpressionUUID->"1d9676b3-4476-4624-aba0-\
d49cde9b3399"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Formats", " ", "the", " ", "frozen_cartesian", " ", "argument", " ", "to",
     " ", "set", " ", "optking"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"psi4GeometryFrozenPositions", "[", "\n", "\t", 
    RowBox[{"mList_", ",", "\n", "\t", "positions_"}], "\n", "\t", "]"}], ":=", \
"\n", "\t", 
   RowBox[{"psi4GeometryFrozenSettingPrep", "@", "\n", "\t\t", 
    RowBox[{"Replace", "[", 
     RowBox[{"positions", ",", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m_", "\[Rule]", "l_"}], ")"}], ":>", "\n", "\t\t\t\t", 
         RowBox[{"\"\<'`` ``'\>\"", "~", "TemplateApply", "~", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"StringPadLeft", "[", 
             RowBox[{
              RowBox[{"ToString", "@", 
               RowBox[{"psi4AtomArgToNum", "[", 
                RowBox[{"mList", ",", "m"}], "]"}]}], ",", "3"}], "]"}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"StringJoin", "@", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Map", "[", 
              RowBox[{"ToPython", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Flatten", "@", 
                  RowBox[{"{", "l", "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<X\>\"", "|", "1"}], "\[Rule]", "\"\<x\>\""}],
                    ",", " ", 
                   RowBox[{
                    RowBox[{"\"\<Y\>\"", "|", "2"}], "\[Rule]", "\"\<y\>\""}],
                    ",", 
                   RowBox[{
                    RowBox[{"\"\<Z\>\"", "|", "3"}], "->", "\"\<z\>\""}]}], 
                  "}"}], ",", "1"}], "]"}]}], "\n", "\t\t\t\t\t\t\t", 
              "]"}]}]}], "\n", "\t\t\t\t\t", "}"}]}]}], ",", "\n", "\t\t\t", 
        RowBox[{"_", "\[Rule]", "Nothing"}]}], "\n", "\t\t\t", "}"}], ",", 
      "\n", "\t\t\t", "1"}], "\n", "\t\t\t", "]"}]}]}]}]], "CodeInput",
 CellChangeTimes->{{3.7151829786121273`*^9, 3.715182982439602*^9}, {
   3.715183015930588*^9, 3.715183024682906*^9}, {3.715183082990143*^9, 
   3.7151832283599787`*^9}, {3.715183272971106*^9, 3.715183297034994*^9}, 
   3.715183363774963*^9, {3.7151836040799847`*^9, 3.715183604975936*^9}, 
   3.715186236902103*^9, 3.715186306368099*^9, {3.7151880339885063`*^9, 
   3.7151880429027576`*^9}, {3.7151884223366957`*^9, 3.715188428582203*^9}, {
   3.7151891682420273`*^9, 3.715189169758675*^9}, {3.715189264372662*^9, 
   3.715189280379867*^9}},ExpressionUUID->"45811a42-3a12-4d30-897c-\
8d07e15f62fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Formats", " ", "the", " ", "frozen_distance", " ", "argument", " ", "to", 
    " ", "set", " ", "optking"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"psi4GeometryFrozenDistances", "[", "\n", "\t", 
    RowBox[{"mList_", ",", "\n", "\t", "dists_"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"psi4GeometryFrozenSettingPrep", "@", "\n", "\t\t", 
    RowBox[{"Replace", "[", 
     RowBox[{"dists", ",", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", ":", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_"}], "}"}]}], "\[Rule]", "l_"}], ")"}], ":>",
          "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"NumericQ", "@", "l"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
           "\"\<'`` `` '+ str(``)\>\"", "~", "TemplateApply", "~", "\n", "\t",
             "\t\t\t\t\t", 
            RowBox[{"Append", "[", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPadLeft", "[", 
                  RowBox[{
                   RowBox[{"ToString", "@", 
                    RowBox[{"psi4AtomArgToNum", "[", 
                    RowBox[{"mList", ",", " ", "#"}], "]"}]}], ",", "3"}], 
                  "]"}], "&"}], ",", "m"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToPython", "@", "l"}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
           "\"\<'`` `` ``'\>\"", "~", "TemplateApply", "~", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"Append", "[", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPadLeft", "[", 
                  RowBox[{
                   RowBox[{"ToString", "@", 
                    RowBox[{"psi4AtomArgToNum", "[", 
                    RowBox[{"mList", ",", " ", "#"}], "]"}]}], ",", "3"}], 
                  "]"}], "&"}], ",", "m"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToPython", "@", "l"}]}], "\n", "\t", "\t\t\t\t\t\t", 
             "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"_", "\[Rule]", "Nothing"}]}], "\n", "\t\t\t", "}"}], ",", 
      "\n", "\t\t\t", "1"}], "\n", "\t\t\t", "]"}]}]}]}]], "CodeInput",
 CellChangeTimes->{{3.7151828236316137`*^9, 3.71518282879245*^9}, {
   3.715182960830386*^9, 3.7151829923993483`*^9}, {3.715183300767777*^9, 
   3.715183394878933*^9}, {3.71518351658115*^9, 3.715183518584989*^9}, {
   3.7151835956415377`*^9, 3.715183601650715*^9}, 3.715186304103277*^9, {
   3.7151863836296043`*^9, 3.7151863848082533`*^9}, {3.7151880207123203`*^9, 
   3.71518803015206*^9}, {3.715188434202292*^9, 3.715188439675403*^9}, {
   3.715189012904358*^9, 3.715189027683548*^9}, {3.715189282661113*^9, 
   3.7151893445410147`*^9}, {3.715189411011416*^9, 
   3.715189412255691*^9}},ExpressionUUID->"f30c23b7-6dd2-4755-a6db-\
159a0e177934"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Formats", " ", "the", " ", "frozen_bend", " ", "argument", " ", "to", " ",
     "set", " ", "optking"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"psi4GeometryFrozenAngles", "[", "\n", "\t", 
    RowBox[{"mList_", ",", "\n", "\t", "angs_"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"psi4GeometryFrozenSettingPrep", "@", "\n", "\t\t", 
    RowBox[{"Replace", "[", 
     RowBox[{"angs", ",", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", ":", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "\[Rule]", "l_"}], 
          ")"}], ":>", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"NumericQ", "@", "l"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
           "\"\<'`` `` `` '+ str(``)\>\"", "~", "TemplateApply", "~", "\n", 
            "\t", "\t\t\t\t\t", 
            RowBox[{"Append", "[", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPadLeft", "[", 
                  RowBox[{
                   RowBox[{"ToString", "@", 
                    RowBox[{"psi4AtomArgToNum", "[", 
                    RowBox[{"mList", ",", " ", "#"}], "]"}]}], ",", "3"}], 
                  "]"}], "&"}], ",", "m"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToPython", "@", "l"}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
           "\"\<'`` `` `` ``'\>\"", "~", "TemplateApply", "~", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"Append", "[", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPadLeft", "[", 
                  RowBox[{
                   RowBox[{"ToString", "@", 
                    RowBox[{"psi4AtomArgToNum", "[", 
                    RowBox[{"mList", ",", " ", "#"}], "]"}]}], ",", "3"}], 
                  "]"}], "&"}], ",", "m"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToPython", "@", "l"}]}], "\n", "\t", "\t\t\t\t\t\t", 
             "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"_", "\[Rule]", "Nothing"}]}], "\n", "\t\t\t", "}"}], ",", 
      "\n", "\t\t\t", "1"}], "\n", "\t\t\t", "]"}]}]}]}]], "CodeInput",
 CellChangeTimes->{{3.7151828236316137`*^9, 3.71518282879245*^9}, {
   3.715182960830386*^9, 3.7151829923993483`*^9}, {3.715183300767777*^9, 
   3.715183361331676*^9}, {3.715183467997891*^9, 3.7151835263622847`*^9}, {
   3.715183589969674*^9, 3.715183593316588*^9}, 3.715186302176865*^9, {
   3.715186378285516*^9, 3.715186379485598*^9}, {3.715188001333231*^9, 
   3.715188013662579*^9}, {3.715188366222377*^9, 3.7151883759540987`*^9}, {
   3.7151884421127157`*^9, 3.715188447979167*^9}, {3.7151890368399982`*^9, 
   3.7151890393798857`*^9}, {3.715189354249112*^9, 3.715189360872445*^9}, {
   3.715189407402143*^9, 
   3.715189408434746*^9}},ExpressionUUID->"b1b09d56-d9de-4d7b-823c-\
adb69c8b5c7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Formats", " ", "the", " ", "frozen_dihedral", " ", "argument", " ", "to", 
    " ", "set", " ", "optking"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"psi4GeometryFrozenDihedrals", "[", "\n", "\t", 
    RowBox[{"mList_", ",", "\n", "\t", "diheds_"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"psi4GeometryFrozenSettingPrep", "@", "\n", "\t\t", 
    RowBox[{"Replace", "[", 
     RowBox[{"diheds", ",", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", ":", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "}"}]}], "\[Rule]", 
           "l_"}], ")"}], ":>", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"NumericQ", "@", "l"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
           "\"\<'`` `` `` `` '+ str(``)\>\"", "~", "TemplateApply", "~", "\n",
             "\t", "\t\t\t\t\t", 
            RowBox[{"Append", "[", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPadLeft", "[", 
                  RowBox[{
                   RowBox[{"ToString", "@", 
                    RowBox[{"psi4AtomArgToNum", "[", 
                    RowBox[{"mList", ",", " ", "#"}], "]"}]}], ",", "3"}], 
                  "]"}], "&"}], ",", "m"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToPython", "@", "l"}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
           "\"\<'`` `` `` `` ``'\>\"", "~", "TemplateApply", "~", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"Append", "[", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringPadLeft", "[", 
                  RowBox[{
                   RowBox[{"ToString", "@", 
                    RowBox[{"psi4AtomArgToNum", "[", 
                    RowBox[{"mList", ",", " ", "#"}], "]"}]}], ",", "3"}], 
                  "]"}], "&"}], ",", "m"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToPython", "@", "l"}]}], "\n", "\t", "\t\t\t\t\t\t", 
             "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"_", "\[Rule]", "Nothing"}]}], "\n", "\t\t\t", "}"}], ",", 
      "\n", "\t\t\t", "1"}], "\n", "\t\t\t", "]"}]}]}]}]], "CodeInput",
 CellChangeTimes->{{3.7151828236316137`*^9, 3.71518282879245*^9}, {
   3.715182960830386*^9, 3.7151829923993483`*^9}, {3.715183300767777*^9, 
   3.715183361331676*^9}, {3.715183467997891*^9, 3.715183539128821*^9}, {
   3.7151835853850107`*^9, 3.715183587668146*^9}, {3.715186296796028*^9, 
   3.7151862983482924`*^9}, {3.715186356664485*^9, 3.715186370234378*^9}, {
   3.715187979729109*^9, 3.715187993302794*^9}, 3.715188363510804*^9, {
   3.7151884526740923`*^9, 3.715188458650214*^9}, {3.715189044665255*^9, 
   3.715189046187458*^9}, {3.7151893697343817`*^9, 
   3.715189401367173*^9}},ExpressionUUID->"15f31871-2e7c-4eb5-a29a-\
0e44945b4e38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"psi4GeometryFrozenPrepString", "[", "s_", "]"}], ":=", "\n", "\t", 
  "s"}]], "CodeInput",
 CellChangeTimes->{{3.715188181725246*^9, 3.715188196549005*^9}, {
  3.715188245478208*^9, 3.715188310037099*^9}, {3.715188507983521*^9, 
  3.715188509639543*^9}, {3.7151887196768837`*^9, 
  3.71518872156181*^9}},ExpressionUUID->"5bd1ec6c-15d4-46ea-8348-\
bb8d427bbd49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"psi4GeometryFrozenParams", "[", 
    RowBox[{"mList_", ",", "params_List"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ms", "=", 
       RowBox[{"First", "/@", "mList"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"KeyValueMap", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{
         "#", ",", "\n", "\t", "\t\t\t", "1", ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"\"\<frozen_cartesian\>\"", "->", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "psi4GeometryFrozenPrepString", "@", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"psi4GeometryFrozenPositions", "[", 
             RowBox[{"ms", ",", "#2"}], "]"}]}]}], ",", "\n", "\t\t\t\t", "2",
           ",", "\n", "\t\t\t\t\t", 
          RowBox[{"\"\<frozen_distance\>\"", "->", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "psi4GeometryFrozenPrepString", "@", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"psi4GeometryFrozenDistances", "[", 
             RowBox[{"ms", ",", "#2"}], "]"}]}]}], ",", "\n", "\t\t\t\t", "3",
           ",", "\n", "\t\t\t\t\t", 
          RowBox[{"\"\<frozen_bend\>\"", "->", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "psi4GeometryFrozenPrepString", "@", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"psi4GeometryFrozenAngles", "[", 
             RowBox[{"ms", ",", "#2"}], "]"}]}]}], ",", "\n", "\t\t\t\t", "4",
           ",", "\n", "\t\t\t\t\t", 
          RowBox[{"\"\<frozen_dihedral\>\"", "->", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "psi4GeometryFrozenPrepString", "@", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"psi4GeometryFrozenDihedrals", "[", 
             RowBox[{"ms", ",", "#2"}], "]"}]}]}], ",", "\n", "\t\t\t\t", "_",
           ",", "\n", "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t", "]"}], 
        "&"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"GroupBy", "[", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"params", ",", "_Rule"}], "]"}], ",", "\n", "\t", "\t", 
         "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", "#", "]"}], ",", 
             RowBox[{"Length", "[", "#", "]"}], ",", "1"}], "]"}], "&"}], "@*",
           "First"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"psi4GeometryFrozenParams", "[", 
    RowBox[{"mList_", ",", "All"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"psi4GeometryFrozenParams", "[", "\n", "\t\t", 
    RowBox[{"mList", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", "\"\<xyz\>\""}], "&"}], "/@", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "[", "mList", "]"}]}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"psi4GeometryFrozenParams", "[", "__", "]"}], ":=", "\n", "\t", 
  RowBox[{"{", "}"}]}]}], "CodeInput",
 CellChangeTimes->{{3.715183576649143*^9, 3.715183582919146*^9}, {
  3.715183613023963*^9, 3.715183892593961*^9}, {3.715183946088895*^9, 
  3.7151839767429047`*^9}, {3.71518455243639*^9, 3.715184568408649*^9}, {
  3.7151846146155357`*^9, 3.7151846508805428`*^9}, {3.715185910500313*^9, 
  3.7151859445889893`*^9}, {3.715186224754157*^9, 3.715186230510858*^9}, {
  3.715187428495367*^9, 3.7151874679234324`*^9}, {3.715187513279347*^9, 
  3.7151875407896967`*^9}, {3.7151876821004953`*^9, 3.715187722209785*^9}, {
  3.715187754471156*^9, 3.7151877695911503`*^9}, {3.7151880931036997`*^9, 
  3.715188134589011*^9}, {3.715188168451041*^9, 3.7151882228635674`*^9}, {
  3.7151907883783283`*^9, 3.715190789329647*^9}, {3.715552560519849*^9, 
  3.715552565499669*^9}},ExpressionUUID->"5c068079-e461-43c7-9245-\
038dece318b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psi4OptKingConfig", "[", 
   RowBox[{"rules_", "?", "OptionQ"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"PyColumn", "@", "\n", "\t\t", 
   RowBox[{"Append", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PyAssign", "[", 
        RowBox[{
         RowBox[{"\"\<optking_\>\"", "<>", 
          RowBox[{"First", "@", "#"}]}], ",", 
         RowBox[{"Last", "@", "#"}]}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"List", "@", "rules"}]}]}], ",", "\n", "\t\t\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"$Psi4ConfigBlockRiffle", " ", "=", " ", "\"\< = \>\""}], 
        "\n", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
       RowBox[{"Psi4Config", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
        "\"\<OptimizationParameters\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
         RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", "#"}], "->", 
             RowBox[{"\"\<optKing_\>\"", "<>", 
              RowBox[{"First", "@", "#"}]}]}], "&"}], ",", "\n", 
           "\t\t\t\t\t\t\t", 
           RowBox[{"Flatten", "@", 
            RowBox[{"List", "@", "rules"}]}]}], "\n", "\t\t\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
    "\n", "\t\t\t", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.715189966236578*^9, 3.7151899783197327`*^9}, {
  3.715190010730093*^9, 3.715190142985654*^9}, {3.7151903012868853`*^9, 
  3.715190308694724*^9}, {3.7151903548910503`*^9, 3.715190356605805*^9}, {
  3.715190403496842*^9, 3.7151904547696857`*^9}, {3.715190500705263*^9, 
  3.715190502095934*^9}, {3.7151905455820017`*^9, 3.715190579627632*^9}, {
  3.715190744489889*^9, 
  3.715190747061874*^9}},ExpressionUUID->"f875c332-a093-4c4d-b9db-\
e12d7457c7ff"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Optimize\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694297847031735*^9, 
  3.694297862487296*^9}},ExpressionUUID->"1f22027d-5b06-4fc0-9852-\
f15c0b2e28df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4GeometryOptimize", "]"}], "=", "\n", "\t", 
   RowBox[{"Normal", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Options", "@", "Psi4ConfigureCall"}], ",", "\n", "\t", 
        "\t\t", 
        RowBox[{"\"\<Wavefunction\>\"", "\[Rule]", "\"\<scf\>\""}], ",", "\n",
         "\t\t\t", 
        RowBox[{"\"\<FrozenParameters\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      "Last"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GeometryOptimize", "[", "a_Association", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"defs", "=", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Options", "@", "Psi4GeometryOptimize"}]}], "}"}], ",", 
         "First"}], "]"}]}], "}"}], ",", "\n", "\t", 
     RowBox[{"Psi4ConfigureCall", "@", "\n", "\t\t", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
          "\"\<Output\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           "Psi4DataParseGeometry"}], ",", "\n", "\t\t\t", 
          RowBox[{"KeySelect", "[", 
           RowBox[{"a", ",", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"Except", "[", 
              RowBox[{
              "\"\<Wavefunction\>\"", "|", "\"\<Properties\>\"", "|", 
               "\"\<FrozenParameters\>\""}], "]"}], "]"}]}], "]"}], ",", "\n",
           "\t\t\t", 
          RowBox[{"\"\<Configuration\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"KeyMap", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Replace", "[", "$Psi4GeometryParametersMap", "]"}], ",",
              "\n", "\t\t\t\t\t", 
             RowBox[{"Merge", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                   RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"\"\<BasisSet\>\"", "\[Rule]", "\"\<dz\>\""}]}], 
                "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
               "First"}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
            "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"opts", "=", "\n", "\t\t\t\t", 
              RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"List", "@", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                    RowBox[{"<|", "|>"}]}], "]"}], ",", 
                    "\"\<OptimizationParameters\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], ",", "\n", "\t\t\t\t\t", 
                
                RowBox[{"psi4GeometryFrozenParams", "[", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{"a", ",", "\"\<Molecules\>\""}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{"a", ",", "\"\<FrozenParameters\>\""}], "]"}]}], 
                 "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
             "\n", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "opts", "]"}], ">", "0"}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"\"\<ConfigFooter\>\"", "->", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Psi4OptKingConfig", "[", "opts", "]"}]}], ",", "\n", 
              "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
           "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Function\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"a", ",", "\"\<Function\>\"", ",", 
                   RowBox[{"<|", "|>"}]}], "]"}], ",", 
                 RowBox[{"p_String", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Call\>\"", "\[Rule]", "p"}], ")"}]}]}], "]"}],
                ",", "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Call\>\"", "\[Rule]", "\"\<optimize\>\""}], ",", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Arguments\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", 
                  RowBox[{"defs", "[", "\"\<Wavefunction\>\"", "]"}], 
                  "}"}]}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
             "\t\t\t\t\t", "First"}], "]"}]}]}], "\n", "\t\t\t", "}"}], ",", 
        "\n", "\t\t\t", "Last"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/SPVIS6g7bXjC2fTVBBtt2Z9MYh2cbBtBNFyL592
gWgr229g+vEf7YUgetLaosUguvJ58XYQbfbxNpieNuv3YRC9Y539ERC9wW1f
RCiQlrBNjAbREzwulYDoimKBUhB9Z9vlXREgexaf2g2iObTDCv/0v3b82nQR
THNET5BSW/faMffzEXkQfYfltQqIljn2UhNEC/3ZZgyi9zkUmoDoXUKeeSDa
9cQHMB329lQliOZ0vgKmnWZOXAKij/B8XAqi5YzergXRnw6F7wXzXZZdBtEx
0XOugGiJW5MfgWjRayaPQfSpVlU9DSCtdW2XCYju2H3wtCaQPnf9J5gGAL3P
sI8=
  "],ExpressionUUID->"b38e97d2-f550-4108-8358-d70a5503011a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GeometryOptimize", "[", 
    RowBox[{"atoms_List", ",", "props___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4GeometryOptimize", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", 
       RowBox[{"{", "atoms", "}"}]}], ",", "\n", "\t\t\t", "props"}], "\n", 
     "\t\t\t", "|>"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6942978420124474`*^9, 3.6942978976645393`*^9}, {
  3.6942980134897757`*^9, 3.694298121914095*^9}, {3.6942981991847067`*^9, 
  3.694298199694974*^9}, {3.69429837737462*^9, 3.694298395583688*^9}, {
  3.694298555622006*^9, 
  3.6942986043401403`*^9}},ExpressionUUID->"beedf380-1aa1-4d0f-b963-\
1e406f2439af"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Info\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694314341556137*^9, 
  3.694314342090898*^9}},ExpressionUUID->"29b0f014-75a3-4dde-b7b2-\
445b6475ed5c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4GeometryInfo", "]"}], "=", 
   RowBox[{"Options", "[", "Psi4GeometryOptimize", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GeometryInfo", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   
   RowBox[{"Psi4GeometryOptimize", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"a", ",", "\n", "\t\t\t", 
        RowBox[{"\"\<Configuration\>\"", "->", "\n", "\t\t\t\t", 
         RowBox[{"<|", 
          RowBox[{"\"\<InternalCoordinatesOnly\>\"", "\[Rule]", "True"}], 
          "|>"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"\"\<Output\>\"", "->", "\n", "\t\t\t\t", 
         RowBox[{"First", "@*", "Psi4DataParseGeometry"}]}]}], "\n", "\t\t\t",
        "}"}], ",", "\n", "\t\t\t", "Last"}], "\n", "\t\t\t", "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4GeometryInfo", "[", 
    RowBox[{"atoms_List", ",", "props___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4GeometryInfo", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", 
       RowBox[{"{", "atoms", "}"}]}], ",", "\n", "\t\t\t", "props"}], "\n", 
     "\t\t\t", "|>"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694314354630392*^9, 3.694314455784369*^9}, {
  3.694314587553504*^9, 3.6943146650010366`*^9}, {3.694314862793845*^9, 
  3.694314882568222*^9}, {3.694315150002694*^9, 
  3.6943151504904737`*^9}},ExpressionUUID->"0559a695-05b8-446a-8527-\
07c8295d14d8"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Energy\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.711070164226256*^9, 
  3.711070165058999*^9}},ExpressionUUID->"9ad74d13-554c-4e93-af62-\
85886bb6303f"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Energy\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7110701586679068`*^9, 
  3.7110701630910807`*^9}},ExpressionUUID->"7092cde1-3ead-4cf9-b4ca-\
39e4da94acd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4Energy", "]"}], "=", "\n", "\t", 
   RowBox[{"Normal", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "Psi4ConfigureCall"}], ",", "\n", "\t", 
        "\t\t", 
        RowBox[{"\"\<Wavefunction\>\"", "\[Rule]", "\"\<scf\>\""}], ",", "\n",
         "\t\t\t", 
        RowBox[{"\"\<FrozenParameters\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      "Last"}], "\n", "\t\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Energy", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"defs", "=", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Options", "@", "Psi4GeometryOptimize"}]}], "}"}], ",", 
         "First"}], "]"}]}], "}"}], ",", "\n", "\t", 
     RowBox[{"Psi4ConfigureCall", "@", "\n", "\t\t", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
          "\"\<Output\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           "Psi4DataParseGeometry"}], ",", "\n", "\t\t\t", 
          RowBox[{"KeySelect", "[", 
           RowBox[{"a", ",", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"Except", "[", 
              RowBox[{
              "\"\<Wavefunction\>\"", "|", "\"\<Properties\>\"", "|", 
               "\"\<FrozenParameters\>\""}], "]"}], "]"}]}], "]"}], ",", "\n",
           "\t\t\t", 
          RowBox[{"\"\<Configuration\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"KeyMap", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Replace", "[", "$Psi4GeometryParametersMap", "]"}], ",",
              "\n", "\t\t\t\t\t", 
             RowBox[{"Merge", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                   RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"\"\<BasisSet\>\"", "\[Rule]", "\"\<dz\>\""}]}], 
                "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
               "First"}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
            "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"opts", "=", "\n", "\t\t\t\t", 
              RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"List", "@", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                    RowBox[{"<|", "|>"}]}], "]"}], ",", 
                    "\"\<OptimizationParameters\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], ",", "\n", "\t\t\t\t\t", 
                
                RowBox[{"psi4GeometryFrozenParams", "[", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{"a", ",", "\"\<Molecules\>\""}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{"a", ",", "\"\<FrozenParameters\>\""}], "]"}]}], 
                 "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
             "\n", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "opts", "]"}], ">", "0"}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"\"\<ConfigFooter\>\"", "->", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Psi4OptKingConfig", "[", "opts", "]"}]}], ",", "\n", 
              "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
           "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Function\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"a", ",", "\"\<Function\>\"", ",", 
                   RowBox[{"<|", "|>"}]}], "]"}], ",", 
                 RowBox[{"p_String", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Call\>\"", "\[Rule]", "p"}], ")"}]}]}], "]"}],
                ",", "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Call\>\"", "\[Rule]", "\"\<energy\>\""}], ",", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Arguments\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", 
                  RowBox[{"defs", "[", "\"\<Wavefunction\>\"", "]"}], 
                  "}"}]}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
             "\t\t\t\t\t", "First"}], "]"}]}]}], "\n", "\t\t\t", "}"}], ",", 
        "\n", "\t\t\t", "Last"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6942978420124474`*^9, 3.6942978976645393`*^9}, {
  3.6942980134897757`*^9, 3.694298121914095*^9}, {3.6942981991847067`*^9, 
  3.694298199694974*^9}, {3.69429837737462*^9, 3.694298395583688*^9}, {
  3.694298555622006*^9, 3.6942985588731947`*^9}, {3.6942986558626204`*^9, 
  3.694298657990078*^9}, {3.694308037946129*^9, 3.6943080590387077`*^9}, {
  3.6943082625713577`*^9, 3.6943082645140953`*^9}, {3.6943149666160717`*^9, 
  3.694314974332412*^9}, {3.699368842692753*^9, 3.699368846547236*^9}, {
  3.7110702155706167`*^9, 3.711070216170928*^9}, {3.711070254595687*^9, 
  3.711070341745439*^9}, {3.715184181357561*^9, 3.715184223645233*^9}, {
  3.715184297196343*^9, 3.7151843001101913`*^9}, {3.7151843526733227`*^9, 
  3.71518438792309*^9}, {3.715187147225668*^9, 3.71518715173038*^9}, {
  3.715190373701001*^9, 
  3.715190375455697*^9}},ExpressionUUID->"a59346e1-6170-48c6-beba-\
471514f939c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4Energy", "[", 
    RowBox[{"atoms_List", ",", "props___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4Energy", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", 
       RowBox[{"{", "atoms", "}"}]}], ",", "\n", "\t\t\t", "props"}], "\n", 
     "\t\t\t", "|>"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6942978420124474`*^9, 3.6942978976645393`*^9}, {
  3.6942980134897757`*^9, 3.694298121914095*^9}, {3.6942981991847067`*^9, 
  3.694298199694974*^9}, {3.69429837737462*^9, 3.694298395583688*^9}, {
  3.694298555622006*^9, 3.6942986043401403`*^9}, {3.7110703463179407`*^9, 
  3.7110703469738207`*^9}},ExpressionUUID->"a5a2099d-1832-430a-aaf9-\
5e016172d3f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]EnergyScan\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7110701586679068`*^9, 3.7110701630910807`*^9}, {
  3.715082563263583*^9, 
  3.715082563788827*^9}},ExpressionUUID->"1e26bf12-03d0-43dd-a2f3-\
f1c3117415b8"],

Cell["Does a scan over the energy of a system", "Text",
 CellChangeTimes->{{3.715082565412773*^9, 3.715082572868843*^9}, {
  3.715082770510208*^9, 
  3.715082770939013*^9}},ExpressionUUID->"0921bdac-1141-4400-9eef-\
ed926b8629e9"],

Cell[BoxData[
 RowBox[{"Psi4EnergyScan", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.715094088156117*^9, 
  3.715094088872322*^9}},ExpressionUUID->"7fa26429-6382-474d-8541-\
d706548681f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4EnergyScan", "]"}], "=", "\n", "\t", 
   RowBox[{"Normal", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "Psi4Scan"}], ",", "\n", "\t\t\t", 
        RowBox[{"\"\<Wavefunction\>\"", "\[Rule]", "\"\<scf\>\""}], ",", "\n",
         "\t\t\t", 
        RowBox[{"\"\<FrozenParameters\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      "Last"}], "\n", "\t\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4EnergyScan", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"defs", "=", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Options", "@", "Psi4EnergyScan"}]}], "}"}], ",", 
         "First"}], "]"}]}], "}"}], ",", "\n", "\t", 
     RowBox[{"Psi4Scan", "@", "\n", "\t\t", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
          "\"\<Output\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           "Psi4DataParseGeometry"}], ",", "\n", "\t\t\t", 
          RowBox[{"KeySelect", "[", 
           RowBox[{"a", ",", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"Except", "[", 
              RowBox[{"\"\<Wavefunction\>\"", "|", "\"\<Properties\>\""}], 
              "]"}], "]"}]}], "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"opts", "=", "\n", "\t\t\t\t", 
              RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"List", "@", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Lookup", "[", 
                   RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                    RowBox[{"<|", "|>"}]}], "]"}], ",", 
                    "\"\<OptimizationParameters\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}]}]}], ",", "\n", "\t\t\t\t\t", 
                
                RowBox[{"psi4GeometryFrozenParams", "[", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{"a", ",", "\"\<Molecules\>\""}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Lookup", "[", 
                    RowBox[{"a", ",", "\"\<FrozenParameters\>\""}], "]"}], "/.",
                    "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}]}]}], "\n", 
                 "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
             "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "opts", "]"}], ">", "0"}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"\"\<ScanPre\>\"", "->", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Psi4OptKingConfig", "[", "opts", "]"}]}], ",", "\n", 
              "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
           "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Configuration\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"KeyMap", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Replace", "[", "$Psi4GeometryParametersMap", "]"}], ",",
              "\n", "\t\t\t\t\t", 
             RowBox[{"Merge", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                   RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"\"\<BasisSet\>\"", "\[Rule]", "\"\<dz\>\""}]}], 
                "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
               "First"}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
            "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Function\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"a", ",", "\"\<Function\>\"", ",", 
                   RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"p_String", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Call\>\"", "\[Rule]", "p"}], ")"}]}]}], "\n", 
                "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Call\>\"", "\[Rule]", "\"\<energy\>\""}], ",", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Arguments\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", 
                  RowBox[{"defs", "[", "\"\<Wavefunction\>\"", "]"}], 
                  "}"}]}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
             "\t\t\t\t\t", "First"}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", 
         "\t\t\t", "}"}], ",", "\n", "\t\t\t", "Last"}], "]"}]}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4EnergyScan", "[", 
    RowBox[{"atoms_List", ",", 
     RowBox[{"props___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4EnergyScan", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", 
       RowBox[{"{", "atoms", "}"}]}], ",", "\n", "\t\t\t", "props"}], "\n", 
     "\t\t\t", "|>"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4EnergyScan", "[", "\n", "\t", 
   RowBox[{"atoms_List", ",", "\n", "\t", 
    RowBox[{"grid", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_Integer", ",", "_Integer", ",", "_Integer"}], "}"}], "|", 
      "_Integer"}], ":", "27"}], ",", "\n", "\t", 
    RowBox[{"ops___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"Psi4EnergyScan", "@", "\n", "\t\t", 
   RowBox[{"Psi4AutoScan", "[", 
    RowBox[{"atoms", ",", "grid", ",", "ops"}], "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.6942978420124474`*^9, 3.6942978976645393`*^9}, {
   3.6942980134897757`*^9, 3.694298121914095*^9}, {3.6942981991847067`*^9, 
   3.694298199694974*^9}, {3.69429837737462*^9, 3.694298395583688*^9}, {
   3.694298555622006*^9, 3.6942985588731947`*^9}, {3.6942986558626204`*^9, 
   3.694298657990078*^9}, {3.694308037946129*^9, 3.6943080590387077`*^9}, {
   3.6943082625713577`*^9, 3.6943082645140953`*^9}, {3.6943149666160717`*^9, 
   3.694314974332412*^9}, {3.699368842692753*^9, 3.699368846547236*^9}, {
   3.7110702155706167`*^9, 3.711070216170928*^9}, {3.711070254595687*^9, 
   3.711070341745439*^9}, {3.715082458899585*^9, 3.715082460154601*^9}, {
   3.715082496406908*^9, 3.715082527786982*^9}, {3.7150825801540737`*^9, 
   3.715082594120085*^9}, {3.715082741594329*^9, 3.7150827664952707`*^9}, {
   3.7150940447962627`*^9, 3.715094080673259*^9}, {3.715094117044695*^9, 
   3.715094155767931*^9}, {3.715094192558998*^9, 3.7150941990105677`*^9}, 
   3.715094261736223*^9, {3.715094324949235*^9, 3.715094332314251*^9}, {
   3.715184245770862*^9, 3.7151842733190117`*^9}, {3.7151844329876223`*^9, 
   3.715184436654917*^9}, {3.715186290912279*^9, 3.715186329878007*^9}, {
   3.7151864676697483`*^9, 3.71518649953642*^9}, {3.715186530736381*^9, 
   3.715186546296938*^9}, {3.715186580631197*^9, 3.715186600579968*^9}, {
   3.71518680399617*^9, 3.715186814656082*^9}, {3.7151871233720293`*^9, 
   3.715187123527843*^9}, {3.715190379421397*^9, 3.715190380936194*^9}, 
   3.715552620085525*^9},ExpressionUUID->"de411c88-c380-4644-884f-\
6d93a9bf64f7"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Property\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69984094646244*^9, 
  3.699840947510688*^9}},ExpressionUUID->"31c50298-83eb-4f1d-ae6a-\
0b0989d41e22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Psi4PropertyParametersMap", "=", 
   RowBox[{"<|", "\n", "\t", 
    RowBox[{
    "\"\<PropertiesOrigin\>\"", "\[Rule]", "\"\<properties_origin\>\""}], 
    "\n", "\t", "|>"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699840956598485*^9, 
  3.699840992247074*^9}},ExpressionUUID->"220e0abf-4ede-4268-ba3b-\
f221aeef8129"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Scan\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699842770870908*^9, 
  3.699842771335293*^9}},ExpressionUUID->"32e1068d-5719-4d2e-90eb-\
4145002e3e92"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Scan\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6998427735509577`*^9, 
  3.6998427745031357`*^9}},ExpressionUUID->"02c27fb0-53c2-4f74-a815-\
1835aa48cf4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4Scan", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Options", "@", "Psi4ConfigureCall"}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Scan\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<ScanCoordinatesPre\>\"", "\[Rule]", "Identity"}]}], "\n", 
      "\t\t\t", "}"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"varspec", "=", 
      RowBox[{"_String", "|", "_Symbol", "|", "_PySymbol"}]}], "}"}], ",", 
    "\n", 
    RowBox[{
     RowBox[{"Psi4Scan", "[", "a_Association", "]"}], ":=", "\n", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"components", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{"Options", "@", "Psi4Scan"}]}], "}"}], ",", "First"}], 
          "]"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"Psi4ConfigureCall", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<Molecules\>\"", "->", 
             RowBox[{"components", "[", "\"\<Molecules\>\"", "]"}]}], "/.", 
            RowBox[{
             RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
             RowBox[{"\"\<pyVar_\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}]}]}]}], ",", "\n", "\t\t\t", 
           
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"components", "[", "\"\<Scan\>\"", "]"}], ",", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"scan_List", ":>", "\n", "\t\t\t\t\t", 
                RowBox[{"\"\<Function\>\"", "->", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"precoords", "=", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    "components", ",", "\"\<ScanCoordinatesPre\>\"", ",", 
                    "Identity"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"prefunc", "=", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    "components", ",", "\"\<ScanPre\>\"", ",", "None"}], 
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"molNameVars", "=", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Association", "@", 
                    RowBox[{"Flatten", "@", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mnameCounter", "=", "1"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"components", "[", "\"\<Molecules\>\"", "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"m", ":", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_String", ",", "_"}], "}"}], "..."}], "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "_String", "}"}], ",", "___"}], "}"}]}]}], 
                    "\[RuleDelayed]", 
                    RowBox[{"{", "m", "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m_", "\[Rule]", "e_"}], ")"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"e", ",", 
                    RowBox[{"_Slot", "|", "_PyVar"}], ",", "\[Infinity]"}], 
                    "]"}], "->", "m"}], "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"e_", "\[RuleDelayed]", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Thread", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"e", ",", 
                    RowBox[{"_Slot", "|", "_PyVar"}], ",", "\[Infinity]"}], 
                    "]"}], "->", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<mol_\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"mnameCounter", "++"}], "]"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", ")"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "1"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"scanList", "=", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"itVarCounter", "=", "1"}], "}"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Reverse", "@", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"scan", "/.", 
                    RowBox[{
                    RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}]}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"s", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"varspec", "|", 
                    RowBox[{"{", 
                    RowBox[{"varspec", ".."}], "}"}]}], ",", "__"}], "}"}]}], 
                    "\[RuleDelayed]", 
                    RowBox[{"{", "s", "}"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"i", ":", 
                    RowBox[{"Except", "[", 
                    RowBox[{"varspec", "|", 
                    RowBox[{"{", 
                    RowBox[{"varspec", ".."}], "}"}]}], "]"}]}], ":>", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"itVarCounter", "++"}], "]"}]}], ",", "i"}], 
                    "}"}], ",", "1"}], "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "1"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"Fold", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", ":", 
                    RowBox[{"varspec", "|", 
                    RowBox[{"{", 
                    RowBox[{"varspec", ".."}], "}"}]}]}], ",", "s_"}], "}"}], 
                    ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"PyForIn", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"n_Integer", "\[RuleDelayed]", 
                    RowBox[{"PyRange", "[", "n", "]"}]}]}], "]"}]}], "]"}], 
                    "[", "#", "]"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", ":", "varspec"}], ",", "s1_", ",", "s2__"}], 
                    "}"}], ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"PyForIn", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"PyRange", "[", 
                    RowBox[{"s1", ",", "s2"}], "]"}]}], "]"}], "[", "#", 
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", "#"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], "&"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "molNameVars", "]"}], ">", "0"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"mnVars", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "KeyValueMap", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PyDot", "[", 
                    RowBox[{"#2", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    "#", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Slot", "]"}], "[", "n_", "]"}], 
                    ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "molNameVars"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "scanVars", ":=", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"SortBy", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"First", ",", "scanList"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Last", "/@", "mnVars"}], ",", "#"}], "]"}], 
                    "&"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"pref", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"prefunc", "=!=", "None"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"prefunc", "/.", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"f_String", "[", "args___", "]"}], ":>", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"PyCall", "[", "f", "]"}], "[", "args", "]"}]}], 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "/.", 
                    RowBox[{
                    RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "Nothing"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"pf", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"precoords", "=!=", "Identity"}], ",", "\n", "\t",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"precoords", "/.", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"f_String", "[", "args___", "]"}], ":>", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"PyCall", "[", "f", "]"}], "[", "args", "]"}]}], 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "/.", 
                    RowBox[{
                    RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "scanVars"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"PyColumn", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"pref", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "PyAssign", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "mnVars", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "pf"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "#"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "&"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "Identity"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"components", ",", "\"\<Function\>\""}], "]"}], "/.", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"s_String", "[", "args___", "]"}], ":>", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"PyCall", "[", "s", "]"}], "[", "args", "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "/.", 
                    RowBox[{
                    RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
                    RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}]}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "f_Association", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Psi4Function", "@", "f"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"s", ":", 
                    RowBox[{
                    RowBox[{"_", "?", "SymbolicPythonQ"}], "|", "_String"}]}],
                     ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t", "s"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Defer", "[", "e___", "]"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "e", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PyPrint", "@", 
                    RowBox[{"Psi4Function", "@", "components"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", "scanList"}], "\n", "\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", "Nothing"}]}], "\t", 
              "\n", "\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t\t", 
           RowBox[{"\"\<Molecules\>\"", "->", "\n", "\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{"components", ",", "\"\<Molecules\>\"", ",", "None"}], 
               "]"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"l", ":", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"_List", "|", "_"}], "\[Rule]", "_List"}], ")"}]}],
                 ":>", "\n", "\t\t\t\t\t\t", 
                RowBox[{"(", 
                 RowBox[{"l", "/.", 
                  RowBox[{
                   RowBox[{"Slot", "[", "n_", "]"}], "\[RuleDelayed]", 
                   RowBox[{"\"\<pyVar_\>\"", "<>", 
                    RowBox[{"ToString", "[", "n", "]"}]}]}]}], ")"}]}], "\n", 
               "\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"Normal", "@", "\n", "\t\t\t\t", 
            RowBox[{"KeyDrop", "[", 
             RowBox[{"components", ",", "\n", "\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
               "\"\<Molecules\>\"", ",", "\n", "\t\t\t\t\t\t", "\"\<Scan\>\"",
                 ",", "\"\<ScanCoordinatesPre\>\"", ",", "\n", 
                "\t\t\t\t\t\t", "\"\<Function\>\"", ",", "\"\<Call\>\"", ",", 
                "\n", "\t\t\t\t\t\t", "\"\<AssignTo\>\"", ",", 
                "\"\<Arguments\>\"", ",", "\n", "\t\t\t\t\t\t", 
                "\"\<KeyWordArguments\>\""}], "\n", "\t\t\t\t\t\t", "}"}]}], 
             "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}]}]}]}], "\n",
       "\t\t", "]"}]}]}], "\n", "\t", "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6998427757208557`*^9, 3.6998428224013147`*^9}, {
   3.699843200446766*^9, 3.699843525954426*^9}, {3.6998435669387693`*^9, 
   3.69984361668075*^9}, {3.699843698841311*^9, 3.699843921337117*^9}, {
   3.699844283810884*^9, 3.6998444963445883`*^9}, {3.6998445563943253`*^9, 
   3.699844560558401*^9}, {3.6998446745727463`*^9, 3.699844764146426*^9}, {
   3.699844855796668*^9, 3.699844874443932*^9}, {3.6998449066285543`*^9, 
   3.6998449584593*^9}, {3.699845050860835*^9, 3.699845130051344*^9}, {
   3.699845172328491*^9, 3.699845175046216*^9}, {3.6998452805215483`*^9, 
   3.699845413963188*^9}, {3.699845455531745*^9, 3.69984549668399*^9}, {
   3.699845545330112*^9, 3.699845652312505*^9}, {3.699845689521121*^9, 
   3.6998457958864117`*^9}, {3.699845829096938*^9, 3.699845887437953*^9}, {
   3.6998464230470343`*^9, 3.699846436891739*^9}, {3.699846969453438*^9, 
   3.699846974635668*^9}, {3.7110653571245947`*^9, 3.711065373418006*^9}, {
   3.71106565517666*^9, 3.7110656689087543`*^9}, {3.7110657934535713`*^9, 
   3.711065884894899*^9}, {3.715083982343992*^9, 3.7150842812989283`*^9}, {
   3.7150849143921347`*^9, 3.7150849214196453`*^9}, {3.7150852292364492`*^9, 
   3.715085369629712*^9}, {3.715085415382749*^9, 3.715085425787408*^9}, 
   3.715085960038412*^9, {3.715094291713028*^9, 3.715094300872877*^9}, {
   3.715094827167164*^9, 3.715094845068227*^9}, {3.715095224558049*^9, 
   3.7150952873267527`*^9}, {3.715095436904182*^9, 3.715095460051292*^9}, {
   3.7150955076103163`*^9, 3.715095658215787*^9}, {3.715095691875436*^9, 
   3.715095772146949*^9}, {3.715095830419333*^9, 3.715095833762743*^9}, {
   3.7150959081536903`*^9, 3.715095926022236*^9}, {3.715095990030541*^9, 
   3.715096146525551*^9}, {3.7151387047204742`*^9, 3.715138712791917*^9}, {
   3.7151387598112297`*^9, 3.715138790771541*^9}, {3.715138846615155*^9, 
   3.7151388616144047`*^9}, {3.7151389626419563`*^9, 3.715139054669098*^9}, {
   3.7151391005786963`*^9, 3.715139191912134*^9}, {3.7151392336904907`*^9, 
   3.71513939197736*^9}, {3.715139423984357*^9, 3.7151395142884283`*^9}, {
   3.715139547400373*^9, 3.7151396240860777`*^9}, 3.7151396949738693`*^9, {
   3.715139738440036*^9, 3.715139842130845*^9}, {3.71513987413626*^9, 
   3.715140007154148*^9}, {3.7151401196402197`*^9, 3.7151402069618263`*^9}, {
   3.715140262522435*^9, 3.715140275569784*^9}, {3.715140308542897*^9, 
   3.7151403435898733`*^9}, {3.715140413111765*^9, 3.715140452964349*^9}, {
   3.7151404923097773`*^9, 3.7151405680636473`*^9}, {3.7151406182192993`*^9, 
   3.7151406248574877`*^9}, 3.715140654914138*^9, {3.7151407203424873`*^9, 
   3.7151407439104633`*^9}, {3.715186644442402*^9, 3.715186766171624*^9}, {
   3.715194080407934*^9, 3.715194087940858*^9}, {3.715194836265197*^9, 
   3.715194845937069*^9}, {3.7151949856011047`*^9, 3.7151950239134808`*^9}, {
   3.7151950955070343`*^9, 3.7151951662136793`*^9}, {3.715195238873866*^9, 
   3.715195479721518*^9}, {3.715200021835026*^9, 3.715200027156363*^9}, {
   3.715553662635725*^9, 
   3.7155537031901703`*^9}},ExpressionUUID->"d0834043-a554-4837-bdcf-\
4634cb1b5d55"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OneElectronProperty\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693150161821474*^9, 3.693150166501059*^9}, {
  3.6931502741640787`*^9, 
  3.6931502823158503`*^9}},ExpressionUUID->"01772d4b-723a-46c6-8cd9-\
0bc7bbcc6bec"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]$OneElectronParametersMap\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"b3bad7bc-747f-45b9-94d3-9924d84104c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Psi4OneElectronParametersMap", "=", "\n", "\t", 
   RowBox[{"ToUpperCase", "/@", 
    RowBox[{"<|", "\n", "\t\t", 
     RowBox[{
      RowBox[{"\"\<DipoleMoment\>\"", "\[Rule]", "\"\<dipole\>\""}], ",", 
      "\n", "\t", "\t", 
      RowBox[{"\"\<QuadrupoleMoment\>\"", "\[Rule]", "\"\<quadrupole\>\""}], 
      ",", "\n", "\t", "\t", 
      RowBox[{"\"\<MultipoleMoment\>\"", "\[Rule]", "\"\<multipole\>\""}], 
      ",", "\n", "\t", "\t", 
      RowBox[{
      "\"\<NucleiElectrostaticPotential\>\"", "\[Rule]", 
       "\"\<esp_at_nuclei\>\""}], ",", "\n", "\t", "\t", 
      RowBox[{
      "\"\<ElectrostaticPotential\>\"", "\[Rule]", "\"\<grid_esp\>\""}], ",", 
      "\n", "\t", "\t", 
      RowBox[{"\"\<ElectricField\>\"", "\[Rule]", "\"\<grid_field\>\""}], ",",
       "\n", "\t", "\t", 
      RowBox[{"\"\<OrbitalExtents\>\"", "\[Rule]", "\"\<mo_extents\>\""}], 
      ",", "\n", "\t", "\t", 
      RowBox[{
      "\"\<MullikenCharges\>\"", "\[Rule]", "\"\<mulliken_charges\>\""}], ",",
       "\n", "\t", "\t", 
      RowBox[{"\"\<LoewdinCharges\>\"", "\[Rule]", "\"\<lowdin_charges\>\""}],
       ",", "\n", "\t", "\t", 
      RowBox[{
      "\"\<WidbergIndices\>\"", "\[Rule]", "\"\<widberg_lowdin_charges\>\""}],
       ",", "\n", "\t", "\t", 
      RowBox[{"\"\<MayerIndices\>\"", "\[Rule]", "\"\<mayer_indices\>\""}], 
      ",", "\n", "\t", "\t", 
      RowBox[{
      "\"\<OrbitalOccupations\>\"", "\[Rule]", "\"\<no_occupations\>\""}]}], 
     "\n", "\t\t", "|>"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"91464e61-b5e3-4eda-96b2-1f2c7bce46e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OneElectronProperty\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693048461811756*^9, 3.6930484633547993`*^9}, {
   3.693150167876998*^9, 3.6931501679730062`*^9}, 3.693150285422518*^9, 
   3.6941779015617933`*^9},ExpressionUUID->"aae586e2-d506-497e-a61a-\
c96787a5ec2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "Psi4OneElectronProperty"}], "=", "\n", "\t", 
   RowBox[{"Normal", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "Psi4ConfigureCall"}], ",", "\n", "\t", "\t", 
        "\t\t", 
        RowBox[{"\"\<Wavefunction\>\"", "\[Rule]", "\"\<scf\>\""}], ",", "\n",
         "\t", "\t\t\t", 
        RowBox[{"\"\<Properties\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t", "\t\t\t", "}"}], ",", "\n", 
      "\t\t\t", "Last"}], "\n", "\t\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronProperty", "[", "a_Association", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"defs", "=", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Options", "@", "Psi4OneElectronProperty"}]}], "}"}], ",", 
         "First"}], "]"}]}], "}"}], ",", "\n", "\t", 
     RowBox[{"Psi4ConfigureCall", "@", "\n", "\t\t", 
      RowBox[{"Merge", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"KeySelect", "[", 
           RowBox[{"a", ",", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"Except", "[", 
              RowBox[{"\"\<Wavefunction\>\"", "|", "\"\<Properties\>\""}], 
              "]"}], "]"}]}], "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Configuration\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                 RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"<|", 
                RowBox[{"\"\<BasisSet\>\"", "\[Rule]", "\"\<cc-pvdz\>\""}], 
                "|>"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
             "First"}], "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<FunctionHeader\>\"", "->", "\n", "\t\t\t\t", 
           RowBox[{"PyAssign", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"PyTuple", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<h\>\"", ",", " ", "\"\<wfn\>\""}], "}"}], "]"}], 
             ",", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"PyCall", "[", "\"\<energy\>\"", "]"}], "[", 
              RowBox[{
               RowBox[{"PyString", "@", 
                RowBox[{"defs", "[", "\"\<Wavefunction\>\"", "]"}]}], ",", 
               " ", 
               RowBox[{"\"\<return_wfn\>\"", "\[Rule]", "True"}]}], "]"}]}], 
            "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Function\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"\"\<KeyWordArguments\>\"", "->", "\n", "\t\t\t\t\t\t", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"a", ",", " ", "\"\<KeyWordArguments\>\"", ",", 
                  RowBox[{"{", "}"}]}], " ", "]"}]}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Lookup", "[", 
                  RowBox[{"a", ",", "\"\<Function\>\"", ",", 
                   RowBox[{"<|", "|>"}]}], "]"}], ",", 
                 RowBox[{"p_String", "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"\"\<Call\>\"", "\[Rule]", "p"}], ")"}]}]}], "]"}],
                ",", "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Call\>\"", "\[Rule]", "\"\<oeprop\>\""}], ",", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<Arguments\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                RowBox[{"Prepend", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    "$Psi4OneElectronParametersMap", ",", " ", "#", ",", " ", 
                    "#"}], "]"}], "&"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"defs", "[", "\"\<Properties\>\"", "]"}], 
                    "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t", "wfn"}], "\n", "\t\t\t\t\t\t\t", 
                 "]"}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
             "\t\t\t\t\t", "First"}], "]"}]}]}], "\n", "\t\t\t", "}"}], ",", 
        "\n", "\t\t\t", "Last"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronProperty", "[", 
    RowBox[{"r", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}], "|", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}]}], ")"}]}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4OneElectronProperty", "@", 
    RowBox[{"Association", "@", "r"}]}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"41ca7a87-f1bb-4b99-952a-e915bdac3b73"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronProperty", "[", "\n", "\t", 
    RowBox[{"atoms_List", ",", "\n", "\t", 
     RowBox[{"grid", ":", 
      RowBox[{"_List", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"props___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Psi4OneElectronProperty", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", 
       RowBox[{"{", "atoms", "}"}]}], ",", "\n", "\t\t\t", "props"}], "\n", 
     "\t\t\t", "|>"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"11cc726a-d08f-4d2b-a61c-ea5995777178"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OneElectronElectrostaticPotential\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693048685877018*^9, 3.693048688467197*^9}, {
  3.6931502980528393`*^9, 3.693150313435066*^9}, {3.693150812919429*^9, 
  3.69315082057482*^9}},ExpressionUUID->"b08d0494-0b1b-4486-9e16-\
c008ef3d5e86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4OneElectronElectrostaticPotential", "]"}], 
   "=", "\n", "\t", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "@", "Psi4OneElectronProperty"}], ",", 
     RowBox[{"\"\<Grid\>\"", "\[Rule]", "None"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Psi4OneElectronElectrostaticPotential", "[", "a_Association", "]"}], ":=",
    "\t", "\n", "\t", 
   RowBox[{"Psi4OneElectronProperty", "@", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"<|", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"\"\<Header\>\"", "->", "\n", "\t", "\t\t\t", 
           RowBox[{"\"\<#\>\"", "<>", 
            RowBox[{"DateString", "@", "Now"}], "<>", "\"\<\\n\>\"", "<>", 
            "\n", "\t", "\t\t\t\t", 
            "\"\<#Grid electrostatic potential calculation\>\""}]}], ",", 
          "\n", "\t", "\t\t", 
          RowBox[{"\"\<MoleculeOptions\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<noreorient\>\"", ",", "\"\<nocom\>\""}], "}"}]}], 
          ",", "\n", "\t", "\t\t", 
          RowBox[{"\"\<Arguments\>\"", "\[Rule]", 
           RowBox[{"{", "\"\<scf\>\"", "}"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Properties\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<GRID_ESP\>\"", ",", "\"\<GRID_FIELD\>\""}], "}"}]}], 
          ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Output\>\"", "\[Rule]", 
           RowBox[{
           "\"\<grid_esp.dat\>\"", "|", "\"\<grid_field.dat\>\""}]}]}], "\n", 
         "\t\t\t", "|>"}], ",", "\n", "\t\t", "a"}], "}"}], ",", "\n", "\t\t",
       "First"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronElectrostaticPotential", "[", "\n", "\t", 
    RowBox[{"r", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}], "|", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}]}], ")"}]}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4OneElectronElectrostaticPotential", "@", 
    RowBox[{"Association", "@", "r"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692978196224111*^9, 3.692978206648143*^9}, {
   3.692996254373472*^9, 3.692996283801708*^9}, {3.6929963419889717`*^9, 
   3.6929963597621317`*^9}, {3.692996693835596*^9, 3.6929967491788473`*^9}, {
   3.692997483392777*^9, 3.692997488605171*^9}, {3.692997535031782*^9, 
   3.6929975667379913`*^9}, {3.692997608448585*^9, 3.692997668596798*^9}, {
   3.692997718578734*^9, 3.692997746574026*^9}, {3.692997780143731*^9, 
   3.692997843890889*^9}, {3.692997876342819*^9, 3.692998013046933*^9}, {
   3.6929983139621067`*^9, 3.692998345849275*^9}, {3.692998392583846*^9, 
   3.6929983948706827`*^9}, {3.692998477379286*^9, 3.692998502322568*^9}, {
   3.692998559755603*^9, 3.6929985599217157`*^9}, {3.6929995780168667`*^9, 
   3.6929996682528477`*^9}, {3.6929999329427357`*^9, 
   3.6929999744034157`*^9}, {3.693000025569598*^9, 3.6930003652678757`*^9}, 
   3.693000408822631*^9, 3.693000985254649*^9, {3.693001029350933*^9, 
   3.6930010320846853`*^9}, {3.693001078846306*^9, 3.693001086053059*^9}, 
   3.6930012698790617`*^9, {3.693002427300621*^9, 3.6930024276593933`*^9}, {
   3.6930025717511997`*^9, 3.6930025760638103`*^9}, {3.6930125263498383`*^9, 
   3.693012542603902*^9}, 3.693012658815428*^9, {3.693016192672867*^9, 
   3.693016221152482*^9}, {3.693021034849657*^9, 3.693021060516371*^9}, {
   3.693048762436462*^9, 3.693048770563938*^9}, {3.6930491496548643`*^9, 
   3.693049201330361*^9}, {3.69304955918906*^9, 3.6930495841612263`*^9}, {
   3.693049647192759*^9, 3.693049670580441*^9}, 3.693049806818754*^9, {
   3.693075752759631*^9, 3.69307576124508*^9}, {3.693075796676609*^9, 
   3.693075899393615*^9}, {3.6930760006274433`*^9, 3.693076066365554*^9}, 
   3.693076596685248*^9, {3.69307669302417*^9, 3.693076700470335*^9}, {
   3.693076825872069*^9, 3.693076912815332*^9}, {3.6930771011478148`*^9, 
   3.693077103859424*^9}, {3.6930848497832823`*^9, 3.693084851949369*^9}, {
   3.6930867951115923`*^9, 3.6930868445584*^9}, {3.693086947874755*^9, 
   3.693086974585919*^9}, {3.693091880738132*^9, 3.6930918908475437`*^9}, {
   3.6930919448067293`*^9, 3.693092036477233*^9}, {3.693092067081284*^9, 
   3.693092163226372*^9}, {3.6930935423264933`*^9, 3.693093548063961*^9}, {
   3.6931182582620773`*^9, 3.693118267023242*^9}, {3.693118371518407*^9, 
   3.693118386902088*^9}, {3.6931184854472847`*^9, 3.6931185094214087`*^9}, {
   3.6931185591805162`*^9, 3.693118564451632*^9}, {3.693150194459313*^9, 
   3.6931502017351303`*^9}, {3.693150326308937*^9, 3.693150365594977*^9}, {
   3.693150846594646*^9, 3.6931508534639997`*^9}, {3.694178524766335*^9, 
   3.6941785280498466`*^9}, {3.694178964446774*^9, 3.694178995768897*^9}, 
   3.6941801548194532`*^9, {3.699368860193988*^9, 
   3.699368863738134*^9}},ExpressionUUID->"da6248ab-75e5-4751-b044-\
0376cccf48a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronElectrostaticPotential", "[", 
    RowBox[{"atomset_List", ",", " ", "a___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4OneElectronElectrostaticPotential", "@", "\n", "\t\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Psi4UtilsAutoGrid", "[", 
       RowBox[{"atomset", ",", "a"}], "]"}], ",", "2"}], "]"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"97c45f38-dc32-496b-9fee-9c3f55e0b94e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OneElectronDipoleMoment\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69418286120263*^9, 
  3.694182866946306*^9}},ExpressionUUID->"67bfc177-a5c3-4057-b1c9-\
1d339831b5ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4OneElectronDipoleMoment", "[", "specs__", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Psi4OneElectronProperty", "[", 
    RowBox[{"specs", ",", "\n", "\t\t", 
     RowBox[{
     "\"\<Properties\>\"", "\[Rule]", "\n", "\t\t\t", 
      "\"\<DipoleMoment\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{
     "\"\<Output\>\"", "\[Rule]", "\n", "\t\t\t", "Psi4DataParseDipoles"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6941828818925333`*^9, 3.6941829205371113`*^9}, {
  3.694182952906665*^9, 3.6941829534472227`*^9}, {3.694182997465336*^9, 
  3.694183018691154*^9}, {3.694308231291733*^9, 
  3.6943082324823236`*^9}},ExpressionUUID->"59997c89-2f99-476a-99f8-\
e4ca9da8bcfa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CubeProperty\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693150389704082*^9, 
  3.693150393518331*^9}},ExpressionUUID->"00ba61d1-87a4-4b37-9609-\
6090c9e85131"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CubeProperty\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6930484666597958`*^9, 3.6930484683302383`*^9}, 
   3.693150403145474*^9, 
   3.69315087671947*^9},ExpressionUUID->"27e8f4e0-04f8-4d90-a298-\
fe94038bc707"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4CubeProperty", "]"}], "=", 
   RowBox[{"Append", "[", 
    RowBox[{"Options", "@", "Psi4ConfigureCall"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeProperty", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   
   RowBox[{"Psi4ConfigureCall", "@", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"<|", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"\"\<MoleculeOptions\>\"", "\[Rule]", "\n", "\t\t\t\t", 
           RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<MolTable\>\"", ",", "\"\<noreorient\>\"", ",", 
               "\"\<nocom\>\""}], "}"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{"a", ",", "\"\<MoleculeOptions\>\"", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
          ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Configuration\>\"", "->", "\n", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                 RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"<|", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<BasisSet\>\"", "\[Rule]", "\"\<cc-pvdz\>\""}], 
                 ",", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{"\"\<SCFType\>\"", "->", "\"\<df\>\""}], ",", "\n", 
                 "\t", "\t\t\t\t\t", 
                 RowBox[{
                 "\"\<CubePropTasks\>\"", "\[Rule]", "\"\<orbitals\>\""}], 
                 ",", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{"\"\<CubePropOrbitals\>\"", "\[Rule]", 
                  RowBox[{"{", "1", "}"}]}]}], "\n", "\t\t\t\t\t\t", "|>"}]}],
               "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", "First"}], 
            "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Function\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
           RowBox[{"<|", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"\"\<AssignTo\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", ",", "\"\<wfn\>\""}], "}"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"\"\<Call\>\"", "\[Rule]", "\"\<energy\>\""}], ",", "\n",
              "\t\t\t\t\t\t", 
             RowBox[{"\"\<Arguments\>\"", "\[Rule]", 
              RowBox[{"{", "\"\<scf\>\"", "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
             
             RowBox[{"\"\<KeyWordArguments\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<ReturnWavefunction\>\"", "\[Rule]", "True"}], 
               "}"}]}]}], "\n", "\t\t\t\t\t\t", "|>"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"\"\<Footer\>\"", "->", "\"\<cubeprop(wfn)\>\""}], ",", 
          "\n", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Lookup", "[", 
              RowBox[{"a", ",", "\"\<Grid\>\"", ",", "None"}], "]"}], "===", 
             "None"}], ",", "\n", "\t\t\t\t", "Nothing", ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"\"\<Input\>\"", "\[Rule]", "\n", "\t", "\t\t\t\t", 
             RowBox[{"Merge", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"a", "[", "\"\<Input\>\"", "]"}], ",", 
                 RowBox[{"<|", 
                  RowBox[{"\"\<grid.dat\>\"", "\[Rule]", 
                   RowBox[{"Psi4GridFile", "@", 
                    RowBox[{"a", "[", "\"\<Grid\>\"", "]"}]}]}], "|>"}]}], 
                "}"}], ",", "Last"}], "]"}]}]}], "\n", "\t", "\t\t\t", 
           "]"}]}], "\n", "\t\t\t", "|>"}], ",", "\n", "\t\t", "a", ",", "\n",
         "\t\t", 
        RowBox[{"<|", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"\"\<Header\>\"", "\[Rule]", 
           RowBox[{"\"\<#\>\"", "<>", 
            RowBox[{"DateString", "@", "Now"}], "<>", "\"\<\\n\>\"", "<>", 
            "\n", "\t\t\t\t", "\"\<#Cube prop call\>\""}]}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"\"\<Output\>\"", "\[Rule]", 
           RowBox[{"\"\<*.cube\>\"", "|", "\"\<*.xyz\>\""}]}]}], "\n", 
         "\t\t\t", "|>"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
      "First"}], "\n", "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeProperty", "[", 
    RowBox[{"r", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}], "|", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}]}], ")"}]}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4CubeProperty", "@", 
    RowBox[{"Association", "@", "r"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693086582814024*^9, 3.693086592568355*^9}, {
   3.693093032353001*^9, 3.693093153481297*^9}, {3.693093205636938*^9, 
   3.6930935160701447`*^9}, {3.693093554645804*^9, 3.693093570759224*^9}, 
   3.69309392043358*^9, {3.6930939654639893`*^9, 3.6930940362389307`*^9}, {
   3.6931085464823523`*^9, 3.693108549634598*^9}, {3.693117239296294*^9, 
   3.6931172484619493`*^9}, {3.693117279110229*^9, 3.693117284662683*^9}, {
   3.693150250795053*^9, 3.693150251959783*^9}, {3.693150405187478*^9, 
   3.693150444745162*^9}, {3.6931509860804167`*^9, 3.693150999686058*^9}, {
   3.6931543345210114`*^9, 3.6931543413522577`*^9}, {3.693154375180722*^9, 
   3.693154380370026*^9}, {3.693154413135024*^9, 3.6931544146270733`*^9}, {
   3.6931547108945427`*^9, 3.693154711066024*^9}, {3.699368866283684*^9, 
   3.699368869098822*^9}},ExpressionUUID->"43c3b271-2e0f-4a8f-8acc-\
14a2b7ed34c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CubeOrbitals\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6931379733688803`*^9, 3.69313799830441*^9}, {
  3.6931504867394657`*^9, 
  3.693150488441791*^9}},ExpressionUUID->"dd99e600-5f80-49f5-b0a3-\
5dc194ab79ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Psi4CubeOrbitals", "]"}], "=", 
   RowBox[{"Options", "@", "Psi4CubeProperty"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeOrbitals", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   
   RowBox[{"Psi4CubeProperty", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"a", ",", "\n", "\t", "\t\t\t", 
          RowBox[{"\"\<Configuration\>\"", "->", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                 RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"<|", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<CubePropTasks\>\"", "\[Rule]", 
                  RowBox[{"{", "\"\<orbitals\>\"", "}"}]}], ",", "\n", "\t", 
                 "\t", "\t", "\t\t\t\t", 
                 RowBox[{"\"\<CubePropOrbitals\>\"", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "2", ",", 
                    RowBox[{"-", "2"}], ",", "3", ",", 
                    RowBox[{"-", "3"}], ",", "4", ",", 
                    RowBox[{"-", "4"}], ",", "5", ",", 
                    RowBox[{"-", "5"}]}], "}"}]}]}], "\n", "\t", 
                "\t\t\t\t\t\t", "|>"}]}], "\n", "\t", "\t\t\t\t\t", "}"}], 
             ",", "\n", "\t\t\t\t\t\t", "First"}], "]"}]}]}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"\"\<Output\>\"", "\[Rule]", "\"\<Psi_*.cube\>\""}]}], "\n", 
       "\t\t\t", "}"}], ",", "\n", "\t\t\t", "First"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeOrbitals", "[", 
    RowBox[{"atomList_List", ",", 
     RowBox[{"orbitals", ":", 
      RowBox[{"{", "__Integer", "}"}], ":", 
      RowBox[{"{", "1", "}"}]}], ",", 
     RowBox[{"p", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "..."}]}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Psi4CubeOrbitals", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", "atomList"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"\"\<CubePropOrbitals\>\"", "\[Rule]", "orbitals"}], ",", "\n", 
      "\t\t\t", "p"}], "\n", "\t\t\t", "|>"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Psi4CubeOrbitals", "[", 
   RowBox[{"atomList_List", ",", "orbitals_Integer", ",", 
    RowBox[{"p", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "..."}]}]}], "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Psi4CubeOrbitals", "[", 
   RowBox[{"atomList", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"#", ",", 
        RowBox[{"-", "#"}]}], "]"}], "&"}], "@", 
     RowBox[{"Range", "[", "orbitals", "]"}]}]}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.693150493835544*^9, 3.693150776432743*^9}, {
  3.6931544945051928`*^9, 3.693154504723358*^9}, {3.6931545755891953`*^9, 
  3.693154597322904*^9}, {3.693169294303996*^9, 3.693169304063504*^9}, {
  3.6931775545622187`*^9, 
  3.69317757934454*^9}},ExpressionUUID->"18a6232d-1276-46b8-be41-8ce66389e122"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CubeElectronDensity\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69315078539983*^9, 
  3.69315079280731*^9}},ExpressionUUID->"40b32647-2e56-4967-95f2-\
341a6285447a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeElectronDensity", "[", "a_Association", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Psi4CubeProperty", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"a", ",", "\n", "\t", "\t\t\t", 
          RowBox[{"\"\<Configuration\>\"", "->", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lookup", "[", 
                RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
                 RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"<|", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<CubePropTasks\>\"", "\[Rule]", 
                  RowBox[{"{", "\"\<density\>\"", "}"}]}], ",", "\n", "\t", 
                 "\t", "\t", "\t\t\t\t", 
                 RowBox[{"\"\<CubePropOrbitals\>\"", "\[Rule]", 
                  RowBox[{"{", "1", "}"}]}]}], "\n", "\t", "\t\t\t\t\t\t", 
                "|>"}]}], "\n", "\t", "\t\t\t\t\t", "}"}], ",", "\n", 
             "\t\t\t\t\t\t", "First"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"\"\<Output\>\"", "\[Rule]", 
         RowBox[{
         "\"\<Dt.cube\>\"", "|", "\"\<Ds.cube\>\"", "|", "\"\<Da.cube\>\"", 
          "|", "\"\<Db.cube\>\""}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
      "\t\t\t", "First"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeElectronDensity", "[", 
    RowBox[{"atomList_List", ",", "p___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4CubeElectronDensity", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", "atomList"}], ",", "\n", 
      "\t\t\t", "p"}], "\n", "\t\t\t", "|>"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6931507976992207`*^9, 3.6931507977008867`*^9}, {
  3.693150882908593*^9, 3.693150883388113*^9}, {3.693151373270046*^9, 
  3.69315146440348*^9}, {3.693154424426433*^9, 3.6931544852388363`*^9}, {
  3.693154610947569*^9, 3.693154642449456*^9}, {3.693177539881946*^9, 
  3.693177543536954*^9}},ExpressionUUID->"ffd77a87-03ec-4535-b30b-\
a346233a4b60"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CubeElectrostaticPotential\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693150803738369*^9, 
  3.693150805671248*^9}},ExpressionUUID->"10f7e0ea-7987-4010-97e1-\
c5e65f27a594"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeElectrostaticPotential", "[", "a_Association", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Psi4CubeProperty", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"\"\<Configuration\>\"", "->", "\n", "\t\t\t\t", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Lookup", "[", 
              RowBox[{"a", ",", "\"\<Configuration\>\"", ",", 
               RowBox[{"<|", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"<|", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"\"\<CubePropTasks\>\"", "\[Rule]", 
                RowBox[{"{", "\"\<esp\>\"", "}"}]}], ",", "\n", "\t", "\t", 
               "\t", "\t\t\t\t", 
               RowBox[{"\"\<CubePropOrbitals\>\"", "\[Rule]", 
                RowBox[{"{", "1", "}"}]}], ",", "\n", "\t", "\t", "\t", 
               "\t\t\t\t", 
               RowBox[{
               "\"\<DFTSelfConsistentBasisSet\>\"", "->", 
                "\"\<cc-pvdz-jkfit\>\""}], ",", "\n", "\t", "\t", "\t", 
               "\t\t\t\t", 
               RowBox[{"\"\<FreezeCore\>\"", "\[Rule]", "True"}]}], "\n", 
              "\t", "\t\t\t\t\t\t", "|>"}]}], "\n", "\t", "\t\t\t\t\t", "}"}],
            ",", "\n", "\t\t\t\t\t", "First"}], "\n", "\t\t\t\t\t", "]"}]}], 
        ",", "\n", "\t\t\t\t", "a", ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<Output\>\"", "\[Rule]", 
         RowBox[{"\"\<Dt.cube\>\"", "|", "\"\<ESP.cube\>\""}]}]}], "\n", 
       "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", "First"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4CubeElectrostaticPotential", "[", 
    RowBox[{"atomList_List", ",", "p___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Psi4CubeElectrostaticPotential", "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<Molecules\>\"", "\[Rule]", "atomList"}], ",", "\n", 
      "\t\t\t", "p"}], "\n", "\t\t\t", "|>"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693150888793305*^9, 3.693150939595825*^9}, {
  3.693150992852543*^9, 3.693151003595791*^9}, {3.693151073907166*^9, 
  3.6931510765681067`*^9}, {3.693151310967362*^9, 3.69315136367519*^9}, {
  3.693154517211398*^9, 3.69315452931078*^9}, {3.6931546532936907`*^9, 
  3.6931546831117*^9}, {3.693177591136073*^9, 3.693177594719298*^9}, {
  3.710179204035283*^9, 
  3.710179209776005*^9}},ExpressionUUID->"3b7ac61c-4055-467c-9ba4-\
03e71295bb26"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Import and manipulations\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692978168778529*^9, 
  3.692978184664754*^9}},ExpressionUUID->"701b4dc1-9bf9-45c4-a296-\
26eef9554807"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ParseGeometry\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69310873545693*^9, 3.693108743607357*^9}, {
  3.711819244429182*^9, 
  3.711819250562024*^9}},ExpressionUUID->"b745b4bf-36eb-4960-9ae0-\
5617aad4ba18"],

Cell[CellGroupData[{

Cell["Mol Layouts", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7118192091891747`*^9, 
  3.711819228330616*^9}},ExpressionUUID->"f9b7eeed-0fef-4007-8d1e-\
1d2ca8b05e3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zmatrix1", "=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{"Whitespace", "~~", 
     RowBox[{"LetterCharacter", ".."}], "~~", 
     RowBox[{"(", 
      RowBox[{"Whitespace", "|", "EndOfLine"}], ")"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zmatrix2", "=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{"Whitespace", "~~", 
     RowBox[{"LetterCharacter", ".."}], "~~", "Whitespace", "~~", "\n", 
     "\t\t", 
     RowBox[{"(", 
      RowBox[{"DigitCharacter", ".."}], ")"}], "~~", "Whitespace", "~~", 
     "NumberString", "~~", 
     RowBox[{"(", 
      RowBox[{"Whitespace", "|", "EndOfLine"}], ")"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zmatrix3", "=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{"Whitespace", "~~", 
     RowBox[{"LetterCharacter", ".."}], "~~", "Whitespace", "~~", "\n", 
     "\t\t", 
     RowBox[{"(", 
      RowBox[{"DigitCharacter", ".."}], ")"}], "~~", "Whitespace", "~~", 
     "NumberString", "~~", "Whitespace", "~~", "\n", "\t\t", 
     RowBox[{"(", 
      RowBox[{"DigitCharacter", ".."}], ")"}], "~~", "Whitespace", "~~", 
     "NumberString", "~~", 
     RowBox[{"(", 
      RowBox[{"Whitespace", "|", "EndOfLine"}], ")"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zmatrix4", "=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{"Whitespace", "~~", 
     RowBox[{"LetterCharacter", ".."}], "~~", "Whitespace", "~~", "\n", 
     "\t\t", 
     RowBox[{"(", 
      RowBox[{"DigitCharacter", ".."}], ")"}], "~~", "Whitespace", "~~", 
     "NumberString", "~~", "Whitespace", "~~", "\n", "\t\t", 
     RowBox[{"(", 
      RowBox[{"DigitCharacter", ".."}], ")"}], "~~", "Whitespace", "~~", 
     "NumberString", "~~", "Whitespace", "~~", "\n", "\t\t", 
     RowBox[{"(", 
      RowBox[{"DigitCharacter", ".."}], ")"}], "~~", "Whitespace", "~~", 
     "NumberString", "~~", 
     RowBox[{"(", 
      RowBox[{"Whitespace", "|", "EndOfLine"}], ")"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"molTable", "=", "\n", "\t", 
   RowBox[{"Whitespace", "~~", 
    RowBox[{"LetterCharacter", ".."}], "~~", "\n", "\t\t", "Whitespace", "~~",
     "NumberString", "~~", "\n", "\t\t", "Whitespace", "~~", "NumberString", "~~",
     "\n", "\t\t", "Whitespace", "~~", "NumberString"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692969417757328*^9, 3.692969423191565*^9}, {
   3.692969460587884*^9, 3.692969547951334*^9}, {3.692969822104176*^9, 
   3.692969959696897*^9}, {3.692969998891737*^9, 3.692970260550481*^9}, {
   3.692970571630241*^9, 3.692970572211853*^9}, {3.692971138529858*^9, 
   3.692971140984559*^9}, {3.692971182345237*^9, 3.692971319978126*^9}, {
   3.692971358834344*^9, 3.6929714231499777`*^9}, {3.694182826611768*^9, 
   3.694182830111547*^9}, {3.694307986185626*^9, 3.694308021146285*^9}, {
   3.6943083458631353`*^9, 3.6943083654365*^9}, {3.69430841033885*^9, 
   3.694308410970708*^9}, {3.694310379411541*^9, 3.6943103803864717`*^9}, 
   3.694310440641942*^9, {3.694352311973194*^9, 
   3.69435231447563*^9}},ExpressionUUID->"ea9f1cb5-d64e-4f6a-baac-\
f03b0e4d16a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi4GeomTableHeader", "=", "\n", "\t", 
   RowBox[{"StringExpression", "@@", "\n", "\t\t", 
    RowBox[{"Riffle", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
       "StartOfLine", ",", "\n", "\t", "\t\t", "\"\<Center\>\"", ",", 
        "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<Mass\>\"", 
        ",", "\"\<\\n\>\"", ",", "\n", "\t", "\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"Repeated", "[", "\"\<-\>\"", "]"}], ",", "4"}], "]"}]}], 
        ",", "\n", "\t", "\t\t", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Repeated", "[", "\"\<-\>\"", "]"}], "~~", "\"\<\\n\>\""}], 
         ")"}]}], "\n", "\t", "\t\t", "}"}], ",", "\n", "\t\t\t", 
      "Whitespace"}], "\n", "\t\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{"psi4GeomTableBody", "=", "\n", "\t", 
  RowBox[{"Repeated", "[", "\n", "\t\t", 
   RowBox[{"StringExpression", "@@", "\n", "\t\t\t", 
    RowBox[{"Riffle", "[", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t\t", 
       RowBox[{"\"\<\>\"", ",", 
        RowBox[{"WordCharacter", ".."}], ",", "\n", "\t", "\t\t\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"NumberString", ",", "3"}], "]"}]}], ",", "\n", 
        "\t\t\t\t\t", 
        RowBox[{"NumberString", "~~", "\"\<\\n\>\""}]}], "\n", "\t\t\t\t\t", 
       "}"}], ",", "\n", "\t\t\t\t", "Whitespace"}], "\n", "\t\t\t\t", 
     "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.715180350271537*^9, 3.715180366512258*^9}, {
   3.7151804593857527`*^9, 3.7151808090786552`*^9}, 3.7151811933632*^9, {
   3.715181238733152*^9, 
   3.715181376337998*^9}},ExpressionUUID->"9300eaa8-74b0-4b76-8b5f-\
2696360184c0"]
}, Closed]],

Cell[CellGroupData[{

Cell["parsePointGroup", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7118192091891747`*^9, 3.7118192133549967`*^9}, {
  3.711823958104725*^9, 3.711823960694686*^9}, {3.71182399099254*^9, 
  3.711823991173553*^9}},ExpressionUUID->"996a3332-76ba-4cbc-942b-\
3ddd86fcebc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$pointGroupList", "=", "\n", "\t", 
   RowBox[{"<|", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<c1\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "1"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<c2\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "3"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c2h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "5"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<c2v\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "7"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c3\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "16"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<c3h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "22"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c3v\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "19"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<c4\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "9"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c4h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "11"}], "}"}], 
       "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<c4v\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "13"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<c5\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CyclicGroup\>\"", ",", "5"}], "}"}], "}"}]}], ",", 
     RowBox[{"\"\<c5h\>\"", "\[Rule]", "\"\<C5h\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c5v\>\"", "\[Rule]", "\"\<C5v\>\""}], ",", 
     RowBox[{"\"\<c6\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "21"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c6h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "23"}], "}"}], 
       "}"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<c6v\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "25"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<c7\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CyclicGroup\>\"", ",", "7"}], "}"}], "}"}]}], ",", 
     RowBox[{"\"\<c7v\>\"", "\[Rule]", "\"\<C7v\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c8\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CyclicGroup\>\"", ",", "8"}], "}"}], "}"}]}], ",", 
     RowBox[{"\"\<c8v\>\"", "\[Rule]", "\"\<C8v\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<ci\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "2"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<cs\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "4"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<c\[Infinity]v\>\"", "\[Rule]", "\"\<C\[Infinity]v\>\""}], 
     ",", 
     RowBox[{"\"\<d2\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "6"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d2d\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "14"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<d2h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "8"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d3\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "18"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<d3d\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "20"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d3h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "26"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<d4\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "12"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d4d\>\"", "\[Rule]", "\"\<D4d\>\""}], ",", 
     RowBox[{"\"\<d4h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "15"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d5\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<DihedralGroup\>\"", ",", "5"}], "}"}], "}"}]}], ",", 
     RowBox[{"\"\<d5d\>\"", "\[Rule]", "\"\<D5d\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d5h\>\"", "\[Rule]", "\"\<D5h\>\""}], ",", 
     RowBox[{"\"\<d6\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "24"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d6d\>\"", "\[Rule]", "\"\<D6d\>\""}], ",", 
     RowBox[{"\"\<d6h\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "27"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d7\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<DihedralGroup\>\"", ",", "7"}], "}"}], "}"}]}], ",", 
     RowBox[{"\"\<d7d\>\"", "\[Rule]", "\"\<D7d\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d7h\>\"", "\[Rule]", "\"\<D7h\>\""}], ",", 
     RowBox[{"\"\<d8\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<DihedralGroup\>\"", ",", "8"}], "}"}], "}"}]}], ",", 
     "\n", "\t", "\t", 
     RowBox[{"\"\<d8d\>\"", "\[Rule]", "\"\<D8d\>\""}], ",", 
     RowBox[{"\"\<d8h\>\"", "\[Rule]", "\"\<D8h\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<d\[Infinity]h\>\"", "\[Rule]", "\"\<D\[Infinity]h\>\""}], 
     ",", 
     RowBox[{"\"\<i\>\"", "\[Rule]", "\"\<I\>\""}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<ih\>\"", "\[Rule]", 
      RowBox[{"{", "\"\<Icosahedral\>\"", "}"}]}], ",", 
     RowBox[{"\"\<o\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "30"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<oh\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "32"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<s10\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<SymmetricGroup\>\"", ",", "10"}], "}"}], "}"}]}], ",", 
     "\n", "\t", "\t", 
     RowBox[{"\"\<s12\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<SymmetricGroup\>\"", ",", "12"}], "}"}], "}"}]}], ",", 
     RowBox[{"\"\<s2\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<SymmetricGroup\>\"", ",", "2"}], "}"}], "}"}]}], ",", 
     "\n", "\t", "\t", 
     RowBox[{"\"\<s4\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "10"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<s6\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "17"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<s8\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<SymmetricGroup\>\"", ",", "8"}], "}"}], "}"}]}], ",", 
     RowBox[{"\"\<t\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "28"}], "}"}], 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"\"\<td\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "31"}], "}"}], 
       "}"}]}], ",", 
     RowBox[{"\"\<th\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<CrystallographicPointGroup\>\"", ",", "29"}], "}"}], 
       "}"}]}]}], "\n", "\t\t", "|>"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{
  3.711823710767709*^9, {3.711823744361362*^9, 
   3.711823795176692*^9}},ExpressionUUID->"f6573aea-8928-4abd-83fc-\
ca9872e0e6f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parsePointGroup", "[", "grp_", "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", "=", "\n", "\t\t", 
      RowBox[{"ToLowerCase", "@", "\n", "\t\t\t", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"grp", ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{"\"\<_inf_\>\"", "\[Rule]", "\"\<\[Infinity]\>\""}], "\n", 
          "\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"Replace", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Lookup", "[", "\n", "\t\t\t\t", 
       RowBox[{"$pointGroupList", ",", "\n", "\t", "\t\t\t", 
        RowBox[{"ToLowerCase", "@", "s"}], ",", "\n", "\t", "\t", "\t\t", 
        RowBox[{
         RowBox[{"ToUpperCase", "[", 
          RowBox[{"StringTake", "[", 
           RowBox[{"s", ",", "1"}], "]"}], "]"}], "<>", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"s", ",", "1"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "l_", "}"}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"Entity", "[", 
        RowBox[{"\"\<FiniteGroup\>\"", ",", "l"}], "]"}]}]}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.711821109172121*^9, 3.711821112172233*^9}, {
  3.711822219560375*^9, 3.711822250720971*^9}, {3.7118222912649307`*^9, 
  3.7118223077686872`*^9}, {3.711822628066742*^9, 3.711822679198332*^9}, {
  3.711823811327232*^9, 
  3.7118238291190147`*^9}},ExpressionUUID->"d742c2ec-a50b-43b0-ba75-\
79ddf3b85890"]
}, Closed]],

Cell[CellGroupData[{

Cell["parseUnit", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7118192091891747`*^9, 3.7118192133549967`*^9}, {
  3.7118239655440407`*^9, 
  3.71182396639884*^9}},ExpressionUUID->"ddf4ef7a-850a-40da-af7b-\
5a64f4b7bd1b"],

Cell[BoxData[
 RowBox[{"$parseUnitList", "=", "\n", "\t", 
  RowBox[{"{", "\n", "\t\t", 
   RowBox[{
    RowBox[{"\"\<a.u.\>\"", "\[Rule]", "\"\<AtomicUnitOfForce\>\""}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<cm^-1\>\"", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"1", "/", "\"\<Centimeters\>\""}], ")"}]}]}], "\n", "\t\t", 
   "}"}]}]], "CodeInput",
 CellChangeTimes->{{3.711820931509891*^9, 
  3.711820940751837*^9}},ExpressionUUID->"4df86550-af9e-405a-a4da-\
ace5d05d5eed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseUnit", "[", 
   RowBox[{"u_", ",", 
    RowBox[{"reps_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Quantity", "@", "\n", "\t\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"StringTrim", "[", 
      RowBox[{"u", ",", 
       RowBox[{
       "\"\<]\>\"", "|", "\"\<[\>\"", "|", "\"\<)\>\"", "|", "\"\<(\>\""}]}], 
      "]"}], ",", "\n", "\t\t\t", 
     RowBox[{"Flatten", "@", 
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{"reps", ",", "\n", "\t\t\t\t", "$parseUnitList"}], "\n", 
       "\t\t\t\t", "}"}]}]}], "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.711820780511435*^9, 
  3.71182094297887*^9}},ExpressionUUID->"634d2c0f-d72d-4746-bac3-a8a11a196306"]
}, Closed]],

Cell[CellGroupData[{

Cell["parseProp", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7118192091891747`*^9, 
  3.7118192133549967`*^9}},ExpressionUUID->"9435b29c-2dcd-44ad-973c-\
ff3a9fe116c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"propLinePattern", "=", "\n", "\t", 
   RowBox[{"Whitespace", "~~", "\n", "\t\t", 
    RowBox[{"(", "\n", "\t\t\t", 
     RowBox[{
     "\"\<Molecular point group\>\"", "|", "\n", "\t\t\t", 
      "\"\<Full point group\>\"", "|", "\n", "\t\t\t", 
      "\"\<Rotational constants\>\"", "|", "\n", "\t\t\t", 
      "\"\<Nuclear repulsion\>\"", "|", "\n", "\t\t\t", "\"\<Charge\>\"", 
      "|", "\"\<Multiplicity\>\"", "|", "\"\<Electrons\>\"", "|", "\n", 
      "\t\t\t", "\"\<Nalpha\>\"", "|", "\"\<Nbeta\>\"", "|", "\n", "\t\t\t", 
      "\"\<Nuclear Repulsion Energy\>\"", "|", "\"\<One-Electron Energy\>\"", 
      "|", "\n", "\t\t\t", "\"\<Two-Electron Energy\>\"", "|", 
      RowBox[{"(", 
       RowBox[{
       "\"\<Total Energy\>\"", "~~", "Whitespace", "~~", "\"\<=\>\""}], ")"}],
       "|", "\n", "\t\t\t", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<Nuclear\>\"", "|", "\"\<Electronic\>\""}], ")"}], "~~", 
        "\"\< Dipole Moment:\>\"", "~~", 
        RowBox[{
         RowBox[{"Except", "[", "\"\<\\n\>\"", "]"}], ".."}], "~~", 
        "\"\<\\n\>\""}], ")"}], "|", "\n", "\t\t\t", 
      "\"\<Setting geometry variable \>\""}], "\n", "\t\t\t", ")"}], "~~", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Except", "[", "\"\<\\n\>\"", "]"}], ".."}], ")"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.692969417757328*^9, 3.692969423191565*^9}, {
   3.692969460587884*^9, 3.692969547951334*^9}, {3.692969822104176*^9, 
   3.692969959696897*^9}, {3.692969998891737*^9, 3.692970260550481*^9}, {
   3.692970571630241*^9, 3.692970572211853*^9}, {3.692971138529858*^9, 
   3.692971140984559*^9}, {3.692971182345237*^9, 3.692971319978126*^9}, {
   3.692971358834344*^9, 3.6929714231499777`*^9}, {3.694182826611768*^9, 
   3.694182830111547*^9}, {3.694307986185626*^9, 3.694308021146285*^9}, {
   3.6943083458631353`*^9, 3.6943083654365*^9}, {3.69430841033885*^9, 
   3.694308410970708*^9}, {3.694310379411541*^9, 3.6943103803864717`*^9}, 
   3.694310440641942*^9, {3.694352311973194*^9, 3.69435231447563*^9}, {
   3.711071020624634*^9, 3.711071057606222*^9}, {3.711071460855699*^9, 
   3.7110714657500267`*^9}, {3.711820240223238*^9, 3.711820263737523*^9}, {
   3.7118202937474937`*^9, 3.71182036599468*^9}, {3.711821040320779*^9, 
   3.711821066485705*^9}, {3.7151800073998957`*^9, 3.7151800240240793`*^9}, {
   3.7151801835206833`*^9, 
   3.715180183774723*^9}},ExpressionUUID->"e2f8be42-a68a-4b7f-90f3-\
513236243986"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parseProp", "[", "s_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Which", "[", "\n", "\t\t", 
   RowBox[{"(*", " ", 
    RowBox[{"Point", " ", "Groups"}], " ", "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"s", ",", "\"\<point group:\>\""}], "]"}], ",", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTrim", "@", 
       RowBox[{"First", "@", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"s", ",", "\"\<point group:\>\""}], "]"}]}]}], "<>", "\n", 
      "\t\t\t\t", "\"\<PointGroup\>\""}], "->", "\n", "\t\t\t\t\t", 
     RowBox[{"parsePointGroup", "@", "\n", "\t\t\t\t\t\t", 
      RowBox[{"First", "@", 
       RowBox[{"StringCases", "[", 
        RowBox[{"s", ",", 
         RowBox[{
          RowBox[{"\"\<: \>\"", "~~", 
           RowBox[{"p", ":", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Except", "[", "WhitespaceCharacter", "]"}], ".."}], 
             ")"}]}]}], "\[RuleDelayed]", "p"}]}], "]"}]}]}]}], ",", "\n", 
    "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Rotational", " ", "Constants"}], " ", "*)"}], "\n", "\t\t", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"s", ",", "\"\<Rotational constants\>\""}], "]"}], ",", "\n", 
    "\t\t\t", 
    RowBox[{"\"\<RotationalConstants\>\"", "->", "\n", "\t\t\t\t", 
     RowBox[{"Association", "@", 
      RowBox[{"Cases", "[", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"s", ",", 
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"l_", "~~", "\"\< =\>\"", "~~", "Whitespace", "~~", 
              RowBox[{"v", ":", "NumberString"}]}], "\[RuleDelayed]", "\n", 
             "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"l", "->", 
              RowBox[{"ToExpression", "@", "v"}]}]}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"\"\<[\>\"", "~~", 
              RowBox[{"u", ":", 
               RowBox[{
                RowBox[{"Except", "[", "\"\<]\>\"", "]"}], ".."}]}], "~~", 
              "\"\<]\>\""}], "\[RuleDelayed]", "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"\"\<Units\>\"", "->", 
              RowBox[{"parseUnit", "[", "u", "]"}]}]}]}], "\n", 
           "\t\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t", "_Rule"}],
        "]"}]}]}], ",", "\n", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Nuclear", " ", "Repulsion"}], " ", "*)"}], "\n", "\t\t", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"s", ",", "\"\<Nuclear repulsion\>\""}], "]"}], ",", "\n", 
    "\t\t\t", 
    RowBox[{"\"\<NuclearRepulsion\>\"", "->", "\n", "\t\t\t\t", 
     RowBox[{"First", "@", 
      RowBox[{"StringCases", "[", 
       RowBox[{"s", ",", "NumberString"}], "]"}]}]}], ",", "\n", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Charge", ",", " ", "Multiplicity", ",", " ", "Electrons", ",", " ", 
      "N_alpha", ",", " ", "N_beta"}], " ", "*)"}], "\n", "\t\t", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"s", ",", 
      RowBox[{
      "\"\<Charge\>\"", "|", "\"\<Multiplicity\>\"", "|", "\"\<Electrons\>\"",
        "|", "\"\<Nalpha\>\"", "|", "\"\<Nbeta\>\""}]}], "]"}], ",", "\n", 
    "\t\t\t\t", 
    RowBox[{"First", "@", "\n", "\t\t\t\t\t", 
     RowBox[{"StringCases", "[", 
      RowBox[{"s", ",", "\n", "\t\t\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"l", ":", 
          RowBox[{"(", 
           RowBox[{"LetterCharacter", ".."}], ")"}]}], "~~", "Whitespace", 
         "~~", "\"\<= \>\"", "~~", 
         RowBox[{"n", ":", "NumberString"}]}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"l", "->", "n"}], ")"}]}]}], "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"(*", " ", "Energies", " ", "*)"}], "\n", "\t\t", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"s", ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
       "\"\<Nuclear Repulsion Energy\>\"", "|", "\"\<One-Electron Energy\>\"",
         "|", "\n", "\t\t\t", "\"\<Two-Electron Energy\>\"", "|", 
        "\"\<Total Energy\>\""}], "~~", "Whitespace", "~~", "\"\<=\>\""}]}], 
     "\n", "\t\t\t", "]"}], ",", "\n", "\t\t\t", 
    RowBox[{"First", "@", "\n", "\t\t\t\t", 
     RowBox[{"StringCases", "[", 
      RowBox[{"s", ",", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"l", ":", "__"}], "~~", "\"\<= \>\"", "~~", "Whitespace", "~~", 
         RowBox[{"n", ":", "NumberString"}]}], "\[RuleDelayed]", "\n", 
        "\t\t\t\t\t", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{"l", ",", 
            RowBox[{
             RowBox[{"Except", "[", "WordCharacter", "]"}], "\[Rule]", 
             "\"\<\>\""}]}], "]"}], "\[Rule]", 
          RowBox[{"ToExpression", "[", "n", "]"}]}], ")"}]}]}], "\n", 
      "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Dipole", " ", "Moments"}], " ", "*)"}], "\n", "\t\t", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"s", ",", "\"\<Dipole Moment\>\""}], "]"}], ",", "\n", "\t\t\t", 
    
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bits", "=", 
        RowBox[{"StringTrim", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"s", ",", " ", 
           RowBox[{
           "\"\<Dipole Moment:\>\"", "|", "\"\<X:\>\"", "|", "\"\<Y:\>\"", 
            "|", "\"\<Z:\>\""}]}], "]"}]}]}], "}"}], ",", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"bits", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<DipoleMoment\>\""}], "->",
        "\n", "\t\t\t\t\t", 
       RowBox[{"Append", "[", "\n", "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], 
           ",", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"ToExpression", "@", 
            RowBox[{"bits", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4", ",", "5"}], "}"}], "]"}], "]"}]}]}], 
          "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"\"\<Unit\>\"", "->", 
          RowBox[{"parseUnit", "@", 
           RowBox[{"bits", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\n", "\t\t\t\t\t\t", 
        "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Scan", " ", "variables"}], " ", "*)"}], "\n", "\t\t", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"s", ",", "\"\<Setting geometry variable \>\""}], "]"}], ",", 
    "\n", "\t\t\t", 
    RowBox[{"StringCases", "[", 
     RowBox[{"s", ",", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Setting geometry variable \>\"", "~~", 
        RowBox[{"var", ":", 
         RowBox[{
          RowBox[{"Except", "[", "WhitespaceCharacter", "]"}], ".."}]}], 
        "~~", "\"\< to \>\"", "~~", "\n", "\t\t\t\t\t", 
        RowBox[{"val", ":", 
         RowBox[{
          RowBox[{"Except", "[", "WhitespaceCharacter", "]"}], ".."}]}]}], ":>",
        "\n", "\t\t\t\t\t", 
       RowBox[{"\"\<ScanVariable\>\"", "->", "\n", "\t\t\t\t\t\t", 
        RowBox[{"(", 
         RowBox[{"var", "\[Rule]", 
          RowBox[{"ToExpression", "[", "val", "]"}]}], ")"}]}]}]}], "\n", 
     "\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.692969417757328*^9, 3.692969423191565*^9}, {
   3.692969460587884*^9, 3.692969547951334*^9}, {3.692969822104176*^9, 
   3.692969959696897*^9}, {3.692969998891737*^9, 3.692970260550481*^9}, {
   3.692970571630241*^9, 3.692970572211853*^9}, {3.692971138529858*^9, 
   3.692971140984559*^9}, {3.692971182345237*^9, 3.692971319978126*^9}, {
   3.692971358834344*^9, 3.6929714231499777`*^9}, {3.694182826611768*^9, 
   3.694182830111547*^9}, {3.694307986185626*^9, 3.694308021146285*^9}, {
   3.6943083458631353`*^9, 3.6943083654365*^9}, {3.69430841033885*^9, 
   3.694308410970708*^9}, {3.694310379411541*^9, 3.6943103803864717`*^9}, 
   3.694310440641942*^9, 3.694352311973194*^9, {3.711070709857748*^9, 
   3.7110707216806087`*^9}, {3.711070891575719*^9, 3.711070915276741*^9}, {
   3.711071152707718*^9, 3.711071173340886*^9}, {3.711071206142624*^9, 
   3.711071356717642*^9}, {3.711071402058091*^9, 3.711071441785407*^9}, {
   3.711071472493932*^9, 3.711071482137271*^9}, 3.7118192033841133`*^9, {
   3.711820111353006*^9, 3.711820125902718*^9}, {3.711820374513332*^9, 
   3.711820513910902*^9}, {3.711820617146096*^9, 3.711820649801985*^9}, {
   3.7118209079031277`*^9, 3.711820909610015*^9}, {3.7118209506208572`*^9, 
   3.711821022754972*^9}, {3.711823847327703*^9, 3.711823909936017*^9}, {
   3.711823976819109*^9, 3.711823978324067*^9}, {3.715180035246862*^9, 
   3.715180124785329*^9}},ExpressionUUID->"791609fe-cff9-45fc-a595-\
31ced680ce38"]
}, Closed]],

Cell[CellGroupData[{

Cell["Block Delimiters", "CodeSubsubsubsection",
 CellChangeTimes->{{3.711819785388056*^9, 
  3.711819789185717*^9}},ExpressionUUID->"04b7a65d-6867-42dd-871e-\
cc8ca0a396e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"blockDelimeters", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\"\<*** tstart()\>\"", "~~", 
      RowBox[{
       RowBox[{"Except", "[", "\"\<\\n\>\"", "]"}], ".."}]}], ")"}], "|", 
    RowBox[{"(", 
     RowBox[{"\"\<*** tstop()\>\"", "~~", 
      RowBox[{
       RowBox[{"Except", "[", "\"\<\\n\>\"", "]"}], ".."}]}], ")"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.711819792115281*^9, 3.71181981346271*^9}, {
  3.711819877878805*^9, 3.7118198823969307`*^9}, {3.715200808578765*^9, 
  3.715200827409397*^9}},ExpressionUUID->"ee367600-81fb-4d22-926b-\
544acbda53eb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Psi4DataParseGeometry", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7118192091891747`*^9, 
  3.7118192399550667`*^9}},ExpressionUUID->"4478753f-9242-4682-afdd-\
94a7e5b7d25b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psi4DataParseGeometry", "[", "os_", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"atomCount", "=", "\n", "\t\t\t", 
       RowBox[{"Length", "@", 
        RowBox[{"Select", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"StringSplit", "[", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"StringCases", "[", 
              RowBox[{"os", ",", 
               RowBox[{"\"\<molecule\>\"", "~~", 
                RowBox[{
                 RowBox[{"Except", "[", "\"\<}\>\"", "]"}], ".."}], "~~", 
                "\"\<}\>\""}]}], "]"}]}], ",", "\"\<\\n\>\""}], "]"}], ",", 
          "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "NumberString"}], "]"}], "||", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"ChemDataAtomQ", "@", 
             RowBox[{"StringTrim", "@", "#"}]}]}], "&"}]}], "\n", "\t", 
         "\t\t\t", "]"}]}]}], "\n", "\t", "\t", "}"}], ",", "\n", "\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"blockMolTable", "=", "None"}], ",", "\n", "\t\t", 
         RowBox[{"blockZMatrix", "=", "None"}], ",", "\n", "\t\t", 
         RowBox[{"blockGeomTable", "=", "None"}], ",", "\n", "\t\t", 
         RowBox[{"blockProps", "=", 
          RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
         RowBox[{"blockMeta", "=", 
          RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
         RowBox[{"blockCache", "=", 
          RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
         RowBox[{"cacheBlockData", "=", 
          RowBox[{
           RowBox[{"(", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"AppendTo", "[", "\n", "\t\t\t\t", 
              RowBox[{"blockCache", ",", "\n", "\t\t\t\t", 
               RowBox[{"<|", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<ZMatrix\>\"", "\[Rule]", "blockZMatrix"}], ",", 
                 "\n", "\t\t\t\t\t", 
                 RowBox[{"\"\<MolTable\>\"", "\[Rule]", "blockMolTable"}], 
                 ",", "\n", "\t\t\t\t\t", 
                 RowBox[{
                 "\"\<GeometryTable\>\"", "\[Rule]", "blockGeomTable"}], ",", 
                 "\n", "\t\t\t\t\t", 
                 RowBox[{"\"\<Properties\>\"", "\[Rule]", "blockProps"}], ",",
                  "\n", "\t\t\t\t\t", 
                 RowBox[{"\"\<MetaInfo\>\"", "->", "blockMeta"}]}], "\n", 
                "\t\t\t\t\t", "|>"}]}], "]"}], ";", "\n", "\t\t\t\t", 
             RowBox[{"blockProps", "=", 
              RowBox[{"{", "}"}]}], ";", "\n", "\t\t\t\t", 
             RowBox[{"blockMeta", "=", 
              RowBox[{"{", "}"}]}], ";", "\n", "\t\t\t\t", 
             RowBox[{"blockZMatrix", "=", "None"}], ";", "\n", "\t\t\t\t", 
             RowBox[{"blockMolTable", "=", "None"}], ";", "\n", "\t\t\t\t", 
             RowBox[{"blockGeomTable", "=", "None"}], ";"}], "\n", "\t\t\t\t",
             ")"}], "&"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"Replace", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{"os", ",", 
            RowBox[{"{", "\n", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{"Extract", " ", "GeomTable"}], " ", "*)"}], "\n", 
             "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"psi4GeomTableHeader", "~~", 
                RowBox[{"s", ":", "psi4GeomTableBody"}]}], "\[RuleDelayed]", 
               "\n", "\t\t\t\t", 
               RowBox[{"\"\<GeometryTable\>\"", "->", "\n", "\t\t\t\t\t", 
                RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"ImportString", "[", 
                   RowBox[{"s", ",", "\"\<Table\>\""}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "e_", ",", "x_", ",", "y_", ",", "z_", ",", "m_"}], "}"}],
                    "\[RuleDelayed]", 
                   RowBox[{"{", 
                    RowBox[{"e", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "m"}], 
                    "}"}]}], ",", "\n", "\t\t\t\t\t\t", "1"}], "\n", 
                 "\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{"Extract", " ", "MolTable"}], " ", "*)"}], "\n", 
              "\t\t\t", 
              RowBox[{
               RowBox[{"s", ":", 
                RowBox[{"(", 
                 RowBox[{"StartOfLine", "~~", 
                  RowBox[{"Repeated", "[", 
                   RowBox[{
                    RowBox[{"molTable", "~~", "EndOfLine"}], ",", 
                    RowBox[{"{", "atomCount", "}"}]}], "]"}]}], ")"}]}], ":>",
                "\n", "\t", "\t\t\t", 
               RowBox[{"\"\<MolTable\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"ImportString", "[", 
                   RowBox[{
                    RowBox[{"StringTrim", "@", "s"}], ",", "\"\<Table\>\""}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"e_", ",", "x_", ",", "y_", ",", "z_"}], "}"}], 
                   "\[RuleDelayed]", 
                   RowBox[{"{", 
                    RowBox[{"e", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}]}], ",", 
                  "\n", "\t\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t", 
                 "]"}]}]}], ",", "\n", "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{"Extract", " ", "ZMatrix"}], " ", "*)"}], "\n", 
              "\t\t\t", 
              RowBox[{
               RowBox[{"s", ":", 
                RowBox[{"(", 
                 RowBox[{"StartOfLine", "~~", 
                  RowBox[{"StringExpression", "@@", "\n", "\t", "\t\t\t\t", 
                   RowBox[{"Switch", "[", 
                    RowBox[{
                    "atomCount", ",", "\n", "\t", "\t\t\t\t\t", "1", ",", 
                    "\n", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", "zmatrix1", "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t", "2", ",", "\n", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"zmatrix1", ",", "zmatrix2"}], "}"}], ",", "\n", 
                    "\t", "\t\t\t\t\t", "_", ",", "\n", "\t", "\t\t\t\t\t\t", 
                    
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"zmatrix1", ",", "zmatrix2", ",", "zmatrix3"}], 
                    "}"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"zmatrix4", ",", 
                    RowBox[{"atomCount", "-", "3"}]}], "]"}]}], "]"}]}], "\n",
                     "\t", "\t\t\t\t\t", "]"}]}]}], ")"}]}], ":>", "\n", "\t",
                "\t\t\t", 
               RowBox[{"\"\<ZMatrix\>\"", "\[Rule]", 
                RowBox[{"ImportString", "[", 
                 RowBox[{
                  RowBox[{"StringTrim", "@", "s"}], ",", "\"\<Table\>\""}], 
                 "]"}]}]}], ",", "\n", "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{"Extract", " ", "Properties"}], " ", "*)"}], "\n", 
              "\t\t\t", 
              RowBox[{
               RowBox[{"s", ":", 
                RowBox[{"(", 
                 RowBox[{
                 "StartOfLine", "~~", "propLinePattern", "~~", "EndOfLine"}], 
                 ")"}]}], ":>", "\n", "\t", "\t\t\t", 
               RowBox[{"\"\<Property\>\"", "\[Rule]", 
                RowBox[{"parseProp", "@", "s"}]}]}], ",", "\n", "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{"Extract", " ", "run", " ", "times"}], " ", "*)"}], 
              "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"timeBlock", ":", "\n", "\t\t\t\t", 
                RowBox[{"(", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"WordCharacter", ".."}], "~~", "\"\< time:\\n\>\"", 
                  "~~", "\n", "\t", "\t", "\t\t\t", 
                  RowBox[{"Repeated", "[", "\n", "\t", "\t", "\t\t\t\t", 
                   RowBox[{"Whitespace", "~~", 
                    RowBox[{"WordCharacter", ".."}], "~~", "\"\< time\>\"", "~~",
                     "Whitespace", "~~", "\"\<=\>\"", "~~", "Whitespace", "~~",
                     "\n", "\t", "\t", "\t", "\t", "\t", "\t", "NumberString",
                     "~~", "\"\< seconds \>\"", "~~", 
                    RowBox[{
                    RowBox[{"Except", "[", "\"\<\\n\>\"", "]"}], ".."}]}], 
                   "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", ")"}]}],
                ":>", "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<MetaInfo\>\"", "\[Rule]", 
                RowBox[{"(", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"\"\<RunTime\>\"", "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"blocks", "=", 
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"timeBlock", ",", "\"\<\\n\>\"", ",", "2"}], 
                    "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"\"\<Timing\>\"", "->", 
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"blocks", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< time:\>\""}], 
                    "]"}]}], "]"}], "@", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"StringCases", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "blocks"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Whitespace", "~~", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"sys", ":", 
                    RowBox[{"WordCharacter", ".."}]}], "~~", "\"\< time\>\"", 
                    "~~", "Whitespace", "~~", "\"\<=\>\"", "~~", "Whitespace",
                     "~~", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"time", ":", "NumberString"}], "~~", 
                    "\"\< seconds \>\""}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ToUpperCase", "@", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{"sys", ",", " ", "1"}], "]"}]}], "<>", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"sys", ",", " ", "1"}], "]"}]}], ")"}], "<>", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "\"\<Time\>\""}], 
                    "\[Rule]", 
                    RowBox[{"Quantity", "[", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", "time", "]"}], ",", 
                    "\"\<Seconds\>\""}], "]"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t",
                    "]"}]}], "\n", "\t\t\t\t\t\t", ")"}]}]}], ",", "\n", 
              "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{"Block", " ", "Delimiters"}], " ", "*)"}], "\n", 
              "\t\t\t", 
              RowBox[{
               RowBox[{"s", ":", 
                RowBox[{"(", 
                 RowBox[{
                 "StartOfLine", "~~", "blockDelimeters", "~~", "EndOfLine"}], 
                 ")"}]}], ":>", "\n", "\t\t\t\t", "Break"}]}], "\n", 
             "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
          RowBox[{"{", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Break", ":>", "\n", "\t\t\t\t", 
             RowBox[{"cacheBlockData", "[", "]"}]}], ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\"\<GeometryTable\>\"", "\[Rule]", "t_"}], ")"}], ":>",
              "\n", "\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"blockGeomTable", "===", "None"}], ",", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"blockGeomTable", "=", "t"}], ",", "\n", "\t\t\t\t\t", 
               
               RowBox[{"cacheBlockData", "[", "]"}]}], "\n", "\t\t\t\t\t", 
              "]"}]}], ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\"\<MolTable\>\"", "\[Rule]", "t_"}], ")"}], ":>", 
             "\n", "\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"blockMolTable", "===", "None"}], ",", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"blockMolTable", "=", "t"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"cacheBlockData", "[", "]"}]}], "\n", "\t\t\t\t\t", 
              "]"}]}], ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\"\<ZMatrix\>\"", "\[Rule]", "t_"}], ")"}], ":>", "\n",
              "\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"blockZMatrix", "===", "None"}], ",", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"blockZMatrix", "=", "t"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"cacheBlockData", "[", "]"}]}], "\n", "\t\t\t\t\t", 
              "]"}]}], ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\"\<Property\>\"", "\[Rule]", "p_"}], ")"}], ":>", 
             "\n", "\t\t\t\t", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"blockProps", ",", "p"}], "]"}]}], ",", "\n", "\t\t\t", 
            
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\"\<MetaInfo\>\"", "\[Rule]", "p_"}], ")"}], ":>", 
             "\n", "\t\t\t\t", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"blockMeta", ",", "p"}], "]"}]}]}], "\n", "\t\t\t", 
           "}"}], ",", "\n", "\t\t", "1"}], "]"}], ";", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "blockProps"}], ">", "0"}], ",", 
          RowBox[{"cacheBlockData", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
        RowBox[{"DeleteCases", "[", "\n", "\t\t\t", 
         RowBox[{"blockCache", ",", "\n", "\t\t\t", 
          RowBox[{"_Association", "?", 
           RowBox[{"(", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{"#", ",", "\n", "\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<ZMatrix\>\"", ",", "\"\<MolTable\>\"", ",", 
                  "\"\<GeometryTable\>\"", ",", "\"\<Properties\>\"", ",", 
                  "\"\<MetaInfo\>\""}], "}"}]}], "\n", "\t\t\t\t\t", "]"}], "===", 
              RowBox[{"{", 
               RowBox[{"None", ",", "None", ",", "None", ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], "&"}], "\n", "\t\t\t\t", 
            ")"}]}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], "\n",
     "\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"329cdd1d-d37c-4811-b841-d7fdf670c914"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Dipoles\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6941828029414673`*^9, 
  3.694182803924406*^9}},ExpressionUUID->"3a16e6a5-8ca1-42d4-b6eb-\
c959b8a957fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psi4DataParseDipoles", "[", "out_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lines", "=", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"out", ",", "EndOfLine"}], "]"}]}], "}"}], ",", "\n", "\t", 
      "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"lines", ",", 
            RowBox[{"_String", "?", 
             RowBox[{"(", 
              RowBox[{"StringContainsQ", "[", "\"\<Dipole\>\"", "]"}], 
              ")"}]}]}], "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lines", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"Replace", "[", 
           RowBox[{"p", ",", 
            RowBox[{
             RowBox[{"{", "i_", "}"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "1"}]}], "}"}]}], ",", "1"}], "]"}]}], " ", 
         "]"}]}], "\n", "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t\t", "]"}], 
    ",", "\n", "\t", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dLine_", ",", "pLine_"}], "}"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"Association", "@*", "Append"}], "@@", 
      RowBox[{"{", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{"dLine", ",", 
            RowBox[{
             RowBox[{"Except", "[", "WhitespaceCharacter", "]"}], ".."}]}], 
           "]"}], ",", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dT_:", "\"\<Overall\>\""}], ",", "\"\<Dipole\>\"", ",", 
             "__", ",", "dU_"}], "}"}], "\[RuleDelayed]", 
           RowBox[{"{", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"\"\<DipoleType\>\"", "\[Rule]", "dT"}], ",", "\n", "\t",
              "\t\t\t\t", 
             RowBox[{
             "\"\<DipoleUnits\>\"", "\[Rule]", "\n", "\t", "\t\t\t\t", "\t", 
              RowBox[{"Quantity", "[", 
               RowBox[{"1", ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"Evaluate", "@", 
                 RowBox[{"Switch", "[", 
                  RowBox[{
                  "dU", ",", "\n", "\t", "\t\t\t\t\t\t\t", "\"\<(a.u.)\>\"", 
                   ",", "\n", "\t", "\t", "\t\t\t\t\t\t", "\t", 
                   RowBox[{
                   "\"\<ElementaryCharge\>\"", "*", "\"\<BohrRadius\>\""}], 
                   ",", "\n", "\t", "\t\t\t\t\t\t\t", "\"\<(Debye)\>\"", ",", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t", "\t", "\"\<Debye\>\""}], 
                  "]"}]}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
            "\t", "\t\t\t\t", "}"}]}]}], "]"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{"pLine", ",", "NumberString"}], "]"}], ",", "\n", "\t", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_", ",", "z_", ",", "___"}], "}"}], 
           "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
           RowBox[{"\"\<DipoleVector\>\"", "->", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}]}]}], "\n", "\t", 
         "\t\t\t", "]"}]}], "\n", "\t", "\t\t", "}"}]}]}], ",", "\n", "\t", 
    "\t", "1"}], "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6941817898016987`*^9, 3.694182378025111*^9}, {
  3.694182549802032*^9, 3.6941826584914837`*^9}, {3.694182694893297*^9, 
  3.69418274308418*^9}, {3.694182778241063*^9, 
  3.694182816902403*^9}},ExpressionUUID->"78942974-e7ac-4682-94d9-\
090905d44fd8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Lookup\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69310875152069*^9, 
  3.693108753159162*^9}},ExpressionUUID->"fcb42269-4cc6-40a3-9a23-\
c39822c12b91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Psi4DataLookup", "[", 
    RowBox[{"data_Association", ",", 
     RowBox[{"p", ":", 
      RowBox[{"(", 
       RowBox[{"_String", ".."}], ")"}]}], ",", 
     RowBox[{"its", ":", 
      RowBox[{"_Integer", "|", "_List", "|", "All"}], ":", "All"}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"data", "[", "p", "]"}], ",", "\n", "\t\t", 
     RowBox[{"l_List", "\[RuleDelayed]", 
      RowBox[{"l", "[", 
       RowBox[{"[", "its", "]"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi4DataLookup", "[", 
    RowBox[{
     RowBox[{"Psi4Data", "[", "a_Association", "]"}], ",", "o___"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Psi4DataLookup", "[", 
    RowBox[{"a", ",", "o"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6929686323234777`*^9, 3.692968833456594*^9}, {
  3.6941828387802877`*^9, 
  3.6941828423398*^9}},ExpressionUUID->"142a93b1-bc52-4d70-988c-66809eb4fc7b"]\

}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"acc23cd4-e341-46a9-83e0-\
1e729c4baf43"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"7cca8c6f-6b37-47bf-b801-\
ef2e76014dba"]
},
WindowSize->{809, 748},
WindowMargins->{{Automatic, 92}, {Automatic, 27}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

