Notebook[{

Cell[CellGroupData[{
Cell["Spectra", "CodeSection",
 CellChangeTimes->{{3.692619234792058*^9, 
  3.6926192387674026`*^9}},ExpressionUUID->"94f0d441-d035-414d-91d6-\
ddfa26b58e71"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Basics\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692619275686701*^9, 
  3.692619276734231*^9}},ExpressionUUID->"9556636f-4f5c-469a-9c5a-\
2f1d1733f00c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrum", "::", "usage"}], "=", 
   "\"\<Inert head for wrapping up spectral data\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6925422226718473`*^9, 
  3.6925422333413687`*^9}},ExpressionUUID->"5bcc4f68-e4e1-4e16-9942-\
b9aea646da4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]View\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6926192485761757`*^9, 
  3.692619249460898*^9}},ExpressionUUID->"944948c7-13e9-4f04-8350-\
d686bb27072b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPlot", "::", "usage"}], "=", 
   "\"\<Plots a spectrum\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPlotDiscrete", "::", "usage"}], "=", 
   "\"\<Plots discrete frequencies\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumViewer", "::", "usage"}], "=", "\n", "\t", 
   "\"\<An interactive viewer to focus on pieces of a spectrum\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692537080038538*^9, 3.692537121933693*^9}, 
   3.692537194696789*^9, {3.6925415533591957`*^9, 3.692541580641577*^9}, 
   3.692541894010786*^9, {3.692559357479487*^9, 3.6925593711481752`*^9}, 
   3.6926477701065063`*^9, {3.692706382112245*^9, 
   3.6927064282762747`*^9}},ExpressionUUID->"bb63fc2e-9aaa-4df4-be1d-\
924233597705"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Select\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6926192516231527`*^9, 
  3.692619252518744*^9}},ExpressionUUID->"bd98fa30-2dba-46ed-bc04-\
ad572811a520"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelect", "::", "usage"}], "=", 
   "\"\<Picks data matching a criterion\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692537080038538*^9, 3.692537121933693*^9}, 
   3.692537194696789*^9, {3.6925415533591957`*^9, 3.692541580641577*^9}, {
   3.692541894010786*^9, 3.692541918906745*^9}, {3.692544339736868*^9, 
   3.692544339742983*^9}, 
   3.692544738452695*^9},ExpressionUUID->"4bb0da6d-6e02-4ffc-8588-\
10ec8df78729"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumZoom", "::", "usage"}], "=", 
   "\"\<Zooms in on a piece of the spectrum\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692544740412129*^9, 
  3.692544749770116*^9}},ExpressionUUID->"8492b485-d4e8-44ed-9607-\
24501ce3dbd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelectAbove", "::", "usage"}], "=", 
   "\"\<Picks data above a threshold\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelectBelow", "::", "usage"}], "=", 
   "\"\<Picks data below a threshold\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692537080038538*^9, 3.692537121933693*^9}, 
   3.692537194696789*^9, {3.6925415533591957`*^9, 3.692541580641577*^9}, {
   3.692541894010786*^9, 3.692541918906745*^9}, {3.692544339736868*^9, 
   3.692544339742983*^9}, 
   3.692544738452695*^9},ExpressionUUID->"b0ad1d99-b661-4c85-b443-\
d8d42d8e3fed"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Selector\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6942063882975492`*^9, 
  3.6942063892562532`*^9}},ExpressionUUID->"21b377c4-6cd6-4485-b3e8-\
ae56b5e53ed9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumLineStore", "::", "usage"}], "=", "\n", "\t", 
    "\"\<Represents a cache of lines. \nHas HoldFirst and can be used as an \
operator to add to the cache.\>\""}], ";"}], " "}]], "CodeInput",
 CellChangeTimes->{{3.694206392850135*^9, 3.69420641714358*^9}, 
   3.69420649730515*^9, {3.694255730707082*^9, 
   3.694255757239278*^9}},ExpressionUUID->"2a77a7b0-cedc-4345-bf48-\
b59dd9d4f2de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumLineSelector", "::", "usage"}], "=", "\n", "\t", 
   "\"\<An interactive spectrum viewer and selector.\nHas stacking, zooming, \
a cursor, and can apply an arbitrary function.\nTo be used with the operator \
form of ChemSpectrumLineStore\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6942064203503237`*^9, 3.694206495534031*^9}, 
   3.694255733641173*^9},ExpressionUUID->"1ef12c02-e196-4d54-af06-\
75477b8f5f81"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"feb5ca9c-1c12-4ed7-a0ff-\
7cac3736862a"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Formatting\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692542650159218*^9, 
  3.692542651173723*^9}},ExpressionUUID->"72576300-ff85-4665-8fe2-\
17c73d1d102a"],

Cell[CellGroupData[{

Cell["Continuous", "CodeSubsubsection",
 CellChangeTimes->{{3.692708696819388*^9, 
  3.692708699378559*^9}},ExpressionUUID->"8dc22b1f-f8d0-4f87-8a5f-\
c0a63fec595e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$specIcon", "=", 
   RowBox[{"Image", "[", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJztnXlwVdeZ4J8Ag5KeoqZSmVT3TE3NTFdlXDXVVdM1k6qe6r8y3ZXK9GRC
d5aOnQQHY8fxEseJl3iTwRaLzWZjFgMGG7PviE0gkBBIAoFA+4KEJLRLCEmA
QAI9SW+58/3Ovefp6uk9vSch6WF0//h0n+56lt/5zne+s/2XZ/74099Ncblc
r8fLn5/Ofet/v/ba3Hd+9m/ln3995fUXn3/lud/+0ytvPPf8c6/9r2emyskM
S6aJGIbhyARIWU2H689rMoxYh8MRR2IhDv+OTGZx+HdkMovDvyOTWRz+HZnM
4vDvyGQW4X+Kw78jk1VKr7XPcPh3ZLLK1fpbrjfXZhqxDocjjsRCrtTedOx/
RyatnMmrX/TKJ6eNWIfDEUdiITtPXTF+99EpI9bhcMSRWMiW4yXGbz88acQ6
HI44EgvZllLqfs7h35FJKltPlPod/h2ZrCL8Gw7/jkxWcfh3ZDKLw78jk1kc
/h2ZzOLw78hkFod/RyazfHW8xOHfkUkru9PKHf4dmbSyLaXM4d+RSSvvfX7O
eHZxihHrcDjiSCzkV/OPGc8scvh3ZHIK/KP/+z2++FiHxRFHJlqeWXjCsX8c
mbQyJ/G4Y/84MmnlN8L/3IUpxvni5rmxDosjjky0wP/TYgO9tDzVE+uwOOLI
RIvmf86C40asw+KIIxMtpv1zwnj7s8z+WIfFEUcmWjT/b63N8MY6LI44MtGi
+X9j9Vkj1mFxxJGJFod/RyazOPw7MpnF4d+RySwO/45MZnH4d2Qyi+r/WnDc
ePXTM0asw+KIIxMt8M8YuD86a6A7MgkF/pGXV6QZsQ6LI45MtDj8OzKZxeHf
kcksDv+OTGZx+HdkMovDvyOTWRz+HZnM4vDvyGQWh39HJrM4/DsymcXh35HJ
LA7/jkxmcfh3ZDKLw78jk1kc/h2ZzKL5f2lZqhHrsDjiyESL5v/5JaeMWIfF
EUcmWjT/Lzj8OzIJRfP/4lLH/nFk8onDvyOTWWLBv99vTPX5/VNjHXdHHIkF
/8L+Y16f/7FYx90RRxz/pyOTWQL+n6UT5/8R/T9d9P+0WMfdEUc0/3MXnTAm
6psXS6+fXnewcHOs4+6II5p/ZKK+uetUedcvEo5M2PcccSScaPafXjBx+v/k
xdof/nnN2Qn7niOOhJOA/bNwIu2fFtfqfXnuWMfdEUdiYf+cK2pyLd1+acK+
54gj4SQW/GcWNM34aOvFiN/z+pSfaHqs08iRR1diwX9WYZNrybacCfueI46E
k4eRf5/fH+/z+eNjnTaOPPryMPKv5dZd93dv3Lr/3VinkSOPrjzM/H+VXJIr
9+XGOo0ceXTlYeS/paP7R9eab/+Ie36/3JmX7Mj4ycPIf8rFmltfHSu5tff0
VeOzAwUTFi5HJp9MJP/Spp3u8fqmR+J/X3qF8fHOy8bxCzW9O05e6Y11Gjny
6MrDqP+Pna/2fX6o0JeUUWVsOlI8YeFyZPLJw8n/Nc/GQ0Weg8L/xsMO/46M
n0wk/3fv9f7PlvbuxyPxf/RctbEhqdBw9L8j4y0Tyf/Ji7Wt76zLynf4d+Rh
kYnkf29aRcET7x01NP/h5sEfEf7XH3T4d2T8ZSL5P1fU9O/mbzpn53+aL8Q8
yCNZDv+OTIxMBP9+v1+N5cytaHWt2HW5L5L9czKn1tiSXOLw78i4y0Tq/wul
LVMXfXUhoP9F93/T4/V9M/i+w5lVqt/L4d+R8ZYJ5n/aQhv/5XU3d0tbd3fw
fSv35KlxDw7/joy3jCP/cfp3T6/HdePW/f8m/Lvs+n9/eqXxyienh3x3yfYc
45lFKQ7/joy7jAf/0q7F3p+h/y+ubhednluk+c8sbFT8rz9YYPxy3rEh392d
Vm4s237J4d+RcZeJsH/g/aXlqUYw/9tOlLn/sOL0kHnwp6T9u/V4qcO/I+Mu
E8H/pbIW17yN54bwn3a53gg1D/7Y+Wrj80OO/9OR8Zfx4P/uvV5XUXX7fL9h
rnWYV94K933B/J8rajJW78sPfBe7yS/3m/5/x//jyPjLePBf09LpWrt/gOvL
V667Pvji/BD9fyavwVi+8/KQ7zrjHxyZKLHzL7p6TN5ZVtPhemddpqH/D8d/
OvzvGMS/mvMeiX/mxjvz4x0ZCxkP/V96rd311tqMXq/Ph+/zb4bT/yts+r/P
43W55X5H/zsyUTJe/L+59qz/1t0eV255a2m0/Nddv+Mqqmordfh3ZKLEzv/t
u+4xeSf8v70uw7jWdNv1xdESIxL/tJMZC3ehpPnn+9OvGsH8S5t4GqLfX9ty
5+dSVn4e67Rz5Osvdv7zK1rH5J2W/WMUVd1wzfv8XET+eYax0CkXa7oZ9xOC
/6l+2zjpPWkV3ftOX+2Oddo58vUXO/+sSzsW79T8U57eXJvRFwX/ao3P5PPX
jFV7cvsi2T8b5dyXUq/EOu0c+fqLnf9LwulYvFPzX1h5w/Xe51kR9b/PHB89
88SFGs9n+/OH6P9+j2+mtI1n6vfvPFXu2Z1a4Yl12jky/uLx+uIl/8fN1zeI
/7IH4x+OCetI+W+9dc9VUX8zKRz/mQWNSScv1iapdUFFHP4fOZkSq2/b+c95
QP612PlP2BCZ/4LKtv+elFFpCP/G2hD8f3m02Fi5m2UQzffvOHnF2HWqnHbz
FH8M086RBxf6/H22sZITLQ8D/+m59VfW7i8Iy/+uU1eMzw8VGfr9mn/GmMYy
7RwZfxHd+OTF0pYnx+v9Y8n/zTs9rgslLU+OlH+xbYyPd+a6w/EvR/f2lCvu
6qbOJysbbj2p+Y913jjy4CL6y+Xu84S9/sEX2ff/sOL0/fH6vp1/9uV6kHcV
XL3h+u3ik/dHyn/qpTqDOV/h+KdP4KvkUmPf6Yr7O09due/w/+hI4427ruPZ
1xbxG1so+Dr7BP159dlxy2s7/9nFzQ+01xD+TtY3GSn/aZfr+lbtjcz/5mMl
yg7S/OdV3FhUVNW2KNZ56MjoBTbeWZdhhLt+OLPKsyOlbNx8HXb+zxc3P9C7
Khtuw71nNPr/0yj0/560Co/YQR7N/4akIjVPJtZ56Eh0Emp8ZU5Zi8u2F+4Q
P+fRrGrvzpNXvOMVpkH2T9mD2T9VJv/e8eO/3Cv8ezX/6+WeLckO/18jGeKr
yxebOfHL7LB74e5Pr1D+v/EKk53/M/kN/+NB3nW1/pbrtVVnQtk/U8aC/92p
5cyZDNg/20+WuQ+kX3X2Ef76yBBfXZ7YzO9vPOfv7fe67tzrHfLMgTOS98fG
r6/fzv/Bs5VXH+Rd8P96CP4vlV2f8f6m4fnH/pd2kLFmX17U/Ivt49+XVuF/
CPLVkQiC7dPd0z/kPPzP33jOqG+948ooaPh18PWJ5H/f6atRf0evW2hfvzAc
//kVNxT3kfiXdrCx8XBR1PxvEdt/b1oF62hN89nGh5rjRY0h6yo6Ejtx9/W7
ckKMr9H80/Zctj1nSF0+kfwfO38t6u8IY1PsRyQc/7nlrdh4Ee0f+gHWHRw6
/jMS/4RBeJ8yEDanX/hhk1t3elzLd1xaEnxe8y8sqGPw9Ynk/0R2Td9o3qHm
ufv8M8Lxn3KhZqde/2TxMPzD+qufpo+Y/1jnrSORpaW92/X0gqFzrAb0f5Nr
6bacIX7OieQ/OUr9z3q27j7Pt+i7u3u/91v6fDj+D5656pkj74/E/8e7Lhtz
JI1Gyv89d/+3eno9gXD09Xu/5fH6vjVWaeTIgwv8P/VB8hC+AvwXqTUBh/g5
H0b+u+73ufalX01u77zvWrM/P1mfD8f/2byGp19ffca4UNI8rP2zS/j+QNrJ
I+X/80NFyXvSKgLhOFfUlFxyrSOZchqqT9GRiZfrHd2u5z86qex7u22q+Wfu
CX29wc89jPZ/++37rj9+ctqovX7H9ct5Rw3Rta7Ort7vheOfcRGLtlyIyP/p
y/XC+8jbv39cedpY9NVFQ9n9IpukDZ2cXUNcphhOO+ChEPj/7eIU5auzj1kM
5t9aAyom/MNdNM/cuHmPuCif1TOLThi37rpdx85dqxqu/buA9m8E/ln3f/0o
2r+socV5r9c3gzGhtKFZQ8sw/c3O+NCHQCz+h/AVQv/jt1P+PPx6kfhX5eUB
wmXnH/9jNM+wTsPchSfcjW13XS+vSHM33LjrWvjlBWMY/3+88v9H4B///+oQ
/n/8spuPhedfzruTz9cEfGefHyp0HztX7WbdafpVYp33joyIf1Vn67p8gv0/
UX0Hzrkf7l9Yesq41tTpeuXj02H5D4x/iMB/cP/voSj1P+PiDpypDISdZ3nH
1YZbrqa2rpjn/WQTsYeH1Lmaf8Y6Cy/L9flg/rt7+ly0K/X1KPh/oDrezn+o
tWhDxa22Ren/AP+1zXdcf1iR1jde/B8VW2Z3asUQ/r9KLjH2yDnmwrOXgNj8
y88XNS/X/Ev9sfxCScvy0aaNI2Mnmv8OYds+dj2Y/2vNnd8+X9z0bXev59tS
Fr4diX98kP4HWLfQzv/LK4buRRFKWm+acdH8VzXeFv7HXv8PzP8qV+Oeh4x/
kN+mbWTq/7c+yzTWSFtA80+7QNolUcXJkfETaZPFa/5pM767PiuQJ8H8ny9u
TvniaHHK8fM1KesOFqZo/qVtF494LNHPN0r9frtr9OtW2flfuPlClPzfcz1n
4z+v4oZrrrSDx4t/2havrkwP8L/T4n+P2D7sFab5552MB9X8886jDv8TJnos
gOjwvxvKjMk/tvILS1Pd+v5g/k/l1Ck7ZN2BQuP3K9KMSPpf2Pm78rqbQ743
Gv43HR5+nCl+zsYbXX+ny7Lm/3J5q+vpBePHP30Cf5D2RTD/jBkizJr/bcfL
3KI33Jr/9UmF7hMXap3xoRMkwoeaP/X66rM1wWP9tc6UsuH6/fI0PzYL9wfz
nyYswAT5uVwdQ/Ov+3bW7i+oyShorBkL/ilzw93L+NQPt16ssfP/4tJUo1K4
Z7+68eJ/uzDPunDB9s/Loh9YZ1rz/+WREv/hzGr/euX/VHtI+o9n1zjjQydY
fvTaAYO1j70+5cN0Nbd1za03fYZGjfD/R6nL9b3B/KfnNriFBfepS3Xuzcml
bs3/ldqOuaLn514obZlbXN0+17D8pB9tzTHYL2gs+F+9N3/Y93Tc6XH9av4x
I5j/OmkP/0niNF7883+o9i/2Pjab5n/joWIj6WyVSq+UizWqzAj/htYVPnNc
aMz5eNTlqQ+OK/4lrePw9+xJLfdUNpg+Q/inLg/HP32gn+zOVX2xYv8H9P+6
AwWeDUlFnjfXZHg+2Z3HOCH2V4z7eFeucTq3fkz4XxbB/8P6DozjCfDfavI/
Xv7PEPMfQ/p/NP/YQviMaCuzh5LmX4ffb9uT0pGxl52nyj+B97mLUvrhn3OM
lXlj9Vmjzqb/4R87aHvKlU/C8X9U+P/swAD/q8XWZY2c94SnNcIIbV7mE0hZ
6E/Pq+8fC/7/vCYjIv9PLzjeP1H8HzxbaXx+uCjg4wnmn/oA3r84apYRygr/
v/rpGZVWvMsa02T3ETv9weMkP3/nsHGnu1cxBf937/V9p1P+//X7yf26/av5
Zw/cXyQcMaLV/7tPlffvTavo33q8tP9IVnW/PPed6ubb3xlL/f/cRycj8j+R
+v9QZrXl2w/d/6XqBLGL8PkcPFsV4H+OtMWxC9dL+kn7V41P8rLOTK/nO/0e
X8w5eVTlp28fMtj7DZZ6+z0usSdSbwv/YjN7dftX8w/3z8r/w/G/3sa/5LdX
9J9X+PcK/17hIPVsfkPqWPL/2w/D84/dPFL+C67eiMfXG8x/RkFDPHGNxD+2
y3ZhPSz/x02biN/4+Zk7Bv+LpE2wPaVMlR32mKyov6nG3568UJtaWtMRc04e
VRGe3ffE3oGlnt5+14/fOGig/58Wu0czo/mnPfDe51nuaPnfkWLmOWMbsXVX
7s5TY7zGkn9YHubeKSPlv7i6Te17Gsw/cx2W77gUkf+tx8uMZXJfpPEPn0ga
YB9p/qkPGEu3+KuLZh9BVtXf55W3/j33ybf+fqBMD5435siDiTDk77bx/+R7
RxX/v7Exo/kvr+tgbXx/tPaP5v8LqeOxi/HVcM9Y8o8vP9x9wsn0kfJfIvzP
D8F/thzhPhL/jBnlO5H4f0HCwHc0/xyx+9E7vF/SsU6+Ucf8mlM5tXU6Tvif
fT7/A635NRlFbMnHQvnRYMjOv9QHveH4v1LbodrFo+V/3YHCXrFte8eS/2dD
jM+zy0j5zypsnEdcNf/C/WP4Kw9nVs17XeIeif+P5RrzISPx/6a025dKe0Lz
v87y//Nt+jRYO5qxfav25vUyxtWn8s//WKw5+rpKOD9aMP8ch+Ofda8i818Z
kn/8G9jHY8k/Euoe+vII/0j5RwfzTpv+j0P/Y6uo9YYi+X+ULo9i/KfVRtb8
6/5f0oh5MIwJYm79yj3K/iGOcYbjCx1z+brzPyfE/GSEuHx2oGDVSPnPLGhc
8vLytAD/ueXXXUu35xhJGZVLXvv0TET+YXebtGMj8b9L/ueZYP5JK94t7+w/
dbG23+I/4CuWd6wqrGpbFWtuvm7S2dX7V+xVOzH8h7Z/xoN/+idC3YNP9xfv
HjFG0/6db9v/Tuyh/8w8GNq/0dj/+DRhOrL+Lw6j//H/D9X/99z9f9XX7/2r
ZxalGPvSo1/zyBFTFm+5mF5ed3NY/u9HxX/GQ8V/qPUpNP//Okr+7fs/7jtd
UYmPVfl/ouCf/t+NUc9/CcG/1f8bzL/UqelFVW3phJE5Z7Hm6esmP337sPJl
6P/1uM9Y8j9aP14k+5+40achutI9Kv//ugH/v7BaSxs7o6AxKv9/tPN/vwrD
/2dh+MevxP+r9+e7Jd2d8aEjFOZ6FFe3B/7Hj+YPx3+XOyT/ZTVjyz9+vNGM
7YrEP3Gz+vT8o+j/jUtYb85/h39pD/xX+gMyCxvjRjL+R6WB8M8+SKx3Tt8W
Y6BHyz9tEGucrT+joMEZHxql+Pym3/O9z8/1VkRr/0Tgn7Ux5288P2L+yVt4
mQj/j+7THtX4B/p/Lf5p/8L9SMe/af6JN/1Z2Oz4BUbL/6d7cnvP5jX0Ms/i
bH7DqNNusgrcloXoR7fzL22sceWfPCWPvw78X7L1f+H/H6v1z0fLP/1g6ZJm
9C07/I9c3lht8s9ccOqDrcfL1nZZ3Efin3kAjP8P2D/lrTNoI46Uf/jhf82/
2NprGWPkVWGKfj5wOP5ZR4cxTFtPlK2Nlv+KUOv/2/jPLm5+bMGXo+efvgOp
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
zyO/5P55Xu/kGh9K2pOumn/S54yk00Twr/U/391wqCii/qePgnaksv9LW7T9
H/f+pvN95bVqjs6w/rtg/uEyWv4Z78P/I+X/nMV/ptj/6P1g/lnXbv0I/P+a
f/ZiXSgMh+M/kv5fouyfFsLWlyNhlv/78kcxpvbrKqyNyroO+N7QqQH+t1j8
b3pA/oWZaPk/JfnEnp+R+P9U+3+2m7br+xux0Vrj39uQ5eMbyoc3jO4K5p/n
o7V/4J6+adayps0Utf63+X9W7hngH79WqP1Po+Wf9i3Xtf2zLgL/3I9fSPOP
DiGsi7dc9F0sk+NXF325I+hL/LpJc3v3k0VVbT+Qum2qMDK1uqnzB+V1HT+A
f8YZrrH4X7HjsltsVvdo+L/THZb/qcPxz/gWWInEf7D/f+GX2WqM6dufZRrF
Ve0j9v9jR0XW/+ZavrR/f0/7NzL/U4fz/2v+sU2w+0fLP2sFsc5btPyTzlIW
A/yTZidzap9kjo7UpaovJafsenzjja4fMC7kQfZZfhhF0rXvxWWpbayHx5qG
RzKr24SxNtKVNF+zr0CtH8O+EOiqUfEf3v55bDj+mZvKOt7h+GdMBEwEj3/Q
/NNXVlIdeRxoMP/PfpgSnf0Tqf1r83+KLfGY3v/azn/6kP3f6wLsjoZ/0uZw
ZnUU7d9c9e1g/umz3p5S1kcYsSXRMdQHmw4Xt9Gn8aiMDWXtR6/X95ik5wHy
U58nbVkvUvPPfiKpl+ofiH/2Ow3FP+mJvgnHPz6dP608M2L+abtJHq/Q/J+4
UPMqYYuW/6cSkw3swOH413GOln9saOYuRuL/K7H3aM9Hy7+5/8sA/xuU/79S
jfVhHEkk/gkr79b8k5+StgcI40Ub/+9tMNcwMqx+INjxPQLrhzJeXfSsn32h
pA6YdiD9qh/fZ8D+2Zf/wPq/NWjMmOa/tKZj+hvD6H/GqaxPGqb9+2Xo8W9m
H1alofmf/X6ykTdMGy6Yf4Q5PcPxr/dyitb/KTbE9Gj0P79572j1/0jnPyp/
l+g4zT9pmG2F0c6/hN0/kj7Fr4sQ15W7cz3Zxc2b96RVbJb2l2ff6QqP5p8x
iYxD1PzrtiXz30uvdcTDf20Y/rutfrBw+l/S+zTtgXD8Mwbmi6MlI+affiP5
/x3N/6+F/8LKthHx3+8x+XeH4b8+SP/b978Lxf+x89dOP7/kVET+Gc/PGI9o
+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
gWsLLLH9b5Yj6x4rT5+y3gPX1K+zTXZUGnEvdYaVZ6odgg/CTDOJ5wdmHNfs
zfcOpKWZtuh3/KA6H/V19L9Oc52f/E+bHX8YddGZvPpvcp72JQz92uKN+px0
Rff19Xu/yfysf3kziec9T8476kHfS7n3cM+/vnvEI/rcgw4gTpwnLNiTHH+q
j/KMlU+Gvg4zzN+x0sKjys98Mz0IC/pijpXn+pxOV86z16/1Tg9x/IX+X5cP
eSdH0U3q+BMrDLOtckK81HMJRzy0tyQcHnu+8F3qKnQcv+FV1/tmPZTMbzdH
ROoSN7qOdKE+IL2J3xz1LfNIfpEG1G3YppxH/1HHzTXtCbeOo7IpTN3vZu9T
joSZ54kr/3PkHtGd3YRL7KDuuep40vPMYt41wO2zi813S1zdWgeE5B29vyBg
76hv824dBn5rH4FZl6QEyoD1W32Xc6S1vMet3y363E1dTdqIqLTjGezzpyyd
Qv2I3rHS3w0HfFfKRbfFmGKGOoc214qdlxcTNnkXaeAWRmkDqqOE0c17OKr7
l55yY1OLnnBL23wL76Uul+e7CdNvF590s442z1BniN27hTBaaeBnf1F+Sxr6
1f+LTvglnn4z3wb93xs4n3jcb6W9n9+SDoH79ZF3SdzVkfuets6p30FH7h/4
pvk+/S7ztylSntRx7sLBYeLdFse9ZphT/BJ3dV6/W4dJ8k89z29JE3VN0iMQ
FiuP1H3kC+/hWSlT7qetMEl5MI9yD2WWI/YK9yoWpdxLGXDzP3lEuIkH/3PE
luDdHK36yW/m61FV/rjHsj/UvTwnfKjfOg0QpaPkHqVXzHQLWwa4D+G9CN/g
eavc+4nTr+eb6fEr66h+SxpZ9apKJ87xPOHhN2Vd57Ol19TznNfpaNkb6kgc
Zr9v6qKfm/qNcJNm6jtPyn2MM+A+7nnSjL/SK7+y7DP7eW2rcfzxG0nqOm3g
X1j3cZ48Ut+Wc//06gF1XfjtEelFpIwEfsOU9TtwDqHv17rWYx7NZ/itzwc/
J/EMfmck6bG+Ffh/ru1ZqUsG3S/M6DD1Wvns09ck/oHvDnqHLUySHuq3pKM6
Un7Qx/yW9O8lnSQP1b2SP4H4cY2jpGkv9SHP48/5pRzl3h7eIed7JF96qSfn
WO/ge3yDeov616p3CTdx6VF1yoITPdzzM+u9jH/kPbzDqu8CcZlllrlenlPh
t+qGUEK8yQ/ei0hd0kuZtcpvL3FBVDjN+FnpeKSXeyR86jpH0kWnI2HQ+aXS
S66Lnu61GFPPWPz1Eme+qZkkbsRH0q1H0lelFc/+WNKSuHLvT948pHilTPyz
PM/31HnrOteID0fY5vr/fe1A4D6OvE/fyzVpVyaRbz99y3y3XQjXT0Kcl3B6
eIZrpv1kniftkeD7Edqe3G9/H/EJ9X67oB/s4dG/aXfa75M09eh40DcteePR
1/CL6O/Y30EdyP08h//GfG+qOv7KtHOS+I1vUNrJKp1+/u5hpav0O7jGkTbe
vM/PJeGL/HjX5STaZnwr8cvsJPpvsHs/2paTpO1CfHjU4ct2XEr6eFdukrSv
k8ROSjLbqPRBZyfNUfbdEWxV9d7FX11M0n3UPIcNoplYtTcviTThOeKKPUs6
INqOtPj30FYn7gs3X0hC9PMJG7KSsDnwD9FXTtrgM7Ono9j3Sehj/AKwK+3c
JNq/XBdbRV3jN+efVPedYZ58kk4jSYskfCEr9+QmrdqbT9okkW6kNfHh26pP
Y9ulJOxNaTvsIm24d7nEGV6lnZ306Z48dQ6RtrE6SvsjKfGL7CTyas3+/F2c
W7u/IHAfsmafeVy6PSfpo605u253uWfqevCJIFF1TIjzEk6Pvl/XY/o3PudQ
zzCW9okQ3yGvQ92v5Q3Jb/0b36r+jT/Hfp9w5dH1IHn+6ifpHn2NPUlCvYPx
Fr+eb9bBB85UqHPrkwrUEd/GpSstM/nNOMmG1rvqN3bxL23pwjWOjJk5m98w
c/OxYqOlvWsmY4nIx8Kq1pn4jRg3VtvSOfONVWfFlk5W/c/w2iT3dtzpmVl3
vXNm6qW6mbQf8ffmVrTOfFd4e3GpWv9/Jn1QFXU3Z9JfAr/N8hy2rU7P++7+
mfhx8+Q50zZKHsT/0wt0OTjuYezbJ7vz8K/OLBPh/nvyfEZBw8y1+/OMnSfL
VJ8Hacm+mDqurBWWVdg48wU1R/KK8uncutsz87MD+er69Y7umdj//OY8a/Yy
l4Dw6zRKu1yn0ubOvd6ZPb2emel59TOzS5pmXihpnolfnLFXH351UaU3cw0I
Y52kG/dev9k9E1753d3Tp45IU1uXOtZLGuZVXJ/ZeOPuoOuhhHcWX2ubiQ9o
e8qVxF2p5YkHz1YNkpV78hIPnLk65Dw+Sp6RvEj87EBh4PyGQ0WJSRmVQ+5H
iq+1y/1XE/ekVQTOHThbmXgoY+i9dhGmAr+PZ9cEfpfX3Rx0HyxInqn3YX+w
xry+1nb7fsh3FFW1JR6W+49kVSc2td213tuhjqcv1ycyzonf12/eSySd+J18
/tqgMHONY931O4mSN66qxlvq3qv1t9S3evs9Lr4veaLOn81vTJQyk3jj1r1E
4T3R3gdJf9n54mZ1nj3xzhU2JZ7KqUmkv6ay4VYiPmvhQs7VqufOFzclJlnh
4P+KulvquX3pV9Uex6QD9T3lW/sq0DfClMS9PZG+IEQ/zzyOspr2RCmniTXN
nSqewnQgru2d9xPp+zx5sTaxXuIr5Vo9V1bTEQgD5/Tv1Jw6dR/h12nEmCjS
RseZdU0Yq8B4XuJT23wnMfdKq7pe3Xg70ePxBY9TG1Z6rDH50Qj9tqypQv8u
/V7B1+k7C/XcvI3nunmG/KBfVp+nX36475ljUEcWn2jlaFZ1N2NC+f3cRye7
j5671j0G7w30D0a57szUEPcO+w7O+QfWtQn5nBE0vyPUu2x9meoouqCbdEAs
/1D3b0wfVXfQe6fano86joHv2tY78tt+B62DNOQ3123fHPJtW/xU2nCvXj+f
34Gjz2+7br5H/W+7Hkr0vT5rzkAocYsuCXW+sKpttv5tH2cXyzUaW2/eC4Qp
u7h5tuit2WPw3iFzLKK53x/+uVDvmGbN25g2zL3Tgs8Fz6/R85L0PVJPzCYd
MgsbZ2OfbztRNhv+j52rnh303mm256OO4wCnA/wIU9NCnQ8VF70Wsi0Mwd+2
x0fdy/v1c3bR1+3vCr4n1DO2uH/D6/V/o9/jGyRybcg567x6RtgfdA+/ORfq
Ga+c91gS6no48YQ57/X5Q4ZJ/0b0NZ9vaNzUu71D3+e1naM86+cZNxvqHfrd
PG/1qX/DmmuhzjPWVqWv9Q5P0HP+AXa4z6XDxHP23+bz/oH3mrpnUPz1PR5b
GiC0oSrrb6p+JNYP0Hmh584G0o/3e8246O/Y085nxdGeXuq7Opy2NNfpr8MU
SCOfGQdbuVXf9Vnx9VpckR76WT0vK9y8xsB1Pdclivlf+t7/D9aCIFw=
        "], {{0, 
        192}, {192, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag[
       "Byte", ColorSpace -> "RGB", ImageResolution -> 1000, Interleaving -> 
        False],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{192, 192},
      PlotRange->{{0, 192}, {0, 192}}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"32", ",", "32"}], "}"}]}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692543341020484*^9, 3.6925433713060913`*^9}, {
  3.692543532903859*^9, 
  3.6925435876575613`*^9}},ExpressionUUID->"78c2b2cc-e707-4054-95fc-\
f1b636f6218c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"ChemSpectrum", "[", "data_List", "]"}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"RawBoxes", "@", 
    RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t", 
     RowBox[{"\"\<ChemSpectrum\>\"", ",", "\n", "\t\t", 
      RowBox[{"ChemSpectrum", "[", "data", "]"}], ",", "\n", "\t\t", 
      "$specIcon", ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Points: \>\"", ",", 
           RowBox[{"Length", "@", "data"}]}], "}"}], ",", "StandardForm"}], 
        "]"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"BoxForm`MakeSummaryItem", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Scanning Range: \>\"", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"MinMax", "@", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", ".001"}], 
             "]"}]}], "}"}], ",", "\n", "\t\t\t\t", "StandardForm"}], "]"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"BoxForm`MakeSummaryItem", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Intensity Range: \>\"", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"MinMax", "@", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", ".001"}], 
             "]"}]}], "}"}], ",", "\n", "\t\t\t\t", "StandardForm"}], "]"}]}],
        "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", "StandardForm"}], "\n", 
     "\t\t", "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6925422156812687`*^9, 3.692542435581572*^9}, {
  3.692542581148922*^9, 3.692542581770741*^9}, {3.6925426145777493`*^9, 
  3.692542637241089*^9}},ExpressionUUID->"227a6a91-b901-4a44-8547-\
2a91c50d2fa7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Discrete", "CodeSubsubsection",
 CellChangeTimes->{{3.6927087012420273`*^9, 
  3.692708702762529*^9}},ExpressionUUID->"0fe750be-fa6f-4676-88ba-\
8cefbada46d0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"specPlot", "=", "\[IndentingNewLine]", 
   RowBox[{"waterSpec", "//", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ChemSpectrumPlotDiscrete", "[", 
      RowBox[{"#", ",", "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Ticks", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"500", ",", "Automatic"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"AbsoluteThickness", "[", "4", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ColorRules", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "___"}], "}"}], "\[Rule]", 
           RowBox[{"Hue", "[", ".35", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "___"}], "}"}], "\[Rule]", "Purple"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "___"}], "}"}], "\[Rule]", "Red"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageMargins", "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
      "]"}], "&"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6941762047600403`*^9, 3.694176479371481*^9}, {
   3.694176513072225*^9, 3.694176790863048*^9}, {3.694176824102407*^9, 
   3.69417692646741*^9}, {3.694177066781105*^9, 3.6941771080981493`*^9}, 
   3.6941771483208027`*^9},ExpressionUUID->"5ef55ca4-205a-4562-8479-\
e6f84e2c28d7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Image", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"specPlot", "//", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageResize", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ColorReplace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Rasterize", "[", 
           RowBox[{"#", ",", "\"\<Image\>\"", ",", 
            RowBox[{"ImageResolution", "\[Rule]", "1000"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"White", "\[Rule]", 
           RowBox[{"RGBColor", "[", 
            RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"100", ",", "100"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      "&"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"32", ",", "32"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6941762047600403`*^9, 3.694176479371481*^9}, {
  3.694176513072225*^9, 3.694176790863048*^9}, {3.694176824102407*^9, 
  3.69417692646741*^9}, {3.694177066781105*^9, 3.6941770749711733`*^9}, {
  3.694177113299738*^9, 
  3.6941771298908367`*^9}},ExpressionUUID->"c4be7d80-0758-44ad-9d06-\
27752442594f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$discSpecIcon", "=", 
   RowBox[{"Image", "[", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1: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
P0DKn8aDBI5ok6by6Hz08LszBQVxr/BYYpGYeMkqJaVoaGzsM+x8r2sd/x0I
oUfa8x7Yetj20br/78nFJR4hWVlR78BjPuaRj1TuHFDbVFCodIHZKLMM8Ooa
1qVpZBI9yJQ0oYeiIgvzEOiZCeuP1/FQ6T2et8LzBPBjZKS40qjCaxjW1uOe
557khlRZJZLyQtH6vHmCR1rTgwcb3aiM1Kk8BNjx9PR8UaqmdjPnh/W/gJ07
MwTjHh+J25AxeXmhDrl5RECGtFCPC2IP7PNnY2KHhv6kERzcrhYY1InV4dj5
PtHDm5lOnOghHgdUdP26lmZwSFtsQYHv6xpMfNYylQcPoP0qBMhsBoc4rUbr
qrg6lOimj1ePjF1r+LfY41pv7xpEUZHN34Jer3RNwhpBy/f7YJ28mXhgcYN8
XTPpp8TLdqqhP4cqxla7c7KSkLaOr4GyMvViXb2uPQESmscpPu8BY+s/fPhJ
qopKZ/y/vgNg924mLPIQb3u/p9egVUYmA5DJGvwJHhPzZmhk5PO9Xt6DO909
eKLrU/JED38WOwH10JzsUXbrlsqx85G3YvLH/xeAxBaT/neJ2ONohUcR5oG1
tccEPOF9f43bNnm39qxprToGRd1cuGpM7OFOpqQ3Dg39CztnwbYtBVfM7dPK
R+vllAS6mW/i4UyhsIXn2O2b6ufd6WlRfwm9f/Q7R3BePanU7WJmMuqxFKio
kEilZU6nEpKLJ3sI+gY+F4x7fMpWUWkjLFuOoB5pkz00AwI7rDOz6JM9BkZG
/jjGHx+PNzgy8sV+b59eec9zw+j7ORM9sPPYjkjilN66pTrZo/TmTdWjEeeb
X9dDuM+uwSX80fH9iz20KlzLxeVD3CcxJJ0rr1u+ZoBrDEXcXLCKJ/IgeVFp
9Lx79w4M7NpVOrJ3T57rWb8bqb9UHFIHesK8plVUnH4dDycKOQObB12ttHa2
jKlL/Ef0df01rkiEWmLZBA+IWl5ha5WYUjTJgw4Gh/4wht0nQT1YKirtKd8v
A1N5qPsHdE30EIjmB7Iz4mru3hV+Dxht4/4J9ejb43luROxxrbV1q/C6AcML
FHx8e6taWvZNVT5ex0NcLu6X3t8a/E1wW2+b6F6AaP6eCoubxwU2CQ132rc9
6u/7Gpunz3Avq1+z5inX6FePVDU2JZTNjtWOT6gv2LBxLOSY7sNzp5zuXhyp
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

        "], {{0, 100}, {100, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag[
       "Byte", ColorSpace -> "RGB", Interleaving -> False, Magnification -> 
        Automatic],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSize->{32, 32},
      ImageSizeRaw->{100, 100},
      PlotRange->{{0, 100}, {0, 100}}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"32", ",", "32"}], "}"}]}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692708745193839*^9, 3.69270876712892*^9}, {
   3.6927087993983088`*^9, 3.6927088470791607`*^9}, 3.692708893230245*^9, 
   3.6941769709406977`*^9, 
   3.694177183931397*^9},ExpressionUUID->"c8723e4d-6905-43c9-8b0e-\
48876e8204d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"ChemSpectrum", "[", "data_Association", "]"}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"RawBoxes", "@", 
    RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t", 
     RowBox[{"\"\<ChemSpectrum\>\"", ",", "\n", "\t\t", 
      RowBox[{"ChemSpectrum", "[", "data", "]"}], ",", "\n", "\t\t", 
      "$discSpecIcon", ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Transitions: \>\"", ",", "\n", "\t\t\t\t", 
           RowBox[{"Length", "@", 
            RowBox[{"Lookup", "[", 
             RowBox[{"data", ",", "\"\<Frequencies\>\"", ",", 
              RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], ",", "StandardForm"}], 
        "]"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"BoxForm`MakeSummaryItem", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Scanning Range: \>\"", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"MinMax", "@", 
               RowBox[{"Lookup", "[", 
                RowBox[{"data", ",", "\"\<Frequencies\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"-", "1"}], "}"}]}], "]"}]}], ",", ".001"}], 
             "]"}]}], "}"}], ",", "\n", "\t\t\t\t", "StandardForm"}], "]"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"BoxForm`MakeSummaryItem", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Intensity Range: \>\"", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"MinMax", "@", 
               RowBox[{"Lookup", "[", 
                RowBox[{"data", ",", "\"\<Weights\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"-", "1"}], "}"}]}], "]"}]}], ",", ".001"}], 
             "]"}]}], "}"}], ",", "\n", "\t\t\t\t", "StandardForm"}], "]"}]}],
        "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", "StandardForm"}], "\n", 
     "\t\t", "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69270789446588*^9, 3.692708015375016*^9}, {
   3.692708811506323*^9, 3.692708817825633*^9}, 
   3.6941770336728287`*^9},ExpressionUUID->"9f8cae3e-8bb3-49cc-abac-\
e5df5a79ae12"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Viewing\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692542661126648*^9, 
  3.692542662021559*^9}},ExpressionUUID->"3f22d1a5-78bd-4c07-ac53-\
d3f83f64fedb"],

Cell[CellGroupData[{

Cell["Continuous", "CodeSubsubsection",
 CellChangeTimes->{{3.6927083576803493`*^9, 
  3.692708363047368*^9}},ExpressionUUID->"e178eed8-ab34-4aeb-b488-\
83b624ec8815"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemSpectrumPlot", "]"}], "=", 
   RowBox[{"Options", "[", "ListPlot", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPlot", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"spectalData_List", "|", 
      RowBox[{"ChemSpectrum", "[", "spectalData_List", "]"}]}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"spectalData", ",", "\n", "\t\t", 
     RowBox[{"FilterRules", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ops", ",", "\n", "\t\t\t\t", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "0"}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Large", ",", "Automatic"}], "}"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], "\n", "\t\t\t\t", 
        "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "ListPlot"}]}], "]"}]}], "\n", "\t\t", "]"}]}],
   ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692541003557725*^9, 3.69254108194545*^9}, {
  3.692541504501615*^9, 3.692541544752569*^9}, {3.692541601916202*^9, 
  3.692541605123766*^9}, {3.6925424511315002`*^9, 3.692542465510003*^9}, {
  3.692547169824987*^9, 3.692547182345619*^9}, {3.6925472140953293`*^9, 
  3.692547245404814*^9}, {3.692706355913571*^9, 3.692706366513455*^9}, {
  3.694269540896784*^9, 3.6942695498771276`*^9}, {3.69850697625915*^9, 
  3.698506976760291*^9}},ExpressionUUID->"9fd33ae5-9580-41e4-8342-\
3350d94fc97a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPlot", "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"a_Association", "?", 
       RowBox[{"(", 
        RowBox[{"KeyMemberQ", "[", "\"\<Transitions\>\"", "]"}], ")"}]}], "|",
       "\n", "\t\t", 
      RowBox[{"ChemSpectrum", "[", "a_Association", "]"}]}], ",", "\n", "\t", 
     "ops___"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumPlotDiscrete", "[", 
    RowBox[{"a", ",", "ops"}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694198258188134*^9, 3.694198306625758*^9}, {
  3.694198730936833*^9, 
  3.694198732277645*^9}},ExpressionUUID->"b33a8b92-dce3-4ca0-8ff2-\
1d945815fdbd"]
}, Closed]],

Cell[CellGroupData[{

Cell["PlotDiscrete", "CodeSubsubsection",
 CellChangeTimes->{{3.692706453938294*^9, 
  3.692706455938785*^9}},ExpressionUUID->"83ce64f1-7d6d-4eb1-a477-\
4c74d16123d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemSpectrumPlotDiscrete", "]"}], "=", "\n", "\t", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "@", "ListLinePlot"}], ",", 
     RowBox[{"ColorRules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"_", "->", 
        RowBox[{"Hue", "[", 
         RowBox[{".5", ",", ".5", ",", ".5"}], "]"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPlotDiscrete", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"lines", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "NumericQ"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"weights", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"__", "?", "NumericQ"}], "}"}], "|", "None"}], ":", "None"}], 
     ",", "\n", "\t", 
     RowBox[{"transitions", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "__Integer", "}"}], ".."}], "}"}], "|", "None"}], ":", 
      "None"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"data", "=", "\n", "\t\t\t", 
        RowBox[{"Table", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"{", "\n", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lines", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lines", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"weights", "===", "None"}], ",", "\n", 
                "\t\t\t\t\t\t\t", "1", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"weights", "[", 
                 RowBox[{"[", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "@", "weights"}], ",", "1"}], "]"}], 
                  " ", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
             "}"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "lines"}]}], "}"}]}], "\n", "\t\t\t\t", 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"coloring", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"transitions", "===", "None"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Hue", "[", 
           RowBox[{".5", ",", ".5", ",", ".5"}], "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"PadRight", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{"transitions", "/.", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "ColorRules"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"_Integer", ",", "___"}], "}"}], "->", 
                   RowBox[{"Hue", "[", 
                    RowBox[{".5", ",", ".5", ",", ".5"}], "]"}]}]}], 
                 "}"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Length", "@", "lines"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Hue", "[", 
             RowBox[{".5", ",", ".5", ",", ".5"}], "]"}]}], "\n", 
           "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"ListLinePlot", "[", "\n", "\t\t\t", 
      RowBox[{"data", ",", "\n", "\t\t\t", 
       RowBox[{"PlotStyle", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "@", "PlotStyle"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{"Not", "@*", 
                RowBox[{"FreeQ", "[", "Automatic", "]"}]}], ")"}]}], "->", 
             "\n", "\t\t\t\t\t\t", 
             RowBox[{"Directive", "@@@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{"Thin", ",", "coloring"}], "}"}]}]}]}], ",", "\n", 
            "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"d_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"FreeQ", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"_", "?", "ColorQ"}], ",", "\[Infinity]"}], "]"}], 
                "&"}], ")"}]}], ":>", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Directive", "@@", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Append", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "d", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"Directive", "[", "a__", "]"}], "\[RuleDelayed]", 
                    "a"}], ",", "1"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                   "#"}], "]"}]}], "&"}], ",", "\n", "\t\t\t\t\t\t\t", 
               "coloring"}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
           "\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ops", ",", "\n", "\t\t\t\t", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "0"}], "}"}]}], ",", "\n", "\t\t\t\t", 
           
           RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Large", ",", "Automatic"}], "}"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{"1", "/", "3"}]}]}], "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Options", "@", "ListLinePlot"}]}], "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPlotDiscrete", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"a_Association", "|", 
      RowBox[{"ChemSpectrum", "[", "a_Association", "]"}]}], ",", "\n", "\t", 
     "ops___"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumPlotDiscrete", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"a", "[", "\"\<Frequencies\>\"", "]"}], ",", "\n", "\t\t", 
     RowBox[{"Lookup", "[", 
      RowBox[{"a", ",", "\"\<Weights\>\"", ",", "None"}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Lookup", "[", 
      RowBox[{"a", ",", "\"\<Transitions\>\"", ",", "None"}], "]"}], ",", 
     "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692706459148477*^9, 3.692706796493235*^9}, {
   3.6927068279585533`*^9, 3.692707005717725*^9}, {3.692707049751247*^9, 
   3.692707069459508*^9}, {3.6927071297441196`*^9, 3.692707169623537*^9}, {
   3.6927072025995283`*^9, 3.692707238381518*^9}, {3.6927074488073177`*^9, 
   3.692707481381033*^9}, {3.692707522628809*^9, 3.692707619352401*^9}, {
   3.692708338565784*^9, 3.692708349301138*^9}, {3.692708414816724*^9, 
   3.6927085406706133`*^9}, {3.692708572685569*^9, 3.6927086287465477`*^9}, {
   3.692708941696658*^9, 3.692708950135118*^9}, {3.692708991071208*^9, 
   3.6927090763646183`*^9}, {3.692733643028803*^9, 3.69273365578179*^9}, {
   3.6942533534773684`*^9, 3.694253495647408*^9}, {3.694253677349635*^9, 
   3.6942536812440767`*^9}, {3.694253713171486*^9, 3.694253742928543*^9}, 
   3.694253916424539*^9, {3.694269474220757*^9, 
   3.6942695321117077`*^9}},ExpressionUUID->"2555089b-2204-4169-880d-\
7dd0d437e832"]
}, Closed]],

Cell[CellGroupData[{

Cell["Viewer", "CodeSubsubsection",
 CellChangeTimes->{{3.692706447323709*^9, 
  3.692706448370743*^9}},ExpressionUUID->"8a6050e8-714c-455f-bbde-\
af480fb9cdcb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemSpectrumViewer", "]"}], "=", "\n", "\t", 
   RowBox[{"DeleteDuplicatesBy", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Options", "@", "ChemSpectrumPlot"}], ",", 
       RowBox[{"Options", "@", "ChemSpectrumPlotDiscrete"}]}], "]"}], ",", 
     "First"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumViewer", "[", "\n", "\t", 
    RowBox[{"spectrum_ChemSpectrum", ",", "\[IndentingNewLine]", 
     RowBox[{"rangeStart", ":", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_Scaled", "|", 
           RowBox[{"_", "?", "NumericQ"}]}], ",", 
          RowBox[{"_Scaled", "|", 
           RowBox[{"_", "?", "NumericQ"}]}]}], "}"}], ",", "\n", "\t\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_Scaled", "|", 
           RowBox[{"_", "?", "NumericQ"}]}], ",", 
          RowBox[{"_Scaled", "|", 
           RowBox[{"_", "?", "NumericQ"}]}]}], "}"}]}], "\n", "\t\t", "}"}], 
      ":", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".25", "]"}], ",", 
          RowBox[{"Scaled", "[", ".75", "]"}]}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"0.035", ",", 
          RowBox[{"Scaled", "[", "1", "]"}]}], "}"}]}], "\n", "\t\t\t", 
       "}"}]}], ",", "\n", "\t", 
     RowBox[{"plotFuntion", ":", 
      RowBox[{
      "ChemSpectrumPlot", "|", "ChemSpectrumPlotDiscrete", "|", "Automatic"}],
       ":", "Automatic"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plotF", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"plotFuntion", ",", "\n", "\t\t\t", 
         RowBox[{"Automatic", "\[RuleDelayed]", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"First", "@", "spectrum"}], ",", "_List", ",", 
            "ChemSpectrumPlot", ",", "_", ",", "ChemSpectrumPlotDiscrete"}], 
           "]"}]}]}], "\n", "\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"d", "=", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Large", "|", "Automatic"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"600", ",", 
                 RowBox[{"600", "/", "3"}]}], "}"}]}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Small", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"250", ",", 
                 RowBox[{"250", "/", "3"}]}], "}"}]}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"e", ":", 
                RowBox[{"{", 
                 RowBox[{"_", ",", "_"}], "}"}]}], "\[RuleDelayed]", "e"}], 
              ",", "\n", "\t\t\t\t\t", 
              RowBox[{"_", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"150", ",", 
                 RowBox[{"150", "/", "3"}]}], "}"}]}]}], "\n", "\t\t\t\t\t", 
             "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"R", "=", 
          RowBox[{"Range", "@", "spectrum"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"M", "=", 
          RowBox[{"MinMax", "@", "spectrum"}]}]}], "}"}], ",", "\n", 
       "\t\t\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"rMinS", "=", "\n", "\t", "\t\t\t\t\t\t", 
            RowBox[{"Max", "@", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"rangeStart", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Scaled", "[", "s_", "]"}], "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", "R"}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "@", "R"}], "-", 
                    RowBox[{"First", "@", "R"}]}], ")"}], ")"}]}]}], 
                   ")"}]}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
               RowBox[{"First", "@", "R"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", 
              "}"}]}]}], ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"rMaxS", "=", "\n", "\t", "\t\t\t\t\t\t", 
            RowBox[{"Min", "@", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"rangeStart", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Scaled", "[", "s_", "]"}], "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", "R"}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "@", "R"}], "-", 
                    RowBox[{"First", "@", "R"}]}], ")"}], ")"}]}]}], 
                   ")"}]}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Last", "@", "R"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", 
              "}"}]}]}], ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"hMinS", "=", "\n", "\t", "\t\t\t\t\t\t", 
            RowBox[{"Max", "@", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"rangeStart", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Scaled", "[", "s_", "]"}], "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", "M"}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "@", "M"}], "-", 
                    RowBox[{"First", "@", "M"}]}], ")"}], ")"}]}]}], 
                   ")"}]}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
               RowBox[{"First", "@", "M"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", 
              "}"}]}]}], ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"hMaxS", "=", "\n", "\t", "\t\t\t\t\t\t", 
            RowBox[{"Max", "@", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"rangeStart", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Scaled", "[", "s_", "]"}], "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", "M"}], "+", 
                    RowBox[{"s", "*", 
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Last", "@", "M"}], "-", 
                    RowBox[{"First", "@", "M"}]}], ")"}], ")"}]}]}], 
                   ")"}]}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Last", "@", "M"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", 
              "}"}]}]}]}], "\n", "\t", "\t\t\t\t\t", "}"}], ",", "\n", "\t", 
         "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"DynamicModule", "[", "\n", "\t", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rRange", ",", "hRange", ",", "applyUpdates"}], "}"}], 
            ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Panel", "@", "\n", "\t", "\t\t\t\t\t\t\t", 
             RowBox[{"Grid", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Panel", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Column", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "EventHandler", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Dynamic", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "applyUpdates", ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"plotF", "[", 
                    RowBox[{
                    RowBox[{"spectrum", "[", 
                    RowBox[{"rRange", ",", "hRange"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", "d"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"rRange", ",", "hRange"}], "}"}]}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "ops"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"SynchronousUpdating", "\[Rule]", "False"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", "applyUpdates", "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"applyUpdates", "=", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "EventHandler", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Scanning Range: \>\"", ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "InputField", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Dynamic", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"rRange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", ".001"}], "]"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"rRange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "@", "R"}], ",", "#"}], "}"}]}]}], ";"}],
                     "&"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "Number", ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "InputField", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Dynamic", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"rRange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", ".001"}], "]"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"rRange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Last", "@", "R"}], ",", "#"}], "}"}]}]}], ";"}], 
                    "&"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "Number", ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "]"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t",
                     "}"}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Intensity Range: \>\"", ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "InputField", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Dynamic", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"hRange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", ".001"}], "]"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"hRange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "@", "M"}], ",", "#"}], "}"}]}]}], ";"}],
                     "&"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "Number", ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "InputField", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Dynamic", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"hRange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", ".001"}], "]"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"hRange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Last", "@", "M"}], ",", "#"}], "}"}]}]}], ";"}], 
                    "&"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "Number", ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "]"}]}], "}"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alignment", "\[Rule]", "Left"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<ReturnKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"applyUpdates", "=", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dividers", "\[Rule]", "Center"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"hRange", ",", 
                    RowBox[{"{", 
                    RowBox[{"hMinS", ",", "hMaxS"}], "}"}], ",", "\"\<\>\""}],
                     "}"}], ",", 
                    RowBox[{"First", "@", "M"}], ",", 
                    RowBox[{"Last", "@", "M"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"25", ",", 
                    RowBox[{"Last", "@", "d"}]}], "}"}]}], ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "\[Rule]", "IntervalSlider"}], ",",
                     "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Vertical\>\""}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "~", 
                    "EventHandler", "~", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"applyUpdates", "=", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t\t\t\t", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rRange", ",", 
                    RowBox[{"{", 
                    RowBox[{"rMinS", ",", "rMaxS"}], "}"}], ",", "\"\<\>\""}],
                     "}"}], ",", 
                    RowBox[{"First", "@", "R"}], ",", 
                    RowBox[{"Last", "@", "R"}], ",", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "@", "d"}], ",", "25"}], "}"}]}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "\[Rule]", "IntervalSlider"}], ",",
                     "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "~", "EventHandler", 
                   "~", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"applyUpdates", "=", 
                    RowBox[{"RandomReal", "[", "]"}]}], ")"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t\t\t\t",
                 "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"Alignment", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Left", ",", "Top"}], "}"}]}]}], "\n", "\t", 
              "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t\t\t\t\t\t", 
            RowBox[{"SynchronousInitialization", "\[Rule]", "False"}], ",", 
            "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"SaveDefinitions", "\[Rule]", "False"}]}], "\n", 
           "\t\t\t\t\t\t\t", "]"}], "//", "Deploy"}]}], "\n", "\t\t\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692545062885564*^9, 3.6925451182218657`*^9}, {
   3.692546121174065*^9, 3.692546121330741*^9}, {3.6925461933005323`*^9, 
   3.692546399956238*^9}, {3.692546444329301*^9, 3.692546492052746*^9}, 
   3.6925465221479588`*^9, {3.692546572699649*^9, 3.692546592595151*^9}, {
   3.6925466450919228`*^9, 3.6925466492691708`*^9}, {3.69254669256038*^9, 
   3.692546721198326*^9}, {3.6925467531154013`*^9, 3.692546782750926*^9}, {
   3.692546823709564*^9, 3.692546838865834*^9}, {3.692546924101214*^9, 
   3.6925469335394793`*^9}, {3.692547023955546*^9, 3.692547051976796*^9}, {
   3.692547131011273*^9, 3.692547140640513*^9}, 3.692547273459306*^9, {
   3.692547384959654*^9, 3.692547403011846*^9}, {3.692547441048815*^9, 
   3.692547501206338*^9}, {3.692547584889596*^9, 3.69254759338542*^9}, {
   3.6925476807778263`*^9, 3.692547837449996*^9}, {3.692547888522107*^9, 
   3.6925479111850433`*^9}, {3.69254805323204*^9, 3.692548166507259*^9}, {
   3.692548208514221*^9, 3.692548225656069*^9}, {3.6925482767240257`*^9, 
   3.692548277354185*^9}, {3.692548312584218*^9, 3.692548454769355*^9}, {
   3.6925484947298813`*^9, 3.692548558457313*^9}, {3.692548690257773*^9, 
   3.6925487221195107`*^9}, {3.6925487666188097`*^9, 3.692549030008174*^9}, {
   3.692549060539377*^9, 3.692549083185199*^9}, {3.6925492510469217`*^9, 
   3.6925493371780453`*^9}, {3.692549381166993*^9, 3.692549419379305*^9}, {
   3.692549450132043*^9, 3.692549693205385*^9}, {3.692549745111117*^9, 
   3.692549780236944*^9}, {3.692549812974393*^9, 3.692549990340683*^9}, {
   3.692550109037491*^9, 3.692550127312114*^9}, {3.692550178441023*^9, 
   3.692550276494862*^9}, {3.692550339134099*^9, 3.6925507409853487`*^9}, 
   3.692550813542149*^9, {3.6925508708388453`*^9, 3.692550894229773*^9}, {
   3.692550947076222*^9, 3.692550956813526*^9}, {3.692551000124752*^9, 
   3.692551003798066*^9}, {3.6925510472238483`*^9, 3.692551080438509*^9}, {
   3.692551130281241*^9, 3.6925511683734837`*^9}, {3.692551952355123*^9, 
   3.692552113968128*^9}, 3.692552250194817*^9, {3.6925522908109617`*^9, 
   3.692552344860888*^9}, {3.692552378395321*^9, 3.6925524371760807`*^9}, {
   3.692552641855139*^9, 3.6925526639808273`*^9}, {3.692552709707861*^9, 
   3.6925529278367977`*^9}, {3.692552964635367*^9, 3.692553003297995*^9}, {
   3.692553048592125*^9, 3.692553056193289*^9}, {3.6925530883830767`*^9, 
   3.6925531754925003`*^9}, {3.692553232412825*^9, 3.69255353392712*^9}, {
   3.692553575465601*^9, 3.6925535760812063`*^9}, {3.692553618448456*^9, 
   3.692553671868853*^9}, {3.692553729569564*^9, 3.69255375922281*^9}, {
   3.692553964010062*^9, 3.6925540183984327`*^9}, {3.692554281123765*^9, 
   3.6925542926999187`*^9}, {3.692554471773919*^9, 3.692554635637738*^9}, {
   3.6925548570232153`*^9, 3.692554950730009*^9}, {3.692555013461095*^9, 
   3.692555025357078*^9}, {3.6925575732688704`*^9, 3.692557624532596*^9}, {
   3.6925576576538258`*^9, 3.69255795239137*^9}, {3.692558025855132*^9, 
   3.6925580347332783`*^9}, {3.692558082018556*^9, 3.6925581556309967`*^9}, {
   3.692558325351795*^9, 3.6925583604867487`*^9}, {3.692558409833008*^9, 
   3.692558418577529*^9}, {3.692558475499621*^9, 3.692558527490407*^9}, {
   3.692558600712235*^9, 3.6925586107677402`*^9}, {3.6925586625308*^9, 
   3.69255867781776*^9}, {3.6925587233742123`*^9, 3.6925587351988087`*^9}, {
   3.692558781839747*^9, 3.692559020848628*^9}, {3.692559155899665*^9, 
   3.6925591585238247`*^9}, {3.692559192701552*^9, 3.692559272676043*^9}, {
   3.69255931973107*^9, 3.6925593392524157`*^9}, {3.692559436648149*^9, 
   3.692559443280073*^9}, {3.692559485606977*^9, 3.692559485772688*^9}, {
   3.6927063679100513`*^9, 3.692706371938973*^9}, {3.692724969090727*^9, 
   3.6927251469477987`*^9}, {3.6927314940808973`*^9, 3.692731512384388*^9}, {
   3.692731760994939*^9, 3.692731839033968*^9}, {3.692731967493517*^9, 
   3.692731985982205*^9}, {3.692732025636302*^9, 3.692732040463317*^9}, {
   3.692732085816539*^9, 3.692732089878212*^9}, {3.692732192236877*^9, 
   3.692732192610886*^9}, {3.692732333661099*^9, 3.692732475602282*^9}, {
   3.692732508174835*^9, 3.692732544161498*^9}, {3.6927325790832367`*^9, 
   3.6927325992156057`*^9}, {3.6927326368670807`*^9, 3.692732759431904*^9}, {
   3.692732799156736*^9, 3.692732862656961*^9}, {3.692732897028389*^9, 
   3.6927329300311623`*^9}, {3.69273298174634*^9, 3.692733038410234*^9}, {
   3.69273316778623*^9, 3.692733179053772*^9}, {3.692733317451252*^9, 
   3.6927334329035463`*^9}, {3.692733474992029*^9, 
   3.692733476669183*^9}},ExpressionUUID->"7113540d-38ac-4558-ac44-\
07852e3310b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineStore", "CodeSubsubsection",
 CellChangeTimes->{{3.6942153957482433`*^9, 3.69421539721105*^9}, {
  3.694255767010961*^9, 
  3.6942557695009193`*^9}},ExpressionUUID->"f9581dae-cdaa-4ee7-8730-\
03f74e56d0a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumLineStore", "[", 
    RowBox[{
    "sym_", ",", "pos_", ",", "scaling_", ",", "spectra_", ",", "\n", "\t", 
     RowBox[{"selectFrom", ":", 
      RowBox[{
      "_InterpolatingFunction", "|", "_Composition", "|", "_Integer"}], ":", 
      "1"}]}], "\n", "\t", "]"}], ":=", 
   RowBox[{"(", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"sym", ",", "_Symbol"}], "]"}], ",", 
       RowBox[{"sym", "=", 
        RowBox[{"{", "}"}]}]}], "]"}], ";", "\n", "\t", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"sym", ",", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"selectFrom", ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"f", ":", 
             RowBox[{"(", 
              RowBox[{"First", "@*", "First", "@*", "_NearestFunction"}], 
              ")"}]}], ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"f", "@", "pos"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"ChemSpectrumNearestPeak", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Replace", "[", 
               RowBox[{
               "selectFrom", ",", "\n", "\t", "\t", "\t", "\t\t\t\t", 
                RowBox[{"i_Integer", ":>", 
                 RowBox[{"spectra", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}], "\n", "\t", "\t", "\t", 
               "\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t", "\t\t\t", 
              "pos"}], "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumLineStore", "[", 
     RowBox[{"sym_", ",", "\n", "\t", 
      RowBox[{"selectFrom", ":", 
       RowBox[{
       "_Composition", "|", "_InterpolatingFunction", "|", "_Integer"}], ":", 
       "1"}]}], "]"}], "[", "a___", "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumLineStore", "[", 
    RowBox[{"sym", ",", "a", ",", "selectFrom"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrumLineStore", "~", "SetAttributes", "~", "HoldFirst"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694206253433392*^9, 3.694206353228972*^9}, {
  3.694215035756522*^9, 3.694215220696947*^9}, {3.694215341476959*^9, 
  3.694215370186327*^9}, {3.694215983627857*^9, 3.694215995586297*^9}, {
  3.694216076498149*^9, 3.694216144991806*^9}, {3.694255368705681*^9, 
  3.6942553704223433`*^9}, {3.694255634525524*^9, 
  3.6942556365226583`*^9}},ExpressionUUID->"2df23f55-bb6e-4d3e-8753-\
067ff59c9b83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrumLineStore", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Normal", "@", 
     RowBox[{"ChemSpectrumLineStore", "[", 
      RowBox[{"s_", ",", "___"}], "]"}]}], "]"}], ":=", "\n", "\t\t", "s"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrumLineStore", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"ChemSpectrum", "@", 
     RowBox[{"ChemSpectrumLineStore", "[", 
      RowBox[{"s_", ",", "___"}], "]"}]}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"ChemSpectrum", "@", "s"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrumLineStore", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"ChemSpectrumPlot", "[", 
     RowBox[{
      RowBox[{"ChemSpectrumLineStore", "[", 
       RowBox[{"s_", ",", "___"}], "]"}], ",", "ops___"}], "]"}], "]"}], ":=",
    "\n", "\t\t", 
   RowBox[{"ChemSpectrumPlotDiscrete", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"AssociationThread", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Frequencies\>\"", ",", "\"\<Weights\>\"", ",", 
         "\"\<Transitions\>\""}], "}"}], ",", "\n", "\t", "\t\t\t", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"s", ",", "List"}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"Length", "@", "s"}]}], "]"}]}], "]"}]}], "\n", "\t\t\t\t",
       "]"}], ",", "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{"\t"}]}], "CodeInput",
 CellChangeTimes->{{3.694255706185174*^9, 3.694255718119149*^9}, {
  3.6942557919567823`*^9, 3.694255796308687*^9}, {3.694257913192411*^9, 
  3.694257927151349*^9}, {3.694257967917494*^9, 
  3.694258097316416*^9}},ExpressionUUID->"b3f2295c-9960-44ce-9fd1-\
f6fecdfdf246"]
}, Closed]],

Cell[CellGroupData[{

Cell["LineSelector", "CodeSubsubsection",
 CellChangeTimes->{{3.694206224939355*^9, 
  3.694206227738223*^9}},ExpressionUUID->"3b0b659f-e524-45bd-90d9-\
ff478ac1d96d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumLineSelector", "[", "\n", "\t", 
   RowBox[{
   "spectrumA_ChemSpectrum", ",", "others___ChemSpectrum", ",", "\n", "\t", 
    RowBox[{"selectFunction", ":", "\n", "\t\t", 
     RowBox[{"Except", "[", 
      RowBox[{
      "_ChemSpectrum", "|", "_Rule", "|", "_RuleDelayed", "|", "_String"}], 
      "]"}], ":", "\n", "\t\t", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Print", "[", "#1", "]"}], "&"}], ")"}]}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "..."}]}]}], "]"}], ":=",
   "\n", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"spectra", "=", "\n", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pr", "=", 
          RowBox[{"Last", "@", 
           RowBox[{"First", "@", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ops", ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "}"}], ",", 
              "PlotRange"}], "]"}]}]}]}], "}"}], ",", "\n", "\t", 
        RowBox[{"MapThread", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{"#2", ",", "\n", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", 
                RowBox[{"-", "\[Infinity]"}], "|", "_Scaled"}], ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", "\[Infinity]", "|", 
                "_Scaled"}]}], "}"}], ",", "\n", "\t\t\t\t", 
             RowBox[{"#", "[", 
              RowBox[{"All", ",", "#2"}], "]"}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{"#", "[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"#2", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", "\n",
              "\t\t\t", "_", ",", "\n", "\t\t\t\t", "#"}], "\n", "\t\t\t", 
            "]"}], "&"}], ",", "\n", "\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"spectrumA", ",", "others"}], "}"}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"Switch", "[", 
             RowBox[{"pr", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", 
                  RowBox[{"-", "\[Infinity]"}], "|", "_Scaled"}], ",", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", "\[Infinity]", "|", 
                  "_Scaled"}]}], "}"}], "|", 
               RowBox[{"Except", "[", "_List", "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"pr", ",", 
                RowBox[{"Length", "@", 
                 RowBox[{"{", 
                  RowBox[{"spectrumA", ",", "others"}], "}"}]}]}], "]"}], ",",
               "\n", "\t\t\t\t\t\t", "_", ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"PadRight", "[", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"pr", ",", 
                  RowBox[{"UpTo", "[", 
                   RowBox[{"Length", "@", 
                    RowBox[{"{", 
                    RowBox[{"spectrumA", ",", "others"}], "}"}]}], "]"}]}], 
                 "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Length", "@", 
                 RowBox[{"{", 
                  RowBox[{"spectrumA", ",", "others"}], "}"}]}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", "All"}], "]"}]}], "\n", "\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", 
       "]"}]}], "}"}], ",", "\t", "\n", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t", 
       RowBox[{
        RowBox[{"plots", "=", "\n", "\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t", 
            RowBox[{"ps", "=", 
             RowBox[{"Last", "@", 
              RowBox[{"First", "@", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"ops", ",", 
                   RowBox[{"PlotStyle", "\[Rule]", "Automatic"}]}], "}"}], 
                 ",", "PlotStyle"}], "]"}]}]}]}], "\n", "\t\t\t", "}"}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"ChemSpectrumPlot", "[", "\n", "\t\t\t\t\t", 
               RowBox[{"#", ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"#2", ",", "\n", "\t\t\t\t\t\t", 
                   RowBox[{"FilterRules", "[", 
                    RowBox[{
                    RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"DeleteCases", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Keys", "@", 
                    RowBox[{"Merge", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Options", "@", "ChemSpectrumPlot"}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{"Options", "@", "ChemSpectrumPlotDiscrete"}]}], 
                    "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", "First"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotStyle", "|", "PlotRange"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
               "\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t\t", 
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{"spectra", ",", "\n", "\t\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"directives", "=", 
                   RowBox[{"(", 
                    RowBox[{
                    "_Symbol", "|", "_Directive", "|", "_Opacity", "|", 
                    "_Thickness", "|", "_RGBColor", "|", "_Hue"}], ")"}]}], 
                  "}"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"TrueQ", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"ps", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"directives", "|", 
                    RowBox[{"{", 
                    RowBox[{"directives", ".."}], "}"}]}], ")"}], ".."}], 
                    "}"}]}], "]"}], "&&", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Length", "@", "ps"}], "\[Equal]", 
                    RowBox[{"Length", "@", "spectra"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "#", "}"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"d", ":", 
                    RowBox[{"directives", "|", 
                    RowBox[{"{", 
                    RowBox[{"directives", ".."}], "}"}]}]}], ":>", "\n", "\t",
                     "\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"PlotStyle", "\[Rule]", "d"}], ")"}]}], ",", "\n",
                     "\t", "\t\t\t\t\t\t\t", "1"}], "]"}], "&"}], "/@", 
                    "ps"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "ps", "}"}]}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Length", "@", "spectra"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                  "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
              "}"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], ",", "\n", "\t", 
        RowBox[{"selF", "=", "\n", "\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"selectFunction", ",", 
           RowBox[{"{", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"ChemSpectrumLineStore", "[", "s_", "]"}], ":>", "\n", 
             "\t\t\t\t", 
             RowBox[{"ChemSpectrumLineStore", "[", 
              RowBox[{"s", ",", 
               RowBox[{"Interpolation", "@", 
                RowBox[{"Last", "@", "spectra"}]}]}], "]"}]}], "\n", "\t\t\t",
             "}"}]}], "]"}]}], ",", "\n", "\t", 
        RowBox[{"R", "=", 
         RowBox[{"Range", "@", "spectrumA"}]}], ",", "\n", "\t", 
        RowBox[{"S", "=", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"Reverse", "@", 
           RowBox[{"Range", "@", "spectrumA"}]}]}]}], ",", "\n", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"MinMax", "/@", "spectra"}]}], ",", "\n", "\t", 
        RowBox[{"makeDialog", "=", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"First", "@", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ops", ",", 
                RowBox[{"CreateDialog", "\[Rule]", "True"}]}], "}"}], ",", 
              "CreateDialog"}], "]"}]}]}]}]}], ",", "\n", "\t", 
        RowBox[{"cachedPoints", "=", "\n", "\t\t", 
         RowBox[{"Last", "@", 
          RowBox[{"First", "@", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ops", ",", "\n", "\t\t\t", 
               RowBox[{"\"\<CachedPoints\>\"", "\[Rule]", "\n", "\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{"selectFunction", ",", 
                  RowBox[{"{", "\n", "\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"c", ":", 
                    RowBox[{"ChemSpectrumLineStore", "[", 
                    RowBox[{"s_", ",", "___"}], "]"}]}], "\[RuleDelayed]", 
                    "c"}], ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"_", "\[Rule]", 
                    RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], 
                 "]"}]}]}], "\n", "\t\t\t\t", "}"}], ",", 
             "\"\<CachedPoints\>\""}], "]"}]}]}]}], ",", "\n", "\t", 
        RowBox[{"singlePlot", "=", 
         RowBox[{"(", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "spectra"}], "\[Equal]", "1"}], "||", "\n",
            "\t\t", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"Last", "@", 
             RowBox[{"First", "@", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ops", ",", 
                  RowBox[{"Overlay", "\[Rule]", "False"}]}], "}"}], ",", 
                "Overlay"}], "]"}]}]}]}]}], "\n", "\t\t", ")"}]}], ",", "\n", 
        "\t", 
        RowBox[{"WH", "=", "\n", "\t\t", 
         RowBox[{"Replace", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ops", ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"500", ",", "250"}], "}"}]}]}], "}"}], ",", 
              "ImageSize"}], "]"}]}], ",", 
           RowBox[{"{", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"w_", ",", "h_"}], "}"}]}], ")"}], ":>", "\n", 
              "\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{"w", ",", 
                  RowBox[{
                   RowBox[{"Except", "[", "_Integer", "]"}], "\[RuleDelayed]",
                    "500"}]}], "]"}], ",", 
                RowBox[{"Replace", "[", 
                 RowBox[{"h", ",", 
                  RowBox[{
                   RowBox[{"Except", "[", "_Integer", "]"}], "\[RuleDelayed]",
                    "250"}]}], "]"}]}], "}"}]}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ImageSize", "\[Rule]", "w_"}], ")"}], ":>", "\n", 
              "\t\t\t\t", 
              RowBox[{"{", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{"w", ",", 
                  RowBox[{
                   RowBox[{"Except", "[", "_Integer", "]"}], "\[RuleDelayed]",
                    "500"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{".5", "*", 
                 RowBox[{"Replace", "[", 
                  RowBox[{"w", ",", 
                   RowBox[{
                    RowBox[{"Except", "[", "_Integer", "]"}], 
                    "\[RuleDelayed]", "500"}]}], "]"}]}]}], "\n", 
               "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}]}], 
       "}"}], ",", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "Display"}]}]}]}]}]}]}]}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Window", "--"}], "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}], "--"}], "--"}], "--"}]}], "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"DynamicModule", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t", 
          RowBox[{"raster", ",", "update", ",", "\n", "\t\t", 
           RowBox[{"windowWidth", "=", 
            RowBox[{"First", "@", "WH"}]}], ",", "\n", "\t\t", 
           RowBox[{"windowHeight", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Last", "@", "WH"}], ")"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{"singlePlot", ",", "1", ",", 
               RowBox[{"Length", "@", "plots"}]}], "]"}]}]}], ",", "\n", 
           "\t\t", "r", ",", "m", ",", 
           RowBox[{"rOld", "=", "0"}], ",", "v", ",", 
           RowBox[{"vOld", "=", "0"}], ",", 
           RowBox[{"doFast", "=", "False"}], ",", 
           RowBox[{"failSize", "=", "0.01"}]}], "}"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Panel", "@", "\n", "\t\t\t", 
           RowBox[{"Grid", "@", 
            RowBox[{"{", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"DynamicWrapper", "[", "\n", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"update", ";", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Overlay", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "Main"}]}]}]}]}]}]}]}]}], " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Graphic", "--"}], "--"}], "--"}], "--"}], "--"}],
                     "--"}], "--"}], "--"}], "--"}], "--"}]}], "*)"}], "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Graphics", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Inset", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"raster", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"raster", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "g_Graphics", "\[RuleDelayed]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Show", "[", 
                    RowBox[{"g", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "PlotRange", "\[Rule]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"PlotRange", "@", "g"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"1", "->", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m", "-", 
                    RowBox[{"r", "/", "2"}]}], ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"r", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "R"}], "]"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], "*)"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Scaled", "@", 
                    RowBox[{"{", 
                    RowBox[{".5", ",", "0"}], "}"}]}], ",", 
                    RowBox[{"Scaled", "@", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "0"}], "}"}]}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "PlotRange", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "windowWidth"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "windowHeight"}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"windowWidth", ",", 
                    RowBox[{"windowHeight", "-", "25"}]}], "}"}]}], ",", "\n",
                     "\t\t\t\t\t\t\t\t", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "Cursor"}]}]}]}]}]}]}]}]}], " ", "+", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Labels", "--"}], "--"}], "--"}], "--"}], 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}], "*)"}], "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Thin", ",", 
                    RowBox[{"Opacity", "[", ".5", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Line", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{".5", ",", 
                    RowBox[{"(", 
                    RowBox[{"20", "/", "windowHeight"}], ")"}]}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{".5", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"GrayLevel", "[", ".3", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Inset", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Rescale", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "R"}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{".5", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Center", ",", "Bottom"}], "}"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Inset", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Rescale", "[", 
                    RowBox[{
                    RowBox[{"m", "-", 
                    RowBox[{"r", "/", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "R"}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Bottom"}], "}"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Inset", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Rescale", "[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"r", "/", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "R"}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Right", ",", "Bottom"}], "}"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t", "Green", ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Between", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m", "-", 
                    RowBox[{"r", "/", "2"}]}], ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"r", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "R"}], "]"}]}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"(", 
                    RowBox[{"25", "/", "windowHeight"}], ")"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "Nothing"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"Normal", "@", "cachedPoints"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f_", ",", "_"}], "}"}], "\[RuleDelayed]", "f"}], 
                    ",", "1"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}], 
                    ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"l", ":", 
                    RowBox[{"{", "__", "}"}]}], "\[RuleDelayed]", 
                    RowBox[{"Point", "@", "l"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "\[RuleDelayed]", "Nothing"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"windowWidth", ",", "windowHeight"}], "}"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", "None"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageMargins", "\[Rule]", "None"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"windowWidth", ",", "windowHeight"}], "}"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Center", ",", "Top"}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t", "]"}], "//", 
                    RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{"#", ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", ".75", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"BaseStyle", "\[Rule]", "\"\<Panel\>\""}]}], 
                    "]"}], "&"}]}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "raster"}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", "Generate"}]}]}]}]}]}]}]}]}], " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Graphic", "--"}], "--"}], "--"}], "--"}], "--"}],
                     "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}],
                     "*)"}], "\n", "\t\t\t\t\t", 
                   RowBox[{"raster", "=", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"dims", "=", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"windowWidth", "/", "r"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"windowHeight", "/", 
                    RowBox[{"If", "[", 
                    RowBox[{"singlePlot", ",", "1", ",", 
                    RowBox[{"Length", "@", "plots"}]}], "]"}]}], ")"}], "-", 
                    "10"}]}], "\n", "\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"baseOps", "=", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "@", "dims"}], ",", 
                    RowBox[{"Last", "@", "dims"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", "All"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Ticks", "\[Rule]", "None"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Axes", "->", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageMargins", "\[Rule]", "None"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"graphic", "=", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{"singlePlot", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Show", "[", 
                    RowBox[{"plots", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sequence", "@@", "baseOps"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"R", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "0"}], 
                    "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Max", "@", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "*", "v"}]}], 
                    "}"}]}], "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Column", "@", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Reverse", "@", 
                    RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{"#", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sequence", "@@", "baseOps"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"R", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "#2"}], ",", "0"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Last", "@", "#2"}], "*", "v"}]}], "}"}]}], 
                    "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"plots", ",", "M"}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t",
                     "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"makeDialog", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"SetOptions", "[", 
                    RowBox[{
                    RowBox[{"EvaluationNotebook", "[", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowStatusArea", "\[Rule]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"TemplateApply", "[", 
                    RowBox[{
                    "\"\<Horizontal Scaling: ``%| Vertical Scaling: ``%\>\"", 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"100", "*", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "v"}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", "Try"}]}]}]}]}]}]}]}]}], " ", "to", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"rasterize", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}], "*)"}], "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "<", "failSize"}], "||", 
                    RowBox[{"TrueQ", "@", "doFast"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "graphic", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Quiet", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"g", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Check", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Image", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    RowBox[{"Rasterize", "[", 
                    RowBox[{"graphic", ",", "\"\<Image\>\""}], "]"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"windowWidth", "/", "r"}], ",", "windowHeight"}], 
                    "}"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "graphic"}],
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "$MessageList"}], ">", "0"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"failSize", "=", "r"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "g"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t",
                     "]"}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "v", ",", "doFast"}], "}"}]}]}], "\n", 
                  "\t\t\t\t\t\t", "]"}], "//", "\n", "\t\t\t\t", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", "Plot"}]}]}]}]}]}]}]}]}], " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"EventHandler", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}], "*)"}], "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"EventHandler", "[", 
                   RowBox[{"#", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    "\"\<MouseClicked\>\"", "\[RuleDelayed]", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SelectionMove", "[", 
                    RowBox[{
                    RowBox[{"EvaluationBox", "[", "]"}], ",", "All", ",", 
                    "Expression"}], "]"}], ";", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"CurrentValue", "@", "\"\<ShiftKey\>\""}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"doFast", "=", "True"}], ";", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CurrentValue", "@", "\"\<MouseClickCount\>\""}], 
                    ">", "1"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"CreateDialog", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"raster", "/.", 
                    RowBox[{
                    "g_Graphics", "\[RuleDelayed]", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pr", "=", 
                    RowBox[{"PlotRange", "@", "g"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Show", "[", 
                    RowBox[{"g", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ImageSize", "\[Rule]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"windowWidth", ",", 
                    RowBox[{"windowHeight", "/", 
                    RowBox[{"If", "[", 
                    RowBox[{"singlePlot", ",", "1", ",", 
                    RowBox[{"Length", "@", "plots"}]}], "]"}]}]}], "}"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PlotRange", "->", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Rescale", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m", "-", 
                    RowBox[{"r", "/", "2"}]}], ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"r", "/", "2"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"First", "@", "pr"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Last", "@", "pr"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "WindowMargins", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "Automatic"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "#2"}], "}"}]}], "}"}]}], "&"}],
                     "@@", 
                    RowBox[{
                    "CurrentValue", "[", "\"\<MousePosition\>\"", "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Selectable", "\[Rule]", "True"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowClickSelect", "\[Rule]", "True"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ShowSelection", "\[Rule]", "True"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Editable", "\[Rule]", "False"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Deployed", "\[Rule]", "False"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ShowCellBracket", "\[Rule]", "True"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "]"}], ";"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                   "\t\t\t\t\t", "]"}], "&"}]}], ",", "\n", "\t\t\t", 
                RowBox[{"EventHandler", "[", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Control", "@", 
                   RowBox[{"{", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v", ",", "1"}], "}"}], ",", "1", ",", ".0001", 
                    ",", ".01", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "\[Rule]", "VerticalSlider"}], ",", 
                    RowBox[{"(*", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ImageSize", "\[Rule]", "windowHeight"}], ","}], 
                    "*)"}], "\n", "\t\t\t\t\t\t", 
                    RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "\n", 
                    "\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t", 
                  RowBox[{"{", "\n", "\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "True"}], ")"}]}], ",", "\n", "\t",
                     "\t\t\t\t", 
                    RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "False"}], ")"}]}], ",", "\n", 
                    "\t\t\t\t\t", 
                    RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "\n", 
                   "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
               "\t\t\t\t", "}"}], ",", "\n", "\t\t", 
              RowBox[{"{", "\n", "\t\t\t", 
               RowBox[{"EventHandler", "[", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"Control", "@", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1"}], "}"}], ",", "1", ",", ".0001", 
                    ",", ".01", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"ControlType", "\[Rule]", "Slider"}], ",", "\n", 
                    "\t\t\t\t\t", 
                    RowBox[{"ContinuousAction", "\[Rule]", "True"}], ",", 
                    "\n", "\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", "windowWidth"}]}], "\n", 
                   "\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t", 
                 RowBox[{"{", "\n", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "True"}], ")"}]}], ",", "\n", "\t",
                    "\t\t\t\t", 
                   RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "False"}], ")"}]}], ",", "\n", 
                   "\t\t\t\t\t", 
                   RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "\n", 
                  "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}], "}"}], ",", 
              "\n", "\t\t", 
              RowBox[{"{", "\n", "\t\t\t", 
               RowBox[{"Control", "@", 
                RowBox[{"{", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{
                    RowBox[{"Except", "[", 
                    RowBox[{"_", "?", "NumericQ"}], "]"}], "\[RuleDelayed]", 
                    ".5"}]}], "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t", "0", 
                  ",", "1", ",", "\n", "\t\t\t\t", 
                  RowBox[{"ControlType", "\[Rule]", "Slider"}], ",", "\n", 
                  "\t\t\t\t", 
                  RowBox[{"ContinuousAction", "\[Rule]", "True"}], ",", "\n", 
                  "\t\t\t\t", 
                  RowBox[{"ImageSize", "\[Rule]", "windowWidth"}]}], "\n", 
                 "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", 
             "}"}]}]}], "//", "\n", "\t\t", 
          RowBox[{
           RowBox[{"EventHandler", "[", 
            RowBox[{
             RowBox[{"Deploy", "@", "#"}], ",", "\n", "\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"scalingFactor", "=", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Which", "[", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"CurrentValue", "@", "\"\<CommandKey\>\""}], ",", 
                    "\n", "\t\t\t\t\t\t", "10", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"CurrentValue", "@", "\"\<OptionKey\>\""}], ",", 
                    "\n", "\t\t\t\t\t\t", "1000", ",", "\n", "\t\t\t\t\t", 
                    "True", ",", "\n", "\t\t\t\t\t\t", "100"}], "]"}], ")"}], 
                  "&"}]}], "}"}], ",", "\n", "\t\t\t", 
               RowBox[{"{", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "\"\<RightArrowKeyDown\>\"", "\[RuleDelayed]", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"TrueQ", "@", 
                    RowBox[{"CurrentValue", "[", "\"\<ShiftKey\>\"", "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"doFast", "=", "True"}], ";", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"r", "=", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{".001", ",", 
                    RowBox[{"r", "-", 
                    RowBox[{"1", "/", 
                    RowBox[{"scalingFactor", "[", "]"}]}]}]}], "}"}]}]}], 
                    ")"}]}], ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "False"}], ")"}], ";", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"m", "=", 
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"r", "/", 
                    RowBox[{"scalingFactor", "[", "]"}]}]}]}], "}"}]}]}], 
                    ")"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                 "\t\t\t\t", 
                 RowBox[{
                 "\"\<LeftArrowKeyDown\>\"", "\[RuleDelayed]", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"TrueQ", "@", 
                    RowBox[{"CurrentValue", "[", "\"\<ShiftKey\>\"", "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"doFast", "=", "True"}], ";", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"r", "=", 
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "+", 
                    RowBox[{"1", "/", 
                    RowBox[{"scalingFactor", "[", "]"}]}]}]}], "}"}]}]}], 
                    ")"}]}], ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "False"}], ")"}], ";", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"m", "=", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"m", "-", 
                    RowBox[{"(", 
                    RowBox[{"r", "/", 
                    RowBox[{"scalingFactor", "[", "]"}]}], ")"}]}]}], 
                    "}"}]}]}], ")"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
                 "\n", "\t\t\t\t", 
                 RowBox[{
                 "\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"TrueQ", "@", 
                    RowBox[{"CurrentValue", "[", "\"\<ShiftKey\>\"", "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"doFast", "=", "True"}], ";", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"v", "=", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{"0.0001", ",", 
                    RowBox[{"v", "-", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"scalingFactor", "[", "]"}]}], ")"}]}]}], 
                    "}"}]}]}]}], ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "False"}], ")"}], ";"}]}], "\n", 
                   "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                 RowBox[{
                 "\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"TrueQ", "@", 
                    RowBox[{"CurrentValue", "[", "\"\<ShiftKey\>\"", "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"doFast", "=", "True"}], ";", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"v", "=", 
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"v", "+", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"scalingFactor", "[", "]"}]}], ")"}]}]}], 
                    "}"}]}]}], ")"}]}], ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"doFast", "=", "False"}], ")"}], ";"}]}], "\n", 
                   "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                 RowBox[{"\"\<ReturnKeyDown\>\"", "\[RuleDelayed]", 
                  RowBox[{"(", "\n", "\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"selF", "[", 
                    RowBox[{
                    RowBox[{"Rescale", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "R"}], "]"}], ",", 
                    "m", ",", 
                    RowBox[{"{", 
                    RowBox[{"spectrumA", ",", "others"}], "}"}]}], "]"}], ";",
                     "\n", "\t\t\t\t\t", 
                    RowBox[{"update", "=", 
                    RowBox[{"RandomReal", "[", "]"}]}]}], "\n", "\t\t\t\t\t", 
                   ")"}]}], ",", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<MenuCommand\>\"", ",", "\"\<HandleShiftReturn\>\""}], 
                   "}"}], ":>", "\n", "\t\t\t\t\t", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"doFast", "=", "True"}], ";"}], ")"}]}]}], "\n", 
                "\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
            "\t\t\t\t", "]"}], "&"}]}]}], "\n", "\t\t", "]"}], "//", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"makeDialog", ",", "\n", "\t\t\t", 
          RowBox[{"CreateDialog", "[", 
           RowBox[{"#", ",", "\n", "\t\t\t\t", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", 
               RowBox[{"Options", "@", "CreateDialog"}]}], "]"}]}], ",", "\n",
             "\t\t\t\t", 
            RowBox[{"Selectable", "\[Rule]", "True"}], ",", "\n", "\t", "\t", 
            "\t", "\t", 
            RowBox[{"Editable", "\[Rule]", "False"}], ",", "\n", "\t", "\t", 
            "\t", "\t", 
            RowBox[{"Deployed", "\[Rule]", "False"}], ",", "\n", "\t", "\t", 
            "\t", "\t", 
            RowBox[{"ShowSelection", "\[Rule]", "False"}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"WindowElements", "\[Rule]", 
             RowBox[{"{", "\"\<StatusArea\>\"", "}"}]}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"NotebookEventActions", "\[Rule]", 
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"\"\<UpArrowKeyDown\>\"", "\[RuleDelayed]", "Null"}], 
               ",", "\n", "\t\t\t\t\t", 
               RowBox[{"\"\<DownArrowKeyDown\>\"", "\[RuleDelayed]", "Null"}],
                ",", "\n", "\t\t\t\t\t", 
               RowBox[{"PassEventsUp", "\[Rule]", "False"}]}], "\n", 
              "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t", "#"}], "\n", "\t\t\t", "]"}], "&"}]}]}], "\n", "\t", 
     "]"}]}], "\n", "\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6941860852714376`*^9, 3.6941860963436537`*^9}, {
   3.694186204638138*^9, 3.694186246315735*^9}, {3.694186287181645*^9, 
   3.6941863810789623`*^9}, {3.6941864135779037`*^9, 3.694186440097644*^9}, {
   3.694186474013801*^9, 3.6941864775976152`*^9}, {3.694186550706182*^9, 
   3.694186829315707*^9}, {3.6941868641857862`*^9, 3.694186865567227*^9}, {
   3.6941869546571693`*^9, 3.694187140959313*^9}, {3.694187282426774*^9, 
   3.694187324976535*^9}, {3.694187368688376*^9, 3.694187549217869*^9}, {
   3.694187581791774*^9, 3.6941876493656178`*^9}, {3.6941876794054537`*^9, 
   3.694187691469325*^9}, {3.694187736247787*^9, 3.694187738318838*^9}, {
   3.6941877808691273`*^9, 3.694187784132411*^9}, {3.694187837901782*^9, 
   3.694187998038126*^9}, {3.694188073152978*^9, 3.6941881814500647`*^9}, {
   3.694188211630115*^9, 3.694188213284083*^9}, {3.6941893846374483`*^9, 
   3.69418941544938*^9}, {3.694189461139577*^9, 3.694189482942585*^9}, {
   3.694189527813726*^9, 3.694189564619488*^9}, {3.694189692316636*^9, 
   3.694189694979035*^9}, {3.694189749627845*^9, 3.694189808557723*^9}, {
   3.694189847358107*^9, 3.694189849699819*^9}, {3.694190005190775*^9, 
   3.6941900596862097`*^9}, {3.694190098590836*^9, 3.6941901276694717`*^9}, {
   3.694190288343563*^9, 3.694190557553423*^9}, {3.694190595924906*^9, 
   3.6941906181832447`*^9}, {3.694190651829914*^9, 3.69419065220467*^9}, {
   3.694190686960595*^9, 3.694190854469737*^9}, {3.694190896396748*^9, 
   3.694190918499206*^9}, {3.694190949812599*^9, 3.694190957658044*^9}, {
   3.694191008172515*^9, 3.694191042979433*^9}, {3.694191097325027*^9, 
   3.694191171403634*^9}, {3.694191208969307*^9, 3.6941912811407623`*^9}, {
   3.6941913148757887`*^9, 3.69419135139395*^9}, {3.694191435536147*^9, 
   3.694191501332664*^9}, {3.694191545787265*^9, 3.694191617133357*^9}, 
   3.6941916577407*^9, {3.694191734704541*^9, 3.6941918034365263`*^9}, {
   3.6941918380284348`*^9, 3.694191900833075*^9}, {3.694192551594101*^9, 
   3.694192639676044*^9}, {3.694192674555916*^9, 3.694192679361372*^9}, {
   3.6941927168093643`*^9, 3.694192717255834*^9}, {3.694192933374568*^9, 
   3.6941929914334784`*^9}, {3.694193062359874*^9, 3.6941931460595837`*^9}, {
   3.69419319206961*^9, 3.6941931989078712`*^9}, {3.694193236156114*^9, 
   3.694193417467834*^9}, {3.694193505603765*^9, 3.69419350575429*^9}, {
   3.694193716790214*^9, 3.694193724677465*^9}, {3.6941937790768347`*^9, 
   3.6941937824914103`*^9}, {3.6941938619604893`*^9, 3.694193911751589*^9}, {
   3.694193953569549*^9, 3.694193954889031*^9}, {3.694193988188539*^9, 
   3.694193995533162*^9}, {3.694194082075963*^9, 3.694194086897108*^9}, {
   3.6941941442066603`*^9, 3.694194157557729*^9}, {3.694194220172961*^9, 
   3.694194255484188*^9}, {3.694194308630155*^9, 3.694194342827166*^9}, {
   3.694194470591956*^9, 3.694194505299955*^9}, {3.694194545011639*^9, 
   3.694194556541615*^9}, {3.694194833765791*^9, 3.6941948961108503`*^9}, {
   3.694194958683919*^9, 3.6941949982853127`*^9}, {3.6941950322914047`*^9, 
   3.6941950783562727`*^9}, {3.694195108776731*^9, 3.694195158623158*^9}, {
   3.6941952327028303`*^9, 3.6941952672266827`*^9}, {3.694195312635702*^9, 
   3.694195424045232*^9}, 3.6941954846557827`*^9, {3.694195526124494*^9, 
   3.694195530416901*^9}, {3.69419560104038*^9, 3.694195759842196*^9}, {
   3.694195795351239*^9, 3.694195855398904*^9}, {3.694196548688395*^9, 
   3.6941966390176888`*^9}, {3.694196681292962*^9, 3.6941967004509077`*^9}, {
   3.694196737840692*^9, 3.694196780887157*^9}, {3.694196845031301*^9, 
   3.694196852108555*^9}, {3.694196899399653*^9, 3.694196904566684*^9}, {
   3.6941969628478193`*^9, 3.694196985541493*^9}, {3.69419701719153*^9, 
   3.694197101221332*^9}, {3.694197143154181*^9, 3.6941971860203648`*^9}, {
   3.694197218099588*^9, 3.694197231650544*^9}, {3.69419728718648*^9, 
   3.694197307319627*^9}, {3.694197371269161*^9, 3.694197381700369*^9}, {
   3.69419749430154*^9, 3.6941974999237213`*^9}, {3.6941975473338423`*^9, 
   3.6941975522834806`*^9}, {3.694197590382257*^9, 3.694197615843404*^9}, {
   3.6941976461094017`*^9, 3.694197655841424*^9}, {3.694197725286296*^9, 
   3.694197811519968*^9}, {3.694197869302821*^9, 3.694197874667471*^9}, {
   3.6941979716469584`*^9, 3.694197998633368*^9}, {3.694198101121817*^9, 
   3.694198133410923*^9}, {3.6941981786838007`*^9, 3.694198229993988*^9}, {
   3.6941983280422277`*^9, 3.694198675014264*^9}, {3.694198832531144*^9, 
   3.694198852121426*^9}, {3.6941988888998203`*^9, 3.694198897010374*^9}, {
   3.694198950081966*^9, 3.694198950272606*^9}, {3.6941990323069687`*^9, 
   3.6941990421855803`*^9}, {3.694199095164077*^9, 3.69419910022577*^9}, {
   3.6941992332281303`*^9, 3.694199362136406*^9}, {3.694199393203745*^9, 
   3.6941994531250896`*^9}, {3.694199519542102*^9, 3.694199525748395*^9}, {
   3.694199558841566*^9, 3.694199565060276*^9}, {3.694199718972155*^9, 
   3.694199750914639*^9}, {3.694199811003168*^9, 3.694199812426078*^9}, {
   3.694199868061029*^9, 3.694199927122286*^9}, {3.6942000506182747`*^9, 
   3.6942000624448223`*^9}, {3.694200103043284*^9, 3.694200123505004*^9}, {
   3.694200172645027*^9, 3.694200174643799*^9}, {3.69420026949752*^9, 
   3.6942004250409603`*^9}, {3.6942004992826777`*^9, 3.694200544755891*^9}, {
   3.694200608610558*^9, 3.6942006111517773`*^9}, {3.694200644053116*^9, 
   3.694200645922995*^9}, {3.694200700375827*^9, 3.694200754293914*^9}, {
   3.6942008517382917`*^9, 3.69420089432195*^9}, {3.694200961527894*^9, 
   3.6942010134177713`*^9}, {3.6942012184041758`*^9, 
   3.6942012435436773`*^9}, {3.694201320914322*^9, 3.694201327742733*^9}, {
   3.6942014083280573`*^9, 3.6942014347107553`*^9}, {3.694201587407687*^9, 
   3.694201595461389*^9}, {3.694201792252698*^9, 3.694201803324651*^9}, {
   3.694201852333942*^9, 3.694201931753313*^9}, {3.694202105339622*^9, 
   3.694202151600909*^9}, {3.6942028588595953`*^9, 3.694202890011916*^9}, {
   3.694202951216557*^9, 3.69420296118491*^9}, {3.694202992236899*^9, 
   3.694203044961123*^9}, {3.6942032319142933`*^9, 3.694203258271797*^9}, {
   3.694203413887609*^9, 3.694203452824651*^9}, {3.694203521215205*^9, 
   3.694203537317793*^9}, {3.694203590412314*^9, 3.694203635746376*^9}, 
   3.694203671365443*^9, {3.694203937606093*^9, 3.6942039806030817`*^9}, {
   3.694204028072817*^9, 3.694204118787105*^9}, {3.694204154068282*^9, 
   3.694204189833365*^9}, {3.6942043061500463`*^9, 3.694204385171912*^9}, {
   3.6942044350282183`*^9, 3.6942044924898987`*^9}, 3.694204530105744*^9, {
   3.694204642177503*^9, 3.694204647154148*^9}, {3.694204720258954*^9, 
   3.694204749000627*^9}, {3.694204792020907*^9, 3.694204811978835*^9}, {
   3.6942048811576977`*^9, 3.69420491019598*^9}, {3.694204952986706*^9, 
   3.694205027486524*^9}, {3.694205078730691*^9, 3.694205142267717*^9}, {
   3.694205195354476*^9, 3.694205218464736*^9}, {3.694205279993073*^9, 
   3.69420528235923*^9}, {3.694205363729834*^9, 3.694205382786462*^9}, {
   3.694205661675269*^9, 3.694205963813739*^9}, 3.694206064535762*^9, {
   3.694206185701787*^9, 3.694206194933281*^9}, {3.694206601583984*^9, 
   3.694206659617503*^9}, {3.694206719733027*^9, 3.694206824090213*^9}, {
   3.694206953000247*^9, 3.694207119212256*^9}, {3.6942071655532837`*^9, 
   3.69420720144055*^9}, {3.694207319992354*^9, 3.6942073319581223`*^9}, {
   3.694207467779297*^9, 3.694207475528954*^9}, {3.69420756667983*^9, 
   3.694207567485485*^9}, {3.694207823488669*^9, 3.694207868218083*^9}, {
   3.694208134532112*^9, 3.694208137115615*^9}, {3.694208347251148*^9, 
   3.694208352372189*^9}, {3.6942084909580603`*^9, 3.69420850882088*^9}, {
   3.694208547294215*^9, 3.694208551085565*^9}, {3.694215420333663*^9, 
   3.6942155609713497`*^9}, {3.694250829415288*^9, 3.694250894882625*^9}, 
   3.6942509823239727`*^9, {3.694251078589664*^9, 3.694251133147341*^9}, {
   3.69425119314116*^9, 3.694251275564451*^9}, {3.6942514793473186`*^9, 
   3.694251759363049*^9}, {3.694251796537784*^9, 3.69425193011131*^9}, {
   3.694251992633555*^9, 3.6942519936561193`*^9}, {3.694252042968816*^9, 
   3.694252046927186*^9}, {3.694252077778153*^9, 3.694252078992221*^9}, 
   3.694252214251424*^9, {3.6942523286575737`*^9, 3.69425233105645*^9}, {
   3.6942523768780193`*^9, 3.694252479383165*^9}, {3.694252533260398*^9, 
   3.694252578634467*^9}, {3.694252699308394*^9, 3.6942528360325823`*^9}, 
   3.694252951033049*^9, {3.694253014481572*^9, 3.694253077256691*^9}, {
   3.694253132972788*^9, 3.69425314234829*^9}, {3.6942531903732758`*^9, 
   3.694253192665304*^9}, {3.694253297572824*^9, 3.694253317559116*^9}, {
   3.694253596903068*^9, 3.6942536032647123`*^9}, {3.694253641959195*^9, 
   3.6942536427838507`*^9}, {3.694253794937999*^9, 3.694253804050416*^9}, {
   3.694253834841845*^9, 3.6942538562630177`*^9}, {3.694253893859353*^9, 
   3.694253906601796*^9}, {3.6942540230011463`*^9, 3.694254143483119*^9}, {
   3.694254180048553*^9, 3.694254207695868*^9}, {3.694254238159934*^9, 
   3.6942542458858347`*^9}, {3.69425440588772*^9, 3.694254413319648*^9}, {
   3.694254509562428*^9, 3.694254546837881*^9}, {3.694254641655712*^9, 
   3.694254689525354*^9}, {3.694254747254599*^9, 3.694254748663498*^9}, {
   3.6942547915359507`*^9, 3.694254799328368*^9}, {3.6942548845153723`*^9, 
   3.694254936034219*^9}, {3.694254978244878*^9, 3.6942550135785933`*^9}, {
   3.6942550901681843`*^9, 3.6942551048158817`*^9}, {3.694255158863133*^9, 
   3.694255165102235*^9}, {3.694255260070991*^9, 3.694255333413299*^9}, {
   3.694255437127283*^9, 3.694255700612547*^9}, {3.6942558990532227`*^9, 
   3.694255937275647*^9}, {3.6942560040785313`*^9, 3.6942560547035427`*^9}, {
   3.69425614325778*^9, 3.694256244193307*^9}, {3.6942563141136*^9, 
   3.694256315292013*^9}, {3.694257858713084*^9, 3.694257877856268*^9}, {
   3.694258439711544*^9, 3.694258468340819*^9}, {3.694258503367302*^9, 
   3.69425862313203*^9}, {3.694258661503396*^9, 3.694258696558776*^9}, {
   3.694258735399816*^9, 3.6942589016203012`*^9}, {3.694258952259907*^9, 
   3.694258955263246*^9}, {3.694258992863598*^9, 3.6942590349718647`*^9}, {
   3.694259079780937*^9, 3.694259101708441*^9}, {3.6942603065181303`*^9, 
   3.694260315838517*^9}, {3.6942603791256638`*^9, 3.6942603831247787`*^9}, {
   3.694260414435877*^9, 3.6942604760336533`*^9}, {3.6942605128091908`*^9, 
   3.694260535394093*^9}, {3.69426063864502*^9, 3.694260724881419*^9}, {
   3.6942608011140747`*^9, 3.6942608041381693`*^9}, {3.694260836763063*^9, 
   3.694260871459255*^9}, {3.694269690548606*^9, 3.6942697069202967`*^9}, {
   3.694269780176654*^9, 3.6942697822827377`*^9}, {3.694269821031663*^9, 
   3.694269822320801*^9}, {3.694269866078394*^9, 3.6942698667570667`*^9}, {
   3.694269913821621*^9, 3.6942699914303503`*^9}, {3.6942700892706137`*^9, 
   3.694270106821088*^9}, {3.694270212274168*^9, 3.6942703388546247`*^9}, {
   3.6942703720395927`*^9, 3.694270576043674*^9}, {3.694270618831661*^9, 
   3.694270642941165*^9}, {3.694270758690989*^9, 3.6942707706336184`*^9}, {
   3.694270801762187*^9, 3.694270836158072*^9}, {3.694270868638269*^9, 
   3.694270872212719*^9}, {3.694270905564724*^9, 3.694270981490284*^9}, {
   3.6942710330977507`*^9, 3.6942710466471663`*^9}, {3.694271087752195*^9, 
   3.694271130982266*^9}, {3.694271190964264*^9, 3.694271246371542*^9}, {
   3.6942714344765673`*^9, 3.694271504379401*^9}, {3.694271934480886*^9, 
   3.694271951825314*^9}, {3.6942720836883783`*^9, 3.694272278458788*^9}, {
   3.6942724662417107`*^9, 3.6942726608272*^9}, {3.6942726945854*^9, 
   3.694272718056376*^9}, {3.694272753252823*^9, 3.6942727901971073`*^9}, {
   3.6942728476769543`*^9, 3.694272848621014*^9}, {3.6942728849754972`*^9, 
   3.69427289359834*^9}, {3.6942729291920147`*^9, 3.6942730202664337`*^9}, {
   3.694273139072863*^9, 3.694273139415781*^9}, 3.694277177206417*^9, {
   3.694290419868247*^9, 3.6942904428699217`*^9}, {3.694290759494279*^9, 
   3.694290795660331*^9}, {3.6942908506271763`*^9, 3.6942908548272552`*^9}, {
   3.694296499954939*^9, 
   3.69429654911541*^9}},ExpressionUUID->"9ea79a74-a669-4acb-b1de-\
bc6f23fede05"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Selecting\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6925426649813967`*^9, 3.692542666573305*^9}, {
  3.692544851375285*^9, 
  3.6925448530122013`*^9}},ExpressionUUID->"93209f46-ab43-43cb-b876-\
455e54b01fa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelect", "[", 
    RowBox[{
     RowBox[{"data_List", "|", 
      RowBox[{"ChemSpectrum", "[", "data_List", "]"}]}], ",", "\n", "\t", 
     RowBox[{"pat", ":", 
      RowBox[{"{", 
       RowBox[{"rangePat_", ",", "intensityPat_"}], "}"}]}]}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"ChemSpectrum", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"data", ",", "pat"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelect", "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"data_Association", "?", 
       RowBox[{"(", 
        RowBox[{"KeyMemberQ", "[", "\"\<Frequencies\>\"", "]"}], ")"}]}], "|",
       "\n", "\t", 
      RowBox[{"ChemSpectrum", "[", 
       RowBox[{"data_Association", "?", 
        RowBox[{"(", 
         RowBox[{"KeyMemberQ", "[", "\"\<Frequencies\>\"", "]"}], ")"}]}], 
       "]"}]}], ",", "\n", "\t", 
     RowBox[{"pat", ":", 
      RowBox[{"{", 
       RowBox[{"rangePat_", ",", "intensityPat_"}], "}"}]}]}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"frps", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"data", "[", "\"\<Frequencies\>\"", "]"}], ",", 
           "rangePat"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", "p__", "}"}], "\[RuleDelayed]", 
          RowBox[{"Join", "[", "p", "]"}]}]}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sel", "=", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"KeyMemberQ", "[", 
            RowBox[{"data", ",", "\"\<Weights\>\""}], "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"Intersection", "[", 
            RowBox[{"frps", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"data", "[", "\"\<Weights\>\"", "]"}], ",", 
                 "intensityPat"}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", "p__", "}"}], "\[RuleDelayed]", 
                RowBox[{"Join", "[", "p", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
           "frps"}], "]"}]}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"ChemSpectrum", "@", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<Frequencies\>\"", "->", 
             RowBox[{
              RowBox[{"data", "[", "\"\<Frequencies\>\"", "]"}], "[", 
              RowBox[{"[", "sel", "]"}], "]"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{"\"\<Weights\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyMemberQ", "[", 
                RowBox[{"data", ",", "\"\<Weights\>\""}], "]"}], ",", "\n", 
               "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"data", "[", "\"\<Weights\>\"", "]"}], "[", 
                RowBox[{"[", "sel", "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
               "None"}], "]"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{"\"\<Transitions\>\"", "->", "\n", "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyMemberQ", "[", 
                RowBox[{"data", ",", "\"\<Transitions\>\""}], "]"}], ",", 
               "\n", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"data", "[", "\"\<Transitions\>\"", "]"}], "[", 
                RowBox[{"[", "sel", "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
               "None"}], "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumSelect", "[", "pat_", "]"}], "[", "data_", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemSpectrumSelect", "[", 
    RowBox[{"data", ",", "pat"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6925416078876534`*^9, 3.692541663031352*^9}, {
  3.692541755600514*^9, 3.6925418129326468`*^9}, {3.6925418792250013`*^9, 
  3.692541883612266*^9}, {3.6925419235735607`*^9, 3.692541946098007*^9}, {
  3.692542478052198*^9, 3.692542478467428*^9}, {3.6925436322011127`*^9, 
  3.692543648127781*^9}, {3.6925443396760263`*^9, 3.692544404352069*^9}, {
  3.6927144594148207`*^9, 3.6927147542040443`*^9}, {3.6927148044079113`*^9, 
  3.6927148988221416`*^9}, {3.692714977172782*^9, 
  3.6927150739474897`*^9}},ExpressionUUID->"a85ee713-90b6-4b13-b242-\
128b183a45a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumZoom", "[", "\n", "\t", 
    RowBox[{"data_", ",", "\n", "\t", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rMin", ":", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", 
           RowBox[{"-", "\[Infinity]"}], "|", "\[Infinity]"}]}], ",", 
         RowBox[{"rMax", ":", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", 
           RowBox[{"-", "\[Infinity]"}], "|", "\[Infinity]"}]}]}], "}"}], ",",
        "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"iMin", ":", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", 
           RowBox[{"-", "\[Infinity]"}], "|", "\[Infinity]"}]}], ",", 
         RowBox[{"iMax", ":", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", 
           RowBox[{"-", "\[Infinity]"}], "|", "\[Infinity]"}]}]}], "}"}]}], 
      "\n", "\t\t", "}"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"rminR", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"rMin", ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Scaled", "[", "f_", "]"}], "\[RuleDelayed]", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Rescale", "[", 
            RowBox[{"f", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Switch", "[", 
              RowBox[{
              "data", ",", "\n", "\t\t\t\t\t\t\t", "_ChemSpectrum", ",", "\n",
                "\t\t\t\t\t\t\t\t", 
               RowBox[{"Range", "@", "data"}], ",", "\n", "\t\t\t\t\t\t\t", 
               "_List", ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "\n", 
               "\t\t\t\t\t\t\t", "_Association", ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", "\"\<Frequencies\>\"", "]"}]}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], 
         "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"rmaxR", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"rMax", ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Scaled", "[", "f_", "]"}], "\[RuleDelayed]", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Rescale", "[", 
            RowBox[{"f", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Switch", "[", 
              RowBox[{
              "data", ",", "\n", "\t\t\t\t\t\t\t", "_ChemSpectrum", ",", "\n",
                "\t\t\t\t\t\t\t\t", 
               RowBox[{"Range", "@", "data"}], ",", "\n", "\t\t\t\t\t\t\t", 
               "_List", ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "\n", 
               "\t\t\t\t\t\t\t", "_Association", ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", "\"\<Frequencies\>\"", "]"}]}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], 
         "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"iminR", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"iMin", ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Scaled", "[", "f_", "]"}], "\[RuleDelayed]", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Rescale", "[", 
            RowBox[{"f", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Switch", "[", 
              RowBox[{
              "data", ",", "\n", "\t\t\t\t\t\t\t", "_ChemSpectrum", ",", "\n",
                "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", "data"}], ",", "\n", "\t\t\t\t\t\t\t", 
               "_List", ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "\n", 
               "\t\t\t\t\t\t\t", "_Association", ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", "\"\<Weights\>\"", "]"}]}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], 
         "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"imaxR", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"iMax", ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Scaled", "[", "f_", "]"}], "\[RuleDelayed]", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Rescale", "[", 
            RowBox[{"f", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Switch", "[", 
              RowBox[{
              "data", ",", "\n", "\t\t\t\t\t\t\t", "_ChemSpectrum", ",", "\n",
                "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", "data"}], ",", "\n", "\t\t\t\t\t\t\t", 
               "_List", ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "\n", 
               "\t\t\t\t\t\t\t", "_Association", ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"MinMax", "@", 
                RowBox[{"data", "[", "\"\<Weights\>\"", "]"}]}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], 
         "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t", 
     
     RowBox[{"ChemSpectrumSelect", "[", 
      RowBox[{"data", ",", "\n", "\t\t", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{"Between", "[", 
            RowBox[{"{", 
             RowBox[{"rminR", ",", "rmaxR"}], "}"}], "]"}], ")"}]}], ",", 
         "\n", "\t\t\t", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{"Between", "[", 
            RowBox[{"{", 
             RowBox[{"iminR", ",", "imaxR"}], "}"}], "]"}], ")"}]}]}], 
        "}"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"iMin_", ",", "iMax_"}], "}"}]}], "}"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"iMin", ",", "iMax"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rMin_", ",", "rMax_"}], "}"}], ",", "All"}], "}"}]}], "]"}], 
   ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rMin", ",", "rMax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rMin", ":", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", 
         RowBox[{"-", "\[Infinity]"}]}]}], ",", 
       RowBox[{"rMax", ":", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", 
         "\[Infinity]"}]}]}], "}"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rMin", ",", "rMax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"i", ":", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}]}]}], "}"}]}], "]"}],
    ":=", "\n", "\t", 
   RowBox[{"data", "[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692544434777993*^9, 3.692544713579542*^9}, {
  3.6925449010368757`*^9, 3.692544904246231*^9}, {3.6925449403484163`*^9, 
  3.692544967203313*^9}, {3.6925450213288517`*^9, 3.69254502619214*^9}, {
  3.692714448845141*^9, 3.692714449540935*^9}, {3.694259132216008*^9, 
  3.694259297916089*^9}, {3.6942593623575907`*^9, 3.6942593918159113`*^9}, {
  3.694259426100978*^9, 3.69425959623169*^9}, {3.694259699805498*^9, 
  3.694259887352158*^9}, {3.694261487758984*^9, 
  3.694261499622826*^9}},ExpressionUUID->"7fe35348-4a50-4ed2-b028-\
15e6717188bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumZoom", "[", "range_", "]"}], "[", "data_", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{"data", ",", "range"}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69254471918826*^9, 
  3.692544731498811*^9}},ExpressionUUID->"99d0bb3d-b54c-4811-8f86-\
9639f0420eb7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelectAbove", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"threshold_", "?", "NumericQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumSelect", "[", 
    RowBox[{"data", ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"NumericQ", "@", "#"}], "&&", 
           RowBox[{"#", ">", "threshold"}]}], "&"}], ")"}]}]}], "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumSelectAbove", "[", "threshold_", "]"}], "[", "data_",
     "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumSelectAbove", "[", 
    RowBox[{"data", ",", "threshold"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelectBelow", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"threshold_", "?", "NumericQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumSelect", "[", 
    RowBox[{"data", ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"NumericQ", "@", "#"}], "&&", 
           RowBox[{"#", "<", "threshold"}]}], "&"}], ")"}]}]}], "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumSelectBelow", "[", "threshold_", "]"}], "[", "data_",
     "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumSelectBelow", "[", 
    RowBox[{"data", ",", "threshold"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6925416078876534`*^9, 3.692541663031352*^9}, {
  3.692541755600514*^9, 3.6925418129326468`*^9}, {3.6925418792250013`*^9, 
  3.692541883612266*^9}, {3.6925419235735607`*^9, 3.692541946098007*^9}, {
  3.692542478052198*^9, 3.692542478467428*^9}, {3.6925436322011127`*^9, 
  3.692543705420356*^9}, {3.692544339687913*^9, 3.692544339709714*^9}, {
  3.692544391249062*^9, 
  3.692544412878091*^9}},ExpressionUUID->"ea1f1e65-a473-4313-86f0-\
bffc9d347fa6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Peak Stuff\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6942087864188957`*^9, 
  3.694208792674219*^9}},ExpressionUUID->"d8b1f6da-e804-47a7-a855-\
e528f773f8c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ChemSpectrumFindPeaks"}], "=", 
   RowBox[{"Options", "@", "FindPeaks"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumFindPeaks", "[", 
    RowBox[{"data_List", ",", "params___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FindPeaks", "[", 
    RowBox[{"data", ",", "params"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumFindPeaks", "[", 
    RowBox[{
     RowBox[{"d", ":", 
      RowBox[{"ChemSpectrum", "[", 
       RowBox[{"_List", "|", "_Association"}], "]"}]}], ",", "params___"}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"FindPeaks", "[", 
    RowBox[{
     RowBox[{"Normal", "@", "d"}], ",", "params"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumFindPeaks", "[", 
    RowBox[{"d_Association", ",", "params___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FindPeaks", "[", 
    RowBox[{
     RowBox[{"Normal", "@", 
      RowBox[{"ChemSpectrum", "@", "d"}]}], ",", "params"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694214746118388*^9, 3.694214754443942*^9}, {
  3.694214816395884*^9, 
  3.694214949782003*^9}},ExpressionUUID->"2aa54cb4-fdbd-41ec-97c2-\
29b8604d336c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ChemSpectrumNearestPeak"}], "=", 
   RowBox[{"Options", "@", "FindMaximum"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumNearestPeak", "[", "\n", "\t", 
    RowBox[{"interp_InterpolatingFunction", ",", 
     RowBox[{"wavelength_", "?", "NumericQ"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "peakFindingVar", "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"peakFindingVar", "/.", 
           RowBox[{"Last", "@", "#"}]}], ",", 
          RowBox[{"First", "@", "#"}]}], "}"}], "&"}], "@", "\n", "\t\t\t", 
       RowBox[{"FindMaximum", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"interp", "[", "peakFindingVar", "]"}], ",", 
           RowBox[{"Between", "[", 
            RowBox[{"peakFindingVar", ",", 
             RowBox[{"First", "@", 
              RowBox[{"First", "@", "interp"}]}]}], "]"}]}], "}"}], ",", "\n",
          "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"peakFindingVar", ",", "wavelength"}], "}"}], ",", "\n", 
         "\t", "\t", "\t\t", "ops"}], "]"}]}]}], "\n", "\t\t", "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumNearestPeak", "[", "\n", "\t", 
    RowBox[{
    "interp_InterpolatingFunction", ",", "\n", "\t", "wavelengths_List", ",", 
     "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "peakFindingVar", "}"}], ",", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", "=", 
          RowBox[{"First", "@", 
           RowBox[{"First", "@", "interp"}]}]}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"peakFindingVar", "/.", 
               RowBox[{"Last", "@", "#"}]}], ",", 
              RowBox[{"First", "@", "#"}]}], "}"}], "&"}], "@", "\n", 
           "\t\t\t", 
           RowBox[{"FindMaximum", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"interp", "[", "peakFindingVar", "]"}], ",", 
               RowBox[{"Between", "[", 
                RowBox[{"peakFindingVar", ",", "r"}], "]"}]}], "}"}], ",", 
             "\n", "\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"peakFindingVar", ",", "#"}], "}"}], ",", "\n", "\t", 
             "\t", "\t\t", "ops"}], "]"}]}], "&"}], "/@", "wavelengths"}]}], 
       "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumNearestPeak", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"spec", ":", 
      RowBox[{"_List", "|", "_Association", "|", 
       RowBox[{"ChemSpectrum", "[", 
        RowBox[{"_List", "|", "_Association"}], "]"}]}]}], ",", "\n", "\t", 
     "w_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemSpectrumNearestPeak", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Interpolation", "@", 
      RowBox[{"Replace", "[", 
       RowBox[{"spec", ",", 
        RowBox[{
         RowBox[{"Except", "[", "_ChemSpectrum", "]"}], "\[RuleDelayed]", 
         RowBox[{"ChemSpectrum", "@", "spec"}]}]}], "]"}]}], ",", "\n", 
     "\t\t", "w", ",", "\n", "\t\t", "ops"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694208800366728*^9, 3.694208897450156*^9}, {
  3.694208988652568*^9, 3.6942090060839787`*^9}, {3.694209054394333*^9, 
  3.694209085153406*^9}, {3.694209519001339*^9, 3.6942095794077806`*^9}, {
  3.694209619979039*^9, 3.694209805407374*^9}, {3.694209900454699*^9, 
  3.6942099490698*^9}, {3.694210131585115*^9, 3.6942102239992247`*^9}, {
  3.6942110793183928`*^9, 3.69421110764465*^9}, {3.694211180320693*^9, 
  3.694211218222576*^9}, {3.694211252670928*^9, 3.694211253541482*^9}, {
  3.694211289459509*^9, 3.6942113941572657`*^9}, {3.694212679870014*^9, 
  3.694212845637456*^9}, {3.694213465444347*^9, 3.694213472738841*^9}, {
  3.6942144230558567`*^9, 3.694214425964967*^9}, {3.694214771879944*^9, 
  3.694214809212112*^9}, {3.694214955999421*^9, 
  3.6942149638156652`*^9}},ExpressionUUID->"3a40a728-b804-4178-baf5-\
fc9b5b710b4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Smooth\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6942119646759367`*^9, 
  3.694211966794586*^9}},ExpressionUUID->"4fd90899-1d2a-4d5b-ba26-\
1c0047852675"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSmooth", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"data", ":", 
      RowBox[{"_List", "|", "_Association", "|", 
       RowBox[{"ChemSpectrum", "[", 
        RowBox[{"_List", "|", "_Association"}], "]"}]}]}], ",", "\n", "\t", 
     RowBox[{"averagePoints_:", "10"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"data", ",", "_ChemSpectrum"}], "]"}], ",", " ", 
      "ChemSpectrum", ",", " ", "Identity"}], "]"}], "@", "\n", "\t\t", 
    RowBox[{"MovingAverage", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"Replace", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{"Except", "[", "_ChemSpectrum", "]"}], ":>", 
          RowBox[{"ChemSpectrum", "[", "data", "]"}]}]}], "]"}]}], ",", "\n", 
      "\t\t\t", "averagePoints"}], "\n", "\t\t\t", "]"}]}]}], 
  ";"}]], "CodeInput",
 CellLabel->
  "In[2143]:=",ExpressionUUID->"3bea1041-7b62-4016-a913-b63ee2c0ed1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Overrides\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692543798276793*^9, 
  3.692543799739418*^9}},ExpressionUUID->"9edc58e9-cd53-4c13-b20c-\
0acbe5bef6a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Normal", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", "\t", 
   "d"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Normal", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Thread", "@", 
    RowBox[{"Lookup", "[", 
     RowBox[{"d", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Frequencies\>\"", ",", "\"\<Weights\>\""}], "}"}]}], 
     "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
  3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
  3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
  3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
  3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
  3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
  3.692716066079637*^9}, {3.6942094166966667`*^9, 3.6942094311992493`*^9}, {
  3.694209473209737*^9, 
  3.694209486567357*^9}},ExpressionUUID->"d8e2e532-33ec-495a-b89a-\
73a964c1117f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"ChemSpectrum", "[", "d_", "]"}], "[", 
     RowBox[{"range1_", ",", "range2_"}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumZoom", "[", 
    RowBox[{
     RowBox[{"ChemSpectrum", "[", "d", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"range1", ",", "range2"}], "}"}]}], "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"2a2aff0a-2ffc-4bf3-aa03-0be49d29cf20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_List", "]"}], ",", "i_Integer"}], "]"}],
     "]"}], ":=", "\n", "\t", 
   RowBox[{"Part", "[", 
    RowBox[{"d", ",", "i"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_List", "]"}], ",", 
      RowBox[{"s", ":", 
       RowBox[{"_Span", "|", "_List"}]}]}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrum", "[", 
    RowBox[{"Part", "[", 
     RowBox[{"d", ",", "s"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_Association", "]"}], ",", "spec_"}], 
     "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrum", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"#", ",", "spec"}], "]"}], "&"}], "/@", "d"}], ")"}]}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
  3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
  3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
  3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
  3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
  3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
  3.692716183043634*^9}},ExpressionUUID->"b9b99ee2-49fc-4aa6-b84a-\
b74f71248a35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_List", "]"}], ",", "s___"}], "]"}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrum", "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{"d", ",", "s"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_Association", "]"}], ",", "spec___"}], 
     "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"Values", "@", "d"}]}], ",", 
       RowBox[{"k", "=", 
        RowBox[{"Keys", "@", "d"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"MapThread", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemSpectrum", "@", 
         RowBox[{"Association", "@", 
          RowBox[{"Thread", "[", 
           RowBox[{"k", "\[Rule]", 
            RowBox[{"{", "##", "}"}]}], "]"}]}]}], "&"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", "spec"}], "]"}], "&"}], "/@", "v"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
   3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
   3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
   3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
   3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
   3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
   3.6927160704135942`*^9}, {3.692716186253373*^9, 3.692716205865006*^9}, {
   3.692716240990697*^9, 3.6927162962373743`*^9}, 3.692716512920457*^9, {
   3.692716560691255*^9, 3.692716561741683*^9}, {3.69271662044448*^9, 
   3.6927166686608543`*^9}},ExpressionUUID->"6f0bc446-e423-4197-b3eb-\
a477677ede72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Length", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"Length", "@", "d"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Length", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Length", "@", 
    RowBox[{"d", "[", "\"\<Frequencies\>\"", "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
   3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
   3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
   3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
   3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
   3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
   3.6927160704135942`*^9}, 3.692716186253373*^9, {3.692716311125978*^9, 
   3.692716322386784*^9}},ExpressionUUID->"b093b283-644c-49f0-9d1b-\
6618a8dc688b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Range", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"MinMax", "@", 
    RowBox[{"d", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Range", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"MinMax", "@", 
    RowBox[{"d", "[", "\"\<Frequencies\>\"", "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
   3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
   3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
   3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
   3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
   3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
   3.6927160704135942`*^9}, 3.692716186253373*^9, {3.692716311125978*^9, 
   3.692716340546136*^9}},ExpressionUUID->"5b1599a5-f5c1-4221-8a2d-\
355719247539"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"MinMax", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"MinMax", "@", 
    RowBox[{"d", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"MinMax", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"MinMax", "@", 
    RowBox[{"d", "[", "\"\<Weights\>\"", "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
   3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
   3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
   3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
   3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
   3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
   3.6927160704135942`*^9}, 3.692716186253373*^9, {3.692716311125978*^9, 
   3.692716351182682*^9}, 
   3.692716433172583*^9},ExpressionUUID->"b8bc689d-c705-40ad-a376-\
8cb73e35bd47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Max", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"First", "@", 
    RowBox[{"MaximalBy", "[", 
     RowBox[{"d", ",", "Last"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Max", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"First", "@", 
    RowBox[{"MaximalBy", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", "[", "\"\<Frequencies\>\"", "]"}], ",", 
         RowBox[{"d", "[", "\"\<Weights\>\"", "]"}]}], "}"}], "]"}], ",", 
      "Last"}], "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
   3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
   3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
   3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
   3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
   3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
   3.6927160704135942`*^9}, 3.692716186253373*^9, {3.692716311125978*^9, 
   3.69271639394169*^9}},ExpressionUUID->"da8b7a00-2ccc-4787-8389-\
db55823231b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Min", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"First", "@", 
    RowBox[{"MinimalBy", "[", 
     RowBox[{"d", ",", "Last"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Min", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t", 
   RowBox[{"First", "@", 
    RowBox[{"MinimalBy", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", "[", "\"\<Frequencies\>\"", "]"}], ",", 
         RowBox[{"d", "[", "\"\<Weights\>\"", "]"}]}], "}"}], "]"}], ",", 
      "Last"}], "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692543800406445*^9, 3.6925439680588923`*^9}, {
   3.692544002938684*^9, 3.6925440164732*^9}, {3.6925440470220823`*^9, 
   3.692544133790286*^9}, {3.692544236551209*^9, 3.692544276441689*^9}, {
   3.6925447871555157`*^9, 3.692544840501957*^9}, {3.692547941659947*^9, 
   3.692547981686529*^9}, {3.6925480202566757`*^9, 3.692548038300487*^9}, {
   3.69271596040585*^9, 3.692715982580894*^9}, {3.692716020952405*^9, 
   3.6927160704135942`*^9}, 3.692716186253373*^9, {3.692716311125978*^9, 
   3.692716407492935*^9}},ExpressionUUID->"528a1f8e-35ec-42d1-9a1d-\
d415fe7271df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Lookup", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_Association", "]"}], ",", "k_"}], "]"}],
     "]"}], ":=", "\n", "\t\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"d", ",", "k"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Lookup", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_Association", "]"}], ",", "k_", ",", 
      "def_"}], "]"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"d", ",", "k", ",", "def"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}], "[", "k__", "]"}], 
    "]"}], ":=", "\n", "\t\t", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"#2", ",", "_String", ",", 
        RowBox[{"#", "[", "#2", "]"}], ",", "_List", ",", 
        RowBox[{"Lookup", "[", 
         RowBox[{"#", ",", "#2"}], "]"}]}], "]"}], "&"}], ",", "d", ",", 
     RowBox[{"{", "k", "}"}]}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6932244598732557`*^9, 3.693224656537404*^9}, {
   3.693224707482595*^9, 3.69322470925865*^9}, {3.693224757833145*^9, 
   3.6932247737279987`*^9}, 3.693225747519168*^9, {3.693225814836731*^9, 
   3.693225821315104*^9}},ExpressionUUID->"aec34780-6ae1-49ba-9938-\
e667de3e4b53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Association", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", 
   "\t\t", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Frequencies\>\"", ",", "\"\<Weights\>\""}], "}"}], 
     "\[Rule]", 
     RowBox[{"Thread", "[", 
      RowBox[{"d", ",", "List"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Association", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t\t", "d"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693224823487755*^9, 3.6932248731240664`*^9}, {
  3.693225035203566*^9, 
  3.693225046319339*^9}},ExpressionUUID->"50c45a73-d39f-4d7d-87fc-\
5c229d08cad2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Lookup", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_List", "]"}], ",", "k_"}], "]"}], "]"}],
    ":=", "\n", "\t\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"Association", "@", 
      RowBox[{"ChemSpectrum", "[", "d", "]"}]}], ",", "k"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Lookup", "[", 
     RowBox[{
      RowBox[{"ChemSpectrum", "[", "d_List", "]"}], ",", "k_", ",", "def_"}], 
     "]"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"Association", "@", 
      RowBox[{"ChemSpectrum", "[", "d", "]"}]}], ",", "k", ",", "def"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
  RowBox[{"HoldPattern", "[", 
   RowBox[{
    RowBox[{"ChemSpectrum", "[", "d_List", "]"}], "[", "k__", "]"}], "]"}], ":=",
   "\n", "\t\t", 
  RowBox[{
   RowBox[{"ChemSpectrum", "[", 
    RowBox[{"Association", "[", 
     RowBox[{"ChemSpectrum", "[", "d", "]"}], "]"}], "]"}], "[", "k", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6932244598732557`*^9, 3.693224656537404*^9}, {
   3.693224707482595*^9, 3.69322470925865*^9}, {3.693224757833145*^9, 
   3.693224820781684*^9}, 3.6932248615434313`*^9, {3.693225057159412*^9, 
   3.693225118210792*^9}, 3.693225416666725*^9, {3.693225656440157*^9, 
   3.693225778516033*^9}},ExpressionUUID->"cda737c0-94f9-4e6a-8c56-\
83d6a8590d8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Interpolation", "@", 
     RowBox[{"ChemSpectrum", "[", "d_List", "]"}]}], "]"}], ":=", "\n", 
   "\t\t", 
   RowBox[{"Interpolation", "@", "d"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrum", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Interpolation", "@", 
     RowBox[{"ChemSpectrum", "[", "d_Association", "]"}]}], "]"}], ":=", "\n",
    "\t\t", 
   RowBox[{"First", "@*", "First", "@*", "\n", "\t\t\t", 
    RowBox[{"Nearest", "[", 
     RowBox[{"Normal", "@", 
      RowBox[{"GroupBy", "[", 
       RowBox[{
        RowBox[{"Normal", "@", 
         RowBox[{"ChemSpectrum", "[", "d", "]"}]}], ",", "First"}], "]"}]}], 
     "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694209159135295*^9, 3.6942091802228003`*^9}, {
  3.694209277630602*^9, 3.6942093026771793`*^9}, {3.694215686599972*^9, 
  3.694215759433868*^9}, {3.694215802410899*^9, 
  3.694215844654934*^9}},ExpressionUUID->"70daf98e-5587-487d-877f-\
7da624f826a4"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"9dac5ffd-3497-409e-be10-\
a60ab050c12b"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"7caa748b-78fc-4082-aded-\
e57495d40106"]
},
WindowSize->{808, 755},
WindowMargins->{{214, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

