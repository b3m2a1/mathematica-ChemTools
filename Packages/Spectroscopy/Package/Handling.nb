Notebook[{

Cell[CellGroupData[{
Cell["Spectrum Handling", \
"CodeSection",ExpressionUUID->"94f0d441-d035-414d-91d6-ddfa26b58e71"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Methods\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"b1335fe3-88be-420a-9f42-c1d4c8d68c94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSort", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPart", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"d61ee393-983e-4c45-b2e1-cbcbd86f9a84"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumPoints", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumInterpolation", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumFrequencyRange", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumIntensityRange", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"5eb4c0e3-5eaf-44c3-9058-0c5533c85f35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumMode", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumNorm", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumRegularlySampledQ", "::", "usage"}], "=", 
   "\"\<\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"c0df45d3-778b-4e61-b713-cd0c8f1ee78c"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Modifications\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"bd98fa30-2dba-46ed-bc04-ad572811a520"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSelect", "::", "usage"}], "=", 
   "\"\<Applies Select to a ChemSpectrum\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumChop", "::", "usage"}], "=", 
   "\"\<Applies Threshold to a ChemSpectrum\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumWindow", "::", "usage"}], "=", 
   "\"\<Akin to TimeSeriesWindow\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumResample", "::", "usage"}], "=", 
   "\"\<Akin to TimeSeriesResample\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumScale", "::", "usage"}], "=", 
   "\"\<Scales the frequency range of the spectrum\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumShift", "::", "usage"}], "=", 
   "\"\<Akin to TimeSeriesShift\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"4bb0da6d-6e02-4ffc-8588-10ec8df78729"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumSmooth", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Applies a smoother to the spectrum\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumNormalize", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Normalizes the data\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumAdjust", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Adjusts the spectrum to work better for plotting\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"7e3b9245-f7bf-41c8-a0e8-b3d74cfec100"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Distributions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"59588bbc-5226-4df1-aecb-e65f09aa16cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumDistribution", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Creates a MixtureDistribution based on the peaks and \
intensities\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumNormalDistribution", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Creates a Gaussian-broadend distribution\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumCauchyDistribution", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Creates a Lorentzian-broadend distribution\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"3b4ff287-7841-43eb-a91b-a78569e47b89"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Peaks\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"10ed42bb-e55e-4591-a51a-952e9d172b7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumFindPeaks", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Applies FindPeaks to a ChemSpectrum\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumNearestPeak", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Finds the peak nearest to a given wavelength\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"a2149669-842e-4939-b5bc-7d9bf88ba64c"]\

}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"feb5ca9c-1c12-4ed7-a0ff-\
7cac3736862a"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Misc\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"97d51fbc-0d5e-4909-88fc-1fd76a67c193"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Slices\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"ab2627b8-1de9-481a-b957-a173a8ef611b"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Slice\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"bf133584-8f16-4cde-8c81-4600450afa73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumPart", "[", 
   RowBox[{"spec_", ",", " ", "p_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], ",", " ", "p"}], 
         "]"}], ",", " ", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], ",", " ", "p"}], 
         "]"}]}], "}"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "@", 
       RowBox[{"l", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"ChemSpectrumBuild", "@", "\n", "\t\t\t\t", 
       RowBox[{"ReplacePart", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Normal", "@", "spec"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Frequencies\>\"", "\[Rule]", 
            RowBox[{"l", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"\"\<Intensities\>\"", "\[Rule]", 
            RowBox[{"l", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "\n", "\t\t\t\t\t\t", 
          "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", "l"}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"5a1a14b2-5158-42bb-9cde-71564e348f1a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Sort\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"7b59e566-64eb-4dc6-8e4b-5864d503fcc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumSort", "[", "spec_", "]"}], ":=", "\n", "\t\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"o", "=", 
      RowBox[{"Ordering", "[", 
       RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], "]"}]}], "}"}], ",",
     "\n", "\t\t\t", 
    RowBox[{"ChemSpectrumBuild", "@", "\n", "\t\t\t\t", 
     RowBox[{"ReplacePart", "[", "\n", "\t\t\t\t\t", 
      RowBox[{
       RowBox[{"Normal", "@", "spec"}], ",", "\n", "\t\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<Frequencies\>\"", "\[Rule]", 
          RowBox[{
           RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], "[", 
           RowBox[{"[", "o", "]"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"\"\<Intensities\>\"", "\[Rule]", 
          RowBox[{
           RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], "[", 
           RowBox[{"[", "o", "]"}], "]"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], 
      "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"092535a3-e435-4bdb-8704-6c88480c6bd7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Points\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"5caa8dcf-7e25-4811-969f-e1d21db13e28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumPoints", "[", 
   RowBox[{"spec_", ",", " ", 
    RowBox[{"p_:", "All"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], ",", " ", "p"}], 
         "]"}], ",", " ", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], ",", " ", "p"}], 
         "]"}]}], "}"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "@", 
       RowBox[{"l", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Developer`ToPackedArray", "@", "l"}]}], ",", "\n", "\t\t\t", 
      "l"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"5a5d5c11-f145-4afe-8db3-4030f807078a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Interpolations\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"2605c9da-a44a-4e5c-9d26-fbdf4196631b"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Interpolation\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"deb389f5-9d56-4c79-b815-dcf5bb833e06"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumInterpolation", "[", 
    RowBox[{"spec_", ",", " ", "a___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"spec", "[", "\"\<Points\>\"", "]"}], ",", " ", "a"}], "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"ac69b422-28fa-4f55-bbde-a164beb0b767"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Ranges\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"51dfb78a-74cf-476d-b97a-3ddc82c9b30b"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FrequencyRange\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"873e91de-1f69-4625-bd59-4a140dc00008"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumFrequencyRange", "[", "spec_", "]"}], ":=", "\n", "\t", 
  RowBox[{"MinMax", "@", 
   RowBox[{
   "spec", "[", "\"\<Frequencies\>\"", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"9ee839a1-7212-47fd-9f4a-18fe5a5e1ad4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]IntensityRange\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"0e92b792-2f95-4eac-a0f7-c49b0e7bf85b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumIntensityRange", "[", "spec_", "]"}], ":=", "\n", 
  "\t\t", 
  RowBox[{"MinMax", "@", 
   RowBox[{
   "spec", "[", "\"\<Intensities\>\"", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"2e875a25-f96d-45c9-8c0b-fa1bc1cb71ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ScaledFrequency\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"b20ffb7d-e51f-4923-b3e9-bdabc0e836e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumScaledFrequency", "[", 
   RowBox[{"spec_", ",", " ", "p_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mm", "=", 
      RowBox[{"spec", "[", "\"\<FrequencyRange\>\"", "]"}]}], "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{"Rescale", "[", 
     RowBox[{"p", ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", "mm"}], "]"}]}], "\n", 
   "\t\t", "]"}]}]], \
"CodeInput",ExpressionUUID->"6354688d-ad47-4241-8c40-9d3561a82837"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ScaledIntensity\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"a263c883-3af5-4805-a805-792e67fa7cb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumScaledIntensity", "[", 
   RowBox[{"spec_", ",", " ", "p_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mm", "=", 
      RowBox[{"spec", "[", "\"\<IntensityRange\>\"", "]"}]}], "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{"Rescale", "[", 
     RowBox[{"p", ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", "mm"}], "]"}]}], "\n", 
   "\t\t", "]"}]}]], \
"CodeInput",ExpressionUUID->"e77b2921-0307-409b-87b3-949a526f3332"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]TrueFrequency\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"8e47e807-77c1-4995-a9ed-539e0c30f426"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumTrueFrequency", "[", 
   RowBox[{"spec_", ",", " ", "p_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{"p", ",", " ", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Scaled", "[", "s_", "]"}], ":>", 
     RowBox[{"ChemSpectrumScaledFrequency", "[", 
      RowBox[{"spec", ",", " ", "p"}], "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "2"}], "}"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"9c77f4bb-6414-4085-86d3-0c2d30ed906d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]TrueIntensity\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"74628751-f49f-450c-8d80-3826892b44f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumTrueIntensity", "[", 
   RowBox[{"spec_", ",", " ", "p_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{"p", ",", " ", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Scaled", "[", "s_", "]"}], ":>", 
     RowBox[{"ChemSpectrumScaledIntensity", "[", 
      RowBox[{"spec", ",", " ", "p"}], "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "2"}], "}"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"fab0874e-11ef-41a3-b714-e5faba486bda"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Sampling\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"9eecc3cd-fd5a-4174-b80d-9991b8627811"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]RegularlySampledQ\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"13bfe514-fe0a-4817-a429-c1aeb3e9e743"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"regSampQ", "[", 
    RowBox[{"d_", ",", " ", 
     RowBox[{"window_:", "1000"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "d"}], ">", "window"}], ",", "\n", "\t", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq", "=", "True"}], "}"}], ",", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"Do", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"DeleteDuplicates", "@", 
               RowBox[{"Differences", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"n", "-", "window"}], ";;", "n"}], "]"}], "]"}], 
                "]"}]}]}], ">", "1"}], ",", " ", "\n", "\t\t\t\t\t ", 
            RowBox[{
             RowBox[{"eq", "=", "False"}], ";", 
             RowBox[{"Break", "[", "]"}]}]}], "\n", "\t", "\t\t\t\t", "]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", " ", 
            RowBox[{"window", "+", "1"}], ",", " ", 
            RowBox[{"Length", "@", "d"}], ",", " ", "window"}], "}"}]}], 
         "]"}], ";", "\n", "\t", "\t\t\t", "eq"}]}], "\n", "\t", "\t\t\t", 
      "]"}], ",", "\n", "\t", "\t\t", 
     RowBox[{"Equal", "@@", 
      RowBox[{"Differences", "[", "d", "]"}]}]}], "\n", "\t", "\t\t", "]"}]}],
   ";"}], "\n", 
 RowBox[{"regSampQ", "~", "SetAttributes", "~", 
  "HoldFirst"}]}], \
"CodeInput",ExpressionUUID->"9d2a9ca4-eb00-42da-a5a2-60d65b646224"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumRegularlySampledQ", "[", "spec_", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"regSampQ", "@", 
   RowBox[{
   "spec", "[", "\"\<Frequencies\>\"", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"d5e2b209-f66d-4599-99bb-0d6454140868"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Norm\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"94daad5f-289d-4d3b-b19b-ee5bb65db53c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumNorm", "[", "spec_", "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"Differences", "[", 
    RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], "]"}], ".", "\n", 
   "\t\t", 
   RowBox[{"MovingAverage", "[", 
    RowBox[{
     RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], ",", " ", "2"}], 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"89ca0f90-f273-4bf6-9911-76449461a5b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Mode\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"98107f8b-8c74-4fa7-9701-0950193bb50f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumMode", "[", "spec_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"freqs", "=", 
       RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}]}], ",", "\n", 
      "\t\t\t", "subDiffs", ",", "\n", "\t\t\t", "fdiffs", ",", "\n", 
      "\t\t\t", "stdev", ",", "\n", "\t\t\t", "mean", ",", "\n", "\t\t\t", 
      "rat", ",", "\n", "\t\t\t", "range", ",", "\n", "\t\t\t", "subDiv"}], 
     "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"freqs", "=", "\n", "\t\t\t", 
      RowBox[{"Pick", "[", 
       RowBox[{"freqs", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ">", ".0001"}], "&"}], "/@", 
         RowBox[{"Rescale", "[", 
          RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], "]"}]}]}], 
       "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"fdiffs", "=", 
      RowBox[{"Differences", "[", "freqs", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"stdev", "=", 
      RowBox[{"StandardDeviation", "@", "fdiffs"}]}], ";", "\n", "\t\t", 
     RowBox[{"mean", "=", 
      RowBox[{"Mean", "@", "fdiffs"}]}], ";", "\n", "\t\t", 
     RowBox[{"rat", "=", 
      RowBox[{"stdev", "/", "mean"}]}], ";", "\n", "\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "I", " ", "might", " ", "actually", " ", "want", " ", "to", " ", 
         "filter", " ", "out", " ", "the", " ", "non"}], "-", 
        RowBox[{
        "zero", " ", "frequencies", " ", "before", " ", "I", " ", "do", " ", 
         "all", " ", "this"}]}], "..."}], " ", "*)"}], "\n", "\t\t", 
     RowBox[{"range", "=", 
      RowBox[{"Subtract", "@@", 
       RowBox[{"Reverse", "@", 
        RowBox[{"MinMax", "[", "freqs", "]"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"rat", "<", "10"}], "&&"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"mean", "/", "range"}], "<", ".0005"}], ",", "\n", "\t\t\t", 
       "\"\<Continuous\>\"", ",", "\n", "\t\t\t", "\"\<Discrete\>\""}], "\n", 
      "\t\t\t", "]"}]}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"1e4ef713-896a-4285-bcb7-7460c6363b6c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Selection\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"93209f46-ab43-43cb-b876-455e54b01fa3"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Cases\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"85774b84-82ec-47b6-ab9e-e11156c35820"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumCases", "[", "\n", "\t", 
     RowBox[{"spec_", ",", "\n", "\t", 
      RowBox[{"pat", ":", 
       RowBox[{"{", 
        RowBox[{"rangePat_", ",", "intensityPat_"}], "}"}]}]}], "\n", "\t", 
     "]"}], ":=", "\n", "\t", 
    RowBox[{"ChemSpectrumModify", "[", "\n", "\t\t", 
     RowBox[{"spec", ",", "\n", "\t\t", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"ChemSpectrumPoints", "@", "spec"}], ",", " ", "pat"}], 
       "]"}]}], "\n", "\t\t", "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"This", " ", "might", " ", "be", " ", "expensive"}], "..."}], " ",
    "*)"}]}]], \
"CodeInput",ExpressionUUID->"a85ee713-90b6-4b13-b242-128b183a45a7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Select\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"a5c7e95a-4452-47cb-bff1-c2cd51adf75c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemSpectrumSelect", "[", "\n", "\t", 
     RowBox[{"spec_", ",", "\n", "\t", "test_"}], "\n", "\t", "]"}], ":=", 
    "\n", "\t", 
    RowBox[{"ChemSpectrumModify", "[", 
     RowBox[{"spec", ",", " ", "\n", "\t\t", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"ChemSpectrumPoints", "@", "spec"}], ",", " ", "test"}], 
       "]"}]}], "\n", "\t\t", "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"This", " ", "might", " ", "be", " ", "expensive"}], "..."}], " ",
    "*)"}]}]], \
"CodeInput",ExpressionUUID->"4a473ebe-efc4-4ddb-b1e8-2059f42dfcfd"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Clip\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"0270b717-2844-4dd4-b67f-c0391e8c8890"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumClip", "[", "\n", "\t", 
    RowBox[{"spec_", ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"minInt_", ",", " ", "maxInt_"}], "}"}], ",", "\n", "\t", 
     RowBox[{"Optional", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"minClip_", "?", "NumericQ"}], ",", " ", 
         RowBox[{"maxClip_", "?", "NumericQ"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0.", ",", " ", "1."}], "}"}]}], "]"}]}], " ", "\n", "\t", 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemSpectrumModify", "[", 
    RowBox[{"spec", ",", " ", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"minInt", ",", " ", "maxInt"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"minClip", ",", " ", "maxClip"}], "}"}]}], "]"}]}], "\n", 
      "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"9411ca61-8268-4fa4-a632-9c2652ac6276"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Chop\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"f4e4fd2b-03d9-41f6-8a5e-bab0b154e03d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumChop", "[", "\n", "\t", 
    RowBox[{"spec_", ",", "\n", "\t", "thresh___"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"ChemSpectrumModify", "[", 
    RowBox[{"spec", ",", " ", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"Threshold", "[", 
        RowBox[{
         RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], ",", " ", 
         "thresh"}], "]"}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumChop", "[", "\n", "\t", 
    RowBox[{"spec_", ",", "\n", "\t", "thresh___"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"ChemSpectrumModify", "[", 
    RowBox[{"spec", ",", " ", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"Threshold", "[", 
        RowBox[{
         RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}], ",", " ", 
         "thresh"}], "]"}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"3945eea1-27ac-4b51-a0f3-cade2aec28fa"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Window\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"e3581086-1665-47d6-9972-d811fd0bc350"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chemSpectrumWindow", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"freq_", ",", " ", "int_"}], "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"freqMin_", ",", " ", "freqMax_"}], "}"}], ",", " ", "\n", "\t", 
    
    RowBox[{"{", 
     RowBox[{"intMin_", ",", " ", "intMax_"}], "}"}]}], "\n", "\t", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"sp", ",", "\n", "\t\t\t", 
      RowBox[{"fr", "=", "freq"}], ",", "\n", "\t\t\t", 
      RowBox[{"in", "=", "int"}], ",", "\n", "\t\t\t", 
      RowBox[{"frMs", "=", 
       RowBox[{"{", 
        RowBox[{"freqMin", ",", " ", "freqMax"}], "}"}]}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"inm", "=", "intMin"}], ",", "  ", 
      RowBox[{"inM", "=", "intMax"}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
    "\t\t\t", 
    RowBox[{
     RowBox[{"sp", "=", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"freqMin", "===", 
          RowBox[{"-", "\[Infinity]"}]}], ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"Length", "@", "fr"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"fr", ",", " ", 
           RowBox[{"fr", "-", "freqMin"}]}], "]"}]}], "\n", "\t\t\t\t\t", 
        "]"}], "*", "\n", "\t\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"freqMax", "===", "\[Infinity]"}], ",", " ", "\n", "\t", 
         "\t\t\t\t\t", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"Length", "@", "fr"}]}], "]"}], ",", "\n", "\t", 
         "\t\t\t\t\t", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"fr", ",", " ", 
           RowBox[{"freqMax", "-", "fr"}]}], "]"}]}], "\n", "\t", 
        "\t\t\t\t\t", "]"}]}]}], ";", "\n", "\t\t\t", 
     RowBox[{"fr", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"fr", ",", " ", "sp", ",", " ", "1"}], "]"}]}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"in", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"in", ",", " ", "sp", ",", " ", "1"}], "]"}]}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"sp", "=", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"intMin", "===", 
          RowBox[{"-", "\[Infinity]"}]}], ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"Length", "@", "in"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"in", ",", " ", 
           RowBox[{"in", "-", "intMin"}]}], "]"}]}], "\n", "\t\t\t\t\t", 
        "]"}], "*", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"intMax", "===", "\[Infinity]"}], ",", " ", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", " ", 
           RowBox[{"Length", "@", "in"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"in", ",", " ", 
           RowBox[{"intMax", "-", "in"}]}], "]"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}]}], ";", "\n", "\t\t\t", 
     RowBox[{"fr", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"fr", ",", " ", "sp", ",", " ", "1"}], "]"}]}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"in", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"in", ",", " ", "sp", ",", " ", "1"}], "]"}]}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{"fr", ",", "\n", "\t\t\t\t", "in"}], "\n", "\t\t\t\t", 
      "}"}]}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"9b4cebf4-0e02-4164-b33a-6ae865cb5ed8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumWindow", "[", 
   RowBox[{"spec_", ",", " ", "\n", "\t", 
    RowBox[{"f", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", " ", "_"}], "}"}]}], ",", " ", "\n", "\t", 
    RowBox[{"i", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", " ", "_"}], "}"}], ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}]}], 
   "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemSpectrumTransform", "[", "\n", "\t\t", 
   RowBox[{"spec", ",", " ", "\n", "\t\t", 
    RowBox[{
     RowBox[{"chemSpectrumWindow", "[", "\n", "\t\t\t", 
      RowBox[{"#", ",", " ", "\n", "\t\t\t", 
       RowBox[{"ChemSpectrumTrueFrequency", "[", 
        RowBox[{"spec", ",", " ", "f"}], "]"}], ",", " ", "\n", "\t\t\t", 
       RowBox[{"ChemSpectrumTrueIntensity", "[", 
        RowBox[{"spec", ",", " ", "i"}], "]"}]}], "\n", "\t\t\t", "]"}], 
     "&"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"ea6bd3f5-21e4-4632-a748-2009c9e75e6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Scale\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"626fb5c7-7d48-4d98-815d-503bbd8cbe2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chemSpectrumScale", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"freq_", ",", " ", "int_"}], "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"sc_", ",", " ", "o_"}], "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"is_", ",", " ", "oi_"}], "}"}]}], "\n", "\t", "]"}], ":=", "\n",
   "\t", 
  RowBox[{"{", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"sc", "*", 
      RowBox[{"(", 
       RowBox[{"freq", "-", "o"}], ")"}]}], "+", "o"}], ",", " ", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"is", "*", 
      RowBox[{"(", 
       RowBox[{"int", "-", "oi"}], ")"}]}], "+", "oi"}]}], "\n", "\t\t", 
   "}"}]}]], \
"CodeInput",ExpressionUUID->"cb0fc576-3b15-44a3-a36d-d2e808035f69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumScale", "[", 
   RowBox[{"spec_", ",", " ", "\n", "\t", 
    RowBox[{"sc_", "?", "NumericQ"}], ",", " ", "\n", "\t", 
    RowBox[{"o", ":", 
     RowBox[{"(", 
      RowBox[{"_", "?", "NumericQ"}], ")"}], ":", "0"}]}], "\n", "\t", "]"}], 
  ":=", "\n", "\t", 
  RowBox[{"ChemSpectrumTransform", "[", 
   RowBox[{"spec", ",", " ", "\n", "\t\t", 
    RowBox[{
     RowBox[{"chemSpectrumScale", "[", 
      RowBox[{"#", ",", " ", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"sc", ",", " ", "o"}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0"}], "}"}]}], "\n", "\t\t\t", "]"}], "&"}]}],
    "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"9f6706c3-3801-4110-a9fe-11abac69692b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumScale", "[", 
   RowBox[{"spec_", ",", " ", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sc_", "?", "NumericQ"}], ",", " ", 
      RowBox[{"o_", "?", "NumericQ"}]}], "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"is_", "?", "NumericQ"}], ",", " ", 
      RowBox[{"oi_", "?", "NumericQ"}]}], "}"}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemSpectrumTransform", "[", 
   RowBox[{"spec", ",", " ", "\n", "\t\t", 
    RowBox[{
     RowBox[{"chemSpectrumScale", "[", 
      RowBox[{"#", ",", " ", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"sc", ",", " ", "o"}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"is", ",", " ", "oi"}], "}"}]}], "\n", "\t\t\t", "]"}], 
     "&"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"21643ea5-b879-4b2c-bada-1725bd5010c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Shift\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"dade4df3-fe9e-4a25-9316-405626feb39b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chemSpectrumShift", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"freq_", ",", " ", "int_"}], "}"}], ",", "\n", "\t", 
    "freqShift_", ",", "\n", "\t", "intShift_"}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"freq", "+", "freqShift"}], ",", " ", 
    RowBox[{"int", "+", "intShift"}]}], 
   "}"}]}]], \
"CodeInput",ExpressionUUID->"d60f68a1-7546-4c63-9112-1d2838a88686"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumShift", "[", "\n", "\t", 
   RowBox[{"spec_", ",", " ", "\n", "\t", "freqShift_", ",", "\n", "\t", 
    RowBox[{"intShift_:", "0"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemSpectrumTransform", "[", 
   RowBox[{"spec", ",", " ", "\n", "\t\t", 
    RowBox[{
     RowBox[{"chemSpectrumShift", "[", 
      RowBox[{"#", ",", "\n", "\t\t\t", 
       RowBox[{"ChemSpectrumTrueFrequency", "[", 
        RowBox[{"spec", ",", " ", "freqShift"}], "]"}], ",", " ", "\n", 
       "\t\t\t", 
       RowBox[{"ChemSpectrumTrueIntensity", "[", 
        RowBox[{"spec", ",", " ", "intShift"}], "]"}]}], "\n", "\t\t\t", 
      "]"}], "&"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"2937db1d-11ec-4948-9fa3-ced8184bee7f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Peak Stuff\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6942087864188957`*^9, 
  3.694208792674219*^9}},ExpressionUUID->"d8b1f6da-e804-47a7-a855-\
e528f773f8c4"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FindPeaks\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"11e7f6ac-3097-4b08-b4d5-8a65eee43cf6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "ChemSpectrumFindPeaks"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "FindPeaks"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemSpectrumFindPeaks", "[", 
    RowBox[{"spec_", ",", " ", "params___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"fr", "=", 
        RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"in", "=", 
        RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}]}], ",", "\n", 
       "\t\t\t", "pk"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"pk", "=", 
       RowBox[{"PeakDetect", "[", 
        RowBox[{"in", ",", " ", "params"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"fr", "=", 
       RowBox[{"Pick", "[", 
        RowBox[{"fr", ",", " ", "pk", ",", " ", "1"}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "fr"}], ">", "0"}], ",", "\n", "\t\t\t", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"fr", ",", " ", 
           RowBox[{"Pick", "[", 
            RowBox[{"in", ",", " ", "pk", ",", " ", "1"}], "]"}]}], "}"}]}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"{", "}"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], \
"CodeInput",ExpressionUUID->"2aa54cb4-fdbd-41ec-97c2-29b8604d336c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NearestPeaks\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"46c2529c-3cf2-4b86-9706-d3a64d1a0dc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemSpectrumNearestPeaks", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"\"\<FindPeakParameters\>\"", "\[Rule]", 
     RowBox[{"{", "}"}]}], "\n", "\t\t", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemSpectrumNearestPeaks", "[", 
   RowBox[{"spec_", ",", " ", "\n", "\t", 
    RowBox[{"peak_", "?", "NumericQ"}], ",", " ", "\n", "\t", 
    RowBox[{"n___", "?", 
     RowBox[{"(", 
      RowBox[{"Not", "@*", "OptionQ"}], ")"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pk", "=", 
      RowBox[{"ChemSpectrumFindPeaks", "[", 
       RowBox[{"spec", ",", " ", 
        RowBox[{"OptionValue", "[", "\"\<FindPeakParameters\>\"", "]"}]}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"pk", "[", 
     RowBox[{"[", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pk", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "\[Rule]", 
         "\"\<Index\>\""}], ",", " ", "peak", ",", " ", "n"}], "]"}], "]"}], 
     "]"}]}], "\n", "\t\t", 
   "]"}]}]}], \
"CodeInput",ExpressionUUID->"d2e48b6e-72bb-4f08-9ac6-53fc769cede0"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Normalization\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"4fd90899-1d2a-4d5b-ba26-1c0047852675"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Normalize\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"69d1ca29-7eaf-4df4-9077-1f622863ec52"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "ChemSpectrumNormalize", "[", "\n", "\t", "spec_", "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemSpectrumTransform", "[", "\n", "\t\t", 
   RowBox[{"spec", ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Differences", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
          RowBox[{"MovingAverage", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", "2"}], "]"}]}], 
         ")"}]}]}], "\n", "\t\t\t", "}"}], "&"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"f404db68-5f77-4f5b-8e21-42cb1d8aaf2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Smooth\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"5a1b8089-fbaf-4422-92cb-8350460f63d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumSmooth", "[", "\n", "\t", 
   RowBox[{"spec_", ",", "\n", "\t", 
    RowBox[{"averagePoints_:", "10"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  
  RowBox[{"ChemSpectrumTransform", "[", 
   RowBox[{"spec", ",", " ", 
    RowBox[{
     RowBox[{"MovingAverage", "[", 
      RowBox[{"#", ",", " ", "averagePoints"}], "]"}], "&"}]}], 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"3bea1041-7b62-4016-a913-b63ee2c0ed1f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Adjust\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"0ded2b4f-4af5-4929-94a0-271443ec751f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemSpectrumAdjust", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<FrequencyRange\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<SmoothingPoints\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<FrequencyScaling\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<FrequencyShift\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<IntensityThreshold\>\"", "\[Rule]", "Automatic"}], ",", 
     "\n", "\t\t", 
     RowBox[{"\"\<IntensityScaling\>\"", "\[Rule]", "Automatic"}]}], "\n", 
    "\t\t", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"chemSpectrumAdjust", "[", "\n", "\t", 
   RowBox[{"spec_", ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{
   RowBox[{"PackageExceptionBlock", "[", "\"\<Spectrum\>\"", "]"}], "@", "\n",
    "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "sps", ",", "\n", "\t\t\t", "freqs", ",", "\n", "\t\t\t", "ints", ",", 
       "\n", "\t\t\t", "pspec", ",", "\n", "\t\t\t", 
       RowBox[{"rang", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<FrequencyRange\>\"", "]"}], ",", 
          " ", 
          RowBox[{"Automatic", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], 
            "}"}]}]}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"scale", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<IntensityScaling\>\"", "]"}], ",", 
          " ", 
          RowBox[{"Automatic", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "0"}], "}"}]}]}], "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"shif", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<FrequencyShift\>\"", "]"}], ",", 
          " ", 
          RowBox[{"Automatic", "\[Rule]", "0"}]}], "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"spacescale", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<FrequencyScaling\>\"", "]"}], ",", 
          " ", 
          RowBox[{"Automatic", "\[Rule]", "1"}]}], "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"thresh", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<IntensityThreshold\>\"", "]"}], 
          ",", " ", 
          RowBox[{"Automatic", "\[Rule]", 
           RowBox[{"Scaled", "[", ".001", "]"}]}]}], "]"}]}], ",", "\n", 
       "\t\t\t", "spmin"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"rang", ",", " ", 
           RowBox[{"{", 
            RowBox[{"_", ",", " ", "_"}], "}"}]}], "]"}]}], ",", " ", "\n", 
        "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", 
         RowBox[{
         "Automatic", ",", " ", "\n", "\t\t\t\t", 
          "\"\<Frequency range `` is expected to be a min and max frequency\>\
\"", ",", "\n", "\t\t\t\t", "rang"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"rang", "=", 
       RowBox[{"ChemSpectrumTrueFrequency", "[", 
        RowBox[{"spec", ",", " ", "rang"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"thresh", "=", 
       RowBox[{"ChemSpectrumTrueIntensity", "[", 
        RowBox[{"spec", ",", " ", "thresh"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"NumericQ", "@", "thresh"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", 
         RowBox[{
         "Automatic", ",", " ", "\n", "\t\t\t\t", 
          "\"\<Intensity threshold `` is expected to be a number or \
Scaled\>\"", ",", "\n", "\t\t\t\t", "thresh"}], "\n", "\t\t\t\t", "]"}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"rang", ",", " ", 
           RowBox[{"{", 
            RowBox[{"_", ",", " ", "_"}], "}"}]}], "]"}]}], ",", " ", "\n", 
        "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", 
         RowBox[{
         "Automatic", ",", " ", "\n", "\t\t\t\t", 
          "\"\<Frequency range `` is expected to be a min and max frequency\>\
\"", ",", "\n", "\t\t\t\t", "rang"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"shif", "=", 
       RowBox[{"ChemSpectrumTrueFrequency", "[", 
        RowBox[{"spec", ",", " ", "shif"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"NumericQ", "@", "shif"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", 
         RowBox[{
         "Automatic", ",", " ", "\n", "\t\t\t\t", 
          "\"\<Frequency shift `` is expected to be a number or Scaled\>\"", 
          ",", "\n", "\t\t\t\t", "shif"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"scale", "=", 
       RowBox[{"ChemSpectrumTrueIntensity", "[", 
        RowBox[{"spec", ",", " ", "scale"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"scale", ",", " ", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], "|", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", " ", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}]}], ",", "\n",
         "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", 
         RowBox[{
         "Automatic", ",", " ", "\n", "\t\t\t\t", 
          "\"\<Intensity scaling `` is expected to be a number or list of \
scaling and offset\>\"", ",", "\n", "\t\t\t\t", "scale"}], "\n", "\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"spacescale", "=", 
       RowBox[{"ChemSpectrumTrueIntensity", "[", 
        RowBox[{"spec", ",", " ", "spacescale"}], "]"}]}], ";", "\n", "\t\t", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"spacescale", ",", " ", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], "|", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", " ", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}]}], ",", "\n",
         "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", 
         RowBox[{
         "Automatic", ",", " ", "\n", "\t\t\t\t", 
          "\"\<Frequency scaling `` is expected to be a number or list of \
scaling and offset\>\"", ",", "\n", "\t\t\t\t", "spacescale"}], "\n", 
         "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"freqs", ",", " ", "ints"}], "}"}], "=", "\n", "\t\t\t", 
       RowBox[{"chemSpectrumWindow", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"chemSpectrumShift", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"chemSpectrumScale", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}], ",", " ", 
               RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}]}], "}"}], 
             ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumericQ", "@", "spacescale"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"spacescale", ",", " ", "0"}], "}"}], ",", " ", 
               "spacescale"}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NumericQ", "@", "scale"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"scale", ",", " ", "0"}], "}"}], ",", " ", "scale"}], 
              "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
           "shif", ",", "\n", "\t\t\t\t\t", "0"}], "\n", "\t\t\t\t\t", "]"}], 
         ",", "\n", "\t\t\t\t", "rang", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "thresh"}], "}"}]}], "\n", "\t\t\t\t", 
        "]"}]}]}]}], "\n", "\t\t", 
    "]"}]}]}]}], \
"CodeInput",ExpressionUUID->"d8b69296-aa0c-475a-9090-b84a6987b2df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumAdjust", "[", 
   RowBox[{"spec_", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemSpectrumModify", "[", 
   RowBox[{"spec", ",", " ", "\n", "\t\t", 
    RowBox[{"chemSpectrumAdjust", "[", 
     RowBox[{"spec", ",", " ", "ops"}], "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"b7ddb6e8-0514-46ac-a9c5-ea4b9772199c"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Broadening\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"24da254b-5b11-4b0d-8fb0-f0875ab55a22"],

Cell["\<\
\[LeftCeiling]
\tIntroduces broadening to a discrete spectrum
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"e7127b89-ab35-45c7-9c45-0b59eb5bc967"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]General\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7422236797464857`*^9, 
  3.7422236804406424`*^9}},ExpressionUUID->"3f0e0e4e-a3b6-428f-acdc-\
22e5790ddbac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumDistribution", "[", 
   RowBox[{"spec_", ",", " ", "distribution_", ",", " ", "weighting_"}], 
   "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
     "ints", ",", "\n", "\t\t\t", "pos", ",", "\n", "\t", "\t\t", "dists", 
      ",", "\n", "\t", "\t\t", "weights"}], "\n", "\t\t\t", "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"ints", "=", 
      RowBox[{"spec", "[", "\"\<Intensities\>\"", "]"}]}], ";", "\n", "\t\t", 
     
     RowBox[{"pos", "=", 
      RowBox[{"spec", "[", "\"\<Frequencies\>\"", "]"}]}], ";", "\n", "\t\t", 
     
     RowBox[{"dists", "=", 
      RowBox[{"distribution", "/@", "pos"}]}], ";", "\n", "\t", "\t", 
     RowBox[{"weights", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"weighting", ",", " ", 
        RowBox[{"{", 
         RowBox[{"ints", ",", " ", "dists"}], "}"}]}], "]"}]}], ";", "\n", 
     "\t", "\t", 
     RowBox[{"MixtureDistribution", "[", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "ints", "]"}], "*", 
        RowBox[{"weights", "/", 
         RowBox[{"Max", "[", "weights", "]"}]}]}], ",", "\n", "\t\t\t", 
       "dists"}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"71fc1b05-38df-4ba6-bf18-6a22a8f7c38e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Gaussian Broadening\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.742223571543468*^9, 3.742223575552219*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"a0a7420c-432e-488d-a04c-1cccafcba2c7"],

Cell[BoxData[
 RowBox[{"ChemSpectrumNormalDistribution", "//", 
  "Clear"}]], \
"CodeInput",ExpressionUUID->"af2b1895-309f-43b3-8700-3e1f10828e21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumNormalDistribution", "[", 
   RowBox[{"spec_", ",", " ", 
    RowBox[{"broadening_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"broadness", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"broadening", ",", " ", 
        RowBox[{"Automatic", "\[Rule]", "5"}]}], "]"}]}], "}"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"placeholder", " ", "until", " ", 
      RowBox[{"I", "'"}], "m", " ", "smarter"}], " ", "*)"}], "\n", "\t\t", 
    RowBox[{"ChemSpectrumDistribution", "[", 
     RowBox[{"spec", ",", " ", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"#", ",", " ", "broadness"}], "]"}], "&"}], ",", "\n", "\t", 
      "\t\t", 
      RowBox[{
       RowBox[{"#", "/", 
        RowBox[{"(", 
         RowBox[{"broadness", "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"2", "\[Pi]"}], "]"}]}], ")"}]}], "&"}]}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"b203af23-6d4b-467e-bb87-7174f1538ef0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Lorentzian Broadening\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.742223571543468*^9, 
  3.7422235822741833`*^9}},ExpressionUUID->"08621f91-f6e7-4da5-880e-\
578a67b785b6"],

Cell[BoxData[
 RowBox[{"ChemSpectrumCauchyDistribution", "//", 
  "Clear"}]], \
"CodeInput",ExpressionUUID->"698ee2a7-7485-4617-8e10-b680bd705bfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemSpectrumCauchyDistribution", "[", 
   RowBox[{"spec_", ",", " ", 
    RowBox[{"broadening_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"broadness", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"broadening", ",", " ", 
        RowBox[{"Automatic", "\[Rule]", "5"}]}], "]"}]}], "}"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"placeholder", " ", "until", " ", 
      RowBox[{"I", "'"}], "m", " ", "smarter"}], " ", "*)"}], "\n", "\t\t", 
    RowBox[{"ChemSpectrumDistribution", "[", 
     RowBox[{"spec", ",", " ", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{"CauchyDistribution", "[", 
        RowBox[{"#", ",", " ", "broadness"}], "]"}], "&"}], ",", "\n", "\t", 
      "\t\t", 
      RowBox[{
       RowBox[{"#", "/", 
        RowBox[{"(", 
         RowBox[{"broadness", "*", 
          RowBox[{"Sqrt", "[", "\[Pi]", "]"}]}], ")"}]}], "&"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"aae2fe06-ebdb-4211-addf-4af0ee8a7327"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"9dac5ffd-3497-409e-be10-\
a60ab050c12b"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"7caa748b-78fc-4082-aded-\
e57495d40106"]
},
WindowSize->{808, 755},
WindowMargins->{{Automatic, 84}, {Automatic, 0}},
TaggingRules->{
 "UUIDButtons" -> {
   "Active" -> {
     "Button-590233c6-9680-4d8a-a854-3b15b03893d8" -> False, 
      "Button-33d6ec4d-a39a-4e80-8d92-b8c5561caada" -> False, 
      "Button-c0a09a32-e26b-44bc-931b-a7a8eaa0a4c0" -> False, 
      "Button-4f342a03-9e58-4750-a06d-ce41ba26caad" -> False, 
      "Button-a28516f9-2411-4ad5-87c4-dde843a65756" -> False, 
      "Button-451406bf-3901-4e2c-bbfb-9864f8531f68" -> False, 
      "Button-0d27d59a-6c0a-4062-941e-7021a66cffb6" -> False, 
      "Button-d418e9af-6b42-439f-a2d9-cf94f63c942b" -> False, 
      "Button-4a98cbb2-0f4f-4744-9fda-a829730130bc" -> False, 
      "Button-b8297203-6b28-48f9-8ba3-edbd5eb431d2" -> False, 
      "Button-8c92aebb-2725-4f7c-a6a8-f90e3a4dce9c" -> False, 
      "Button-ede3a027-3279-40a0-8aa4-1fcc5f60357d" -> False, 
      "Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
      "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
      "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

