(* ::Package:: *)


(* ::Title:: *)
(*AtomsetUtils Package*)

(* ::Text::GrayLevel[.5]:: *)
(*Autogenerated ChemTools package*)

CreateTetrahedralAtomset::usage=
	"Makes a new tetrahedral atomset based off of a methane";


Begin["`Private`"];


CreateTetrahedralAtomset//Clear


CreateTetrahedralAtomset[
	coreEl:_String|{_String,___}:"C",
	elements:{Repeated[_String|{_String,___},{4}]},
	check:True|False:False
	]:=
	With[{core=ChemImport["methane"]},
		With[{
			cCore=First@AtomsetGetAtoms[core,"C"],
			hs=AtomsetGetAtoms[core,"H"],
			newCore=CreateAtom@coreEl,
			newOuter=CreateAtom/@elements,
			oldBonds=ChemGet[core["Atoms"],"Bonds"]
			},
			AtomsetSubstituteAtom[
				core,
				Prepend[cCore->newCore]@
					Thread[hs->newOuter],
				check
				];
			ChemRemove/@Flatten@{hs,cCore,oldBonds};
			AtomsetNormalizeBonds[core];
			core
			]
		]


End[];



