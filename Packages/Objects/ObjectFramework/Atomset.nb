Notebook[{

Cell[CellGroupData[{
Cell["Atomset", "CodeSection",
 Evaluatable->False,
 CellChangeTimes->{{3.715287701711544*^9, 
  3.7152877026229267`*^9}},ExpressionUUID->"7acd24f7-b060-4378-849f-\
d5ea9fb6beb9"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Methods\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.691807286050041*^9, 3.691807300265464*^9}, 
   3.692412577527869*^9},ExpressionUUID->"5ec38a51-234e-4885-9e1b-\
4c4e163fec4e"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Creation\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6948705518164883`*^9, 
  3.694870553751421*^9}},ExpressionUUID->"8270b246-32bd-4c75-9f04-\
31f1ed28ff1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreateAtomset", "::", "usage"}], "=", 
   "\"\<Creates an atom set\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.691807461958839*^9, 3.69180747430401*^9}, {
   3.691807547156292*^9, 3.691807598858609*^9}, 3.69241254252344*^9, {
   3.69241257304105*^9, 3.6924125894814663`*^9}, 3.692451252884306*^9, {
   3.700092818051751*^9, 3.7000928527879543`*^9}, {3.700093748294573*^9, 
   3.700093748572188*^9}},ExpressionUUID->"605ba1c3-040f-478d-868f-\
ad243e52721f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAddAtom", "::", "usage"}], "=", 
   "\"\<Adds an atom to an atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRemoveAtom", "::", "usage"}], "=", 
   "\"\<Removes an atom from an atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGetAtoms", "::", "usage"}], "=", 
   "\"\<Gets atoms matching a property\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692451258114037*^9, 3.692451276200618*^9}, {
  3.692451505860423*^9, 
  3.692451540344*^9}},ExpressionUUID->"6552469d-0bed-47fe-bbdb-6e993e2a82cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetJoin", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Creates a new atomset from a collection of atomsets\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.70019091596594*^9, 3.700190954284403*^9}, {
  3.700190987763256*^9, 
  3.7001910042815332`*^9}},ExpressionUUID->"af6b7057-7924-4d62-abcb-\
9ccf180e21b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetEmpiricalFormula", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Pulls the empirical formula for the atomset\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.694492933968183*^9, 
  3.694492953404509*^9}},ExpressionUUID->"7d490cef-2e31-4956-adb8-\
ce17f7030b58"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atom Properties\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870560934799*^9, 
  3.694870566519072*^9}},ExpressionUUID->"7aecde73-82ac-4edb-8520-\
7e36f0ce3b75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetElementPositions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns element position pairs for all the atoms\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetNeighborMap", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns a map of an atom and its neighbors\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMolTable", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns a mol table form of the atomset\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6929994285402737`*^9, 3.692999435754059*^9}, {
  3.694349251979931*^9, 3.694349281845557*^9}, {3.694349873487385*^9, 
  3.694349897571168*^9}, {3.694489615466734*^9, 3.694489684651245*^9}, {
  3.694831340537627*^9, 3.694831358478753*^9}, {3.70009874599424*^9, 
  3.700098756456036*^9}},ExpressionUUID->"7a43547f-1aa8-4106-be28-\
cdbb7f4d3d53"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetSubstituteAtom", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Substitutes in a new atom for an old one\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.710258742848445*^9, 3.7102587582961187`*^9}, {
   3.7102594494283457`*^9, 3.7102594527048388`*^9}, 
   3.710261151092321*^9},ExpressionUUID->"b7730a7f-13ed-4094-84ab-\
5da140e06349"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Bond Properties\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700098749901849*^9, 
  3.70009875173368*^9}},ExpressionUUID->"2ac8f511-f293-414d-9462-\
92d543939170"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBondsIndexed", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns an {i1, i2, type} matrix\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AtomsetBonds", "::", "usage"}], "=", "\n", "\t", 
    "\"\<Returns the bonds an {i, j} -> b association\>\""}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBondLengths", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the indices and length for each bond in the atomset\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBondVectors", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the indices and bond vector for each bond\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMeanBondLengths", "::", "usage"}], "=", 
   "\"\<Returns the mean bond length by atom type\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6929994285402737`*^9, 3.692999435754059*^9}, {
   3.694349251979931*^9, 3.694349281845557*^9}, {3.694349873487385*^9, 
   3.694349897571168*^9}, 3.694489615466734*^9, {3.700096792317333*^9, 
   3.700096810278985*^9}, {3.700098753383068*^9, 
   3.700098791877289*^9}},ExpressionUUID->"f25b4f69-7922-4c86-8293-\
14c717db0772"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetNormalizeBonds", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Normalizes bonds against the standard lookup table\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetSetBondLengths", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Sets bond lengths within an atomset\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.710258233893388*^9, 3.710258244514906*^9}, {
  3.7208470155139847`*^9, 
  3.720847026030204*^9}},ExpressionUUID->"dff790c6-b2ea-495a-ae1d-\
bf18fc71faf2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Point-wise ops\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870573455838*^9, 
  3.6948705937198*^9}},ExpressionUUID->"74e0e850-6c7a-471e-a75c-79759de91864"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBounds", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Applies CoordinateBounds to atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMassPositions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns mass position pairs for all the atoms\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetCenter", "::", "usage"}], "=", 
   "\"\<Returns the center of the atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetCenterOfMass", "::", "usage"}], "=", 
   "\"\<Gets the center of pass of the Atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMove", "::", "usage"}], "=", "\"\<Moves an atom set\>\""}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetTransform", "::", "usage"}], "=", 
   "\"\<Applies a matrix mult or transformation to the atoms\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRotate", "::", "usage"}], "=", 
   "\"\<Rotates an atom set\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRotationTransform", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns a rotation transform on an atom set\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAxisAlign", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Aligns the atomset along a pair of axis specs\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAlign", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Aligns the atomset with another atomset\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.691807461958839*^9, 3.69180747430401*^9}, {
   3.691807547156292*^9, 3.691807598858609*^9}, 3.69241254252344*^9, {
   3.69241257304105*^9, 3.6924125894814663`*^9}, 3.692451252884306*^9, {
   3.6924780267117777`*^9, 3.692478037766224*^9}, {3.692478330195158*^9, 
   3.69247834108685*^9}, {3.692492379005992*^9, 3.692492419544408*^9}, {
   3.692999420860177*^9, 3.692999424034924*^9}, {3.6997493912181597`*^9, 
   3.69974942804559*^9}, {3.70014881336334*^9, 3.700148832152299*^9}, {
   3.700194565328318*^9, 3.700194580460505*^9}, {3.71019968607318*^9, 
   3.7101997053471947`*^9}},ExpressionUUID->"0e7cbc8e-b626-49ce-8d2b-\
62fd2558c964"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Rotational Spec\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870576399506*^9, 
  3.694870581870451*^9}},ExpressionUUID->"3c0afaf7-a34f-442f-b005-\
9ad19179b043"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialTensor", "::", "usage"}], "=", 
   "\"\<Returns the inertial tensor of the atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialEigensystem", "::", "usage"}], "=", 
   "\"\<Returns the eigensystem of the atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialSystem", "::", "usage"}], "=", 
   "\"\<Returns inertial system of atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetPrincipalAxes", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the principal axes of the system with sizes equal to the \
moments\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692536672432723*^9, 3.692536721201024*^9}, {
  3.692569842902479*^9, 3.692569865549478*^9}, {3.694035226067505*^9, 
  3.6940352361930513`*^9}},ExpressionUUID->"3f1a382d-4303-4e5b-b2f7-\
bfa08ef866f5"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Symmetry\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870585247295*^9, 3.694870586630322*^9}, 
   3.694895244640306*^9},ExpressionUUID->"ed26e82a-bd45-47c8-ab25-\
fec78660e29c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetSymmetryElements", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Finds the symmetry elements of the specified atoms in the \
atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialSymmetry", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Finds the symmetry elements of the atomset relating to the inertial \
axes\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetPointGroup", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Guesses the atomset point group\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693952265936307*^9, 
  3.693952338940448*^9}},ExpressionUUID->"b44261bc-6de9-4704-9796-\
5ef5a1ed5fda"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Surfaces and Point functions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870599829525*^9, 
  3.694870605925371*^9}},ExpressionUUID->"738dfb29-756c-41f7-9e01-\
4118d17fa287"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetVdWSurface", "::", "usage"}], "=", 
   "\"\<Returns a mesh of the Van der Waals surface of the atomset\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetVdWVolume", "::", "usage"}], "=", 
   "\"\<Returns the Van der Waals volume of the atomset\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692589690182603*^9, 3.6925897052279387`*^9}, {
  3.692589767990847*^9, 3.692589777172327*^9}, {3.69258987013846*^9, 
  3.6925898865675907`*^9}},ExpressionUUID->"7ae6fec5-1ffb-46be-a066-\
40f0f5c9eb13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetCompile", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Macro to generate function over the atoms in an atomset\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetPointCompile", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Version of AtomsetCompile with Point as the first argument\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6928430457372723`*^9, 3.692843082841754*^9}, {
  3.69284442688369*^9, 3.6928445661319637`*^9}, {3.6928446850480127`*^9, 
  3.692844706306052*^9}, {3.6932648661529093`*^9, 
  3.693264867688985*^9}},ExpressionUUID->"96fbd2af-28e6-48c6-8ce1-\
fc80ee5d3c33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetPartialCharges", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Calculates the Gasteiger partial charges\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetElectricPotential", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Uses the partial charges to generate an esp function\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6948950602426977`*^9, 3.694895096825575*^9}, {
  3.694895197323865*^9, 
  3.69489522419308*^9}},ExpressionUUID->"7d6d2089-c7c0-4222-9558-\
9756604b3216"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetElectricPotentialMap", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Plots the electric potential on the VdW surface\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.694895225969816*^9, 
  3.694895242881699*^9}},ExpressionUUID->"ce3b971a-7e61-400d-9642-\
e4589fcc2513"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Extensions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.710213391572706*^9, 3.710213392513986*^9}, {
  3.711065991142983*^9, 
  3.711065993020113*^9}},ExpressionUUID->"0b54d95c-31e4-46fa-b84d-\
35481cc8abbf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetOrbitals", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Calculates orbitals for an atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetOrbitalsPlot", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Plots orbitals as DensityPlot3D\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.710213395683427*^9, 3.710213410306168*^9}, {
  3.710214722505805*^9, 
  3.710214737474964*^9}},ExpressionUUID->"3864fc72-80a5-4dd4-865c-\
14fbf58a9851"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetEnergyScan", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Scans atomset energy with molecules in different positions\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.711065993830331*^9, 
  3.711066042343747*^9}},ExpressionUUID->"d16ded9c-2301-4dd6-9a11-\
3d835ee007e3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Sample function\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870614140937*^9, 
  3.6948706253248262`*^9}},ExpressionUUID->"86b5e7a5-d9e8-4186-ac75-\
5426eb817275"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AtomsetPolarMoment", "::", "usage"}], "=", 
       "\"\<Returns a polarization gradient vector\>\""}], ";"}], "\n", 
     RowBox[{"AtomsetPolarCenter", "::", "usage"}]}], "=", "\n", "\t", 
    "\"\<Uses FixedPoint to follow the polarization vectors\>\""}], ";", "\n", 
   RowBox[{
    RowBox[{"AtomsetPolarMomentPlot", "::", "usage"}], "=", "\n", "\t", 
    "\"\<Uses compiled PolarMoment to generate a ChemSurfacePlot\>\""}], ";", 
   "\n", 
   RowBox[{
    RowBox[{"AtomsetPolarization", "::", "usage"}], "=", "\n", "\t", 
    "\"\<Returns the vector from the center of an atomset to its polar center\
\>\""}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6924923416810713`*^9, 3.692492372619049*^9}, {
   3.6925757247065077`*^9, 3.6925757457564087`*^9}, {3.6925765633546667`*^9, 
   3.692576615838451*^9}, 3.692589687686317*^9, {3.692596518578624*^9, 
   3.692596543709408*^9}, {3.692843036961377*^9, 
   3.692843040861129*^9}},ExpressionUUID->"92816508-401b-412b-859d-\
7851c3e0534f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Connections and Type Testing\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870631212399*^9, 
  3.694870649907876*^9}},ExpressionUUID->"88d122dd-881f-4ef7-a36b-\
bb9b477d8bfc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraph", "::", "usage"}], "=", 
   "\"\<Returns the graph of the atomset\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraphScan", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Applies a BFS or DFS scan to atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetConnectedComponents", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the collection of connected components for the atomset\>\""}],
   ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692536398744194*^9, 3.692536466356616*^9}, 
   3.692569840701067*^9, {3.692570160816931*^9, 3.692570161076988*^9}, {
   3.700281378491619*^9, 
   3.700281392919582*^9}},ExpressionUUID->"599db343-4ee2-40e7-b911-\
9d857d3dbe39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRings", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the collection of rings for the atomset\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetConjugatedSystems", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the collection of conjugated systems for the atomset\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAromaticRings", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the collection of aromatic rings for the atomset\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAromaticQ", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Checks whether an atom or collection of atoms are aromatic\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694832618003961*^9, 3.694832633424164*^9}, {
  3.694834660827374*^9, 3.694834675320181*^9}, {3.694835171349266*^9, 
  3.694835184105335*^9}, {3.69486719360254*^9, 
  3.694867208411368*^9}},ExpressionUUID->"d0e54554-2cf8-40c8-bcbe-\
0edb70a259be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Checks whether an atom or collection of atoms are of a certain type\>\
\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694872047637912*^9, 3.694872065292729*^9}, 
   3.694874087076428*^9},ExpressionUUID->"df1c0b6d-d934-46af-97ce-\
c9423bf7198a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Graphics\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69487065554629*^9, 
  3.6948706566837463`*^9}},ExpressionUUID->"ac81324c-d889-4e2b-a94e-\
9189122c1e99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraphic", "::", "usage"}], "=", 
   "\"\<Gets a 2D atom set graphics object\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraphic3D", "::", "usage"}], "=", 
   "\"\<Gets a 3D bond graphics object\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.691807461958839*^9, 3.69180747430401*^9}, {
  3.691807547156292*^9, 3.691807598858609*^9}, {3.69241254252344*^9, 
  3.6924125703857727`*^9}},ExpressionUUID->"d3482a26-5f51-451b-8d47-\
c668f22ab657"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Wrappers\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6944893901473703`*^9, 3.694489391145605*^9}, {
  3.7325514573953943`*^9, 
  3.732551457599872*^9}},ExpressionUUID->"b608a27b-becd-41b1-ac15-\
5b802f3265c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetWrapper", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A wrapper that acts like an atomset that creates and deletes itself\>\
\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694489312430498*^9, 
  3.694489380026849*^9}},ExpressionUUID->"1806a38a-574b-46f4-909c-\
99128cb1b5c7"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"c70bc9f8-0e89-4198-948e-\
01b1a2dd9573"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Load", " ", "the", " ", "symbolic", " ", "python", " ", "package"}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"PyToolsLoad", "[", "]"}], ";"}]}]], "CodeInput",
 CellChangeTimes->{{3.715551319564178*^9, 3.71555133834473*^9}, {
  3.726974915581091*^9, 3.726974915763011*^9}, {3.732550840015297*^9, 
  3.732550845426303*^9}},ExpressionUUID->"07929552-d5d1-4e58-b956-\
f5da11a6b763"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Class\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7269718367584133`*^9, 3.7269718400451097`*^9}, {
  3.7308435596451473`*^9, 
  3.730843561004404*^9}},ExpressionUUID->"e85e2a9a-ab53-4b3d-8361-\
5ff30a7256fb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"$ChemObjectDefaults", "[", "\"\<Atomset\>\"", "]"}], "=."}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.726973735927697*^9, 
  3.726973736126667*^9}},ExpressionUUID->"6e73db30-fb09-4dc8-9386-\
fd5af599a0d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"KeyMemberQ", "[", 
      RowBox[{"$ChemObjectDefaults", ",", " ", "\"\<Atomset\>\""}], "]"}]}], 
    ",", "\n", "\t", 
    RowBox[{
     RowBox[{"$ChemObjectDefaults", "[", "\"\<Atomset\>\"", "]"}], "=", "\n", 
     "\t\t\t", 
     RowBox[{"<|", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Atoms\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Join\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetJoin", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<GetAtom\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetGetAtoms", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<AddAtom\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetAddAtom", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<RemoveAtom\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetRemoveAtom", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<SubstitueAtom\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetSubstitueAtom", "]"}]}], ",", "\n",
        "\t\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Bonds\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetBonds", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<BondVectors\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetBondVectors", "]"}]}], ",", "\n",
        "\t\t\t\t", 
       RowBox[{"\"\<BondsIndexed\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetBondsIndexed", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<SetBondLength\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetSetBondLength", "]"}]}], ",", "\n",
        "\t\t\t\t", 
       RowBox[{"\"\<NormalizeBonds\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetNormalizeBonds", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<GuessBonds\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetGuessBonds", "]"}]}], ",", "\n", 
       "\t\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Center\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetCenter", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<CenterOfMass\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetCenterOfMass", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<MassPositions\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetMassPositions", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<Bounds\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetBounds", "]"}]}], ",", "\n", 
       "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Rotate\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetRotate", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<Move\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetMove", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<Transform\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetTransform", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<Align\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetAlign", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<AxisAlign\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetAxisAlign", "]"}]}], ",", "\n", 
       "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<IntertialTensor\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetIntertialTensor", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<InertialEigensystem\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetInertialEigensystem", "]"}]}], 
       ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<InertialSystem\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetInertialSystem", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<PrincipalAxes\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetPrincipalAxes", "]"}]}], ",", 
       "\n", "\n", "\t\t\t\t", 
       RowBox[{"\"\<EmpiricalFormula\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "EmpiricalFormula", "]"}]}], ",", "\n", 
       "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<AdjacencyMatrix\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetAdjacencyMatrix", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<ConnectedComponents\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetConnectedComponents", "]"}]}], 
       ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Graph\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetGraph", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<GraphScan\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetGraphScan", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<NeighborMap\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetNeighborMap", "]"}]}], ",", "\n",
        "\t\t\t\t", 
       RowBox[{"\"\<Rings\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetRings", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<AromaticRings\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetAromaticRings", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<AtomMemberQ\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemProperty", "[", "AtomsetAtomMemberQ", "]"}]}], ",", "\n",
        "\t\t\t\t", 
       RowBox[{"\"\<AromaticQ\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetAromaticQ", "]"}]}], ",", "\n", 
       "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Surface\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetVdWSurface", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<Volume\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetVdWVolume", "]"}]}], ",", "\n", 
       "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<ElectricPotential\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetElectricPotential", "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<ElectricPotentialMap\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetElectricPotentialMap", "]"}]}], 
       ",", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Orbitals\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetOrbitals", "]"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<OrbitalsPlot\>\"", "->", "\n", "\t\t\t\t\t", 
        RowBox[{"ChemMethod", "[", "AtomsetOrbitalsPlot", "]"}]}], ",", "\n", 
       "\t\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Graphic\>\"", "\[Rule]", 
        RowBox[{"ChemMethod", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"o", "=", 
              RowBox[{"{", "##", "}"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"AtomsetGraphic", "[", 
             RowBox[{
              RowBox[{"First", "@", "o"}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"Rest", "@", "o"}], ",", " ", 
                 RowBox[{"Options", "@", "AtomsetGraphic"}]}], "]"}]}]}], 
             "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], 
          "&"}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Graphic3D\>\"", "\[Rule]", 
        RowBox[{"ChemMethod", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"o", "=", 
              RowBox[{"{", "##", "}"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"AtomsetGraphic3D", "[", 
             RowBox[{
              RowBox[{"First", "@", "o"}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"Rest", "@", "o"}], ",", " ", 
                 RowBox[{"Options", "@", "AtomsetGraphic3D"}]}], "]"}]}]}], 
             "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], 
          "&"}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "|>"}]}]}], 
   "\n", "  ", "]"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7269718460174503`*^9, 3.726971866710965*^9}, {
   3.72697192852835*^9, 3.726971937213673*^9}, {3.7269729527788763`*^9, 
   3.726973043721567*^9}, {3.726973258988648*^9, 3.726973721529831*^9}, 
   3.726975296739389*^9, {3.730843568288418*^9, 
   3.7308435860421*^9}},ExpressionUUID->"02e26ca1-7f77-4198-8746-4c274e65a382"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Creation\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69180762801713*^9, 3.6918076289452868`*^9}, 
   3.692412577466568*^9, {3.694865483227442*^9, 3.694865486030445*^9}, {
   3.6948705095356293`*^9, 3.694870511878201*^9}, {3.6948705451848707`*^9, 
   3.694870545503734*^9}, {3.694870689235691*^9, 
   3.694870691770726*^9}},ExpressionUUID->"75e1f355-f0cb-4cea-8f7f-\
8e55c57e2725"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Create\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692450532226883*^9, 
  3.692450533060162*^9}},ExpressionUUID->"8a965780-854c-4312-9a67-\
fde91508ebbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"parseToAtoms", "[", 
    RowBox[{"system_", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ",", "o__"}], "}"}]}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"atoms", "=", "\n", "\t\t\t", 
       RowBox[{"CreateAtom", "[", 
        RowBox[{"system", ",", " ", "\n", "\t\t\t\t", 
         RowBox[{"Map", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"First", "@", "#"}], ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"\"\<Position\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"Rest", "@", 
                RowBox[{"Rest", "@", "#"}]}]}]}], "\n", "\t\t\t\t\t\t", "}"}],
             "&"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "o", "}"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", "a"}], "]"}], "]"}]}], "]"}]}], "\n", "\t\t\t\t\t",
         "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Do", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"AtomCreateBond", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"atoms", "[", 
           RowBox[{"[", " ", 
            RowBox[{"First", "@", "bond"}], " ", "]"}], "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"atoms", "[", 
           RowBox[{"[", " ", 
            RowBox[{"bond", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "]"}], ",", " ", 
          "\n", "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "bond"}], ">", "2"}], ",", 
            RowBox[{"bond", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}], ",", "\n", 
          "\t\t\t\t", "False"}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"bond", ",", 
          RowBox[{
           RowBox[{"{", "o", "}"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"a", "+", "1"}], ";;", 
             RowBox[{"a", "+", "b"}]}], "]"}], "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", "atoms"}]}], "\n", "\t\t", "]"}]}],
   ";"}]], "CodeInput",
 CellChangeTimes->{{3.692461956804494*^9, 3.692462074394251*^9}, 
   3.692462577024076*^9, {3.692462619200439*^9, 3.6924626400477858`*^9}, {
   3.692462788235403*^9, 3.692462819998228*^9}, {3.6924633987308064`*^9, 
   3.692463429265841*^9}, {3.692464373487813*^9, 3.692464374343034*^9}, {
   3.692464585879549*^9, 3.692464614598588*^9}, 3.692464918015768*^9, {
   3.694439842640379*^9, 3.694439860254393*^9}, {3.6945451465341682`*^9, 
   3.6945451477663603`*^9}, {3.7000944820030117`*^9, 3.7000944996233873`*^9}, 
   3.700094532381442*^9, {3.7000990109037447`*^9, 3.700099030542461*^9}, {
   3.720371489672309*^9, 3.7203715303933353`*^9}, {3.720371563872325*^9, 
   3.720371582476457*^9}, {3.7203718724696493`*^9, 3.7203718892512503`*^9}, 
   3.7203719260589542`*^9},ExpressionUUID->"1b081aaa-622f-4851-86f3-\
56c6588c8f66"],

Cell[BoxData[
 RowBox[{"CreateAtomset", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.720371833251028*^9, 
  3.7203718339051037`*^9}},ExpressionUUID->"2eaf6c9b-ad13-440f-8147-\
ed0b8c549dbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CreateAtomset", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"sys", ":", 
      RowBox[{"ChemSysPattern", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"atoms", ":", 
      RowBox[{"ChemObjVectorPattern", "|", 
       RowBox[{"{", "}"}]}]}], ",", "\n", "\t", 
     RowBox[{"others", ":", "ChemOptionsPattern"}]}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"co", "=", "\n", "\t\t", 
       RowBox[{"ChemAdd", "[", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{"sys", ",", 
           RowBox[{"Automatic", "\[Rule]", "$ChemDefaultSystem"}]}], "]"}], 
         ",", "\n", "\t\t\t", "\"\<Atomset\>\"", ",", "\n", "\t\t\t", 
         RowBox[{"\"\<Atoms\>\"", "\[Rule]", "atoms"}], ",", "\n", "\t\t\t", 
         "others"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"ChemAddReference", "[", 
       RowBox[{"co", ",", "atoms"}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"AtomsetAddAtom", "[", 
       RowBox[{"co", ",", "atoms"}], "]"}], ";", "\n", "\t\t", "co"}]}], "\n",
     "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateAtomset", "[", 
    RowBox[{
     RowBox[{"sys", ":", 
      RowBox[{"ChemSysPattern", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"atoms", ":", 
      RowBox[{"ChemObjPattern", "..."}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", "ChemOptionsPattern"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"CreateAtomset", "[", 
    RowBox[{"sys", ",", "\n", "\t\t", 
     RowBox[{"{", "atoms", "}"}], ",", "\n", "\t\t", "ops"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692310172132568*^9, 3.69231017378874*^9}, {
   3.692311144822106*^9, 3.692311234948963*^9}, {3.692311365996387*^9, 
   3.692311423750495*^9}, {3.692315512155553*^9, 3.692315545927567*^9}, {
   3.692316829541572*^9, 3.6923168975954514`*^9}, {3.692316930231468*^9, 
   3.692317002249379*^9}, {3.692392986836624*^9, 3.6923930079558907`*^9}, {
   3.692393039702726*^9, 3.692393096307291*^9}, {3.69245093509582*^9, 
   3.692450937694799*^9}, {3.692450985832436*^9, 3.6924510788313007`*^9}, {
   3.692451978232339*^9, 3.6924519868566103`*^9}, {3.692462555025919*^9, 
   3.692462575087756*^9}, {3.692462827687673*^9, 3.692462862741383*^9}, {
   3.692463171510642*^9, 3.692463198271482*^9}, 3.6924636645863447`*^9, {
   3.692463711212062*^9, 3.692463717299202*^9}, 3.69246380053806*^9, {
   3.692463889671603*^9, 3.692463890513834*^9}, 3.692464011730102*^9, {
   3.692464222722591*^9, 3.6924642542510157`*^9}, {3.692490706309031*^9, 
   3.692490737336252*^9}, {3.693875447850081*^9, 3.6938755883541203`*^9}, {
   3.693875642827552*^9, 3.693875679137187*^9}, {3.6948659015854673`*^9, 
   3.694865979425742*^9}, {3.694866308117886*^9, 3.694866309093183*^9}, {
   3.6948663391481247`*^9, 3.694866343379758*^9}, 3.694866405072382*^9, {
   3.694866611302245*^9, 3.6948666143643017`*^9}, {3.7000925622954807`*^9, 
   3.700092612437337*^9}, {3.7000937866352654`*^9, 3.700093796531309*^9}, {
   3.700094180868566*^9, 3.7000942214502*^9}, {3.701116352351433*^9, 
   3.701116353549732*^9}, {3.710172151532084*^9, 3.710172162926949*^9}, {
   3.7101725710616293`*^9, 3.7101725741243687`*^9}, {3.710172663210024*^9, 
   3.710172664758889*^9}, {3.710172971164753*^9, 3.710172978143976*^9}, {
   3.718335469582025*^9, 3.718335506375515*^9}, {3.7183355504661293`*^9, 
   3.7183355504716578`*^9}},ExpressionUUID->"8d0ab4bd-dcb7-4383-a937-\
e49133259b65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chemAtomListPattern", "=", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"_String", ",", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", "_Quantity"}], ",", "\n", "\t", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", "_Quantity"}], ",", "\n", "\t", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], "|", "_Quantity"}]}], "\n", 
       "\t\t\t\t", "}"}], "|", "_QuantityArray"}], ",", "\n", "\t\t\t", 
     "___"}], "\n", "\t\t\t", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"chemZMxListPattern", "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "_String", "}"}], ",", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"_String", ",", " ", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "\n", "\t\t", "}"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.720371379983046*^9, 3.720371391696024*^9}, {
   3.7203714273024893`*^9, 3.7203714801549597`*^9}, 
   3.720371725916432*^9},ExpressionUUID->"a0b23c08-db38-4188-b600-\
4d6bb746fda3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chemAtomsetBaseSpec", "=", "\n", "\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_Integer", ",", "_Integer"}], "}"}], ",", "\n", "\t\t", 
      "chemAtomListPattern", ",", "\n", "\t\t", "___"}], "\n", "\t\t", "}"}], 
    "|", "\n", "\t", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"chemAtomListPattern", ",", "\n", "\t\t", "___List"}], "\n", 
     "\t\t", "}"}], "|", "\n", "\t", "chemZMxListPattern"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.7101723080927134`*^9, 3.71017231994*^9}, {
   3.72037136897898*^9, 3.720371414795578*^9}, {3.7203716600121107`*^9, 
   3.720371679518969*^9}, 
   3.720371763460003*^9},ExpressionUUID->"8223c0df-7b48-42ef-ab79-\
12f32027bfeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreateAtomset", "[", 
    RowBox[{
     RowBox[{"sys", ":", 
      RowBox[{"ChemSysPattern", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"atoms", ":", "chemAtomsetBaseSpec"}], ",", "\n", "\t", 
     RowBox[{"o", ":", "ChemOptionsPattern"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"atSpec", "=", "\n", "\t\t", 
       RowBox[{"Which", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"First", "@", "atoms"}], ",", 
           RowBox[{"{", 
            RowBox[{"_Integer", ",", "_Integer"}], "}"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", "atoms", ",", "\n", "\t\t\t", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"atoms", ",", " ", "chemZMxListPattern"}], "]"}], ",", "\n",
          "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"#", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"Cases", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"_String", ",", "__"}], "}"}]}], "]"}]}], ",", 
               "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"Length", "@", 
                RowBox[{"Cases", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"_Integer", ",", "__"}], "}"}]}], "]"}]}]}], "\n", 
              "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}], "&"}], "@", 
          
          RowBox[{"ChemUtilsGenerateMolTable", "[", "atoms", "]"}]}], ",", 
         "\n", "\t\t\t", "True", ",", "\n", "\t\t\t\t", 
         RowBox[{"Prepend", "[", 
          RowBox[{"atoms", ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Cases", "[", 
               RowBox[{"atoms", ",", 
                RowBox[{"{", 
                 RowBox[{"_String", ",", "__"}], "}"}]}], "]"}]}], ",", "\n", 
             "\t", "\t\t\t\t\t", 
             RowBox[{"Length", "@", 
              RowBox[{"Cases", "[", 
               RowBox[{"atoms", ",", 
                RowBox[{"{", 
                 RowBox[{"_Integer", ",", "__"}], "}"}]}], "]"}]}]}], "\n", 
            "\t", "\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t", "]"}]}], 
        "\n", "\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"CreateAtomset", "[", 
      RowBox[{"sys", ",", "\n", "\t\t\t", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"parseToAtoms", "[", 
         RowBox[{"sys", ",", "atSpec"}], "]"}]}], ",", "\n", "\t\t\t", "o"}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692310172132568*^9, 3.69231017378874*^9}, {
   3.692311144822106*^9, 3.692311234948963*^9}, {3.692311365996387*^9, 
   3.692311423750495*^9}, {3.692315512155553*^9, 3.692315545927567*^9}, {
   3.692316829541572*^9, 3.6923168975954514`*^9}, {3.692316930231468*^9, 
   3.692317002249379*^9}, {3.692392986836624*^9, 3.6923930079558907`*^9}, {
   3.692393039702726*^9, 3.692393096307291*^9}, {3.69245093509582*^9, 
   3.692450937694799*^9}, {3.692450985832436*^9, 3.6924510788313007`*^9}, {
   3.692451978232339*^9, 3.6924519868566103`*^9}, {3.692462555025919*^9, 
   3.692462575087756*^9}, {3.692462827687673*^9, 3.692462862741383*^9}, {
   3.692463171510642*^9, 3.692463198271482*^9}, 3.6924636645863447`*^9, {
   3.692463711212062*^9, 3.692463717299202*^9}, 3.69246380053806*^9, {
   3.692463889671603*^9, 3.692463890513834*^9}, 3.692464011730102*^9, {
   3.692464222722591*^9, 3.6924642542510157`*^9}, {3.692490706309031*^9, 
   3.692490737336252*^9}, {3.693875447850081*^9, 3.6938755883541203`*^9}, {
   3.693875642827552*^9, 3.693875679137187*^9}, {3.6948659015854673`*^9, 
   3.694865979425742*^9}, {3.694866306286932*^9, 3.694866306645599*^9}, {
   3.699733564817751*^9, 3.699733594491579*^9}, {3.70009425320889*^9, 
   3.700094279951665*^9}, {3.7000944413796883`*^9, 3.7000944699848347`*^9}, {
   3.700094541403091*^9, 3.700094556586198*^9}, {3.700094607692988*^9, 
   3.7000946437294817`*^9}, {3.701116304317801*^9, 3.701116334808234*^9}, {
   3.7011164790532293`*^9, 3.7011165045830297`*^9}, 3.710171803730377*^9, {
   3.710172230926087*^9, 3.710172258792214*^9}, {3.7101726711786747`*^9, 
   3.710172677542468*^9}, {3.710172982170562*^9, 3.7101729858158827`*^9}, {
   3.710174055889903*^9, 3.710174063266979*^9}, {3.718335469599659*^9, 
   3.7183354696045723`*^9}, {3.718335550477375*^9, 3.7183355504822273`*^9}, {
   3.720371599759983*^9, 3.720371654676733*^9}, {3.7203716883675003`*^9, 
   3.720371695347365*^9}, {3.720371775677802*^9, 
   3.720371824090398*^9}},ExpressionUUID->"d15a2879-4e4d-45fe-b0ba-\
b4fff22030f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CreateAtomset", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"sys", ":", 
     RowBox[{"ChemSysPattern", "|", "Automatic"}], ":", "Automatic"}], ",", 
    "\n", "\t", 
    RowBox[{"aspecs", ":", "\n", "\t\t", 
     RowBox[{
      RowBox[{"(", "\n", "\t\t\t", 
       RowBox[{"chemAtomsetBaseSpec", "|", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"chemAtomsetBaseSpec", ",", "ChemOptionsPattern"}], "}"}]}], 
       "\n", "\t\t\t", ")"}], ".."}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"{", "aspecs", "}"}], ",", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"a", ":", "chemAtomsetBaseSpec"}], ":>", "\n", "\t\t\t", 
       RowBox[{"CreateAtomset", "[", 
        RowBox[{"sys", ",", "a"}], "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"e_", ":>", "\n", "\t\t\t", 
       RowBox[{"CreateAtomset", "[", 
        RowBox[{"sys", ",", 
         RowBox[{"Sequence", "@@", "e"}]}], "]"}]}]}], "\n", "\t\t", "}"}], 
    ",", "\n", "\t\t", "1"}], "]"}]}], "\n", 
 RowBox[{"\t\t"}]}], "CodeInput",
 CellChangeTimes->{{3.710172266496695*^9, 3.7101724084363413`*^9}, {
   3.71017268464843*^9, 3.710172686230941*^9}, 3.710172990162002*^9, {
   3.710173785666037*^9, 3.710173795511327*^9}, {3.710174018890629*^9, 
   3.7101740413269444`*^9}, 3.710174099382436*^9, {3.7102061732454777`*^9, 
   3.7102061969222383`*^9}, 3.718335469614114*^9, 
   3.718335550489685*^9},ExpressionUUID->"03844bee-2bbc-47d8-a402-\
14a873c2a23b"]
}, Closed]],

Cell[CellGroupData[{

Cell["GetAtoms", "CodeSubsubsection",
 CellChangeTimes->{{3.692474958383135*^9, 
  3.6924749634470997`*^9}},ExpressionUUID->"3c74724d-8378-4d0f-bdbb-\
6a5db1eba58d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGetAtoms", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "test_"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{"test", ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Identity", "|", "All", "|", "\n", "\t\t\t", 
         RowBox[{"Verbatim", "[", 
          RowBox[{"MatchQ", "[", "_", "]"}], "]"}], "|", 
         RowBox[{"Verbatim", "[", 
          RowBox[{"HoldPattern", "[", 
           RowBox[{"True", "&"}], "]"}], "]"}]}], ":>", "\n", "\t\t\t", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"_String", "?", 
         RowBox[{"(", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"ChemDataAtomQ", "@", "#"}], "&&", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"ChemDataLookup", "[", 
              RowBox[{"#", ",", "\"\<Symbol\>\""}], "]"}], "=!=", 
             "$Failed"}]}], "&"}], "\n", "\t\t\t\t\t", ")"}]}], ":>", "\n", 
        "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"atoms", "=", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n",
           "\t", "\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"elements", "=", "\n", "\t\t\t\t\t\t", 
               RowBox[{"ChemGet", "[", 
                RowBox[{"atoms", ",", "\"\<Element\>\""}], "]"}]}], ",", "\n",
               "\t\t\t\t\t", 
              RowBox[{"sn", "=", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"ChemDataLookup", "[", 
                RowBox[{"test", ",", "\"\<Symbol\>\""}], "]"}]}]}], "\n", 
             "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Pick", "[", 
             RowBox[{"atoms", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "===", "sn"}], "&"}], "/@", "elements"}]}], 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_String", "|", "_Rule", "|", "_RuleDelayed"}], ")"}], ":>", 
        "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ats", "=", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n",
           "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"as", "=", 
              RowBox[{"AtomsetAtomMemberQ", "[", 
               RowBox[{"obj", ",", "ats", ",", "test"}], "]"}]}], "}"}], ",", 
            "\n", "\t", "\t\t\t\t", 
            RowBox[{"RuleCondition", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Pick", "[", 
               RowBox[{"ats", ",", "as"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"ListQ", "@", "as"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
           "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{
          RowBox[{"t_", "[", 
           RowBox[{
            RowBox[{"ChemGet", "[", 
             RowBox[{"#", ",", "p_"}], "]"}], ",", "v_"}], "]"}], "&"}], 
         "]"}], ":>", "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"atoms", "=", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n",
           "\t", "\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"prop", "=", "\n", "\t\t\t\t\t\t", 
               RowBox[{"ChemGet", "[", 
                RowBox[{"atoms", ",", "p"}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"val", "=", "v"}]}], "\n", "\t\t\t\t\t", "}"}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"Pick", "[", 
             RowBox[{"atoms", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"t", "[", 
                 RowBox[{"#", ",", "val"}], "]"}], "&"}], "/@", "prop"}]}], 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"e_", ":>", "\n", "\t\t\t", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ChemGet", "[", 
           RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "e"}], 
         "]"}]}]}], "\n", "\t\t", "}"}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6924749654333687`*^9, 3.6924750471586847`*^9}, {
   3.693960599354282*^9, 3.693960865466242*^9}, {3.7000947163517017`*^9, 
   3.700094782302415*^9}, {3.700094848529482*^9, 3.700094927360517*^9}, {
   3.7001958946881313`*^9, 3.700196214365552*^9}, {3.7001966078851*^9, 
   3.700196622384169*^9}, {3.700196652540876*^9, 3.700196668918972*^9}, {
   3.7001970413096857`*^9, 3.7001970911624193`*^9}, {3.7001971785975227`*^9, 
   3.700197264091826*^9}, {3.7102679946959333`*^9, 3.7102680901493*^9}, {
   3.7102681349641*^9, 3.710268143097925*^9}, {3.710268327493314*^9, 
   3.7102683370268*^9}, {3.710268383944862*^9, 3.710268426908265*^9}, {
   3.710268668643127*^9, 3.71026869308314*^9}, {3.710268891723384*^9, 
   3.7102689041665907`*^9}, {3.7102692248616257`*^9, 
   3.7102693176292677`*^9}, {3.710274248913142*^9, 3.710274254486657*^9}, {
   3.710274533020927*^9, 3.710274549459564*^9}, {3.710274581197543*^9, 
   3.7102745920831947`*^9}, 
   3.7183354819702263`*^9},ExpressionUUID->"08c0c4f9-b6e5-4844-a8ae-\
e6aceb62d219"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddAtom", "CodeSubsubsection",
 CellChangeTimes->{{3.6924505392738*^9, 
  3.692450541787032*^9}},ExpressionUUID->"9a7db3a7-da2e-4e2b-80ef-\
7b8ee6310c76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAddAtom", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"atoms", ":", "ChemObjAllPattern"}]}], "]"}], ":=", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"ChemIncrement", "[", 
      RowBox[{"obj", ",", "\"\<Atoms\>\"", ",", "atoms", ",", 
       RowBox[{"DeleteDuplicates", "@*", "Flatten", "@*", "List"}]}], "]"}], 
     ";", "\n", "\t", 
     RowBox[{"ChemAddReference", "[", 
      RowBox[{"obj", ",", "atoms"}], "]"}], ";", "\n", "\t", 
     RowBox[{"ChemMutate", "[", 
      RowBox[{
       RowBox[{"atoms", "\"\<Atomset\>\""}], ",", 
       RowBox[{"Replace", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_Missing", "\[RuleDelayed]", 
           RowBox[{"{", "obj", "}"}]}], ",", 
          RowBox[{
           RowBox[{"{", "l___", "}"}], "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"l", ",", "obj"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ";", 
     "\n", "\t", "atoms"}], "\n", "\t", ")"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6924505451015797`*^9, 3.692450642293741*^9}, 
   3.692451116994869*^9, {3.6924906073816233`*^9, 3.692490671667938*^9}, 
   3.692490746511861*^9, {3.694865774501711*^9, 3.6948658383838167`*^9}, {
   3.694866001936447*^9, 3.694866154609531*^9}, {3.694866383939445*^9, 
   3.6948664591745377`*^9}, {3.694866489559265*^9, 3.694866637227613*^9}, {
   3.694866709355116*^9, 3.694866793772921*^9}, {3.6948669791838207`*^9, 
   3.694867003948058*^9}, {3.6948670450622463`*^9, 3.694867069243939*^9}, 
   3.694867221592494*^9, {3.700017684093739*^9, 3.700017685514613*^9}, {
   3.7000949415509443`*^9, 3.700095135902774*^9}, 3.718335481978551*^9, 
   3.7183355175358477`*^9},ExpressionUUID->"b70294d4-1ae2-40bb-aabb-\
7c0dc7e41903"]
}, Closed]],

Cell[CellGroupData[{

Cell["RemoveAtom", "CodeSubsubsection",
 CellChangeTimes->{{3.692451134664433*^9, 
  3.692451137159608*^9}},ExpressionUUID->"d7d18f77-b695-4064-affe-\
36d1ced515d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRemoveAtom", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"atoms", ":", "ChemObjAllPattern"}]}], "]"}], ":=", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"ChemMutate", "[", 
      RowBox[{"obj", ",", "\"\<Atoms\>\"", ",", "\n", "\t\t", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"Alternatives", "@@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "atoms", "}"}]}]}], "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"ChemRemoveReference", "[", 
      RowBox[{"obj", ",", "atoms"}], "]"}], ";", "\n", "\t", 
     RowBox[{"ChemMutate", "[", 
      RowBox[{
       RowBox[{"atoms", "\"\<Atomset\>\""}], ",", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_Missing", "\[RuleDelayed]", 
           RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"l_List", "\[RuleDelayed]", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"l", ",", "obj"}], "]"}]}]}], "}"}], "]"}]}], "]"}], 
     ";"}], "\n", "\t", ")"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6924505451015797`*^9, 3.692450642293741*^9}, {
   3.692451116994869*^9, 3.692451151457919*^9}, {3.6924518493501043`*^9, 
   3.6924518518446198`*^9}, {3.6924906814536057`*^9, 3.692490691886546*^9}, 
   3.6924907509609118`*^9, {3.700095150441086*^9, 3.700095205919606*^9}, {
   3.7000953144723663`*^9, 3.700095321221098*^9}, {3.700095391327218*^9, 
   3.700095391757616*^9}, {3.700095602902492*^9, 3.70009564454493*^9}, {
   3.7002792129686327`*^9, 3.700279227773633*^9}, {3.7002792788023767`*^9, 
   3.7002793223426027`*^9}, 3.718335481987587*^9, 
   3.718335517541217*^9},ExpressionUUID->"06082bc5-b57d-49b6-8746-\
ac2110608166"]
}, Closed]],

Cell[CellGroupData[{

Cell["Join", "CodeSubsubsection",
 CellChangeTimes->{{3.700191019453848*^9, 3.700191020022085*^9}, 
   3.726973440095149*^9},ExpressionUUID->"2e9815f5-b04d-49fd-870e-\
69b50806f163"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetJoin", "[", 
    RowBox[{"objV", ":", "ChemObjVectorPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"CreateAtomset", "@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"ChemGet", "[", 
      RowBox[{"objV", ",", "\"\<Atoms\>\""}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{"AtomsetJoin", "[", 
  RowBox[{"objV", ":", 
   RowBox[{"ChemObjPattern", ".."}]}], "]"}]}], "CodeInput",
 CellChangeTimes->{{3.7001910214639187`*^9, 3.700191067260797*^9}, {
  3.718335481995924*^9, 
  3.71833550637997*^9}},ExpressionUUID->"6da56795-0d9a-40ed-80d6-aecaedf9b851"]
}, Closed]],

Cell[CellGroupData[{

Cell["SubstitueAtom", "CodeSubsubsection",
 CellChangeTimes->{{3.710258785799354*^9, 
  3.710258792247074*^9}},ExpressionUUID->"8d2ff041-2d5b-4b57-81dc-\
432784622355"],

Cell[BoxData[
 RowBox[{"AtomsetSubstituteAtom", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.7102789123251553`*^9, 
  3.710278913053801*^9}},ExpressionUUID->"419932b7-3da8-4be7-9683-\
aea29aac77f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", "\n", "\t", 
   RowBox[{
    RowBox[{"AtomsetSubstituteAtom", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t\t", 
      RowBox[{"reps", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ChemObjPattern", "\[Rule]", "ChemObjPattern"}], ")"}], 
         ".."}], "}"}]}], ",", "\n", "\t\t", 
      RowBox[{"check", ":", 
       RowBox[{"True", "|", "False"}], ":", "True"}]}], "\n", "\t\t", "]"}], "/;",
     "\n", "\t\t\t", 
    RowBox[{"(", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{"Sort", "@", 
       RowBox[{"Intersection", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"ChemGet", "[", 
          RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Map", "[", 
          RowBox[{"First", ",", "reps"}], "]"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], "==", 
      RowBox[{"Sort", "@", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "reps"}], "]"}]}]}], "\n", "\t\t\t\t", ")"}]}], 
   "\n", "\t\t", ")"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"old", "=", 
       RowBox[{"First", "/@", "reps"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"new", "=", 
       RowBox[{"Last", "/@", "reps"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"bonds", "=", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{"{", "}"}], "]"}], "@", 
        RowBox[{"ChemGet", "[", 
         RowBox[{
          RowBox[{"First", "/@", "reps"}], ",", "\"\<Bonds\>\""}], "]"}]}]}], 
      ",", "\n", "\t\t\t", "types", ",", "\n", "\t\t\t", "atoms", ",", "\n", 
      "\t\t\t", "pos"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AtomsetRemoveAtom", "[", 
      RowBox[{"obj", ",", "old"}], "]"}], ";", "\n", "\t\t", 
     RowBox[{"AtomsetAddAtom", "[", 
      RowBox[{"obj", ",", "new"}], "]"}], ";", "\n", "\t\t", 
     RowBox[{"pos", "=", 
      RowBox[{"ChemGet", "[", 
       RowBox[{"old", ",", "\"\<Position\>\""}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"ChemThreadSet", "[", 
      RowBox[{"new", ",", "\"\<Position\>\"", ",", "pos"}], "]"}], ";", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "bonds", "]"}], ">", "0"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"BondBreak", "/@", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Flatten", "@", "bonds"}]}]}], ";", "\n", "\t", "\t\t", 
        RowBox[{"types", "=", 
         RowBox[{"ChemGet", "[", 
          RowBox[{"bonds", ",", "\"\<Type\>\""}], "]"}]}], ";", "\n", "\t", 
        "\t\t", 
        RowBox[{"atoms", "=", "\n", "\t", "\t\t\t", 
         RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"ChemGet", "[", 
            RowBox[{"bonds", ",", "\"\<Atoms\>\""}], "]"}], ",", "\n", "\t", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Alternatives", "@@", "old"}], ",", "a_"}], "}"}], 
              "|", 
              RowBox[{"{", 
               RowBox[{"a_", ",", 
                RowBox[{"Alternatives", "@@", "old"}]}], "}"}]}], ")"}], 
            "\[RuleDelayed]", "a"}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"{", "2", "}"}]}], "\n", "\t", "\t\t\t\t", "]"}]}], ";", 
        "\n", "\t", "\t\t", 
        RowBox[{"MapThread", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{"a", "=", "#"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"b", "=", 
                RowBox[{"Replace", "[", 
                 RowBox[{"#2", ",", 
                  RowBox[{
                   RowBox[{"a", ":", 
                    RowBox[{"(", 
                    RowBox[{"Alternatives", "@@", "old"}], ")"}]}], 
                   "\[RuleDelayed]", 
                   RowBox[{"Replace", "[", 
                    RowBox[{"a", ",", "reps"}], "]"}]}], ",", "1"}], "]"}]}], 
               ",", "\n", "\t\t\t\t\t", 
               RowBox[{"t", "=", "#3"}]}], "\n", "\t\t\t\t\t", "}"}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Function", "[", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"a", "=!=", "#"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"AtomCreateBond", "[", 
                   RowBox[{"a", ",", "#", ",", "#2", ",", "check"}], "]"}]}], 
                 "\n", "\t\t\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t\t\t\t", 
                "]"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"b", ",", "\n", "\t", "\t\t\t\t\t\t", "t"}], "\n", 
                "\t", "\t\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t\t", 
              "]"}]}], "\n", "\t", "\t\t\t\t", "]"}], "&"}], ",", "\n", "\t", 
          "\t\t\t", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t", 
           RowBox[{
           "new", ",", "\n", "\t", "\t\t\t\t", "atoms", ",", "\n", 
            "\t\t\t\t\t", "types"}], "\n", "\t\t\t\t\t", "}"}]}], "]"}], 
        ";"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.710259510561789*^9, 3.7102596599011307`*^9}, {
   3.710259697715229*^9, 3.710259773008986*^9}, {3.710259843600523*^9, 
   3.710259846720805*^9}, {3.7102599465058727`*^9, 3.710259949374428*^9}, {
   3.710260153830812*^9, 3.710260155442731*^9}, {3.710260295751498*^9, 
   3.7102603039943027`*^9}, {3.710260422717882*^9, 3.710260476474576*^9}, {
   3.71026069528272*^9, 3.710260726760474*^9}, {3.7102609348042593`*^9, 
   3.7102610710572367`*^9}, {3.710275660904105*^9, 3.710275666990861*^9}, {
   3.7102788134652233`*^9, 3.7102788226897078`*^9}, {3.7102788632584352`*^9, 
   3.710278910365801*^9}, {3.710278991224835*^9, 3.710278991790368*^9}, {
   3.7102791037699213`*^9, 3.710279145102172*^9}, {3.710279197672419*^9, 
   3.710279199495245*^9}, {3.710279233952005*^9, 3.710279379066462*^9}, 
   3.710279409299485*^9, {3.716167769517572*^9, 3.716167787502399*^9}, {
   3.716167846817943*^9, 3.716167856653863*^9}, {3.716167933663351*^9, 
   3.71616794523177*^9}, {3.7161686200959597`*^9, 3.716168625588924*^9}, {
   3.716168661916501*^9, 3.716168747335125*^9}, {3.716169014629869*^9, 
   3.716169061627928*^9}, {3.7161690924297733`*^9, 3.7161691674941807`*^9}, {
   3.718335482006095*^9, 
   3.718335482020713*^9}},ExpressionUUID->"aaeee772-224a-4418-b2bd-\
3f7c13ccdf5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetSubstituteAtom", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"at1", ":", "ChemObjPattern"}], "\[Rule]", 
      RowBox[{"at2", ":", "ChemObjPattern"}]}], ",", "\n", "\t", 
     RowBox[{"check", ":", 
      RowBox[{"True", "|", "False"}], ":", "True"}]}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"a", "=", "\n", "\t\t\t\t", 
       RowBox[{"AtomsetSubstituteAtom", "[", 
        RowBox[{"obj", ",", "\n", "\t", "\t", "\t\t\t", 
         RowBox[{"{", 
          RowBox[{"at1", "\[Rule]", "at2"}], "}"}], ",", "\n", "\t\t\t\t\t", 
         "check"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"a", "/;", 
      RowBox[{
       RowBox[{"Head", "[", "a", "]"}], "=!=", "AtomsetSubstituteAtom"}]}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.710258792924498*^9, 3.710258824735029*^9}, {
   3.710258883001419*^9, 3.710258944474392*^9}, {3.710258975783477*^9, 
   3.7102591457048883`*^9}, {3.71025919314081*^9, 3.710259215932865*^9}, {
   3.710259277693788*^9, 3.710259334945945*^9}, {3.710261292002741*^9, 
   3.710261349786542*^9}, {3.710261435550323*^9, 3.71026144265199*^9}, 
   3.710261492073571*^9, {3.7102787976251698`*^9, 3.710278798432144*^9}, 
   3.710278837263102*^9, {3.716167859918839*^9, 3.7161678700510406`*^9}, {
   3.718335482032209*^9, 
   3.718335482040901*^9}},ExpressionUUID->"07a1cd9e-6429-4c3e-a9ec-\
e84994b62f7c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AtomsetSubstituteAtom", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
       RowBox[{"a", ":", 
        RowBox[{"{", "\n", "\t"}]}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"With", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"a", "=", "\n", "\t\t\t\t", 
        RowBox[{"AtomsetSubstituteAtom", "[", 
         RowBox[{"obj", ",", "\n", "\t", "\t", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{"at1", "\[Rule]", "at2"}], "}"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"a", "/;", 
       RowBox[{
        RowBox[{"Head", "[", "a", "]"}], "=!=", "AtomsetSubstituteAtom"}]}]}],
      "\n", "\t\t", "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.710258792924498*^9, 3.710258824735029*^9}, {
   3.710258883001419*^9, 3.710258944474392*^9}, {3.710258975783477*^9, 
   3.7102591457048883`*^9}, {3.71025919314081*^9, 3.710259215932865*^9}, {
   3.710259277693788*^9, 3.710259334945945*^9}, {3.710261292002741*^9, 
   3.710261349786542*^9}, {3.710261435550323*^9, 3.71026144265199*^9}, 
   3.710261492073571*^9, 
   3.718335482052537*^9},ExpressionUUID->"75d71c56-56d2-4aa1-bfd7-\
1b16d4558e14"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Structural Properties\[RightFloor]", \
"CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870694857984*^9, 3.694870697250669*^9}, {
  3.694870741512184*^9, 
  3.694870750168529*^9}},ExpressionUUID->"1f8bffb0-5d91-4eae-baaf-\
d0568ea0fe5a"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]EmpiricalFormula\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694492993903152*^9, 
  3.6944929977171497`*^9}},ExpressionUUID->"a5a5f59b-061e-4345-825b-\
2bab6dc49f2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetEmpiricalFormula", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"els", "=", "\n", "\t\t", 
       RowBox[{"ChemDataLookup", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"ChemGet", "[", 
          RowBox[{
           RowBox[{"ChemGet", "[", 
            RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", 
           "\"\<Element\>\""}], "]"}], ",", "\n", "\t\t\t", 
         "\"\<Symbol\>\""}], "]"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     
     RowBox[{
      RowBox[{
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{"#", "<>", 
          RowBox[{"ToString", "@", "#2"}]}], "&"}], "]"}], "@", "\n", 
       "\t\t\t", 
       RowBox[{"KeySortBy", "[", 
        RowBox[{
         RowBox[{"Counts", "[", "els", "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Switch", "[", 
           RowBox[{
           "#", ",", "\n", "\t", "\t\t\t\t", "\"\<C\>\"", ",", "\n", "\t", 
            "\t\t\t\t\t", "1", ",", "\n", "\t", "\t\t\t\t", 
            RowBox[{"\"\<O\>\"", "|", "\"\<N\>\""}], ",", "\n", "\t", 
            "\t\t\t\t\t", "2", ",", "\n", "\t", "\t\t\t\t", "\"\<H\>\"", ",", 
            "\n", "\t", "\t\t\t\t\t", "3", ",", "\n", "\t", "\t\t\t\t", "_", 
            ",", "\n", "\t", "\t\t\t\t\t", "4"}], "\n", "\t", "\t\t\t\t", 
           "]"}], "&"}]}], "\n", "\t\t\t\t", "]"}]}], "//", "StringJoin"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694492999364221*^9, 3.6944930674277163`*^9}, {
   3.69449316406402*^9, 3.6944931920578012`*^9}, {3.694493301683283*^9, 
   3.6944934339142427`*^9}, {3.6944935553951693`*^9, 3.694493561327682*^9}, {
   3.700095659677782*^9, 3.700095663690542*^9}, {3.700095712841092*^9, 
   3.700095735906076*^9}, {3.700095897368807*^9, 3.700095897702529*^9}, 
   3.718335482062315*^9},ExpressionUUID->"52f49ea5-914c-42a3-907b-\
a8070f6c7c76"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ElementPositions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692999457875367*^9, 
  3.6929994618098507`*^9}},ExpressionUUID->"d640ff98-7e0f-441c-999e-\
c7a48d2b9653"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetElementPositions", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"ChemGet", "[", 
         RowBox[{"a", ",", "\"\<Element\>\""}], "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"a", ",", "\"\<Position\>\""}], "]"}]}], "\n", "\t\t\t", 
       "}"}]}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692999462869772*^9, 3.692999513896646*^9}, {
   3.700095910217911*^9, 3.700095958695051*^9}, 
   3.718335482070895*^9},ExpressionUUID->"648648cb-e47e-47d6-b95c-\
1fe6f2bc0086"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Bonds\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7000985662009983`*^9, 
  3.700098566703836*^9}},ExpressionUUID->"778cd811-fa64-493d-882f-\
e0d32184a425"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBonds", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"a", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "\n", "\t\t\t", "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"With", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"a", ",", " ", "\"\<Bonds\>\""}], "]"}]}]}]}], ",", "\n",
          "\t\t\t\t", 
         RowBox[{"index", "=", 
          RowBox[{"Association", "@", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[Rule]", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", " ", "a"}], 
            "]"}]}]}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"AssociationThread", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Map", "[", "\n", "\t\t\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Finds", " ", "the", " ", "first", " ", "position", " ", "for", 
            " ", "the", " ", "atom", " ", "in", " ", "the", " ", "bond", " ", 
            "in", " ", "the", " ", "atomset"}], " ", "*)"}], "\n", 
          "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"index", ",", " ", "#"}], "]"}], "&"}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"ChemGet", "[", 
            RowBox[{"b", ",", " ", "\"\<Atoms\>\""}], "]"}]}], "\n", 
          "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "b"}], "\n", "\t\t\t\t",
         "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.700098600640381*^9, 3.7000986579439697`*^9}, {
   3.7000986948910027`*^9, 3.70009872420737*^9}, {3.700098821231016*^9, 
   3.700098824686384*^9}, {3.700098860061651*^9, 3.700098862499181*^9}, 
   3.718335482080051*^9, 3.7331447939680357`*^9, {3.7331448245452642`*^9, 
   3.733144907974378*^9}, 
   3.733144967716071*^9},ExpressionUUID->"3ee217db-1b3b-436c-b42d-\
da1888852eb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Bounds\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700194484348793*^9, 3.700194486217539*^9}, 
   3.7001945489021883`*^9},ExpressionUUID->"ea2d37c0-9ed1-4322-9537-\
47ead0c7d926"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBounds", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"padding", ":", 
      RowBox[{"_", "?", "NumericQ"}], ":", "0"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ats", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t", 
       "rads", ",", "\n", "\t\t", "pos", ",", "\n", "\t\t", 
       RowBox[{"moves", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", "3"}], "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"rads", "=", 
       RowBox[{"QuantityMagnitude", "/@", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"ats", ",", "\"\<Radius\>\""}], "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"pos", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"ats", ",", "\"\<Position\>\""}], "]"}]}], ";", "\n", "\t\t", 
      
      RowBox[{"pos", "=", "\n", "\t\t\t", 
       RowBox[{"Flatten", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"base", "=", 
                 RowBox[{"#", "*", "moves"}]}], ",", "\n", "\t", "\t", 
                "\t\t\t\t", 
                RowBox[{"p", "=", "#2"}]}], "\n", "\t", "\t", "\t\t\t\t", 
               "}"}], ",", "\n", "\t", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"p", "+", "#"}], "&"}], "/@", "base"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}], "&"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"rads", "+", "padding"}], ",", "\n", "\t\t\t\t\t", 
             "pos"}], "\n", "\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", "1"}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"CoordinateBounds", "@", "pos"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.700194487623876*^9, 3.7001945059285727`*^9}, 
   3.7001945461516542`*^9, {3.700194592726636*^9, 3.700194616114346*^9}, {
   3.710286596035117*^9, 3.71028663480717*^9}, {3.7102866934797363`*^9, 
   3.7102867540071373`*^9}, {3.710286790448057*^9, 3.710286941665958*^9}, {
   3.710353508689788*^9, 3.7103535164436083`*^9}, {3.71035357996915*^9, 
   3.7103536678908443`*^9}, 
   3.7183354820939207`*^9},ExpressionUUID->"42bbf46b-2706-4352-8e5f-\
0b5231e6a807"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]BondsIndexed\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694489698236961*^9, 
  3.694489702258643*^9}},ExpressionUUID->"8c2f7620-67dd-4bd1-b1ad-\
0e57d4de6676"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBondsIndexed", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", "=", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"ChemGet", "[", 
            RowBox[{"a", ",", "\"\<Bonds\>\""}], "]"}]}]}]}], "}"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"Map", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"FirstPosition", "[", 
              RowBox[{"a", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"First", "@", 
             RowBox[{"FirstPosition", "[", 
              RowBox[{"a", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"ChemGet", "[", 
             RowBox[{"b", ",", "\"\<Atoms\>\""}], "]"}], ",", "\n", "\t", 
            "\t\t\t\t", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"b", ",", "\"\<Type\>\""}], "]"}]}], "\n", "\t\t\t\t\t", 
           "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694489699394808*^9, 3.694489782567918*^9}, {
   3.69448982574555*^9, 3.694489879815711*^9}, {3.694492612143766*^9, 
   3.694492613223673*^9}, {3.6945239026120787`*^9, 3.694523905010171*^9}, {
   3.694523942208542*^9, 3.694523972112975*^9}, {3.6945240147358837`*^9, 
   3.694524015070447*^9}, {3.7000960095148287`*^9, 3.700096150132065*^9}, {
   3.70009618868296*^9, 3.700096274473996*^9}, {3.7000963943440323`*^9, 
   3.7000963952138643`*^9}, {3.700098875342308*^9, 3.7000989056318398`*^9}, 
   3.7001735367517157`*^9, {3.700173748416048*^9, 3.700173764109639*^9}, 
   3.718335482106785*^9},ExpressionUUID->"ff6dbd4b-b9cf-4d17-b8f3-\
cfc25afa5998"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]BondVectors\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700096777528985*^9, 
  3.700096779159402*^9}},ExpressionUUID->"d8e29c99-e5af-45ac-8d5d-\
2dab8431f0af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetBondVectors", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"a", ",", "\"\<Bonds\>\""}], "]"}]}]}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"p", "=", 
          RowBox[{"ChemGet", "[", 
           RowBox[{"a", ",", "\"\<Position\>\""}], "]"}]}]}], "\n", "\t\t\t", 
        "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"AssociationMap", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Subtract", "@@", 
           RowBox[{"p", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Map", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FirstPosition", "[", 
               RowBox[{"a", ",", "#"}], "]"}]}], "&"}], "]"}], ",", "\n", 
           "\t", "\t\t\t\t", 
           RowBox[{"ChemGet", "[", 
            RowBox[{"b", ",", "\"\<Atoms\>\""}], "]"}]}], "\n", "\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{
  3.700096915099214*^9, 3.700098708425893*^9, {3.70009893928349*^9, 
   3.7000989452823973`*^9}, 
   3.7183354821169863`*^9},ExpressionUUID->"27fb08ea-5fd5-41a4-8a75-\
39886d693f8c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]BondLengths\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694348725316552*^9, 
  3.694348727196684*^9}},ExpressionUUID->"82b09102-f419-40b5-b3f9-\
7254d3d8a699"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AtomsetBondLengths", "[", 
   RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Norm", "/@", 
   RowBox[{"AtomsetBondVectors", "[", "obj", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.6943487284842577`*^9, 3.694348785076296*^9}, {
   3.6943488253213387`*^9, 3.694348862435709*^9}, {3.694348928195292*^9, 
   3.694349214657772*^9}, {3.694349348944072*^9, 3.694349361736022*^9}, {
   3.7000963098608*^9, 3.700096360619205*^9}, {3.700096404951456*^9, 
   3.700096426438921*^9}, {3.700096856695957*^9, 3.700096936956637*^9}, 
   3.718335482124311*^9},ExpressionUUID->"b5f0029d-40b5-41bf-9396-\
75cbf887d23b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]MeanBondLengths\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694349812909436*^9, 
  3.694349815876425*^9}},ExpressionUUID->"f8382789-44c3-405d-899d-\
406dbb3b2732"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AtomsetMeanBondLengths", "[", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
    RowBox[{"extras_:", "None"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"Mean", "@*", 
    RowBox[{"Map", "[", "Last", "]"}]}], "/@", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"bm", "=", 
        RowBox[{"AtomsetBonds", "@", "obj"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"a", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}]}], "\n", "\t\t\t", 
      "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"els", "=", "\n", "\t\t\t\t\t", 
          RowBox[{"ChemDataLookup", "[", 
           RowBox[{
            RowBox[{"ChemGet", "[", 
             RowBox[{"a", ",", "\"\<Element\>\""}], "]"}], ",", 
            "\"\<Symbol\>\""}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"vecs", "=", 
          RowBox[{"Norm", "/@", 
           RowBox[{"BondVector", "@", 
            RowBox[{"Values", "@", "bm"}]}]}]}]}], "\n", "\t\t\t\t", "}"}], 
       ",", "\n", "\t\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{"toGroup", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"extras", "=!=", "None"}], ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Append", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"SortBy", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"els", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Values", "@", "$ChemElements"}], ",", "#"}], 
                    "]"}], "&"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                   "\n", "\t\t\t\t\t\t\t\t\t", "#2"}], "]"}], "\[Rule]", 
                 "#3"}], "&"}], ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Keys", "@", "bm"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"ChemGet", "[", 
                  RowBox[{
                   RowBox[{"Values", "@", "bm"}], ",", "extras"}], "]"}], ",",
                  "\n", "\t\t\t\t\t\t\t\t\t", "vecs"}], "\n", 
                "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Rule", ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"SortBy", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"els", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Values", "@", "$ChemElements"}], ",", "#"}], 
                    "]"}], "&"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], "&"}], 
                  "/@", 
                  RowBox[{"Keys", "@", "bm"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "vecs"}], "\n", "\t\t\t\t\t\t\t\t", 
                "}"}]}], "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", 
          "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"GroupBy", "[", 
          RowBox[{"toGroup", ",", "First"}], "]"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.6943494433799667`*^9, 3.69434968667563*^9}, {
   3.694349720002508*^9, 3.694349757109881*^9}, {3.694349818943735*^9, 
   3.694349863515422*^9}, {3.694350357730777*^9, 3.694350692229388*^9}, {
   3.694350926141152*^9, 3.694350930036552*^9}, {3.694351030556082*^9, 
   3.6943510621065283`*^9}, {3.694351104188943*^9, 3.694351106522819*^9}, {
   3.700096967838245*^9, 3.7000969717477627`*^9}, {3.70009702255346*^9, 
   3.700097073517253*^9}, {3.700097135324876*^9, 3.700097177297661*^9}, {
   3.700097377556077*^9, 3.700097380491426*^9}, {3.700097419265836*^9, 
   3.700097451697151*^9}, {3.700097524944716*^9, 3.700097556613357*^9}, {
   3.700097610059258*^9, 3.700097647192575*^9}, {3.700097819994853*^9, 
   3.700097847245632*^9}, {3.700097882709144*^9, 3.700097935714954*^9}, {
   3.7000982183228407`*^9, 3.700098222839438*^9}, {3.7002677377306433`*^9, 
   3.700267791151326*^9}, {3.7002678221672*^9, 3.700268497192047*^9}, {
   3.70026853533994*^9, 3.700268566579485*^9}, {3.700269460312348*^9, 
   3.700269481717581*^9}, 
   3.71833548213618*^9},ExpressionUUID->"8a4a82cf-a1c2-4eda-9c56-ccc27a375513"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NeighborMap\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6948310252966757`*^9, 
  3.694831049252499*^9}},ExpressionUUID->"51447663-5bbb-488d-9ffb-\
3563e54abb02"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetNeighborMap", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"bindex", "=", 
        RowBox[{"AtomsetBondsIndexed", "[", "obj", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"atoms", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Map", "[", "Last", "]"}], "/@", "\n", "\t\t\t", 
      RowBox[{"GroupBy", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Flatten", "@", "\n", "\t\t\t\t", 
         RowBox[{"ReplaceAll", "[", "\n", "\t\t\t\t\t", 
          RowBox[{"bindex", ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i_Integer", ",", "j_", ",", "___"}], "}"}], 
            "\[RuleDelayed]", "\n", "\t", "\t", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"atoms", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
               RowBox[{"atoms", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"atoms", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[Rule]", 
               RowBox[{"atoms", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}]}], "\n", 
          "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", "First"}], "\n", 
       "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694831057905036*^9, 3.694831146703615*^9}, {
   3.6948312469002657`*^9, 3.694831319232637*^9}, {3.694831506516069*^9, 
   3.694831547499734*^9}, {3.7000982304427156`*^9, 3.700098252177764*^9}, 
   3.7183354821456127`*^9},ExpressionUUID->"9d71578c-bc15-445c-8293-\
b4429c9390a2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]MolTable\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694489602951877*^9, 
  3.694489604286584*^9}},ExpressionUUID->"be17a595-2fc3-49d0-80f3-\
8cf9a92e58b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMolTable", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"AtomsetElementPositions", "[", "obj", "]"}]}], ",", "\n", 
       "\t\t", 
       RowBox[{"b", "=", 
        RowBox[{"AtomsetBondsIndexed", "[", "obj", "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Join", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "@", "a"}], ",", 
          RowBox[{"Length", "@", "b"}]}], "}"}], "}"}], ",", "\n", "\t\t\t", 
       "a", ",", "\n", "\t\t\t", "b"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t",
     "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694489887989341*^9, 3.694489967986349*^9}, {
   3.7000982646352873`*^9, 3.700098274562248*^9}, 
   3.718335482154026*^9},ExpressionUUID->"44ae71c9-d1c8-4474-aa19-\
22601d5d0c84"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SetBondLength\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.710253620808523*^9, 3.7102536227031317`*^9}, {
  3.710253720351581*^9, 3.7102537217202673`*^9}, {3.720846501945212*^9, 
  3.720846504903818*^9}},ExpressionUUID->"f7554ee5-84b3-47b9-9cdb-\
09981d923f56"],

Cell["Sets bond lengths with ", "Text",
 CellChangeTimes->{{3.7102536775375977`*^9, 3.710253706031416*^9}, {
  3.7102547809480247`*^9, 3.710254785633217*^9}, {3.720846919147168*^9, 
  3.7208469242765913`*^9}},ExpressionUUID->"75d95ef8-ca5c-4a21-b348-\
7826fd27e1ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetSetBondLengths", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AccuracyGoal", "\[Rule]", "Automatic"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<AllowUnconnected\>\"", "\[Rule]", "False"}]}], "\n", "\t\t",
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetSetBondLengths", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"bondSel", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ChemObjPattern", "\[Rule]", "_"}], ")"}], ".."}], "}"}]}], 
     ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Catch", "@", "\n", "\t", 
    RowBox[{"Module", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"conoverride", "=", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"OptionValue", "[", "\"\<AllowUnconnected\>\"", "]"}]}]}], 
        ",", "\n", "\t\t\t", "graphs", ",", "\n", "\t\t\t", 
        RowBox[{"atoms", "=", 
         RowBox[{"ChemGet", "[", 
          RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"bonds", "=", 
         RowBox[{"Keys", "@", "bondSel"}]}], ",", "devs", ",", "vecs", ",", 
        "\n", "\t\t\t", "bondats", ",", "\n", "\t\t\t", "ats", ",", "\n", 
        "\t\t\t", "comps"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"graphs", "=", "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e", "=", 
            RowBox[{"EdgeList", "@", 
             RowBox[{"AtomGraph", "[", "atoms", "]"}]}]}], "}"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c", "=", 
              RowBox[{"ConnectedComponents", "[", "e", "]"}]}], "}"}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"GatherBy", "[", 
             RowBox[{"e", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"FirstPosition", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Make", " ", "sure", " ", 
         RowBox[{"we", "'"}], "re", " ", "dealing", " ", "with", " ", "only", 
         " ", "connected", " ", "components"}], " ", "*)"}], "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"conoverride", "||", 
          RowBox[{
           RowBox[{"Length", "[", "graphs", "]"}], "===", "1"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"vecs", "=", 
           RowBox[{"BondVector", "@", "bonds"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"devs", "=", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"bonds", ",", " ", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"Norm", ",", " ", "vecs"}], "]"}], "-", 
              RowBox[{"Values", "@", "bondSel"}]}]}], "]"}]}], ";", "\n", 
          "\t\t\t", 
          RowBox[{"vecs", "=", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"bonds", ",", " ", "vecs"}], "]"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"bondats", "=", 
           RowBox[{"ChemGet", "[", 
            RowBox[{"bonds", ",", "\"\<Atoms\>\""}], "]"}]}], ";", "\n", 
          "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Reassociate", " ", "computed", " ", "info", " ", "with", " ", 
            "each", " ", "connected", " ", "chunk"}], " ", "*)"}], "\n", 
          "\t\t\t", 
          RowBox[{"bonds", "=", "\n", "\t\t\t\t", 
           RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Pick", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{"bonds", ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"g", ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"Alternatives", "@@", 
                    RowBox[{"(", 
                    RowBox[{"UndirectedEdge", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Reverse", "[", "#", "]"}]}], "}"}]}], ")"}]}]}], 
                  "\n", "\t\t\t\t\t\t\t", "]"}], "&"}], "/@", "bondats"}]}], 
              "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"g", ",", "graphs"}], "}"}]}], "\n", "\t\t\t\t\t", 
            "]"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"bondats", "=", 
           RowBox[{"ChemGet", "[", 
            RowBox[{"bonds", ",", "\"\<Atoms\>\""}], "]"}]}], ";", "\n", 
          "\t\t\t", 
          RowBox[{"devs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Lookup", "[", 
              RowBox[{"devs", ",", "#"}], "]"}], "&"}], "/@", "bonds"}]}], 
          ";", "\n", "\t\t\t", 
          RowBox[{"vecs", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Lookup", "[", 
              RowBox[{"vecs", ",", "#"}], "]"}], "&"}], "/@", "bonds"}]}], 
          ";", "\n", "\t\t\t", "\n", "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Map", " ", "over", " ", "chunks"}], " ", "*)"}], "\n", 
          "\t\t\t", 
          RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"graph", "=", "#"}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"gbonds", "=", "#2"}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"gats", "=", "#3"}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"gdevs", "=", "#4"}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"gvecs", "=", "#5"}]}], "\n", "\t\t\t\t\t", "}"}], 
               ",", "\n", "\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "graph", "]"}], ">", "1"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"(*", " ", 
                  RowBox[{"Map", " ", "over", " ", "bonds"}], " ", "*)"}], 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Function", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Compute", " ", "segments", " ", "on", " ", "either", " ",
                     "side", " ", "of", " ", "the", " ", "bond"}], " ", 
                    "*)"}], "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"comps", "=", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ConnectedComponents", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "DeleteCases", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"graph", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"(", 
                    RowBox[{"UndirectedEdge", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"#2", ",", 
                    RowBox[{"Reverse", "[", "#2", "]"}]}], "}"}]}], ")"}]}]}],
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "comps", "]"}], "===", "1"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"c", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Complement", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"VertexList", "[", "graph", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "@", "comps"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], ">", "0"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"comps", ",", "c"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "comps", "]"}], ">", "1"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"comps", "=", 
                    RowBox[{"First", "@", 
                    RowBox[{"MinimalBy", "[", 
                    RowBox[{"comps", ",", "Length"}], "]"}]}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Determine", " ", "which", " ", "atom", " ", "is", " ", 
                    "with", " ", "which", " ", "chunk"}], " ", "*)"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"comps", ",", 
                    RowBox[{"First", "[", "#2", "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"AtomMove", "[", 
                    RowBox[{"comps", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"Normalize", "[", "#4", "]"}]}], ")"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"AtomMove", "[", 
                    RowBox[{"comps", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"Normalize", "[", "#4", "]"}]}], ")"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "gbonds", ",", "\n", "\t\t\t\t\t\t\t\t", "gats", ",", 
                    "\n", "\t\t\t\t\t\t\t\t", "gdevs", ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "gvecs"}], "\n", "\t\t\t\t\t\t\t\t", 
                    "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"AtomMove", "[", 
                   RowBox[{
                    RowBox[{"First", "[", "gats", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"#4", "/", "2"}]}], ")"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"AtomMove", "[", 
                   RowBox[{
                    RowBox[{"Last", "[", "gats", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"#4", "/", "2"}]}], ")"}]}], "\n", 
                   "\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", "\t\t\t\t\t", 
                "]"}]}], "\n", "\t\t\t\t", "]"}], "&"}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
             "graphs", ",", "\n", "\t\t\t\t\t", "bonds", ",", "\n", 
              "\t\t\t\t\t", "bondats", ",", "\n", "\t", "\t\t\t\t", "devs", 
              ",", "\n", "\t\t\t\t\t", "vecs"}], "\n", "\t\t\t\t\t", "}"}]}], 
           "\n", "\t\t\t\t", "]"}], ";"}], ",", "\n", "\t\t\t", "$Failed"}], 
        "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetSetBondLengths", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"bondSel", ":", 
     RowBox[{"(", 
      RowBox[{"ChemObjPattern", "\[Rule]", "_"}], ")"}]}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"AtomsetSetBondLengths", "[", 
   RowBox[{"obj", ",", " ", 
    RowBox[{"{", "bondSel", "}"}], ",", " ", "ops"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.710253639903489*^9, 3.710253657717988*^9}, {
   3.710253690109223*^9, 3.710253785163329*^9}, {3.7102543357730293`*^9, 
   3.710254702385416*^9}, {3.710254754374135*^9, 3.710254818810561*^9}, {
   3.710254872494721*^9, 3.710254927943322*^9}, {3.7102562217886868`*^9, 
   3.7102564893539133`*^9}, {3.710256526834416*^9, 3.710256532880537*^9}, {
   3.710256564312296*^9, 3.710256606706918*^9}, {3.710256642840959*^9, 
   3.7102567423162003`*^9}, {3.710256794981032*^9, 3.710257001585472*^9}, {
   3.710257051033824*^9, 3.710257069379573*^9}, {3.710257104228841*^9, 
   3.7102572360387287`*^9}, {3.7102572821703587`*^9, 3.710257428137683*^9}, {
   3.710257488616548*^9, 3.710257590507555*^9}, {3.7102579093492327`*^9, 
   3.71025802670901*^9}, {3.7102581197474947`*^9, 3.710258177068516*^9}, {
   3.7102582115001707`*^9, 3.710258218444107*^9}, {3.710279570898896*^9, 
   3.710279589667596*^9}, {3.710279795552092*^9, 3.7102798215572557`*^9}, {
   3.7102800546460257`*^9, 3.710280114420129*^9}, {3.710280158456271*^9, 
   3.710280177460659*^9}, {3.710280214639765*^9, 3.710280349780868*^9}, {
   3.7102804261679068`*^9, 3.710280436510686*^9}, {3.710280478355846*^9, 
   3.710280704759816*^9}, {3.7102808250575027`*^9, 3.710280940060465*^9}, {
   3.710281015966132*^9, 3.710281106235735*^9}, {3.710281189337542*^9, 
   3.7102812105429983`*^9}, {3.710281446023939*^9, 3.710281452694376*^9}, {
   3.710281602989518*^9, 3.710281645974004*^9}, {3.7102816813210077`*^9, 
   3.710281685943718*^9}, {3.7102817641414957`*^9, 3.710282038428874*^9}, {
   3.710282077827325*^9, 3.710282153871038*^9}, {3.710282209058127*^9, 
   3.710282233370104*^9}, {3.710282318874035*^9, 3.710282361648951*^9}, {
   3.710282549589834*^9, 3.710282557396062*^9}, {3.710282640368451*^9, 
   3.710282643311339*^9}, {3.710293983353451*^9, 3.7102942519142637`*^9}, {
   3.710294289881176*^9, 3.710294290512887*^9}, {3.7102943226496353`*^9, 
   3.710294323488351*^9}, 3.710294359424095*^9, {3.7102943957123117`*^9, 
   3.710294493968375*^9}, {3.710295409793445*^9, 3.7102954757142973`*^9}, {
   3.7161688911663837`*^9, 3.7161688920528*^9}, 3.7161690020852823`*^9, {
   3.718335482178401*^9, 3.7183355063945217`*^9}, {3.7208465279318647`*^9, 
   3.720846548628957*^9}, {3.720846701972031*^9, 3.720846769016367*^9}, {
   3.720846865725284*^9, 3.7208469555271263`*^9}, {3.720847154792982*^9, 
   3.720847161163815*^9}},ExpressionUUID->"1a34a054-bc71-4c2c-99d6-\
6f2e39b8bd31"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NormalizeBonds\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.710253620808523*^9, 3.7102536227031317`*^9}, {
  3.710253720351581*^9, 
  3.7102537217202673`*^9}},ExpressionUUID->"1b25ca75-4a2b-4916-b7ad-\
f31792edae9d"],

Cell["\<\
Normalize all atomset bonds up to a bond tolerance.
Need to find shared chunks of this and SetBondLengths\
\>", "Text",
 CellChangeTimes->{{3.7102536775375977`*^9, 3.710253706031416*^9}, {
  3.7102547809480247`*^9, 3.710254785633217*^9}, {3.720846972674305*^9, 
  3.72084698695081*^9}},ExpressionUUID->"0eebd19d-8b87-4505-9e2e-\
e387493d7758"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetNormalizeBonds", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AccuracyGoal", "\[Rule]", "Automatic"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<AllowUnconnected\>\"", "\[Rule]", "False"}]}], "\n", "\t\t",
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetNormalizeBonds", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"bondSel", ":", 
     RowBox[{"ChemObjPattern", "|", "ChemObjVectorPattern", "|", "All"}], ":",
      "All"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Catch", "@", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"conoverride", "=", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<AllowUnconnected\>\"", "]"}]}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"tol", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}], ",", "\n", "\t", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_", "?", "NumericQ"}], "]"}], "->", ".1"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", "graphs", ",", "\n", 
       "\t\t\t", 
       RowBox[{"atoms", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t\t", 
       "bonds", ",", "devs", ",", "vecs", ",", "\n", "\t\t\t", "bondats", ",",
        "\n", "\t\t\t", "ats", ",", "\n", "\t\t\t", "comps"}], "\n", "\t\t\t",
       "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"graphs", "=", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e", "=", 
           RowBox[{"EdgeList", "@", 
            RowBox[{"AtomGraph", "[", "atoms", "]"}]}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c", "=", 
             RowBox[{"ConnectedComponents", "[", "e", "]"}]}], "}"}], ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{"GatherBy", "[", 
            RowBox[{"e", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"FirstPosition", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"First", "[", "#", "]"}]}], "]"}]}], "&"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Make", " ", "sure", " ", 
        RowBox[{"we", "'"}], "re", " ", "dealing", " ", "with", " ", "only", 
        " ", "connected", " ", "components"}], " ", "*)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"conoverride", "||", 
         RowBox[{
          RowBox[{"Length", "[", "graphs", "]"}], "===", "1"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"bonds", "=", "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
           RowBox[{"bondSel", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"All", ":>", "\n", "\t\t\t\t\t\t", 
             RowBox[{"DeleteDuplicates", "@", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Flatten", "@", 
               RowBox[{"ChemGet", "[", 
                RowBox[{"atoms", ",", "\"\<Bonds\>\""}], "]"}]}]}]}]}], "\n", 
           "\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"devs", "=", 
          RowBox[{"BondDeviation", "[", "bonds", "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"bonds", "=", 
          RowBox[{"Pick", "[", 
           RowBox[{"bonds", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", ">", "tol"}], "&"}], "/@", 
             RowBox[{"Abs", "[", "devs", "]"}]}]}], "]"}]}], ";", "\n", 
         "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "bonds", "]"}], "===", "0"}], ",", 
           RowBox[{"Throw", "[", "Null", "]"}]}], "]"}], ";", "\n", "\t\t\t", 
         
         RowBox[{"devs", "=", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"bonds", ",", 
            RowBox[{"Pick", "[", 
             RowBox[{"devs", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", ">", "tol"}], "&"}], "/@", 
               RowBox[{"Abs", "[", "devs", "]"}]}]}], "]"}]}], "]"}]}], ";", 
         "\n", "\t\t\t", 
         RowBox[{"vecs", "=", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"bonds", ",", 
            RowBox[{"BondVector", "@", "bonds"}]}], "]"}]}], ";", "\n", 
         "\t\t\t", 
         RowBox[{"bondats", "=", 
          RowBox[{"ChemGet", "[", 
           RowBox[{"bonds", ",", "\"\<Atoms\>\""}], "]"}]}], ";", "\n", 
         "\t\t\t", "\n", "\t\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Reassociate", " ", "computed", " ", "info", " ", "with", " ", 
           "each", " ", "connected", " ", "chunk"}], " ", "*)"}], "\n", 
         "\t\t\t", 
         RowBox[{"bonds", "=", "\n", "\t\t\t\t", 
          RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Pick", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{"bonds", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"g", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Alternatives", "@@", 
                   RowBox[{"(", 
                    RowBox[{"UndirectedEdge", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Reverse", "[", "#", "]"}]}], "}"}]}], ")"}]}]}], 
                 "\n", "\t\t\t\t\t\t\t", "]"}], "&"}], "/@", "bondats"}]}], 
             "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"g", ",", "graphs"}], "}"}]}], "\n", "\t\t\t\t\t", 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"bondats", "=", 
          RowBox[{"ChemGet", "[", 
           RowBox[{"bonds", ",", "\"\<Atoms\>\""}], "]"}]}], ";", "\n", 
         "\t\t\t", 
         RowBox[{"devs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"devs", ",", "#"}], "]"}], "&"}], "/@", "bonds"}]}], ";",
          "\n", "\t\t\t", 
         RowBox[{"vecs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"vecs", ",", "#"}], "]"}], "&"}], "/@", "bonds"}]}], ";",
          "\n", "\t\t\t", "\n", "\t\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Map", " ", "over", " ", "chunks"}], " ", "*)"}], "\n", 
         "\t\t\t", 
         RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"graph", "=", "#"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"gbonds", "=", "#2"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"gats", "=", "#3"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"gdevs", "=", "#4"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"gvecs", "=", "#5"}]}], "\n", "\t\t\t\t\t", "}"}], 
              ",", "\n", "\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "graph", "]"}], ">", "1"}], ",", "\n",
                 "\t\t\t\t\t\t", 
                RowBox[{"(*", " ", 
                 RowBox[{"Map", " ", "over", " ", "bonds"}], " ", "*)"}], 
                "\n", "\t\t\t\t\t\t", 
                RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Function", "[", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Compute", " ", "segments", " ", "on", " ", "either", " ",
                     "side", " ", "of", " ", "the", " ", "bond"}], " ", 
                    "*)"}], "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"comps", "=", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ConnectedComponents", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "DeleteCases", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"graph", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"(", 
                    RowBox[{"UndirectedEdge", "@@@", 
                    RowBox[{"{", 
                    RowBox[{"#2", ",", 
                    RowBox[{"Reverse", "[", "#2", "]"}]}], "}"}]}], ")"}]}]}],
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "comps", "]"}], "===", "1"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"c", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Complement", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"VertexList", "[", "graph", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "@", "comps"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], ">", "0"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"comps", ",", "c"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "comps", "]"}], ">", "1"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"comps", "=", 
                    RowBox[{"First", "@", 
                    RowBox[{"MinimalBy", "[", 
                    RowBox[{"comps", ",", "Length"}], "]"}]}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "Determine", " ", "which", " ", "atom", " ", "is", " ", 
                    "with", " ", "which", " ", "chunk"}], " ", "*)"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"comps", ",", 
                    RowBox[{"First", "[", "#2", "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"AtomMove", "[", 
                    RowBox[{"comps", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"Normalize", "[", "#4", "]"}]}], ")"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"AtomMove", "[", 
                    RowBox[{"comps", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"Normalize", "[", "#4", "]"}]}], ")"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                   "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "gbonds", ",", "\n", "\t\t\t\t\t\t\t\t", "gats", ",", "\n",
                     "\t\t\t\t\t\t\t\t", "gdevs", ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "gvecs"}], "\n", "\t\t\t\t\t\t\t\t", 
                   "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"AtomMove", "[", 
                  RowBox[{
                   RowBox[{"First", "[", "gats", "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"#4", "/", "2"}]}], ")"}]}]}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"AtomMove", "[", 
                  RowBox[{
                   RowBox[{"Last", "[", "gats", "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{"(", 
                    RowBox[{"#3", "*", 
                    RowBox[{"#4", "/", "2"}]}], ")"}]}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", "\t\t\t\t\t", 
               "]"}]}], "\n", "\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
            "graphs", ",", "\n", "\t\t\t\t\t", "bonds", ",", "\n", 
             "\t\t\t\t\t", "bondats", ",", "\n", "\t", "\t\t\t\t", "devs", 
             ",", "\n", "\t\t\t\t\t", "vecs"}], "\n", "\t\t\t\t\t", "}"}]}], 
          "\n", "\t\t\t\t", "]"}], ";"}], ",", "\n", "\t\t\t", "$Failed"}], 
       "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.710253639903489*^9, 3.710253657717988*^9}, {
   3.710253690109223*^9, 3.710253785163329*^9}, {3.7102543357730293`*^9, 
   3.710254702385416*^9}, {3.710254754374135*^9, 3.710254818810561*^9}, {
   3.710254872494721*^9, 3.710254927943322*^9}, {3.7102562217886868`*^9, 
   3.7102564893539133`*^9}, {3.710256526834416*^9, 3.710256532880537*^9}, {
   3.710256564312296*^9, 3.710256606706918*^9}, {3.710256642840959*^9, 
   3.7102567423162003`*^9}, {3.710256794981032*^9, 3.710257001585472*^9}, {
   3.710257051033824*^9, 3.710257069379573*^9}, {3.710257104228841*^9, 
   3.7102572360387287`*^9}, {3.7102572821703587`*^9, 3.710257428137683*^9}, {
   3.710257488616548*^9, 3.710257590507555*^9}, {3.7102579093492327`*^9, 
   3.71025802670901*^9}, {3.7102581197474947`*^9, 3.710258177068516*^9}, {
   3.7102582115001707`*^9, 3.710258218444107*^9}, {3.710279570898896*^9, 
   3.710279589667596*^9}, {3.710279795552092*^9, 3.7102798215572557`*^9}, {
   3.7102800546460257`*^9, 3.710280114420129*^9}, {3.710280158456271*^9, 
   3.710280177460659*^9}, {3.710280214639765*^9, 3.710280349780868*^9}, {
   3.7102804261679068`*^9, 3.710280436510686*^9}, {3.710280478355846*^9, 
   3.710280704759816*^9}, {3.7102808250575027`*^9, 3.710280940060465*^9}, {
   3.710281015966132*^9, 3.710281106235735*^9}, {3.710281189337542*^9, 
   3.7102812105429983`*^9}, {3.710281446023939*^9, 3.710281452694376*^9}, {
   3.710281602989518*^9, 3.710281645974004*^9}, {3.7102816813210077`*^9, 
   3.710281685943718*^9}, {3.7102817641414957`*^9, 3.710282038428874*^9}, {
   3.710282077827325*^9, 3.710282153871038*^9}, {3.710282209058127*^9, 
   3.710282233370104*^9}, {3.710282318874035*^9, 3.710282361648951*^9}, {
   3.710282549589834*^9, 3.710282557396062*^9}, {3.710282640368451*^9, 
   3.710282643311339*^9}, {3.710293983353451*^9, 3.7102942519142637`*^9}, {
   3.710294289881176*^9, 3.710294290512887*^9}, {3.7102943226496353`*^9, 
   3.710294323488351*^9}, 3.710294359424095*^9, {3.7102943957123117`*^9, 
   3.710294493968375*^9}, {3.710295409793445*^9, 3.7102954757142973`*^9}, {
   3.7161688911663837`*^9, 3.7161688920528*^9}, 3.7161690020852823`*^9, {
   3.718335482178401*^9, 
   3.7183355063945217`*^9}},ExpressionUUID->"b8c4104b-da0e-4c65-83af-\
ed21111c2157"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Connectivity Properties\[RightFloor]", \
"CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6948707186986227`*^9, 3.694870720145588*^9}, {
  3.694870755479844*^9, 
  3.694870759584199*^9}},ExpressionUUID->"f1837cd1-bf75-45ae-80ae-\
545746894fff"],

Cell[CellGroupData[{

Cell["AdjacencyMatrix", "CodeSubsubsection",
 CellChangeTimes->{{3.6948330293929157`*^9, 
  3.694833033311345*^9}},ExpressionUUID->"56e9ce7f-dcfa-48d5-82c3-\
473737d15f01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AtomsetAdjacencyMatrix", "[", 
   RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"ReplacePart", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Map", "[", "Boole", "]"}], "/@", 
       RowBox[{"AtomBondedQ", "[", 
        RowBox[{"#", ",", "#"}], "]"}]}], "&"}], "@", 
     RowBox[{"ChemGet", "[", 
      RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i_", ",", "i_"}], "}"}], "\[Rule]", "0"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6948330343029833`*^9, 3.694833064240443*^9}, {
   3.700099934984129*^9, 3.700099985151189*^9}, {3.7001030717038927`*^9, 
   3.700103081184091*^9}, 
   3.718335482196941*^9},ExpressionUUID->"c76dcfea-1d47-4de7-894d-\
9ff799c5188c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Graph", "CodeSubsubsection",
 CellChangeTimes->{{3.692535810330789*^9, 3.692535813202755*^9}, 
   3.6925363802606688`*^9},ExpressionUUID->"b0886a53-296f-4110-bdba-\
d8858fd9b26c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraph", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"style", ":", 
      RowBox[{"True", "|", "False"}], ":", "False"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"adjMat", "=", 
        RowBox[{"AtomsetAdjacencyMatrix", "@", "obj"}]}], ",", 
       RowBox[{"atoms", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "@", "style"}], ",", "\n", "\t\t\t", 
       RowBox[{"Graph", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"EdgeList", "@", 
          RowBox[{"AdjacencyGraph", "@", "adjMat"}]}], "/.", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"i_Integer", ":>", 
          RowBox[{"atoms", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"Graph", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"EdgeList", "@", 
           RowBox[{"AdjacencyGraph", "@", "adjMat"}]}], "/.", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"i_Integer", ":>", 
           RowBox[{"atoms", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"VertexShape", "\[Rule]", "\n", "\t", "\t\t\t\t", 
          RowBox[{"Table", "[", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"AtomColor", "@", "a"}], ",", "\n", "\t", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"Darker", "@", 
                 RowBox[{"AtomColor", "@", "a"}]}], ",", "\n", "\t", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                  RowBox[{"Disk", "[", "]"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"StringJoin", "@", 
                   RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"ChemGet", "[", 
                    RowBox[{"a", ",", "\"\<ObjectKey\>\""}], "]"}], ",", 
                    RowBox[{"\"\<-\>\"", "\[Rule]", "\"\<-\>\""}]}], "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "3"}], "]"}], "]"}]}]}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t\t\t", 
               "}"}], "]"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"a", ",", "atoms"}], "}"}]}], "\n", "\t", "\t\t\t\t\t", 
           "]"}]}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Thick", ",", "Black"}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"VertexSize", "\[Rule]", "\n", "\t\t\t\t\t", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[Rule]", 
              RowBox[{
               RowBox[{"QuantityMagnitude", "[", "#2", "]"}], "/", "2."}]}], 
             "&"}], ",", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{"atoms", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"ChemGet", "[", 
               RowBox[{"atoms", ",", "\"\<Radius\>\""}], "]"}]}], "\n", 
             "\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69253581671143*^9, 3.69253616214404*^9}, {
   3.692536331040337*^9, 3.692536333196406*^9}, {3.692571530164441*^9, 
   3.692571545817184*^9}, {3.692572074982181*^9, 3.692572268847522*^9}, {
   3.700102646749792*^9, 3.700102765316662*^9}, {3.700103044667438*^9, 
   3.700103046257427*^9}, {3.700103175026005*^9, 3.7001032195709553`*^9}, {
   3.700103255763398*^9, 3.70010325990659*^9}, {3.700103328018305*^9, 
   3.700103382581483*^9}, 
   3.718335482209499*^9},ExpressionUUID->"a1296482-4085-4672-ac80-\
5cc94beacdc4"]
}, Closed]],

Cell[CellGroupData[{

Cell["GraphScan", "CodeSubsubsection",
 CellChangeTimes->{{3.7002814112887917`*^9, 
  3.700281413974724*^9}},ExpressionUUID->"2899148d-c7f1-4a46-b39e-\
b22c46ef6e30"],

Cell[CellGroupData[{

Cell["DFS Events", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7002832764796257`*^9, 
  3.7002832780867033`*^9}},ExpressionUUID->"872bfcfd-e468-4007-ba6c-\
0cf4d2ba0fd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"atomsetGraphEvents", "[", 
    RowBox[{"basevs_", ",", "bs_", ",", "as_", ",", "DepthFirstScan"}], "]"}],
    ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"evs", "=", "\n", "\t", "\t", 
       RowBox[{"Merge", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "basevs", "}"}]}], ",", 
           RowBox[{"{", "\n", "\t", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", ":", 
                 RowBox[{"(", 
                  RowBox[{
                  "\"\<BackEdge\>\"", "|", "\"\<FrontierEdge\>\"", "|", "\n", 
                   "\t", "\t\t\t\t", "\"\<ForwardEdge\>\"", "|", 
                   "\"\<CrossEdge\>\""}], ")"}]}], "\[Rule]", "f_"}], ")"}], ":>",
               "\n", "\t", "\t\t\t\t", 
              RowBox[{"k", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"f", "[", 
                  RowBox[{"#", "/.", "bs"}], "]"}], "&"}], ")"}]}]}], ",", 
             "\n", "\t", "\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"k", ":", 
                   RowBox[{
                   "\"\<BackEdge\>\"", "|", "\"\<FrontierEdge\>\"", "|", "\n",
                     "\t", "\t\t\t\t", "\"\<ForwardEdge\>\"", "|", 
                    "\"\<CrossEdge\>\""}]}], ",", "\n", "\t\t\t\t\t", 
                  RowBox[{"c", ":", "ChemObjPattern"}]}], "}"}], "\[Rule]", 
                "f_"}], ")"}], ":>", "\n", "\t", "\t\t\t\t", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"#", "/.", "bs"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}], ",", 
             "\n", "\t", "\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"k_", ",", 
                  RowBox[{"c", ":", "ChemObjPattern"}]}], "}"}], "\[Rule]", 
                "f_"}], ")"}], ":>", "\n", "\t", "\t\t\t\t", 
              RowBox[{"k", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{"#", ",", "c"}], "]"}], ",", 
                   RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}]}], 
             ",", "\n", "\t", "\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", ":", "ChemObjPattern"}], "\[Rule]", "f_"}], 
               ")"}], ":>", "\n", "\t", "\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"c", ",", "as"}], "]"}], ",", "\n", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"Thread", "[", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<DiscoverVertex\>\"", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", "\"\<UnvisitedVertex\>\"", ",", 
                    "\"\<VisitedVertex\>\"", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", "\"\<PrevisitVertex\>\"", ",", 
                    "\"\<PostvisitVertex\>\""}], "}"}], "->", "\n", "\t", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"#", ",", "c"}], "]"}], ",", 
                    RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}], 
                 "\n", "\t", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"Thread", "[", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<BackEdge\>\"", ",", "\"\<FrontierEdge\>\"", ",", "\n",
                     "\t", "\t\t\t\t\t\t\t", "\"\<ForwardEdge\>\"", ",", 
                    "\"\<CrossEdge\>\""}], "}"}], "->", "\n", "\t", 
                  "\t\t\t\t\t\t\t ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"#", "/.", "bs"}], ",", "c"}], "]"}], ",", 
                    RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}], 
                 "\n", "\t", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", 
               "]"}]}]}], "\n", "\t\t\t\t", "}"}], ",", "1"}], "]"}], ",", 
         "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"f", ":", 
            RowBox[{"{", "__", "}"}]}], ":>", "\n", "\t", "\t\t\t", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Through", "[", 
              RowBox[{"f", "[", "#", "]"}], "]"}], "&"}], ")"}]}], "\n", "\t",
           "\t\t\t", "]"}]}], "\n", "\t", "\t\t", "]"}]}], "}"}], ",", "\n", 
     "\t\t", "evs"}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.700283237839184*^9, 3.700283265321451*^9}, {
  3.700284896822369*^9, 3.700284899706542*^9}, {3.718335482224135*^9, 
  3.7183354822366877`*^9}},ExpressionUUID->"0e9e109c-81a7-4581-8b3f-\
ac46fb16c9e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["BFS Events", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7002832276180983`*^9, 
  3.700283248703334*^9}},ExpressionUUID->"c005aea0-398e-4cbf-a9c3-\
b7a4ca5739b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"atomsetGraphEvents", "[", 
    RowBox[{"basevs_", ",", "bs_", ",", "as_", ",", "BreadthFirstScan"}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"Merge", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"{", "basevs", "}"}]}], ",", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", ":", 
             RowBox[{"(", 
              RowBox[{"\"\<FrontierEdge\>\"", "|", "\"\<CycleEdge\>\""}], 
              ")"}]}], "\[Rule]", "f_"}], ")"}], ":>", "\n", "\t\t\t\t", 
          RowBox[{"k", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"#", "/.", "bs"}], "]"}], "&"}], ")"}]}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k", ":", 
               RowBox[{"(", 
                RowBox[{"\"\<FrontierEdge\>\"", "|", "\"\<CycleEdge\>\""}], 
                ")"}]}], ",", "\n", "\t\t\t\t", 
              RowBox[{"c", ":", "ChemObjPattern"}]}], "}"}], "\[Rule]", 
            "f_"}], ")"}], ":>", "\n", "\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"#", "/.", "bs"}], ",", "c"}], "]"}], ",", 
              RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}], ",", 
         "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k_", ",", 
              RowBox[{"c", ":", "ChemObjPattern"}]}], "}"}], "\[Rule]", 
            "f_"}], ")"}], ":>", "\n", "\t\t\t\t", 
          RowBox[{"k", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", "c"}], "]"}], ",", 
               RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}]}], ",", 
         "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", ":", "ChemObjPattern"}], "\[Rule]", "f_"}], ")"}], ":>",
           "\n", "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"as", ",", "c"}], "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<DiscoverVertex\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
                "\"\<UnvisitedVertex\>\"", ",", "\"\<VisitedVertex\>\"", ",", 
                "\n", "\t\t\t\t\t\t\t", "\"\<PrevisitVertex\>\"", ",", 
                "\"\<PostvisitVertex\>\""}], "}"}], "->", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{"#", ",", "c"}], "]"}], ",", 
                  RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}], "\n",
              "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<FrontierEdge\>\"", ",", "\"\<CycleEdge\>\""}], 
               "}"}], "->", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"#", "/.", "bs"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"f", "[", "c", "]"}]}], "]"}], "&"}], ")"}]}], "\n",
              "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", 
        "\t\t\t", "}"}], ",", "\n", "\t\t\t", "1"}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"f", ":", 
        RowBox[{"{", "__", "}"}]}], ":>", "\n", "\t\t\t", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Through", "[", 
          RowBox[{"f", "[", "#", "]"}], "]"}], "&"}], ")"}]}], "\n", "\t\t\t",
       "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7002831115313883`*^9, 3.700283174876946*^9}, {
   3.700283489070704*^9, 3.700283561631873*^9}, {3.700283604576028*^9, 
   3.700283605940443*^9}, {3.700283639767893*^9, 3.700283642028389*^9}, {
   3.700283675149642*^9, 3.700283681963139*^9}, {3.700283713766746*^9, 
   3.700283752472518*^9}, 3.700283800033903*^9, {3.700283873388488*^9, 
   3.700283895290392*^9}, {3.700283944189241*^9, 3.700283944714693*^9}, {
   3.700283975756544*^9, 3.7002839801458178`*^9}, {3.7183354822526407`*^9, 
   3.718335482268409*^9}},ExpressionUUID->"3c78f2f6-dcbd-4cb9-a379-\
fef88cc8a147"]
}, Closed]],

Cell[CellGroupData[{

Cell["GraphEvents", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700283336933671*^9, 
  3.7002833390045233`*^9}},ExpressionUUID->"4b889bd9-2f43-4c01-a43d-\
72ceb33bb2a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraphEvents", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"BreadthFirstScan", "|", "DepthFirstScan"}], ":", 
      "BreadthFirstScan"}], ",", "\n", "\t", 
     RowBox[{"events_:", 
      RowBox[{"{", "}"}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"basevs", "=", "\n", "\t", "\t\t\t", 
          RowBox[{"Flatten", "@", "events"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"bs", "=", "\n", "\t\t\t\t", 
          RowBox[{"Dispatch", "@", 
           RowBox[{"Normal", "@", 
            RowBox[{"KeyMap", "[", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"UndirectedEdge", "@@", "#"}], "|", 
                   RowBox[{"UndirectedEdge", "@@", 
                    RowBox[{"Reverse", "@", "#"}]}]}], ")"}], "&"}], "@", 
                "\n", "\t", "\t", "\t\t\t\t", 
                RowBox[{"as", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", "\n", "\t", 
              "\t", "\t\t\t", 
              RowBox[{"AtomsetBonds", "[", "obj", "]"}]}], "\n", "\t", "\t", 
             "\t\t\t", "]"}]}]}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"atomsetGraphEvents", "[", 
        RowBox[{"basevs", ",", "bs", ",", "as", ",", "mode"}], "]"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.700283340109496*^9, 3.700283424860569*^9}, {
   3.7002839674109077`*^9, 3.700283967640532*^9}, {3.700284758143961*^9, 
   3.700284762479537*^9}, {3.7002849728165092`*^9, 3.700284976791258*^9}, 
   3.718335482280328*^9},ExpressionUUID->"3aea155a-1c77-4ac8-ad44-\
793336f5b5f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Main", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7002833116876297`*^9, 
  3.700283312141226*^9}},ExpressionUUID->"4516800e-8124-4e89-b998-\
f12cd5c2d1b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AtomsetGraphScan", "[", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"startingNode", ":", 
     RowBox[{"ChemObjPattern", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
    
    RowBox[{"mode", ":", 
     RowBox[{"BreadthFirstScan", "|", "DepthFirstScan", "|", "Automatic"}], 
     ":", "Automatic"}], ",", "\n", "\t", 
    RowBox[{"events_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"scanF", "=", "\n", "\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"mode", ",", "\n", "\t\t\t", 
        RowBox[{"Automatic", ":>", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"events", ",", "\n", "\t", "\t", "\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{
              "\"\<BackEdge\>\"", "|", "\"\<FrontierEdge\>\"", "|", "\n", 
               "\t", "\t", "\t", "\t\t\t\t", "\"\<ForwardEdge\>\"", "|", 
               "\"\<CrossEdge\>\""}], ")"}]}], "]"}], ",", "\n", "\t", "\t", 
           "\t\t\t", "BreadthFirstScan", ",", "\n", "\t\t\t\t\t", 
           "DepthFirstScan"}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", 
       "\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"startingNode", "===", "None"}], ",", "\n", "\t\t\t", 
      RowBox[{"scanF", "[", 
       RowBox[{
        RowBox[{"AtomsetGraph", "@", "obj"}], ",", "\n", "\t", "\t\t\t", 
        RowBox[{"AtomsetGraphEvents", "[", 
         RowBox[{"obj", ",", "scanF", ",", "events"}], "]"}]}], "\n", 
       "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"scanF", "[", 
       RowBox[{
        RowBox[{"AtomsetGraph", "@", "obj"}], ",", "startingNode", ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"AtomsetGraphEvents", "[", 
         RowBox[{"obj", ",", "scanF", ",", "events"}], "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7002814151172733`*^9, 3.7002815476579733`*^9}, {
   3.700281588747888*^9, 3.7002816880847263`*^9}, {3.7002817309224253`*^9, 
   3.7002817436078672`*^9}, {3.700281868154676*^9, 3.700281871761402*^9}, {
   3.700281944850195*^9, 3.7002821233108683`*^9}, {3.700282172938011*^9, 
   3.700282418029537*^9}, {3.700282530187027*^9, 3.7002825825033207`*^9}, {
   3.700282619686895*^9, 3.700282848811378*^9}, {3.7002829100367393`*^9, 
   3.700282933301351*^9}, {3.7002829678730297`*^9, 3.70028308754753*^9}, 
   3.700283147045496*^9, {3.7002831855590553`*^9, 3.700283220263947*^9}, {
   3.700283288058118*^9, 3.700283303305238*^9}, 3.7002833675450687`*^9, {
   3.700283430605569*^9, 3.700283452369169*^9}, {3.700284987209057*^9, 
   3.70028498895945*^9}, {3.70028507684381*^9, 3.700285143780587*^9}, {
   3.7002852351629972`*^9, 3.700285239912122*^9}, {3.7002863622257137`*^9, 
   3.70028639717319*^9}, 3.7008830999165077`*^9, 3.700883143279027*^9, {
   3.718335482292185*^9, 
   3.718335482297162*^9}},ExpressionUUID->"677a2c66-de08-4fd6-b835-\
85678c35a682"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectedComponents", "CodeSubsubsection",
 CellChangeTimes->{{3.6924751738551893`*^9, 3.692475178678073*^9}, {
   3.692475340460493*^9, 3.692475341689633*^9}, 
   3.692843112679348*^9},ExpressionUUID->"75a85917-5c4d-4c16-a964-\
a0fcf7311618"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetConnectedComponents", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"a", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"ConnectedComponents", "@", 
       RowBox[{"(", 
        RowBox[{"AtomsetGraph", "[", "obj", "]"}], ")"}]}], "/.", "\n", 
      "\t\t\t", 
      RowBox[{"(", 
       RowBox[{"i_Integer", "\[RuleDelayed]", 
        RowBox[{"a", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.692535517024001*^9, 3.692535524327156*^9}, {
   3.6925356345970173`*^9, 3.6925357652509413`*^9}, {3.6925362893834343`*^9, 
   3.692536370900071*^9}, {3.6925367939921017`*^9, 3.6925368039018784`*^9}, {
   3.692572317580739*^9, 3.6925723245525827`*^9}, {3.700102773975074*^9, 
   3.700102795402091*^9}, {3.700102916679542*^9, 3.700102968652782*^9}, 
   3.7183354823059807`*^9},ExpressionUUID->"4b32ad69-2557-40f0-b5da-\
9b767260d47c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rings", "CodeSubsubsection",
 CellChangeTimes->{{3.6948321756350517`*^9, 
  3.694832176410042*^9}},ExpressionUUID->"557045f1-332c-449f-a051-\
69c3d8538ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findRing", "[", 
   RowBox[{"baseAtoms_", ",", "vds_", ",", "ed_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"edges1", "=", "\n", "\t\t", 
      RowBox[{"Cases", "[", 
       RowBox[{"ed", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Alternatives", "@@", "baseAtoms"}], ")"}], 
         "\[UndirectedEdge]", 
         RowBox[{"(", 
          RowBox[{"Alternatives", "@@", "baseAtoms"}], ")"}]}]}], "\n", 
       "\t\t\t", "]"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"AllTrue", "[", 
       RowBox[{
        RowBox[{"VertexDegree", "[", "edges1", "]"}], ",", 
        RowBox[{"GreaterThan", "[", "1", "]"}]}], "]"}], ",", "\n", "\t\t\t", 
      "baseAtoms", ",", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "@", "baseAtoms"}], "\[Equal]", 
         RowBox[{"Sort", "@", 
          RowBox[{"VertexList", "@", "ed"}]}]}], ",", "\n", "\t\t\t\t", 
        "$Failed", ",", "\n", "\t\t\t\t", 
        RowBox[{"findRing", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"VertexList", "@", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"Cases", "[", 
            RowBox[{"ed", ",", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Alternatives", "@@", "baseAtoms"}], ")"}], 
               "\[UndirectedEdge]", "_"}], "|", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"_", "\[UndirectedEdge]", 
               RowBox[{"Alternatives", "@@", "baseAtoms"}]}]}]}], "]"}]}], 
          ",", "\n", "\t", "\t\t\t\t", "vds", ",", "\n", "\t\t\t\t\t", "ed"}],
          "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.700885259565344*^9, 3.7008852607927237`*^9}, {
  3.700885297503381*^9, 3.7008853154493856`*^9}, {3.700885704926426*^9, 
  3.70088570680558*^9}, {3.700885805916874*^9, 3.700885976275041*^9}, {
  3.700886619663937*^9, 
  3.700886742820977*^9}},ExpressionUUID->"aefa0536-0a79-41e4-a03d-\
33ccdea9106a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRings", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gbase", "=", "\n", "\t\t", 
       RowBox[{"AtomGraph", "@", "\n", "\t\t\t", 
        RowBox[{"FixedPoint", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Pick", "[", 
              RowBox[{
               RowBox[{"VertexList", "@", "#"}], ",", "\n", "\t", "\t\t\t\t", 
               
               RowBox[{
                RowBox[{"GreaterThan", "[", "1", "]"}], "/@", 
                RowBox[{"VertexDegree", "@", "#"}]}]}], "]"}], "&"}], "@", 
            "\n", "\t", "\t\t\t\t", 
            RowBox[{"AtomGraph", "@", "#"}]}], "&"}], ",", "\n", "\t", 
          "\t\t\t", 
          RowBox[{"ChemGet", "[", 
           RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "\n", "\t", 
         "\t\t\t", "]"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"edges", "=", 
          RowBox[{"EdgeList", "@", "gbase"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"vds", "=", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{
            RowBox[{"VertexList", "@", "gbase"}], ",", 
            RowBox[{"VertexDegree", "@", "gbase"}]}], "]"}]}]}], "\n", 
        "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rings", "=", "\n", "\t\t\t\t", 
           RowBox[{"DeleteCases", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"findRing", "[", 
                RowBox[{"#", ",", "vds", ",", "edges"}], "]"}], "&"}], "/@", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"ConnectedComponents", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"AtomGraph", "@", 
                RowBox[{"Keys", "@", 
                 RowBox[{"Select", "[", 
                  RowBox[{"vds", ",", 
                   RowBox[{"EqualTo", "[", "2", "]"}]}], "]"}]}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
             "$Failed"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", 
          "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"MapIndexed", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Intersection", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Flatten", "@", 
                  RowBox[{"Delete", "[", 
                   RowBox[{"rings", ",", 
                    RowBox[{"First", "@", "#2"}]}], "]"}]}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", "#"}], "\n", "\t\t\t\t\t\t\t\t", "]"}], 
               ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", "}"}], "\[Rule]", "#"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Sort", "[", "#", "]"}], "\[Rule]", "#"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"l_", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"rings", ",", "l"}], "]"}], "||", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"!", 
                    RowBox[{
                    "ConnectedGraphQ", "@", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Graph", "@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"edges", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Alternatives", "@@", "l"}], ")"}], 
                    "\[UndirectedEdge]", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"Alternatives", "@@", "l"}], ")"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "Nothing", ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "l"}], "\n", "\t\t\t\t\t\t\t\t", 
                   "]"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], "]"}], "&"}], 
            ",", "\n", "\t\t\t\t\t", "rings"}], "\n", "\t\t\t\t\t", "]"}]}]}],
         "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694832252487008*^9, 3.6948324121705637`*^9}, {
   3.694832445871111*^9, 3.694832562725068*^9}, {3.694832658918151*^9, 
   3.6948326598047037`*^9}, {3.694832837543461*^9, 3.694832871575973*^9}, {
   3.6948329284021797`*^9, 3.694832955988702*^9}, {3.694833006271852*^9, 
   3.694833020088437*^9}, {3.694833077560748*^9, 3.694833174955011*^9}, {
   3.694833220290308*^9, 3.694833248545739*^9}, {3.694833312004633*^9, 
   3.694833344376449*^9}, {3.6948334063759108`*^9, 3.694833415855081*^9}, {
   3.694833473595364*^9, 3.694833581047338*^9}, {3.7000982834506407`*^9, 
   3.700098297802026*^9}, {3.7001686924145403`*^9, 3.700168715592252*^9}, {
   3.7001688181388197`*^9, 3.700168819769495*^9}, {3.700884734093707*^9, 
   3.700884896439075*^9}, {3.7008853619163227`*^9, 3.700885380179048*^9}, {
   3.700885552998272*^9, 3.700885597077073*^9}, {3.7008857096136827`*^9, 
   3.700885797987702*^9}, {3.700885831201989*^9, 3.700885847338937*^9}, 
   3.700886648229246*^9, {3.700886800017078*^9, 3.700887003556403*^9}, {
   3.700887059105775*^9, 3.700887122280429*^9}, {3.700887178063901*^9, 
   3.70088722977962*^9}, {3.700887269797201*^9, 3.7008873193956633`*^9}, {
   3.7008874394724627`*^9, 3.700887473222636*^9}, {3.700887504229538*^9, 
   3.700887518667296*^9}, {3.700888869660084*^9, 3.700888923765789*^9}, {
   3.700889265721998*^9, 3.700889305083891*^9}, {3.7008893755198593`*^9, 
   3.700889516224334*^9}, 
   3.718335482317713*^9},ExpressionUUID->"d086017e-2203-44a1-8240-\
02d15a123fd2"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConjugatedSystems", "CodeSubsubsection",
 CellChangeTimes->{{3.694834297306089*^9, 
  3.694834300888935*^9}},ExpressionUUID->"b3c1909a-b1d7-4a0f-8b65-\
91a34df053ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetConjugatedSystems", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"atoms", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bonds", "=", 
         RowBox[{"ChemGet", "[", 
          RowBox[{"atoms", ",", "\"\<Bonds\>\""}], "]"}]}], "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"types", "=", "\n", "\t\t\t\t", 
           RowBox[{"AssociationThread", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"DeleteDuplicates", "@", 
              RowBox[{"Flatten", "@", "bonds"}]}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"ChemGet", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicates", "@", 
                RowBox[{"Flatten", "@", "bonds"}]}], ",", "\"\<Type\>\""}], 
              "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t", "\t\t\t\t", 
            RowBox[{"mx", "=", "\n", "\t", "\t", "\t", "\t\t\t", 
             RowBox[{"ReplacePart", "[", "\n", "\t", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"AtomsetAdjacencyMatrix", "[", "obj", "]"}], ",", "\n",
                "\t", "\t", "\t\t\t\t\t", 
               RowBox[{"Join", "@@", 
                RowBox[{"Table", "[", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "Length", "@", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"bonds", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"types", "[", "#", "]"}], ">", "1"}], "&"}]}], 
                    "]"}]}], "\[Equal]", "0"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "0"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "Nothing"}], "\n",
                    "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                  "\t", "\t", "\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "@", "bonds"}]}], "}"}], ",", "\n", 
                  "\t", "\t", "\t", "\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Length", "@", "bonds"}]}], "}"}]}], "\n", "\t", 
                 "\t", "\t", "\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", "\t", 
              "\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"ConnectedComponents", "@", 
               RowBox[{"AdjacencyGraph", "@", "mx"}]}], ",", "\n", "\t", 
              "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "\n", "\t",
              "\t\t\t\t", "]"}], "/.", 
            RowBox[{"i_Integer", "\[RuleDelayed]", 
             RowBox[{"atoms", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}]}], "\n", "\t", "\t\t\t", 
          "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t",
     "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694834310198251*^9, 3.694834646361247*^9}, {
   3.6948347069787817`*^9, 3.694834720216434*^9}, {3.694834760135838*^9, 
   3.6948347630948973`*^9}, {3.6948348002150307`*^9, 3.694834809654275*^9}, {
   3.7000983085230722`*^9, 3.700098351344742*^9}, {3.700098387276335*^9, 
   3.700098475078499*^9}, {3.700098522702997*^9, 3.700098559258727*^9}, {
   3.700168967032387*^9, 3.700168999133706*^9}, 
   3.718335482329276*^9},ExpressionUUID->"a2456fdf-02e9-41b2-9753-\
7f3e2ee556ae"]
}, Closed]],

Cell[CellGroupData[{

Cell["AromaticRings", "CodeSubsubsection",
 CellChangeTimes->{{3.69483485991575*^9, 
  3.6948348634825687`*^9}},ExpressionUUID->"e5a011b5-82f9-4f4c-9378-\
f2ed62015a6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAromaticRings", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"rs", "=", 
        RowBox[{"AtomsetRings", "[", "obj", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"cs", "=", 
        RowBox[{"AtomsetConjugatedSystems", "[", "obj", "]"}]}]}], "\n", 
      "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Select", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Intersection", "[", 
        RowBox[{"rs", ",", "cs"}], "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", "=", "\n", "\t\t\t\t", 
            RowBox[{"2", "*", 
             RowBox[{"Total", "[", "\n", "\t\t\t\t\t", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ChemGet", "[", 
                 RowBox[{
                  RowBox[{"DeleteDuplicates", "@", "\n", "\t\t\t\t\t\t", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"ChemGet", "[", 
                    RowBox[{"#", ",", "\"\<Bonds\>\""}], "]"}], "]"}]}], ",", 
                  "\"\<Type\>\""}], "]"}], "-", "1"}], ")"}], "\n", 
              "\t\t\t\t\t", "]"}]}]}], "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"t", ",", "4"}], "]"}], "\[Equal]", "2"}]}], "\n", 
         "\t\t\t\t", "]"}], "&"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694834878288721*^9, 3.6948349606231327`*^9}, {
   3.694835009997477*^9, 3.6948350216111107`*^9}, {3.694835068803564*^9, 
   3.694835162155349*^9}, {3.694835218979381*^9, 3.694835220324306*^9}, 
   3.6948353079444313`*^9, {3.694835362642123*^9, 3.694835378600299*^9}, {
   3.700099867766466*^9, 3.7000999210351887`*^9}, 
   3.718335482338604*^9},ExpressionUUID->"4958f7ae-5716-4239-bfaf-\
4dbb258c7550"]
}, Closed]],

Cell[CellGroupData[{

Cell["AtomMemberQ", "CodeSubsubsection",
 CellChangeTimes->{{3.694870908019608*^9, 3.694870908899991*^9}, {
  3.694874185342161*^9, 
  3.69487418906022*^9}},ExpressionUUID->"02f3ca5f-7acc-4426-b8d9-\
3110160dc396"],

Cell[BoxData[
 RowBox[{"AtomsetAtomMemberQ", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.7102660229798717`*^9, 3.710266023732115*^9}, 
   3.7102682465430193`*^9},ExpressionUUID->"46db9e01-79f6-4c35-9703-\
b39803cec712"],

Cell[CellGroupData[{

Cell["Chiral", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6948743057465553`*^9, 3.694874307024207*^9}, {
  3.694874374254669*^9, 3.694874375212624*^9}, {3.694874417105776*^9, 
  3.6948744178806343`*^9}},ExpressionUUID->"9a3b0d58-5ca9-450c-8362-\
92f7c45f6d7f"],

Cell["No implementation", "Text",
 CellChangeTimes->{{3.69487437690867*^9, 
  3.694874381132448*^9}},ExpressionUUID->"6ae99b55-f0b8-4761-9fab-\
eb354641ec98"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ring", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6948743057465553`*^9, 3.694874319871862*^9}, {
  3.6948744404729433`*^9, 
  3.69487444082405*^9}},ExpressionUUID->"46d7a22a-7677-4d5f-b4ec-\
6d2488ca63c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", "ChemObjVectorPattern"}], ",", "\"\<Ring\>\""}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rings", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"AtomsetRings", "[", "obj", "]"}]}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"rings", ",", "#"}], "]"}], "&"}], "/@", "ov"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"{", "b_", "}"}], "\[RuleDelayed]", "b"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694870915678042*^9, 3.694871042009417*^9}, {
   3.694871080921522*^9, 3.694871104408328*^9}, {3.6948711516649313`*^9, 
   3.69487121623423*^9}, {3.694871249146365*^9, 3.6948714517045813`*^9}, {
   3.694871894136182*^9, 3.694871911709198*^9}, {3.694871950517249*^9, 
   3.694872035815366*^9}, {3.694872283853692*^9, 3.694872696388031*^9}, {
   3.69487274774223*^9, 3.694872998289287*^9}, {3.694873035693866*^9, 
   3.6948731137074957`*^9}, {3.694873228050583*^9, 3.694873257953195*^9}, {
   3.694873302669899*^9, 3.694873336433783*^9}, {3.6948737442370443`*^9, 
   3.694873764998835*^9}, {3.694873866578179*^9, 3.6948739788898487`*^9}, {
   3.694874086927443*^9, 3.694874086958789*^9}, {3.6948741668512077`*^9, 
   3.694874175999888*^9}, {3.694874476355689*^9, 3.69487448045872*^9}, {
   3.7001035903740273`*^9, 3.70010361904375*^9}, {3.700103701445178*^9, 
   3.700103763498187*^9}, 3.700104522984275*^9, {3.718335482348876*^9, 
   3.718335506403645*^9}},ExpressionUUID->"6e357c4a-b903-450c-9510-\
114b97fa82ec"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConjugatedSystem", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6948743057465553`*^9, 3.694874319871862*^9}, {
  3.6948744404729433`*^9, 3.69487444082405*^9}, {3.69487448632209*^9, 
  3.694874492057314*^9}},ExpressionUUID->"842e6566-ba07-4930-9a22-\
1e1621640317"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", "ChemObjVectorPattern"}], ",", 
     "\"\<ConjugatedSystem\>\""}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rings", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"AtomsetConjugatedSystems", "[", "obj", "]"}]}]}], "}"}], ",",
      "\n", "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"rings", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"{", "ov", "}"}]}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", "b_", "}"}], "\[RuleDelayed]", "b"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694870915678042*^9, 3.694871042009417*^9}, {
   3.694871080921522*^9, 3.694871104408328*^9}, {3.6948711516649313`*^9, 
   3.69487121623423*^9}, {3.694871249146365*^9, 3.6948714517045813`*^9}, {
   3.694871894136182*^9, 3.694871911709198*^9}, {3.694871950517249*^9, 
   3.694872035815366*^9}, {3.694872283853692*^9, 3.694872696388031*^9}, {
   3.69487274774223*^9, 3.694872998289287*^9}, {3.694873035693866*^9, 
   3.6948731137074957`*^9}, {3.694873228050583*^9, 3.694873257953195*^9}, {
   3.694873302669899*^9, 3.694873336433783*^9}, {3.6948737442370443`*^9, 
   3.694873764998835*^9}, {3.694873866578179*^9, 3.6948739788898487`*^9}, {
   3.694874086927443*^9, 3.694874086958789*^9}, {3.6948741668512077`*^9, 
   3.694874175999888*^9}, {3.694874476355689*^9, 3.694874501359386*^9}, {
   3.700104231077572*^9, 3.70010426076363*^9}, 3.7001045280251493`*^9, {
   3.718335482357209*^9, 
   3.718335506410638*^9}},ExpressionUUID->"614b6ecf-44ae-42c3-b4a2-\
241d109d6a92"]
}, Closed]],

Cell[CellGroupData[{

Cell["AromaticRing", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6948743057465553`*^9, 3.694874319871862*^9}, 
   3.694874674072687*^9},ExpressionUUID->"2d29332d-82c9-4afe-9504-\
b9b7cf684418"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", "ChemObjVectorPattern"}], ",", 
     "\"\<AromaticRing\>\""}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rings", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"AtomsetAromaticRings", "[", "obj", "]"}]}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"rings", ",", "#"}], "]"}], "&"}], "/@", "ov"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"{", "b_", "}"}], "\[RuleDelayed]", "b"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694870915678042*^9, 3.694871042009417*^9}, {
   3.694871080921522*^9, 3.694871104408328*^9}, {3.6948711516649313`*^9, 
   3.69487121623423*^9}, {3.694871249146365*^9, 3.6948714517045813`*^9}, {
   3.694871894136182*^9, 3.694871911709198*^9}, {3.694871950517249*^9, 
   3.694872035815366*^9}, {3.694872283853692*^9, 3.694872696388031*^9}, {
   3.69487274774223*^9, 3.694872998289287*^9}, {3.694873035693866*^9, 
   3.6948731137074957`*^9}, {3.694873228050583*^9, 3.694873257953195*^9}, {
   3.694873302669899*^9, 3.694873336433783*^9}, {3.6948737442370443`*^9, 
   3.694873764998835*^9}, {3.694873866578179*^9, 3.6948739788898487`*^9}, {
   3.694874086927443*^9, 3.694874086958789*^9}, {3.6948741668512077`*^9, 
   3.694874175999888*^9}, 3.694874676479487*^9, {3.7001042794927273`*^9, 
   3.700104305032816*^9}, 3.700104535383644*^9, {3.718335482366701*^9, 
   3.718335506419876*^9}},ExpressionUUID->"f2014cd2-8970-409d-bdb6-\
c27c02862bf8"]
}, Closed]],

Cell[CellGroupData[{

Cell["BaseQ", "CodeSubsubsubsection",
 CellChangeTimes->{{3.710262387229122*^9, 3.710262402418784*^9}, {
  3.7102659052750883`*^9, 3.710265905637639*^9}, {3.710269425556121*^9, 
  3.710269427633078*^9}},ExpressionUUID->"d0148b81-dd1a-47f4-89d5-\
bb055c85d295"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"atomsetAtomMatchQPattern", "=", "\n", "\t", 
   RowBox[{"_String", "|", 
    RowBox[{
     RowBox[{"Verbatim", "[", "Blank", "]"}], "[", "]"}], "|", "\n", "\t\t", 
    "_PatternTest", "|", "_Alternatives"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"atomsetTypeMatchQPattern", "=", "\n", "\t", 
   RowBox[{"_Integer", "|", 
    RowBox[{
     RowBox[{"Verbatim", "[", "Blank", "]"}], "[", "]"}], "|", "_PatternTest",
     "|", "\n", "\t\t", "_PatternTest", "|", "_Alternatives"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7102741965691757`*^9, 3.7102742187362556`*^9}, {
  3.710274264471479*^9, 
  3.710274270253684*^9}},ExpressionUUID->"40605bd2-6dbd-48d8-939e-\
ff1aac2e3ce8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", "ChemObjVectorPattern"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"el", ":", "atomsetAtomMatchQPattern"}], ",", "\n", "\t\t", 
        RowBox[{"pat", ":", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"(", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"(", "\n", "\t\t\t\t\t\t", 
              RowBox[{
              "atomsetAtomMatchQPattern", "\[Rule]", "\n", "\t\t\t\t\t\t\t", 
               "atomsetTypeMatchQPattern"}], "\n", "\t", "\t\t\t\t\t", ")"}], 
             "|", "\n", "\t", "\t\t\t\t", 
             RowBox[{"(", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
              "atomsetAtomMatchQPattern", "|", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Verbatim", "[", "BlankSequence", "]"}], "[", "]"}], 
               "|", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Verbatim", "[", "BlankNullSequence", "]"}], "[", 
                "]"}], "|", "\n", "\t", "\t\t\t\t\t", "_Repeated"}], "\n", 
              "\t\t\t\t\t\t", ")"}]}], "\n", "\t\t\t\t\t", ")"}], ".."}], 
          "\n", "\t\t\t", "}"}]}]}], "]"}], "\[Rule]", 
      RowBox[{"(", "\n", "\t\t\t", 
       RowBox[{"inclusionMode", ":", 
        RowBox[{
        "Center", "|", "Outer", "|", "String", "|", "All", "|", 
         "atomsetAtomMatchQPattern"}], ":", "All"}], "\n", "\t\t", ")"}]}]}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"atoms", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t", 
       "elements", ",", "\n", "\t\t", 
       RowBox[{"bondsIndexed", "=", 
        RowBox[{"AtomsetBondsIndexed", "[", "obj", "]"}]}], ",", "\n", "\t\t",
        "nbrs", ",", "inds", ",", "\n", "\t\t", 
       RowBox[{"bpat", "=", "\n", "\t\t\t", 
        RowBox[{"Sort", "@", "\n", "\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"pat", ",", 
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"k", ":", "atomsetAtomMatchQPattern"}], ":>", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"k", ",", "_"}], "}"}]}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Verbatim", "[", "Repeated", "]"}], "[", 
               RowBox[{
                RowBox[{"k_", "\[Rule]", "v_"}], ",", "spec___"}], "]"}], ":>",
               "\n", "\t\t\t\t\t\t", 
              RowBox[{"Repeated", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"k", ",", "v"}], "}"}], ",", "spec"}], "]"}]}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"k_", "\[Rule]", "v_"}], ")"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"k", ",", "v"}], "}"}]}]}], "\n", "\t\t\t\t\t", "}"}], 
           ",", "\n", "\t\t\t\t\t", "1"}], "]"}]}]}], ",", "\n", "\t\t", 
       RowBox[{"elpat", "=", 
        RowBox[{"Alternatives", "@@", 
         RowBox[{"Replace", "[", 
          RowBox[{"pat", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k_", "\[Rule]", "_"}], ")"}], "\[RuleDelayed]", "k"}], 
           ",", "2"}], "]"}]}]}], ",", "\n", "\t\t", "outerPat", ",", "\n", 
       "\t\t", "corePat", ",", "\n", "\t\t", "coreElQ", ",", "\n", "\t\t", 
       "conElQ"}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"corePat", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"inclusionMode", ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Center", "|", "All"}], "->", "el"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"String", ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{"el", ",", 
                RowBox[{"_String", "|", 
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Alternatives", "]"}], "[", 
                  "__String", "]"}]}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
              "el", ",", "\n", "\t\t\t\t\t\t", "None"}], "\n", "\t\t\t\t\t\t",
              "]"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Outer", "\[Rule]", "None"}]}], "\n", "\t\t\t\t", "}"}]}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"outerPat", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"inclusionMode", ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Center", "->", "None"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"String", ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"elpat", ",", 
              RowBox[{"Except", "[", "_String", "]"}]}], "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"Outer", "|", "All"}], ":>", "\n", "\t\t\t\t\t", 
            "elpat"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"elements", "=", "\n", "\t\t\t", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"atoms", ",", "\"\<Element\>\""}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"nbrs", "=", "\n", "\t\t\t", 
       RowBox[{"Association", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Normal", "@", 
          RowBox[{"AtomsetNeighborMap", "@", "obj"}]}], "/.", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"c_ChemObject", "\[RuleDelayed]", 
          RowBox[{"First", "@", 
           RowBox[{"FirstPosition", "[", 
            RowBox[{"atoms", ",", "c"}], "]"}]}]}]}], "\n", "\t\t\t\t", 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"inds", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"FirstPosition", "[", 
           RowBox[{"atoms", ",", "#"}], "]"}]}], "&"}], "/@", "ov"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"coreElQ", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", "=", "#"}], "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], ">", "2"}], "&&", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"(", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"pat", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Verbatim", "[", "BlankSequence", "]"}], "[", 
                    "]"}], "|", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Verbatim", "[", "BlankNullSequence", "]"}], "[", 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}], "||", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Length", "@", "#"}], "\[Equal]", 
                 RowBox[{"Length", "@", "pat"}]}]}], "\n", "\t\t\t\t\t\t", 
               ")"}], "&&", "\n", "\t\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"oinds", "=", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"Select", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"elements", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "elpat"}], "]"}], 
                    "&"}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}], "}"}], ",", 
                "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"MatchQ", "[", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{"bondsIndexed", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"a", ":", 
                    RowBox[{"Alternatives", "@@", "oinds"}]}], ",", "t_"}], 
                    "}"}], "|", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", ":", 
                    RowBox[{"Alternatives", "@@", "oinds"}]}], ",", "i", ",", 
                    "t_"}], "}"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    ")"}], "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"elements", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], ",", "t"}], "}"}]}]}], 
                   "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{"OrderlessPatternSequence", "@@", "bpat"}], 
                   "}"}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", ")"}], "&"}], 
           "@", 
           RowBox[{"nbrs", "[", "i", "]"}]}]}], "\n", "\t\t\t\t", "]"}], 
        "&"}]}], ";", "\n", "\t\t", 
      RowBox[{"conElQ", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", "=", "#"}], "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"nbrs", "[", "i", "]"}], "]"}], "\[GreaterEqual]", "1"}],
            "&&", "\n", "\t", "\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"cinds", "=", "\n", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"nbrs", "[", "i", "]"}], ",", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"elements", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", "el"}], "]"}], 
                  "&"}]}], "]"}]}], "\n", "\t", "\t", "\t\t\t\t", "}"}], ",", 
             "\n", "\t", "\t", "\t\t\t\t", 
             RowBox[{"AnyTrue", "[", 
              RowBox[{"cinds", ",", "coreElQ"}], "]"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], "&"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"Table", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"elements", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t\t\t", "corePat", 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"coreElQ", "@", "i"}], "||", "\n", "\t\t\t\t\t", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"elements", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "outerPat"}], "]"}], "&&", 
             RowBox[{"conElQ", "@", "i"}]}], ")"}]}], ",", "\n", "\t\t\t\t", 
          "outerPat", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"conElQ", "@", "i"}], ",", "\n", "\t\t\t\t", "_", ",", "\n",
           "\t\t\t\t\t", "False"}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"i", ",", "inds"}], "}"}]}], "\n", "\t\t\t", "]"}]}]}], "\n",
     "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.710262405695074*^9, 3.710262601984562*^9}, {
   3.710263182445623*^9, 3.710263184501707*^9}, {3.710263396303565*^9, 
   3.7102634179512*^9}, 3.710263750722723*^9, {3.710263808881455*^9, 
   3.710263809894649*^9}, {3.710263885163183*^9, 3.7102640275583067`*^9}, {
   3.710264073197678*^9, 3.710264082355783*^9}, {3.710264113619499*^9, 
   3.710264115907311*^9}, {3.710264971535331*^9, 3.7102649920569983`*^9}, {
   3.710265102863317*^9, 3.710265103757098*^9}, {3.7102651922736053`*^9, 
   3.710265231971187*^9}, {3.7102655674769373`*^9, 3.710265576121389*^9}, {
   3.7102659587359962`*^9, 3.710265994434307*^9}, {3.7102660834549837`*^9, 
   3.710266305628414*^9}, {3.710266375555818*^9, 3.71026639607148*^9}, {
   3.710266428509954*^9, 3.710266471753139*^9}, {3.710266506584293*^9, 
   3.710266518906542*^9}, {3.710266880687622*^9, 3.71026688158053*^9}, {
   3.7102669267223043`*^9, 3.710267038451026*^9}, {3.710267073293215*^9, 
   3.710267207678761*^9}, {3.710267254048449*^9, 3.710267267113441*^9}, {
   3.710267298974387*^9, 3.710267454185718*^9}, {3.7102681984053392`*^9, 
   3.710268206908121*^9}, {3.7102687331330643`*^9, 3.710268841592401*^9}, {
   3.710269103902483*^9, 3.710269137232966*^9}, {3.71026949495438*^9, 
   3.710269627451428*^9}, {3.710269683818145*^9, 3.710269719282042*^9}, {
   3.7102697535570383`*^9, 3.710269760329926*^9}, {3.7102699235403013`*^9, 
   3.710269966562392*^9}, {3.710273853557639*^9, 3.710273854619288*^9}, {
   3.7102739088126163`*^9, 3.710273912082312*^9}, {3.710273979995216*^9, 
   3.710274019101144*^9}, {3.710274132145426*^9, 3.7102741513179817`*^9}, {
   3.710274186538692*^9, 3.7102741892415733`*^9}, {3.710274263452771*^9, 
   3.71027434213198*^9}, {3.710274372922179*^9, 3.710274511851942*^9}, {
   3.710274611289474*^9, 3.710274632397547*^9}, {3.710275687193364*^9, 
   3.7102757364782763`*^9}, {3.7102757887402687`*^9, 3.710275802068183*^9}, {
   3.710275900172577*^9, 3.710275931912951*^9}, 3.7102766038501463`*^9, {
   3.710276657680785*^9, 3.710276721743897*^9}, {3.710276811569149*^9, 
   3.7102768978442307`*^9}, {3.7102769389502287`*^9, 
   3.7102770559383307`*^9}, {3.710277107434985*^9, 3.710277148194936*^9}, {
   3.710277183415392*^9, 3.7102771897431803`*^9}, {3.710277219769063*^9, 
   3.710277509013796*^9}, {3.710277584383232*^9, 3.7102776017299128`*^9}, {
   3.710278536652711*^9, 3.7102785415052633`*^9}, {3.710278618100562*^9, 
   3.710278677217737*^9}, {3.7183354823905067`*^9, 
   3.7183355064317303`*^9}},ExpressionUUID->"ecc66969-9e06-47a1-bf39-\
0d3f5fe7a1af"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MatchPatterns", "CodeSubsubsubsection",
 CellChangeTimes->{{3.710277901699006*^9, 
  3.710277917353333*^9}},ExpressionUUID->"d9b71382-203b-4e06-9919-\
82e024125b43"],

Cell[BoxData[
 RowBox[{"atomsetAtomMemberQMatchPats", "=", "\n", "\t", 
  RowBox[{"<|", "\n", "\t\t", 
   RowBox[{
    RowBox[{"\"\<Carboxyl\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<C\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t\t\t\t", 
         "_"}], "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<Sulfate\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<S\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "1"}]}], "\n", "\t\t\t\t\t", "}"}]}],
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"\"\<Phosphate\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<P\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "1"}]}], "\n", "\t\t\t\t\t", "}"}]}],
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"\"\<Sulfone\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<S\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t", "\t\t\t\t", 
         "_", ",", "\n", "\t\t\t\t\t", "_"}], "\n", "\t\t\t\t\t", "}"}]}], 
      "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"\"\<Nitro\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<N\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<O\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t", "\t\t\t\t", 
         "_"}], "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<Amide\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<C\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<N\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<O\>\"", "\[Rule]", "2"}], ",", "\n", "\t\t\t\t\t", 
         "_"}], "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<Methyl\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<C\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<H\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"\"\<H\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<H\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         "_"}], "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<Methylene\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<C\>\"", ",", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<H\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"\"\<H\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t\t\t", 
         "_", ",", "\n", "\t\t\t\t\t", "_"}], "\n", "\t\t\t\t\t", "}"}]}], 
      "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "|>"}]}]], "CodeInput",
 CellChangeTimes->{{3.710277922119667*^9, 3.710278117480688*^9}, {
  3.7102782770308523`*^9, 3.7102782869819117`*^9}, {3.7102783386682796`*^9, 
  3.710278376666897*^9}},ExpressionUUID->"59e9f5d2-a622-4624-81bc-\
617b1d9387d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cases", "CodeSubsubsubsection",
 CellChangeTimes->{{3.710262089761681*^9, 3.710262097943658*^9}, {
  3.710278523549197*^9, 
  3.7102785266769753`*^9}},ExpressionUUID->"ef31ad6c-a08a-454a-af5b-\
05bb62fb5172"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", "ChemObjVectorPattern"}], ",", "\n", "\t", 
     RowBox[{"m_String", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{"atomsetAtomMemberQMatchPats", ",", "#"}], "]"}], "&"}], 
       ")"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AtomsetAtomMemberQ", "[", "\n", "\t\t", 
    RowBox[{"obj", ",", "ov", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"atomsetAtomMemberQMatchPats", "[", "m", "]"}], "\[Rule]", 
      "String"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", "ChemObjVectorPattern"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"m_String", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"atomsetAtomMemberQMatchPats", ",", "#"}], "]"}], "&"}], 
        ")"}]}], "\[Rule]", "sel_"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AtomsetAtomMemberQ", "[", "\n", "\t\t", 
    RowBox[{"obj", ",", "ov", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"atomsetAtomMemberQMatchPats", "[", "m", "]"}], "\[Rule]", 
      "sel"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694870915678042*^9, 3.694871042009417*^9}, {
   3.694871080921522*^9, 3.694871104408328*^9}, {3.6948711516649313`*^9, 
   3.69487121623423*^9}, {3.694871249146365*^9, 3.6948714517045813`*^9}, {
   3.694871894136182*^9, 3.694871911709198*^9}, {3.694871950517249*^9, 
   3.694872035815366*^9}, {3.694872283853692*^9, 3.694872696388031*^9}, {
   3.69487274774223*^9, 3.694872998289287*^9}, {3.694873035693866*^9, 
   3.6948731137074957`*^9}, {3.694873228050583*^9, 3.694873257953195*^9}, {
   3.694873302669899*^9, 3.694873336433783*^9}, {3.6948737442370443`*^9, 
   3.694873764998835*^9}, {3.694873866578179*^9, 3.6948739788898487`*^9}, {
   3.694874086927443*^9, 3.694874086958789*^9}, {3.6948741668512077`*^9, 
   3.694874167623558*^9}, {3.694874332376234*^9, 3.694874334168149*^9}, {
   3.694874632135141*^9, 3.694874661278507*^9}, 3.6948747789694138`*^9, {
   3.7001045630864077`*^9, 3.7001045870970287`*^9}, {3.710262137009983*^9, 
   3.710262275088345*^9}, {3.710262349257704*^9, 3.71026236279956*^9}, {
   3.7102653965737143`*^9, 3.710265407314237*^9}, 3.710268246508184*^9, {
   3.710276453260202*^9, 3.710276454153693*^9}, 3.710276755758778*^9, 
   3.710277084535367*^9, 3.7102775247256823`*^9, {3.71027764727693*^9, 
   3.71027771913183*^9}, {3.7102784765768423`*^9, 3.71027851951798*^9}, {
   3.7183354824021893`*^9, 
   3.7183355064439096`*^9}},ExpressionUUID->"076fb123-bb9e-4f55-828f-\
b531ad0a6cd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6948743057465553`*^9, 
  3.694874331056037*^9}},ExpressionUUID->"8313d333-994b-4dd2-b327-\
1fa2aa30d5ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "type_String"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{"obj", ",", 
     RowBox[{"ChemGet", "[", 
      RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "type"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", 
      RowBox[{"ChemObjPattern", ".."}]}], ",", "type_String"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{"obj", ",", 
     RowBox[{"{", "ov", "}"}], ",", "type"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694870915678042*^9, 3.694871042009417*^9}, {
  3.694871080921522*^9, 3.694871104408328*^9}, {3.6948711516649313`*^9, 
  3.69487121623423*^9}, {3.694871249146365*^9, 3.6948714517045813`*^9}, {
  3.694871894136182*^9, 3.694871911709198*^9}, {3.694871950517249*^9, 
  3.694872035815366*^9}, {3.694872283853692*^9, 3.694872696388031*^9}, {
  3.69487274774223*^9, 3.694872998289287*^9}, {3.694873035693866*^9, 
  3.6948731137074957`*^9}, {3.694873228050583*^9, 3.694873257953195*^9}, {
  3.694873302669899*^9, 3.694873336433783*^9}, {3.694874086971272*^9, 
  3.694874087018683*^9}, {3.694874134564027*^9, 3.6948741488880043`*^9}, {
  3.6948746821108007`*^9, 3.694874682603318*^9}, {3.7001047394729147`*^9, 
  3.700104790492235*^9}, {3.7183354824184732`*^9, 
  3.718335482427576*^9}},ExpressionUUID->"54dc39e6-f440-4ff2-a60f-\
ab0183d68deb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"`Package`PackageAddAutocompletions", "[", "\n", "\t", 
    RowBox[{"\"\<AtomsetAtomMemberQ\>\"", ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"\"\<0\>\"", ",", "#", ",", "#"}], "}"}]}], "\n", "\t", "]"}], 
   "&"}], "@", "\n", "\t\t", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"First", "/@", 
     RowBox[{"DownValues", "[", "AtomsetAtomMemberQ", "]"}]}], ",", "\n", 
    "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", "\n", "\t\t\t\t", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"AtomsetAtomMemberQ", "[", 
        RowBox[{"_", ",", "_", ",", "s_String"}], "]"}], "]"}], "\n", 
      "\t\t\t\t", "]"}], "\[RuleDelayed]", "s"}]}], "\n", "\t\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7102656814464817`*^9, 3.710265742453031*^9}, {
  3.710265792418083*^9, 3.71026579729499*^9}, {3.710265835520217*^9, 
  3.710265840379484*^9}},ExpressionUUID->"0bfffc99-a232-44b3-8dba-\
1a508d3971ad"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["AromaticQ", "CodeSubsubsection",
 CellChangeTimes->{{3.6948656632939863`*^9, 
  3.694865665676298*^9}},ExpressionUUID->"f5407983-9753-4c29-9bc0-\
f18334805e7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAromaticQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ov", ":", "ChemObjVectorPattern"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{"obj", ",", "ov", ",", "\"\<AromaticRing\>\""}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAromaticQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ob", ":", "ChemObjPattern"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"First", "@", 
    RowBox[{"AtomsetAtomMemberQ", "[", 
     RowBox[{"obj", ",", 
      RowBox[{"{", "ob", "}"}], ",", "\"\<AromaticRing\>\""}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAromaticQ", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ob", ":", 
      RowBox[{"ChemObjPattern", ".."}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AtomsetAtomMemberQ", "[", 
    RowBox[{"obj", ",", 
     RowBox[{"{", "ob", "}"}], ",", "\"\<AromaticRing\>\""}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694865681033945*^9, 3.694865736650436*^9}, {
   3.69486647890641*^9, 3.6948664793091173`*^9}, {3.694867084371655*^9, 
   3.694867135190877*^9}, 3.6948671756830482`*^9, {3.6948672298843317`*^9, 
   3.694867321345531*^9}, {3.694871120135832*^9, 3.6948711686158743`*^9}, 
   3.6948740870474577`*^9, {3.69487467013545*^9, 3.694874671899768*^9}, {
   3.7000186720179253`*^9, 3.7000186752787333`*^9}, {3.70010481865759*^9, 
   3.700104875333449*^9}, {3.7001049222259607`*^9, 3.700104931160255*^9}, {
   3.7183354824360037`*^9, 
   3.718335506451263*^9}},ExpressionUUID->"924afba8-4e86-4bca-80ee-\
fb1241fefc1b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Point-Wise Properties\[RightFloor]", \
"CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870764991522*^9, 3.694870769727844*^9}, {
  3.694870805950357*^9, 
  3.694870823917905*^9}},ExpressionUUID->"d587ad9d-656a-4f25-8fa0-\
c26a348098f7"],

Cell[CellGroupData[{

Cell["MassPositions", "CodeSubsubsection",
 CellChangeTimes->{{3.692478111208769*^9, 3.692478145541024*^9}, {
  3.6924782391677933`*^9, 
  3.692478272712327*^9}},ExpressionUUID->"09af3949-ca28-4302-921e-\
c6484f0a425f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMassPositions", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"ChemGet", "[", 
           RowBox[{"a", ",", "\"\<Mass\>\""}], "]"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Quantity", "[", 
              RowBox[{"m_", ",", "\"\<AtomicMassUnit\>\""}], "]"}], 
             "\[RuleDelayed]", "m"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"q_Quantity", "\[RuleDelayed]", 
             RowBox[{"QuantityMagnitude", "@", 
              RowBox[{"UnitConvert", "[", 
               RowBox[{"q", ",", "\"\<AtomicMassUnit\>\""}], "]"}]}]}]}], 
           "\n", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", "1"}], "]"}], ",", 
        "\n", "\t\t\t", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"a", ",", "\"\<Position\>\""}], "]"}]}], "\n", "\t\t", 
       "}"}]}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692478158777026*^9, 3.692478199944943*^9}, 
   3.6924782460129557`*^9, {3.6924782811747637`*^9, 3.6924783217286253`*^9}, {
   3.692478417362404*^9, 3.692478432716021*^9}, {3.692496985907774*^9, 
   3.69249700369974*^9}, {3.7001049427057323`*^9, 3.7001050729975863`*^9}, 
   3.718335482464059*^9},ExpressionUUID->"788f8615-1cf7-4b3a-b718-\
169033503036"]
}, Closed]],

Cell[CellGroupData[{

Cell["Center", "CodeSubsubsection",
 CellChangeTimes->{{3.692492406713731*^9, 3.692492423799844*^9}, 
   3.694523887907827*^9},ExpressionUUID->"ff8e8983-ddae-4067-8a28-\
58fb58dd7f5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetCenter", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Mean", "@", 
    RowBox[{"ChemGet", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"ChemGet", "[", 
       RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "\n", "\t\t", 
      "\"\<Position\>\""}], "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69249241305317*^9, 3.6924924411105747`*^9}, {
   3.692492760399846*^9, 3.6924927733791857`*^9}, {3.692568664950095*^9, 
   3.692568667140551*^9}, {3.70010508684704*^9, 3.7001051146038427`*^9}, {
   3.700105191906446*^9, 3.700105193840178*^9}, 
   3.71833548247213*^9},ExpressionUUID->"096ead0a-4bbf-453c-add3-805c88646507"]
}, Closed]],

Cell[CellGroupData[{

Cell["CenterOfMass", "CodeSubsubsection",
 CellChangeTimes->{3.692478154413765*^9, 
  3.694523891274024*^9},ExpressionUUID->"24fd2f96-d862-4d13-895b-\
2f0cf0e78087"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetCenterOfMass", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"WeightedData", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"ChemGet", "[", 
         RowBox[{"a", ",", "\"\<Position\>\""}], "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"a", ",", "\"\<Mass\>\""}], "]"}]}], "\n", "\t\t\t", "]"}], "//",
       "Mean"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692478449026026*^9, 3.6924784939163647`*^9}, {
   3.69249853623857*^9, 3.692498661052203*^9}, {3.7001051213153343`*^9, 
   3.7001051815994997`*^9}, 3.700112491398279*^9, 
   3.718335482481284*^9},ExpressionUUID->"63ea8e2b-699f-473d-9f27-\
3fe9100d3fd2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Move", "CodeSubsubsection",
 CellChangeTimes->{{3.6924753926510878`*^9, 
  3.6924753930910883`*^9}},ExpressionUUID->"4f9412aa-eee0-4d94-9851-\
fd43e5aac8b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMove", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<Set\>\"", "|", "\"\<Add\>\""}], ":", "\"\<Add\>\""}]}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"inc", "=", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mode", "===", "\"\<Set\>\""}], ",", "\n", "\t", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
          RowBox[{"AtomsetCenterOfMass", "@", "obj"}]}], ",", "\n", "\t\t\t", 
         
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "\n", "\t\t\t", "]"}]}],
       "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"AtomMove", "[", 
      RowBox[{
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "inc", ",", 
       "\"\<Add\>\""}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69228993519167*^9, 3.692289945502901*^9}, {
   3.692290011806403*^9, 3.692290040069462*^9}, 3.692290238044381*^9, {
   3.692290361977475*^9, 3.692290362835683*^9}, {3.69229040061677*^9, 
   3.692290485899002*^9}, {3.6922906559199266`*^9, 3.692290754301355*^9}, {
   3.692477559012205*^9, 3.69247765638862*^9}, {3.692477945317058*^9, 
   3.692477945780587*^9}, {3.692478016729031*^9, 3.6924780216156273`*^9}, {
   3.6924911157174788`*^9, 3.692491116602069*^9}, {3.7001052836001787`*^9, 
   3.700105396021398*^9}, {3.700105517931243*^9, 3.700105610044321*^9}, 
   3.710193533679793*^9, 
   3.7183354824945793`*^9},ExpressionUUID->"259c751c-85f4-47f1-a485-\
088d208226a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetMove", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"at", ":", 
       RowBox[{"ChemObjPattern", "?", 
        RowBox[{"(", 
         RowBox[{"ChemInstanceQ", "[", "\"\<Atom\>\"", "]"}], ")"}]}]}], "->", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"Optional", "[", 
      RowBox[{"\"\<Set\>\"", ",", "\"\<Set\>\""}], "]"}]}], "\n", "\t", "]"}],
    ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"inc", "=", "\n", "\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"at", ",", "\"\<Position\>\""}], "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"AtomMove", "[", 
      RowBox[{
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "inc", ",", 
       "\"\<Add\>\""}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7101935544278183`*^9, 3.710193597373951*^9}, {
   3.7101936343501263`*^9, 3.710193638374628*^9}, 3.710196938440116*^9, {
   3.710197009923677*^9, 3.710197046530676*^9}, {3.7183354825040894`*^9, 
   3.718335482509162*^9}},ExpressionUUID->"3823454b-201d-4e37-a2d1-\
9e19f3e1bcb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rotate", "CodeSubsubsection",
 CellChangeTimes->{{3.692475394994801*^9, 
  3.6924753956670723`*^9}},ExpressionUUID->"406d960d-84af-47f2-abb7-\
3f2f53f3c9e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRotate", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"theta", ":", 
      RowBox[{"_", "?", "NumericQ"}]}], ",", "\n", "\t", 
     RowBox[{"axis", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}], "|", "\"\<A\>\"", "|", 
       "\"\<B\>\"", "|", "\"\<C\>\""}], ":", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"point", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], "|", "_String", "|", 
        "_Plus"}], ")"}], ":", "\"\<CenterOfMass\>\""}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"rpoint", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"point", ",", 
          RowBox[{"{", "\n", "\t", "\t\t\t", 
           RowBox[{
            RowBox[{
            "\"\<Center\>\"", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
             RowBox[{"AtomsetCenter", "[", "obj", "]"}]}], ",", "\n", "\t", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n_", "+", "\"\<Center\>\""}], ")"}], ":>", "\n", "\t", 
             "\t\t\t\t", 
             RowBox[{"n", "+", 
              RowBox[{"AtomsetCenter", "[", "obj", "]"}]}]}], ",", "\n", "\t",
             "\t\t\t", 
            RowBox[{
             RowBox[{"\"\<CenterOfMass\>\"", "|", "\"\<COM\>\""}], 
             "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
             RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}], ",", "\n", 
            "\t", "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"n_", "+", "\"\<CenterOfMass\>\""}], "|", 
               "\"\<COM\>\""}], ")"}], ":>", "\n", "\t", "\t\t\t\t", 
             RowBox[{"n", "+", 
              RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}]}], ",", "\n",
             "\t", "\t\t\t", 
            RowBox[{"_", ":>", "\n", "\t", "\t\t\t\t", 
             RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}]}], "\n", "\t",
            "\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"raxis", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"axis", ",", 
          RowBox[{"{", "\n", "\t", "\t\t\t", 
           RowBox[{
            RowBox[{"\"\<A\>\"", "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"AtomsetPrincipalAxes", "[", "obj", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", "\t\t\t", 
            RowBox[{"\"\<B\>\"", "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"AtomsetPrincipalAxes", "[", "obj", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", "\t\t\t", 
            RowBox[{"\"\<C\>\"", "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"AtomsetPrincipalAxes", "[", "obj", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], 
         "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"AtomRotate", "[", 
      RowBox[{
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "theta", ",", 
       "raxis", ",", "rpoint"}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.692476470468095*^9, 3.692476492774458*^9}, {
   3.692476749236841*^9, 3.692476827745236*^9}, {3.692476860277484*^9, 
   3.692476998069449*^9}, 3.692497936168062*^9, {3.69249798291765*^9, 
   3.692498048651896*^9}, {3.692498125258469*^9, 3.692498127463271*^9}, {
   3.6924981639392033`*^9, 3.6924981640894136`*^9}, 3.69249822046183*^9, 
   3.692498300924008*^9, 3.692498332707138*^9, {3.6924983725335617`*^9, 
   3.692498441022009*^9}, 3.6924984737792892`*^9, 3.692498693327098*^9, {
   3.6925697369643707`*^9, 3.6925698308248463`*^9}, {3.700105802890091*^9, 
   3.70010589269812*^9}, {3.700105960560549*^9, 3.70010611691947*^9}, {
   3.7001062161520433`*^9, 3.700106249540341*^9}, {3.7001124253768387`*^9, 
   3.700112443650032*^9}, {3.7001489839504004`*^9, 3.700148984080168*^9}, 
   3.7008901179645653`*^9, 
   3.718335482521927*^9},ExpressionUUID->"780dab15-3fce-4217-828b-\
f6c9332cefe6"]
}, Closed]],

Cell[CellGroupData[{

Cell["RotationTransform", "CodeSubsubsection",
 CellChangeTimes->{{3.700147987634712*^9, 
  3.7001480043809643`*^9}},ExpressionUUID->"8a409590-9561-481f-8aaa-\
077830e2008e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetRotationTransform", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"theta", ":", 
      RowBox[{"_", "?", "NumericQ"}]}], ",", "\n", "\t", 
     RowBox[{"axis", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}], "|", "\"\<A\>\"", "|", 
       "\"\<B\>\"", "|", "\"\<C\>\""}], ":", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"point", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], "|", "_String", "|", 
        "_Plus"}], ")"}], ":", "\"\<CenterOfMass\>\""}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"rpoint", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"point", ",", 
          RowBox[{"{", "\n", "\t", "\t\t\t", 
           RowBox[{
            RowBox[{
            "\"\<Center\>\"", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
             RowBox[{"AtomsetCenter", "[", "obj", "]"}]}], ",", "\n", "\t", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n_", "+", "\"\<Center\>\""}], ")"}], ":>", "\n", "\t", 
             "\t\t\t\t", 
             RowBox[{"n", "+", 
              RowBox[{"AtomsetCenter", "[", "obj", "]"}]}]}], ",", "\n", "\t",
             "\t\t\t", 
            RowBox[{
             RowBox[{"\"\<CenterOfMass\>\"", "|", "\"\<COM\>\""}], 
             "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
             RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}], ",", "\n", 
            "\t", "\t\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"n_", "+", "\"\<CenterOfMass\>\""}], "|", 
               "\"\<COM\>\""}], ")"}], ":>", "\n", "\t", "\t\t\t\t", 
             RowBox[{"n", "+", 
              RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}]}], ",", "\n",
             "\t", "\t\t\t", 
            RowBox[{"_", ":>", "\n", "\t", "\t\t\t\t", 
             RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}]}], "\n", "\t",
            "\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"raxis", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"axis", ",", 
          RowBox[{"{", "\n", "\t", "\t\t\t", 
           RowBox[{
            RowBox[{"\"\<A\>\"", "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"AtomsetPrincipalAxes", "[", "obj", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", "\t\t\t", 
            RowBox[{"\"\<B\>\"", "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"AtomsetPrincipalAxes", "[", "obj", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", "\t\t\t", 
            RowBox[{"\"\<C\>\"", "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"AtomsetPrincipalAxes", "[", "obj", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], 
         "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"RotationTransform", "[", 
      RowBox[{"theta", ",", "raxis", ",", "rpoint"}], "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.700148005618375*^9, 3.70014804145088*^9}, 
   3.700148854508533*^9, {3.700148974819759*^9, 3.70014898116848*^9}, {
   3.7001490273871107`*^9, 3.700149063526865*^9}, 3.700956705675844*^9, 
   3.7183354825344973`*^9},ExpressionUUID->"80bb7e1a-b9f2-46cc-9459-\
2a8e85aedeb4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Transform", "CodeSubsubsection",
 CellChangeTimes->{{3.699748968467469*^9, 
  3.699748972681919*^9}},ExpressionUUID->"ca0e1ebb-5361-48b3-a08c-\
450d752d77e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetTransform", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"mat", ":", 
      RowBox[{
       RowBox[{"_List", "?", "MatrixQ"}], "|", 
       "_TransformationFunction"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AtomTransform", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ChemGet", "[", 
      RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"mat", ",", "_List"}], "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Dot", "[", 
          RowBox[{"mat", ",", "#"}], "]"}], ")"}], "&"}], ",", "\n", "\t\t\t",
        "mat"}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6997489809174223`*^9, 3.6997490819136887`*^9}, {
   3.699749113974681*^9, 3.699749114678487*^9}, {3.6997493426041718`*^9, 
   3.699749372215438*^9}, {3.700021147605213*^9, 3.700021175741592*^9}, {
   3.700021247126486*^9, 3.7000212986497507`*^9}, {3.7000213337083693`*^9, 
   3.7000213542075*^9}, {3.7001061322782507`*^9, 3.700106154368023*^9}, {
   3.700106209807693*^9, 3.700106213382563*^9}, {3.700106277150769*^9, 
   3.70010629272429*^9}, 
   3.718335482543179*^9},ExpressionUUID->"ff2deb0a-8624-41ba-bde4-\
72b400a7952c"]
}, Closed]],

Cell[CellGroupData[{

Cell["AxisAlign", "CodeSubsubsection",
 CellChangeTimes->{{3.699747779622987*^9, 
  3.699747783132722*^9}},ExpressionUUID->"dab58ad8-7277-4dd9-995a-\
a1422a4d3251"],

Cell["\<\
\[LeftCeiling]Essentially we should take the first axis, rotate it into the \
new one, and then take the second one and rotate it around the first spec in \
to the second\[RightFloor]\
\>", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.727448003157504*^9, 
  3.72744806866199*^9}},ExpressionUUID->"9b191777-47da-4a11-b78b-\
f3be5cec62fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"axisPatternBase", "=", "\n", "\t", 
   RowBox[{"(", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ChemObjPattern", "?", 
      RowBox[{"(", 
       RowBox[{"ChemInstanceQ", "[", "\"\<Bond\>\"", "]"}], ")"}]}], "|", 
     "\n", "\t", "\t", "\"\<Center\>\"", "|", "\"\<CenterOfMass\>\"", "|", 
     "\n", "\t", "\t", "\"\<A\>\"", "|", "\"\<B\>\"", "|", "\"\<C\>\"", "|", 
     "\"\<X\>\"", "|", "\"\<Y\>\"", "|", "\"\<Z\>\"", "|", "\n", "\t", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "\n", "\t\t", ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"axisPattern", "=", 
   RowBox[{"axisPatternBase", "|", 
    RowBox[{"-", "axisPatternBase"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAxisAlignmentTransform", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"a", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"axisPattern", "->", "axisPattern"}], ")"}], "|", "None"}]}], 
     ",", "\n", "\t", 
     RowBox[{"b", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"axisPattern", "->", "axisPattern"}], ")"}], "|", "None"}], 
       ")"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"center", ":", 
      RowBox[{"\"\<Center\>\"", "|", "\"\<CenterOfMass\>\""}], ":", 
      "\"\<CenterOfMass\>\""}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"com", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"center", ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
            "\"\<CenterOfMass\>\"", ":>", "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"AtomsetCenterOfMass", "@", "obj"}]}], ",", "\n", "\t", 
            "\t", "\t\t\t\t", 
            RowBox[{"\"\<Center\>\"", ":>", "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"AtomsetCenter", "@", "obj"}]}]}], "\n", "\t", 
           "\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t", "]"}]}], ",", "\n", 
       "\t", "\t\t", 
       RowBox[{"coords", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{
          RowBox[{"ChemGet", "[", 
           RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", 
          "\"\<Position\>\""}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"abc", "=", 
        RowBox[{
         RowBox[{"AtomsetInertialSystem", "[", "obj", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<AAxis\>\"", ",", "\"\<BAxis\>\"", ",", "\"\<CAxis\>\""}], 
           "}"}], "]"}], "]"}]}]}], "\n", "\t", "\t\t", "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"ChemUtilsAxisAlignmentTransform", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"a", ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ax1_", "\[Rule]", "ax2_"}], ")"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Rule", "@@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Plus", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"com", ",", " ", "0"}], "}"}], ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax1", ",", " ", "ax2"}], "}"}], ",", "\n", "\t", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bond", ":", 
                   RowBox[{"ChemObjPattern", "?", 
                    RowBox[{"(", 
                    RowBox[{"ChemInstanceQ", "[", "\"\<Bond\>\"", "]"}], 
                    ")"}]}]}], ":>", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{"BondVector", "[", "bond", "]"}]}], ",", "\n", "\t",
                  "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"bond", ":", 
                    RowBox[{"ChemObjPattern", "?", 
                    RowBox[{"(", 
                    RowBox[{"ChemInstanceQ", "[", "\"\<Bond\>\"", "]"}], 
                    ")"}]}]}]}], ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"-", 
                   RowBox[{"BondVector", "[", "bond", "]"}]}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"\"\<Center\>\"", "|", "\"\<CenterOfMass\>\""}], 
                  "\[Rule]", "com"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "\"\<Center\>\""}], "|", 
                   "\"\<CenterOfMass\>\""}], "\[Rule]", 
                  RowBox[{"-", "com"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<A\>\"", "\[Rule]", 
                  RowBox[{"abc", "[", "\"\<AAxis\>\"", "]"}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", "\"\<A\>\""}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"abc", "[", "\"\<AAxis\>\"", "]"}]}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<B\>\"", "\[Rule]", 
                  RowBox[{"abc", "[", "\"\<BAxis\>\"", "]"}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", "\"\<B\>\""}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"abc", "[", "\"\<BAxis\>\"", "]"}]}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<C\>\"", "\[Rule]", 
                  RowBox[{"abc", "[", "\"\<CAxis\>\"", "]"}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", "\"\<C\>\""}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"abc", "[", "\"\<CAxis\>\"", "]"}]}]}]}], "\n", 
                "\t", "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], 
            "\n", "\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t\t", "]"}], ",",
        "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"b", ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ax1_", "\[Rule]", "ax2_"}], ")"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Rule", "@@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Plus", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"com", ",", " ", "0"}], "}"}], ",", "\n", "\t", 
             "\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ax1", ",", "ax2"}], "}"}], ",", "\n", "\t", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bond", ":", 
                   RowBox[{"ChemObjPattern", "?", 
                    RowBox[{"(", 
                    RowBox[{"ChemInstanceQ", "[", "\"\<Bond\>\"", "]"}], 
                    ")"}]}]}], ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"BondVector", "[", "bond", "]"}]}], ",", "\n", "\t",
                  "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"bond", ":", 
                    RowBox[{"ChemObjPattern", "?", 
                    RowBox[{"(", 
                    RowBox[{"ChemInstanceQ", "[", "\"\<Bond\>\"", "]"}], 
                    ")"}]}]}]}], ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"-", 
                   RowBox[{"BondVector", "[", "bond", "]"}]}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"\"\<Center\>\"", "|", "\"\<CenterOfMass\>\""}], 
                  "\[Rule]", "com"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "\"\<Center\>\""}], "|", 
                   "\"\<CenterOfMass\>\""}], "\[Rule]", 
                  RowBox[{"-", "com"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<A\>\"", "\[Rule]", 
                  RowBox[{"abc", "[", "\"\<AAxis\>\"", "]"}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", "\"\<A\>\""}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"abc", "[", "\"\<AAxis\>\"", "]"}]}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<B\>\"", "\[Rule]", 
                  RowBox[{"abc", "[", "\"\<BAxis\>\"", "]"}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", "\"\<B\>\""}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"abc", "[", "\"\<BAxis\>\"", "]"}]}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<C\>\"", "\[Rule]", 
                  RowBox[{"abc", "[", "\"\<CAxis\>\"", "]"}]}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"-", "\"\<C\>\""}], "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"abc", "[", "\"\<CAxis\>\"", "]"}]}]}]}], "\n", 
                "\t", "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], 
            "\n", "\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t\t", "]"}], ",",
        "\n", "\t\t\t", "com"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAxisAlign", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"a", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"axisPattern", "->", "axisPattern"}], ")"}], "|", "None"}]}], 
     ",", "\n", "\t", 
     RowBox[{"b", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"axisPattern", "->", "axisPattern"}], ")"}], "|", "None"}], 
       ")"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"center", ":", 
      RowBox[{"\"\<Center\>\"", "|", "\"\<CenterOfMass\>\""}], ":", 
      "\"\<CenterOfMass\>\""}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AtomsetAxisAlignmentTransform", "[", "\n", "\t\t\t", 
      RowBox[{
      "obj", ",", "\n", "\t\t\t", "a", ",", "\n", "\t\t\t", "b", ",", "\n", 
       "\t\t\t", "center"}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
     RowBox[{"transform_TransformationFunction", ":>", "\n", "\t\t\t", 
      RowBox[{"AtomsetTransform", "[", 
       RowBox[{"obj", ",", "transform"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699747670493449*^9, 3.699747713197002*^9}, {
   3.699747818441572*^9, 3.6997479165129633`*^9}, {3.6997480050358963`*^9, 
   3.699748147170979*^9}, {3.6997483767622747`*^9, 3.6997484053925047`*^9}, {
   3.699748752328888*^9, 3.699748777696691*^9}, {3.699748822484007*^9, 
   3.699748926086025*^9}, {3.6997494721585617`*^9, 3.6997496862890387`*^9}, {
   3.699749853975052*^9, 3.6997499330797453`*^9}, {3.699750051555071*^9, 
   3.6997500565218477`*^9}, {3.6997500952497597`*^9, 3.69975009720798*^9}, {
   3.699750127768697*^9, 3.699750170983289*^9}, {3.700020684468011*^9, 
   3.700020692904593*^9}, {3.700020726810678*^9, 3.700020972044093*^9}, {
   3.700022381368763*^9, 3.70002238697582*^9}, {3.700022425952024*^9, 
   3.700022583447514*^9}, {3.700022675554023*^9, 3.700022794408576*^9}, {
   3.700022824671753*^9, 3.700022902179297*^9}, 3.700022937466126*^9, 
   3.7000229723775797`*^9, {3.700023090446273*^9, 3.700023188048808*^9}, {
   3.700023630457016*^9, 3.700023673551827*^9}, {3.700023746924643*^9, 
   3.700023829364888*^9}, {3.700023881002046*^9, 3.7000238863004436`*^9}, {
   3.7001063191684227`*^9, 3.700106366470402*^9}, {3.7101932785010967`*^9, 
   3.710193294732819*^9}, {3.7101933307576647`*^9, 3.710193377413519*^9}, {
   3.710193790495964*^9, 3.710193803978633*^9}, {3.71019385127847*^9, 
   3.710193917471789*^9}, {3.7101948828837852`*^9, 3.710194890790249*^9}, {
   3.7101950146033688`*^9, 3.7101950977827587`*^9}, {3.710195207611395*^9, 
   3.710195311789299*^9}, {3.7101953562693233`*^9, 3.7101954005406923`*^9}, {
   3.710195454580089*^9, 3.710195499232782*^9}, {3.710195536235406*^9, 
   3.710195724609867*^9}, {3.710196693503656*^9, 3.710196697958902*^9}, {
   3.710196756512602*^9, 3.71019676674183*^9}, 3.710196934986742*^9, {
   3.710197870467731*^9, 3.710197913010169*^9}, {3.716062912727955*^9, 
   3.7160629403481627`*^9}, {3.716062978646063*^9, 3.716063067566573*^9}, {
   3.7160631097177143`*^9, 3.7160631380950813`*^9}, 3.7160632059525223`*^9, {
   3.7160632429584723`*^9, 3.7160632505299597`*^9}, {3.716063287826969*^9, 
   3.716063354521805*^9}, {3.718335482567786*^9, 3.7183354826226807`*^9}, {
   3.727447995598143*^9, 3.727447999113964*^9}, {3.727448089823132*^9, 
   3.727448091221087*^9}, {3.72782508110977*^9, 3.7278250843975277`*^9}, {
   3.727825742433257*^9, 3.727825744119569*^9}, {3.7278257742262087`*^9, 
   3.72782577747335*^9}, {3.727826073997946*^9, 3.727826077708256*^9}, {
   3.727826119131247*^9, 
   3.727826172926108*^9}},ExpressionUUID->"dde5c7ee-56ad-47c4-868e-\
4b029fde91b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Align", "CodeSubsubsection",
 CellChangeTimes->{{3.710197853518447*^9, 3.7101978559411983`*^9}, {
  3.710199744012143*^9, 
  3.71019974505051*^9}},ExpressionUUID->"d9a3d626-ff0a-46c0-ba87-\
433d9eab3120"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pt", "=", "\n", "\t", 
   RowBox[{
    RowBox[{"ChemObjPattern", "?", 
     RowBox[{"(", 
      RowBox[{"ChemInstanceQ", "[", "\"\<Atom\>\"", "]"}], ")"}]}], "|", "\n",
     "\t", "\"\<Center\>\"", "|", "\"\<CenterOfMass\>\"", "|", "\n", "\t", 
    "\"\<X\>\"", "|", "\"\<Y\>\"", "|", "\"\<Z\>\"", "|", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}], ",", 
      RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.710197936976573*^9, 3.71019794228583*^9}, {
   3.7101981936526327`*^9, 3.710198214870678*^9}, 
   3.718335482631186*^9},ExpressionUUID->"c39337b5-2a66-4645-9e24-\
eab035dc4f8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAlignmentTransform", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", ":", "pt"}], ",", 
        RowBox[{"b", ":", "pt"}], ",", 
        RowBox[{"c", ":", "pt"}]}], "}"}], "->", "\n", "\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ta", ":", "pt"}], ",", 
        RowBox[{"tb", ":", "pt"}], ",", 
        RowBox[{"tc", ":", "pt"}]}], "}"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"center", "=", "\n", "\t\t\t", 
        RowBox[{"AtomsetCenter", "[", "obj", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"com", "=", "\n", "\t\t\t", 
        RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"abc", "=", 
        RowBox[{
         RowBox[{"AtomsetInertialSystem", "[", "obj", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<AAxis\>\"", ",", "\"\<BAxis\>\"", ",", "\"\<CAxis\>\""}], 
           "}"}], "]"}], "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"pos", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "ta", ",", "tb", ",", "tc"}], "}"}],
            ",", 
           RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"\"\<Center\>\"", "\[Rule]", "center"}], ",", "\n", "\t",
              "\t", "\t", "\t\t\t", 
             RowBox[{"\"\<CenterOfMass\>\"", "\[Rule]", "com"}], ",", "\n", 
             "\t", "\t", "\t\t\t\t", 
             RowBox[{"\"\<A\>\"", "->", 
              RowBox[{"abc", "[", "\"\<AAxis\>\"", "]"}]}], ",", "\n", "\t", 
             "\t", "\t\t\t\t", 
             RowBox[{"\"\<B\>\"", "\[Rule]", 
              RowBox[{"abc", "[", "\"\<BAxis\>\"", "]"}]}], ",", "\n", "\t", 
             "\t", "\t\t\t\t", 
             RowBox[{"\"\<C\>\"", "\[Rule]", 
              RowBox[{"abc", "[", "\"\<CAxis\>\"", "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"o", ":", "ChemObjPattern"}], ":>", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"ChemGet", "[", 
               RowBox[{"o", ",", "\"\<Position\>\""}], "]"}]}]}], "\n", "\t", 
            "\t", "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t", "\t", "\t\t", 
        "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"ChemUtilsAlignmentTransform", "@", "\n", "\t\t\t\t", 
         RowBox[{"Take", "[", 
          RowBox[{"pos", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], "\[Rule]", 
        RowBox[{"Take", "[", 
         RowBox[{"pos", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "6"}], "}"}]}], "]"}]}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAlignmentTransform", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"b", ":", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"_", "?", "StringQ"}], "|", 
           RowBox[{"_", "?", "NumericQ"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", "\n", "\t",
         "\t\t", "___"}], "\n", "\t", "\t\t", "}"}]}]}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemUtilsAlignmentTransform", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AtomsetMassPositions", "[", "obj", "]"}], "->", "\n", "\t\t\t", 
     "b"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAlignmentTransform", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"b", ":", 
      RowBox[{"ChemObjPattern", "?", 
       RowBox[{"(", 
        RowBox[{"ChemInstanceQ", "[", "\"\<Atomset\>\"", "]"}], ")"}]}]}]}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemUtilsAlignmentTransform", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AtomsetMassPositions", "[", "obj", "]"}], "->", "\n", "\t\t\t", 
     
     RowBox[{"AtomsetMassPositions", "[", "b", "]"}]}], "\n", "\t\t", "]"}]}],
   ";"}]}], "CodeInput",
 CellChangeTimes->{{3.710197591791677*^9, 3.710197622361046*^9}, {
   3.710197838526369*^9, 3.7101978388846617`*^9}, {3.710197956455996*^9, 
   3.7101980481999483`*^9}, {3.710198082842368*^9, 3.710198183120409*^9}, {
   3.7101982237901*^9, 3.7101983545007257`*^9}, {3.710199099728571*^9, 
   3.710199244714734*^9}, {3.710199364016141*^9, 3.7101993727899857`*^9}, 
   3.710199513284988*^9, {3.710199764618004*^9, 3.7101997917342653`*^9}, {
   3.7101998638083267`*^9, 3.710199925224121*^9}, {3.718335482648788*^9, 
   3.718335482668852*^9}},ExpressionUUID->"9230624a-82ec-4269-a6a0-\
1f2df8ef5e08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetAlign", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"b", ":", "\n", "\t\t", 
      RowBox[{"(", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pt", ",", "pt", ",", "pt"}], "}"}], "->", 
          RowBox[{"{", 
           RowBox[{"pt", ",", "pt", ",", "pt"}], "}"}]}], ")"}], "|", "\n", 
        "\t\t\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "?", "StringQ"}], ")"}], "|", 
             RowBox[{"(", 
              RowBox[{"_", "?", "NumericQ"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], ",", "___"}], 
         "}"}], "|", "\n", "\t\t\t", 
        RowBox[{"ChemObjPattern", "?", 
         RowBox[{"(", 
          RowBox[{"ChemInstanceQ", "[", "\"\<Atomset\>\"", "]"}], ")"}]}]}], 
       "\n", "\t\t\t", ")"}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AtomsetAlignmentTransform", "[", "\n", "\t\t\t", 
      RowBox[{"obj", ",", "\n", "\t\t\t", "b"}], "\n", "\t\t\t", "]"}], ",", 
     "\n", "\t\t", 
     RowBox[{"transform_TransformationFunction", ":>", "\n", "\t\t\t", 
      RowBox[{"AtomsetTransform", "[", 
       RowBox[{"obj", ",", "transform"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.710197591791677*^9, 3.710197622361046*^9}, {
   3.710197838526369*^9, 3.7101978388846617`*^9}, {3.710197956455996*^9, 
   3.7101980481999483`*^9}, {3.710198082842368*^9, 3.710198183120409*^9}, {
   3.7101982237901*^9, 3.7101983545007257`*^9}, {3.710199099728571*^9, 
   3.710199304011983*^9}, {3.710199349318651*^9, 3.710199360396529*^9}, {
   3.710199509347663*^9, 3.710199510337482*^9}, 3.710199849790206*^9, {
   3.7102002603877563`*^9, 3.710200261370514*^9}, {3.7102004392162743`*^9, 
   3.710200440013856*^9}, 3.710200891722402*^9, {3.718335482678116*^9, 
   3.7183354826825027`*^9}},ExpressionUUID->"8aabb2e5-328c-4755-93c9-\
bcbf48e80531"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Rotational Properties\[RightFloor]", \
"CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6948707960383377`*^9, 
  3.694870803574787*^9}},ExpressionUUID->"ce454493-d013-4498-be50-\
0158e1079730"],

Cell[CellGroupData[{

Cell["IntertialTensor", "CodeSubsubsection",
 CellChangeTimes->{{3.692535474245647*^9, 3.6925354931170473`*^9}, {
  3.6925365377291193`*^9, 
  3.6925365388051853`*^9}},ExpressionUUID->"63d81059-b516-4fad-a154-\
ecd39448838a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialTensor", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemUtilsInertialTensor", "@", "\n", "\t\t", 
    RowBox[{"AtomsetMassPositions", "[", "obj", "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6925355008817863`*^9, 3.692535509756995*^9}, {
   3.692536541078784*^9, 3.692536623516103*^9}, {3.69253676178513*^9, 
   3.6925367811890306`*^9}, {3.6925695112452383`*^9, 
   3.6925695150357513`*^9}, {3.694311800863535*^9, 3.694311820795465*^9}, {
   3.700106378240314*^9, 3.70010638892583*^9}, {3.700106426110073*^9, 
   3.7001064316762247`*^9}, 
   3.718335482690069*^9},ExpressionUUID->"11d12f89-aaaf-4fdf-aa5b-\
a73d7502a313"]
}, Closed]],

Cell[CellGroupData[{

Cell["InertialEigensystem", "CodeSubsubsection",
 CellChangeTimes->{{3.692536544084674*^9, 
  3.692536547820422*^9}},ExpressionUUID->"b03c3589-7d66-4581-b187-\
6171df4a06c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialEigensystem", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemUtilsInertialEigensystem", "@", "\n", "\t\t", 
    RowBox[{"AtomsetElementPositions", "[", "obj", "]"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{
  3.6925365544942617`*^9, {3.692536635857051*^9, 3.6925366557968483`*^9}, {
   3.6925367847893667`*^9, 3.692536789471573*^9}, 3.692536832645464*^9, {
   3.694310907391061*^9, 3.694310915390348*^9}, {3.700106443996048*^9, 
   3.7001064522101593`*^9}, 
   3.7183354826974382`*^9},ExpressionUUID->"f487eec8-0a04-4f45-8f39-\
d29b4ee95fe7"]
}, Closed]],

Cell[CellGroupData[{

Cell["InertialSystem", "CodeSubsubsection",
 CellChangeTimes->{
  3.694035155213592*^9},ExpressionUUID->"9ee1b27c-7e81-4198-a687-\
e5087b04d82c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialSystem", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemUtilsInertialSystem", "@", "\n", "\t\t", 
    RowBox[{"AtomsetInertialEigensystem", "[", "obj", "]"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.694035169112588*^9, 3.694035193722949*^9}, {
   3.700106463453404*^9, 3.700106468683146*^9}, 
   3.718335482704884*^9},ExpressionUUID->"e53e9603-e48a-4c3b-9260-\
5cbdbf157ad4"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrincipalAxes", "CodeSubsubsection",
 CellChangeTimes->{{3.69256969216157*^9, 
  3.692569696745308*^9}},ExpressionUUID->"70b32af3-7cab-4972-88d2-\
6bcbd4b11595"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetPrincipalAxes", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"es", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"First", "@", "#"}]}], ",", 
           RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "@", 
        RowBox[{"AtomsetInertialEigensystem", "[", "obj", "]"}]}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Times", "@@", 
      RowBox[{"SortBy", "[", 
       RowBox[{"es", ",", "First"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.692569704770475*^9, 3.69256972148002*^9}, {
   3.692569901910592*^9, 3.6925699801561127`*^9}, {3.700106473189334*^9, 
   3.700106479899767*^9}, 
   3.718335482712977*^9},ExpressionUUID->"ef40ede0-2755-486f-a473-\
59ac5f15a101"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Symmetry\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6948708290771914`*^9, 
  3.6948708325895977`*^9}},ExpressionUUID->"3a5e49d7-edcc-4900-8222-\
0413ea8c86d1"],

Cell[CellGroupData[{

Cell["SymmetryElements", "CodeSubsubsection",
 CellChangeTimes->{{3.6939515226576443`*^9, 
  3.693951526105762*^9}},ExpressionUUID->"07c57304-0d1c-43fd-a196-\
dcf96b819a7e"],

Cell[BoxData[
 RowBox[{"AtomsetSymmetryElements", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.718838852323072*^9, 
  3.718838853043955*^9}},ExpressionUUID->"3a62104b-d831-4692-b338-\
9b5ac7bfe596"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetSymmetryElements", "]"}], "=", "\n", "\t", 
   
   RowBox[{"Options", "[", "ChemUtilsSymmetryElements", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetSymmetryElements", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"atomPattern", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "_"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"stest1", "=", 
      RowBox[{"ChemGet", "[", 
       RowBox[{"obj", ",", " ", "\"\<SymmetryElements\>\""}], "]"}]}], "}"}], 
    ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AssociationQ", "@", "stest1"}], "&&", 
       RowBox[{"KeyMemberQ", "[", 
        RowBox[{"stest1", ",", " ", 
         RowBox[{"Hash", "@", 
          RowBox[{"AtomsetElementPositions", "[", "obj", "]"}]}]}], "]"}]}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"stest1", "[", 
       RowBox[{"Hash", "@", 
        RowBox[{"AtomsetElementPositions", "[", "obj", "]"}]}], "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{"smells", "=", 
          RowBox[{"ChemUtilsSymmetryElements", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"AtomsetElementPositions", "[", "obj", "]"}], ",", 
              "atomPattern"}], "]"}], ",", "\n", "\t\t\t\t\t", "ops"}], "\n", 
           "\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ChemSet", "[", 
          RowBox[{
          "obj", ",", " ", "\"\<SymmetryElements\>\"", ",", " ", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"Hash", "@", 
              RowBox[{"AtomsetElementPositions", "[", "obj", "]"}]}], "->", 
             "smells"}], "|>"}]}], "]"}], ";", "\n", "\t\t\t\t", "smells"}]}],
        "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.693952365777857*^9, 3.693952448194862*^9}, {
   3.693955032504047*^9, 3.693955034903735*^9}, {3.700106497636076*^9, 
   3.700106509745829*^9}, 3.71833548272054*^9, {3.718838838801139*^9, 
   3.718838878576647*^9}, {3.7208475214972982`*^9, 3.720847633331588*^9}, {
   3.720847750514411*^9, 3.7208477560525618`*^9}, {3.720847853646916*^9, 
   3.720847876264481*^9}, {3.72084791582542*^9, 
   3.720847923895555*^9}},ExpressionUUID->"e3915d5b-e9be-4159-87df-\
0836227b2d53"]
}, Closed]],

Cell[CellGroupData[{

Cell["InertialSymmetry", "CodeSubsubsection",
 CellChangeTimes->{
  3.69395152029251*^9},ExpressionUUID->"ff5c7003-aa87-4367-90e3-9ba54e800ffb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetInertialSymmetry", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemUtilsInertialSymmetry", "@", "\n", "\t\t", 
    RowBox[{"AtomsetElementPositions", "@", "obj"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.693952365777857*^9, 3.6939524899765997`*^9}, {
   3.700106513955553*^9, 3.700106536321752*^9}, 
   3.7183354827281303`*^9},ExpressionUUID->"5f3f2f18-97bc-4950-a073-\
3fd95a615386"]
}, Closed]],

Cell[CellGroupData[{

Cell["PointGroup", "CodeSubsubsection",
 CellChangeTimes->{{3.693951494146452*^9, 
  3.69395149609064*^9}},ExpressionUUID->"5bf0cfa8-1841-485c-8793-\
df4834438f95"],

Cell[BoxData[
 RowBox[{"AtomsetPointGroup", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.7188389234485617`*^9, 
  3.718838924207945*^9}},ExpressionUUID->"5b313b62-9615-4462-a105-\
f12ad29304e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetPointGroup", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "ChemUtilsPointGroup", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetPointGroup", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"atomPattern", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "_"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemUtilsPointGroup", "[", "\n", "\t\t", 
   RowBox[{"AtomsetSymmetryElements", "[", 
    RowBox[{"obj", ",", " ", "atomPattern", ",", " ", "ops"}], "]"}], "\n", 
   "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.69395249663973*^9, 3.693952554904001*^9}, {
   3.700106540745817*^9, 3.7001065594046993`*^9}, 3.718335482735386*^9, {
   3.718838890855942*^9, 3.718838915279923*^9}, {3.7208477634768333`*^9, 
   3.720847781518881*^9}},ExpressionUUID->"7f3a7b97-1c20-4b42-9102-\
4d72d7572089"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Surface Properties\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6948708353326473`*^9, 
  3.6948708455489893`*^9}},ExpressionUUID->"cba4ae80-cb0c-4f14-9eb9-\
73f1d5873c2c"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]VdWSurface\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692584386282688*^9, 3.692584390514286*^9}, 
   3.6925896744464912`*^9, {3.692589820346266*^9, 
   3.692589820985072*^9}},ExpressionUUID->"0223356d-a8af-4a11-ace9-\
950cedc2a0f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetVdWSurface", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "BoundaryDiscretizeRegion"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetVdWSurface", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"atoms", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"radii", "=", 
          RowBox[{"QuantityMagnitude", "/@", 
           RowBox[{"ChemGet", "[", 
            RowBox[{"atoms", ",", "\"\<Radius\>\""}], "]"}]}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"positions", "=", 
          RowBox[{"ChemGet", "[", 
           RowBox[{"atoms", ",", "\"\<Position\>\""}], "]"}]}]}], "\n", 
        "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"BoundaryDiscretizeRegion", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"RegionUnion", "@@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Ball", ",", 
            RowBox[{"{", 
             RowBox[{"positions", ",", "radii"}], "}"}]}], "]"}]}], ",", "\n",
          "\t\t\t\t", "ops", ",", "\n", "\t\t\t\t", 
         RowBox[{"PlotTheme", "\[Rule]", "\"\<SmoothShading\>\""}]}], "\n", 
        "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692584391309732*^9, 3.692584433234866*^9}, {
   3.692584469529879*^9, 3.692584473734809*^9}, {3.692584506878016*^9, 
   3.692584878163336*^9}, {3.692584917622863*^9, 3.692584921239393*^9}, {
   3.692584969848713*^9, 3.692585002094747*^9}, {3.692589573540469*^9, 
   3.6925896706775637`*^9}, {3.692589782159009*^9, 3.692589783862899*^9}, {
   3.692589907929351*^9, 3.692589948071815*^9}, 3.692590029615176*^9, {
   3.70010658401682*^9, 3.700106621250928*^9}, 
   3.718335482748026*^9},ExpressionUUID->"daa975b6-15e8-4262-8088-\
8296cf0e3a8d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]VdWVolume\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692589958661263*^9, 3.692589962428364*^9}, 
   3.694523889330381*^9},ExpressionUUID->"9a945c1f-3241-4833-a66e-\
7ac0ee6b148d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetVdWVolume", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Quantity", "[", 
    RowBox[{
     RowBox[{"Volume", "@", 
      RowBox[{"AtomsetVdWSurface", "[", "obj", "]"}]}], ",", 
     RowBox[{"\"\<Angstroms\>\"", "^", "3"}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.692589897106316*^9, 3.6925899053423986`*^9}, {
   3.692589963988834*^9, 3.6925899958681383`*^9}, {3.692590133251061*^9, 
   3.692590143256936*^9}, {3.700106646661579*^9, 3.700106657852626*^9}, 
   3.7183354827579403`*^9},ExpressionUUID->"0af2b6a4-78c0-4c07-8c9b-\
e92ab45637fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PartialCharges\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694894802317595*^9, 
  3.6948948214053183`*^9}},ExpressionUUID->"12658fc7-4461-4c29-9be6-\
e616b792d031"],

Cell[CellGroupData[{

Cell["gastInitialCharges", "CodeSubsubsubsection",
 CellChangeTimes->{{3.694894961189062*^9, 
  3.694894983521744*^9}},ExpressionUUID->"4773ce4e-77cc-4e26-9130-\
7ecc13cfd238"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"atomsetGastInitialCharges", "[", 
    RowBox[{"obj", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"phos", "=", 
        RowBox[{"AtomsetAtomMemberQ", "[", 
         RowBox[{"obj", ",", "\"\<Phosphate\>\""}], "]"}]}], ",", "\n", 
       "\t\t", 
       RowBox[{"sulf", "=", 
        RowBox[{"AtomsetAtomMemberQ", "[", 
         RowBox[{"obj", ",", "\"\<Sulfate\>\""}], "]"}]}], ",", "\n", "\t\t", 
       
       RowBox[{"carb", "=", 
        RowBox[{"AtomsetAtomMemberQ", "[", 
         RowBox[{"obj", ",", "\"\<Carboxyl\>\""}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"formal", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "0.0", ")"}], "&"}], "/@", 
         RowBox[{"ChemGet", "[", 
          RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}]}], ",", "\n", "\t\t", 
       RowBox[{"elements", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{
          RowBox[{"ChemGet", "[", 
           RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}], ",", 
          "\"\<Element\>\""}], "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Table", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"elements", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<O\>\""}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"Which", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"carb", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"-", ".5"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"phos", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"-", ".666"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"sulf", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"-", ".5"}], ",", "\n", "\t\t\t\t\t\t", "True", ",", "\n", 
           "\t\t\t\t\t\t\t", 
           RowBox[{"formal", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"formal", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "elements"}]}], "}"}]}], "\n", "\t\t\t", 
      "]"}]}], "\t\t", "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694874970289797*^9, 3.69487503204919*^9}, {
   3.694875493438715*^9, 3.694875641425091*^9}, {3.694876021431944*^9, 
   3.694876024264081*^9}, {3.6948761069941397`*^9, 3.694876165782765*^9}, {
   3.69487631893152*^9, 3.694876342025105*^9}, {3.694895028716126*^9, 
   3.694895039328198*^9}, {3.700106721491596*^9, 3.7001067504965076`*^9}, {
   3.700193385966589*^9, 3.700193387564691*^9}, 
   3.7183354827763453`*^9},ExpressionUUID->"54dbef14-b372-48fa-b1fa-\
ac775964d515"]
}, Closed]],

Cell[CellGroupData[{

Cell["gastSigmaChi", "CodeSubsubsubsection",
 CellChangeTimes->{{3.694894961189062*^9, 
  3.694894981265443*^9}},ExpressionUUID->"7ae50dc9-bcae-4ec8-90c2-\
132cfac43e8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"atomsetGastSigmaChi", "[", "atom_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"gscVal", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "\n", "\t\t", "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{
     RowBox[{"Switch", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"ChemGet", "[", 
        RowBox[{"atom", ",", "\"\<AtomicNumber\>\""}], "]"}], ",", "\n", 
       "\t\t\t", "1", ",", "\n", "\t\t\t\t", 
       RowBox[{"gscVal", "=", 
        RowBox[{"{", 
         RowBox[{".37", ",", "7.17", ",", "12.85"}], "}"}]}], ",", "\n", 
       "\t\t\t", "6", ",", "\n", "\t\t\t\t", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"AtomHybridization", "@", "atom"}], ",", "\n", "\t\t\t\t\t", 
         "\"\<sp\>\"", ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{".68", ",", "7.98", ",", "19.04"}], "}"}]}], ",", "\n", 
         "\t\t\t\t\t", "\"\<sp2\>\"", ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{".98", ",", "8.79", ",", "19.62"}], "}"}]}], ",", "\n", 
         "\t\t\t\t\t", "\"\<sp3\>\"", ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{"1.67", ",", "10.39", ",", "20.57"}], "}"}]}]}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "7", ",", "\n", "\t\t\t\t", 
       
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"AtomHybridization", "@", "atom"}], ",", "\n", "\t\t\t\t\t", 
         "\"\<sp3\>\"", ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"ChemGet", "[", 
              RowBox[{"atom", ",", "\"\<Bonds\>\""}], "]"}]}], "\[Equal]", 
            "4"}], ",", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"gscVal", "=", 
            RowBox[{"{", 
             RowBox[{"0.0", ",", "0.0", ",", "23.72"}], "}"}]}], ",", "\n", 
           "\t\t\t\t\t\t\t", 
           RowBox[{"gscVal", "=", 
            RowBox[{"{", 
             RowBox[{"2.08", ",", "11.54", ",", "23.72"}], "}"}]}]}], "\n", 
          "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", "\"\<sp2\>\"", 
         ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{"2.57", ",", "12.87", ",", "24.87"}], "}"}]}], ",", "\n", 
         "\t\t\t\t\t", "\"\<sp\>\"", ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{"2.71", ",", "15.68", ",", "27.11"}], "}"}]}]}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "8", ",", "\n", "\t\t\t\t", 
       
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"AtomHybridization", "@", "atom"}], ",", "\n", "\t\t\t\t\t", 
         "\"\<sp3\>\"", ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{"2.65", ",", "14.81", ",", "28.94"}], "}"}]}], ",", "\n", 
         "\t\t\t\t\t", "\"\<sp2\>\"", ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{"3.75", ",", "17.07", ",", "31.33"}], "}"}]}]}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "9", ",", "\n", "\t\t\t\t", 
       
       RowBox[{"gscVal", "=", 
        RowBox[{"{", 
         RowBox[{"3.12", ",", "14.66", ",", "30.82"}], "}"}]}], ",", "\n", 
       "      ", "15", ",", "\n", "      \t", 
       RowBox[{"gscVal", "=", 
        RowBox[{"{", 
         RowBox[{"1.62", ",", "8.90", ",", "18.10"}], "}"}]}], ",", "\n", 
       "      ", "16", ",", "\n", "        ", 
       RowBox[{"If", "[", 
        RowBox[{"True", 
         RowBox[{"(*", 
          RowBox[{"CountFreeOxygens", "<", "2"}], "*)"}], ",", "\n", 
         "        \t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{"2.39", ",", "10.14", ",", "20.65"}], "}"}]}], ",", "\n", 
         "        \t", 
         RowBox[{"gscVal", "=", 
          RowBox[{"{", 
           RowBox[{"2.39", ",", "12.00", ",", "24.00"}], "}"}]}]}], "\n", 
        "        \t", "]"}], ",", "\n", "      ", "17", ",", "\n", "      \t", 
       RowBox[{"gscVal", "=", 
        RowBox[{"{", 
         RowBox[{"2.66", ",", "11.00", ",", "22.04"}], "}"}]}], ",", "\n", 
       "      ", "35", ",", "\n", "      \t", 
       RowBox[{"gscVal", "=", 
        RowBox[{"{", 
         RowBox[{"2.77", ",", "10.08", ",", "19.71"}], "}"}]}], ",", "\n", 
       "      ", "53", ",", "\n", "      \t", 
       RowBox[{"gscVal", "=", 
        RowBox[{"{", 
         RowBox[{"2.90", ",", "9.90", ",", "18.82"}], "}"}]}], ",", "\n", 
       "      ", "13", ",", "\n", "        ", 
       RowBox[{"gscVal", "=", 
        RowBox[{"{", 
         RowBox[{"1.06", ",", "5.47", ",", "11.65"}], "}"}]}]}], "\n", 
      "        ", "]"}], ";", "\n", "     ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"gscVal", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ">", ".001"}], ")"}], ",", "\n", 
       "     \t", 
       RowBox[{"True", "\[Rule]", "\n", "     \t\t", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"gscVal", ",", 
          RowBox[{"{", "\n", "     \t\t\t", 
           RowBox[{
            RowBox[{"2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"gscVal", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", 
                RowBox[{"gscVal", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "2"}]}], ",", 
            "\n", "     \t\t\t", 
            RowBox[{"3", "->", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"gscVal", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "+", 
                 RowBox[{"gscVal", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "2"}], "-", 
              RowBox[{"gscVal", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\n", "     \t\t\t", 
           "}"}]}], "]"}]}], ",", "\n", "     \t", 
       RowBox[{"False", "\[Rule]", "gscVal"}]}], "\n", "     \t", "]"}]}]}], 
   "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6948770501882067`*^9, 3.69487706806796*^9}, {
   3.694883085793915*^9, 3.694883129678084*^9}, {3.694883274660123*^9, 
   3.694883287948599*^9}, {3.6948833261312103`*^9, 3.694883668708468*^9}, {
   3.694883756901569*^9, 3.694883841695756*^9}, {3.694883909025329*^9, 
   3.6948839626709146`*^9}, {3.694884041743168*^9, 3.694884230783997*^9}, {
   3.694884305982422*^9, 3.694884402563418*^9}, 3.694888732423953*^9, {
   3.694888768637064*^9, 3.694888803953912*^9}, 3.694889136643324*^9, {
   3.6948951569779663`*^9, 3.694895161770321*^9}, {3.700193379287262*^9, 
   3.7001933810611763`*^9}},ExpressionUUID->"8d39b8e1-448f-4950-8f2b-\
2b27ed0d0563"]
}, Closed]],

Cell[CellGroupData[{

Cell["gastAssign", "CodeSubsubsubsection",
 CellChangeTimes->{{3.694894961189062*^9, 
  3.694894990001408*^9}},ExpressionUUID->"867885ca-7496-409a-9f7b-\
40a7e451ad18"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"atomsetGastAssign", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"log", ":", 
      RowBox[{"True", "|", "False"}], ":", "False"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"gastAtoms", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t", 
       "gastBonds", ",", "\n", "\t\t", "gastState", ",", "\n", "\t\t", 
       "gastDenom", ",", "gastA", ",", "gastB", ",", "gastC", ",", "\n", 
       "\t\t", "gastSrc", ",", "gastDst", ",", "gastCharge", ",", "\n", 
       "\t\t", 
       RowBox[{"gastAlpha", "=", "1.0"}], ",", "\n", "\t\t", 
       RowBox[{"gastDampening", "=", ".5"}], ",", 
       RowBox[{"gastDefaultDenom", "=", "20.02"}], ",", "\n", "\t\t", 
       RowBox[{"gastIters", "=", "6"}], ",", 
       RowBox[{"gastLog", "=", 
        RowBox[{"{", "}"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"gastBonds", "=", "\n", "\t\t\t", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "@@", 
         RowBox[{"ChemGet", "[", 
          RowBox[{"gastAtoms", ",", "\"\<Bonds\>\""}], "]"}]}], "]"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"gastState", "=", "\n", "\t\t\t", 
       RowBox[{"atomsetGastInitialCharges", "[", "obj", "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"gastState", "=", "\n", "\t\t\t", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"gastAtoms", ",", "\n", "\t\t\t\t", 
         RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"atomsetGastSigmaChi", "@", 
              RowBox[{"gastAtoms", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"True", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}]}], ")"}], ":>",
                 "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"<|", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"\"\<a\>\"", "->", "a"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<b\>\"", "->", "b"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<c\>\"", "->", "c"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<chi\>\"", "\[Rule]", "0.0"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<denom\>\"", "\[Rule]", 
                   RowBox[{"a", "+", "b", "+", "c"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<q\>\"", "->", 
                   RowBox[{"gastState", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "\n", "\t", 
                 "\t\t\t\t\t\t\t", "|>"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"False", "\[Rule]", "_"}], ")"}], ":>", "\n", 
                "\t\t\t\t\t\t\t", "$Failed"}]}], "\n", "\t\t\t\t\t\t", 
              "}"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "gastAtoms"}]}], "}"}]}], "\n", 
          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"gastState", ",", "$Failed"}], "]"}], ",", 
        RowBox[{"Return", "@", "$Failed"}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"gastAlpha", "*=", "gastDampening"}], ";", "\n", "\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"gastState", "[", "gastAtom", "]"}], "[", "\"\<chi\>\"", 
             "]"}], "=", "\n", "\t\t\t\t\t", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"tempa", ",", "tempb", ",", "tempc", ",", "tempq"}], 
               "}"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"tempa", ",", "tempb", ",", "tempc"}], "}"}], "=", 
                "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                  RowBox[{"gastState", "[", "gastAtom", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\""}], 
                   "}"}]}], "]"}]}], ";", "\n", "\t\t\t\t\t\t", 
               RowBox[{"tempq", "=", 
                RowBox[{
                 RowBox[{"gastState", "[", "gastAtom", "]"}], "[", 
                 "\"\<q\>\"", "]"}]}], ";", "\n", "\t\t\t\t\t\t", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"tempa", "+", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"tempb", "*", "tempq"}], "+", "\n", "\t\t\t\t\t\t\t", 
                
                RowBox[{"tempc", "*", "tempq", "*", "tempq"}]}]}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"gastAtom", ",", "gastAtoms"}], "}"}]}], "\n", "\t\t\t\t",
           "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"gastSrc", ",", "gastDst"}], "}"}], "=", 
             RowBox[{"ChemGet", "[", 
              RowBox[{"gastBond", ",", "\"\<Atoms\>\""}], "]"}]}], ";", "\n", 
            "\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ga", "=", "\n", "\t\t\t\t\t", 
                RowBox[{"First", "@", 
                 RowBox[{"MaximalBy", "[", "\n", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"gastSrc", ",", "gastDst"}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"gastState", "[", 
                    RowBox[{"#", ",", "\"\<chi\>\""}], "]"}], "&"}]}], "\n", 
                  "\t\t\t\t\t\t", "]"}]}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ChemGet", "[", 
                   RowBox[{"ga", ",", "\"\<Element\>\""}], "]"}], "\[Equal]", 
                  "\"\<H\>\""}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"gastDenom", "=", "gastDefaultDenom"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"gastDenom", "=", 
                  RowBox[{"gastState", "[", 
                   RowBox[{"ga", ",", "\"\<denom\>\""}], "]"}]}]}], "\n", 
                "\t\t\t\t\t\t", "]"}], ";"}]}], "\n", "\t\t\t\t\t", "]"}], 
            ";", "\n", "\t\t\t\t", 
            RowBox[{"gastCharge", "=", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"gastState", "[", 
                 RowBox[{"gastSrc", ",", "\"\<chi\>\""}], "]"}], "-", 
                RowBox[{"gastState", "[", 
                 RowBox[{"gastDst", ",", "\"\<chi\>\""}], "]"}]}], ")"}], "/",
               "\n", "\t\t\t\t\t\t", "gastDenom"}]}], ";", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"gastState", "[", 
              RowBox[{"gastSrc", ",", "\"\<q\>\""}], "]"}], "-=", 
             RowBox[{"gastAlpha", "*", "gastCharge"}]}], ";", "\n", 
            "\t\t\t\t", 
            RowBox[{
             RowBox[{"gastState", "[", 
              RowBox[{"gastDst", ",", "\"\<q\>\""}], "]"}], "+=", 
             RowBox[{"gastAlpha", "*", "gastCharge"}]}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"gastBond", ",", "gastBonds"}], "}"}]}], "]"}], ";", "\n",
          "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{"log", ",", "\n", "\t\t\t\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"gastLog", ",", "gastState"}], "]"}]}], "\n", "\t\t\t\t", 
          "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"gastIter", ",", "gastIters"}], "}"}]}], "\n", "\t\t\t", 
       "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
       "log", ",", "\n", "\t\t\t", "gastLog", ",", "\n", "\t\t\t", 
        "gastState"}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.694884514256318*^9, 3.6948845768312817`*^9}, {
   3.694884629982481*^9, 3.694884632623269*^9}, {3.694884699097756*^9, 
   3.694884718481035*^9}, {3.694884761185934*^9, 3.694884783085136*^9}, {
   3.694884912066334*^9, 3.694884914906955*^9}, {3.694885078604802*^9, 
   3.6948851895740423`*^9}, {3.694885251854267*^9, 3.694885266504952*^9}, {
   3.694885506955406*^9, 3.694885841561759*^9}, {3.6948867857528763`*^9, 
   3.694887022475457*^9}, {3.694887587046282*^9, 3.694887669125288*^9}, {
   3.6948877091304283`*^9, 3.694887720897291*^9}, {3.6948877735448008`*^9, 
   3.694887806754355*^9}, {3.694887841345724*^9, 3.694888099960403*^9}, {
   3.694888176730054*^9, 3.694888180657825*^9}, {3.69488918054046*^9, 
   3.6948892081903*^9}, {3.694889254143507*^9, 3.694889256626904*^9}, {
   3.694889289571434*^9, 3.6948892928533382`*^9}, {3.694889333578923*^9, 
   3.6948894331726303`*^9}, {3.694889495747952*^9, 3.694889570001727*^9}, {
   3.694889622891904*^9, 3.694889701293297*^9}, {3.694889964080824*^9, 
   3.6948899795996428`*^9}, {3.694890047808576*^9, 3.694890058604705*^9}, {
   3.6948900945848618`*^9, 3.694890109052292*^9}, {3.694890174984933*^9, 
   3.694890238143861*^9}, {3.694895006200976*^9, 3.69489502012132*^9}, {
   3.700106670576297*^9, 3.700106698840066*^9}, {3.700193272479278*^9, 
   3.700193289568899*^9}, 3.700193337147246*^9, {3.7001935870126143`*^9, 
   3.700193602401917*^9}, 
   3.718335482797608*^9},ExpressionUUID->"f5d9a885-a4e0-46f2-a93e-\
c530423dad36"]
}, Closed]],

Cell[CellGroupData[{

Cell["Composite", "CodeSubsubsubsection",
 CellChangeTimes->{{3.694894961189062*^9, 
  3.6948949627566013`*^9}},ExpressionUUID->"03d99c39-0817-42de-8f34-\
f65fbed3ad19"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetPartialCharges", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"mode", ":", 
      RowBox[{"\"\<Cached\>\"", "|", "\"\<Gasteiger\>\""}], ":", 
      "\"\<Cached\>\""}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ats", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t", 
       "pCharge"}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{
       "mode", ",", "\n", "\t\t\t", "\"\<Cached\>\"", ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"pCharge", "=", 
          RowBox[{"ChemGet", "[", 
           RowBox[{"ats", ",", "\"\<PartialCharge\>\"", ",", "Automatic"}], 
           "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AnyTrue", "[", 
            RowBox[{"pCharge", ",", 
             RowBox[{"Not", "@*", "NumericQ"}]}], "]"}], ",", "\n", "\t", 
           "\t", "\t\t\t", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"ChemGet", "[", 
               RowBox[{"obj", ",", "\"\<MMFF94PartialCharges\>\""}], "]"}], 
              ",", "\n", "\t", "\t", "\t\t\t\t", 
              RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", "n_", "}"}], ",", "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t", "p__"}], "\n", "\t", "\t", "\t", 
                  "\t\t\t\t\t", "}"}], ":>", "\n", "\t", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{"Set", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"AtomPartialCharge", "[", "ats", "]"}], ",", "\n", 
                   "\t", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Last", ",", 
                    RowBox[{"{", "p", "}"}]}], "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0.", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "ats", "]"}], "-", "n"}]}], 
                    "]"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", "]"}]}], 
                  "\n", "\t", "\t", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"_", ":>", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"atomsetGastAssign", "[", "obj", "]"}], ",", "\n", 
                   "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                   RowBox[{
                   "a_Association", ":>", "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t", 
                    RowBox[{
                    "Set", "[", "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"AtomPartialCharge", "[", 
                    RowBox[{"Keys", "[", "a", "]"}], "]"}], ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Values", "[", "a", "]"}], ",", "\"\<q\>\""}], 
                    "]"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    "]"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t", "]"}]}]}], 
               "\n", "\t", "\t", "\t\t\t\t\t", "}"}]}], "\n", "\t", "\t", 
             "\t\t\t\t", "]"}], ";", "\n", "\t", "\t", "\t\t\t", 
            RowBox[{"pCharge", "=", 
             RowBox[{"ChemGet", "[", 
              RowBox[{"ats", ",", "\"\<PartialCharge\>\"", ",", "0."}], 
              "]"}]}], ";"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", 
        "\t\t\t\t", "\"\<Gasteiger\>\"", ",", "\n", "\t\t\t\t\t", 
        RowBox[{"pCharge", "=", "\n", "\t\t\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"atomsetGastAssign", "[", "obj", "]"}], ",", "\n", "\t", 
           "\t\t\t\t\t\t", 
           RowBox[{"a_Association", ":>", "\n", "\t", "\t\t\t\t\t\t\t", 
            RowBox[{"Lookup", "[", 
             RowBox[{
              RowBox[{"Values", "[", "a", "]"}], ",", "\"\<q\>\""}], 
             "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", 
       "]"}], ";", "\n", "\t\t\t", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"pCharge", ",", 
         RowBox[{"ChemGet", "[", 
          RowBox[{"ats", ",", "\"\<Position\>\""}], "]"}]}], "}"}], "]"}]}]}],
     "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.694894815363852*^9, 3.694894840109795*^9}, {
   3.6948949218379803`*^9, 3.694894932217135*^9}, {3.6948950446524878`*^9, 
   3.694895045788266*^9}, {3.700106775818091*^9, 3.700106780817425*^9}, {
   3.700193263434252*^9, 3.7001932658873053`*^9}, {3.700193626506886*^9, 
   3.7001936472247267`*^9}, {3.710167377821026*^9, 3.710167455740281*^9}, {
   3.710167488782382*^9, 3.710167544185527*^9}, {3.7101675766320744`*^9, 
   3.71016779169396*^9}, {3.7101743444567347`*^9, 3.710174457922573*^9}, {
   3.710174497731461*^9, 3.710174497935245*^9}, {3.710174985080303*^9, 
   3.7101750004633512`*^9}, {3.7101750565667887`*^9, 3.710175075940596*^9}, {
   3.710175112120502*^9, 3.710175138438758*^9}, {3.7101752067152977`*^9, 
   3.7101753418464603`*^9}, {3.710175423096917*^9, 3.7101754277183237`*^9}, {
   3.7101754947001667`*^9, 3.710175499701354*^9}, 
   3.718335482813716*^9},ExpressionUUID->"9d019fee-4b52-41d8-ba37-\
e81ebbf2d34a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AtomsetPartialCharges", "/:", "\n", "\t", 
   RowBox[{"Unset", "[", 
    RowBox[{"AtomsetPartialCharges", "[", 
     RowBox[{"obj", ":", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{"MatchQ", "[", "ChemObjPattern", "]"}], ")"}]}]}], "]"}], 
    "]"}], ":=", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{
      RowBox[{"AtomPartialCharge", "[", "g", "]"}], "=."}]}], "\n", "\t\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetPartialCharges", "/:", "\n", "\t", 
   RowBox[{"Set", "[", 
    RowBox[{
     RowBox[{"AtomsetPartialCharges", "[", 
      RowBox[{"obj", ":", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"MatchQ", "[", "ChemObjPattern", "]"}], ")"}]}]}], "]"}], 
     ",", "v_List"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "v", "]"}], "===", 
        RowBox[{"Length", "[", "g", "]"}]}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"AtomPartialCharge", "[", "g", "]"}], "=", "v"}], ",", "\n", 
       "\t\t\t\t", "$Failed"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetPartialCharges", "/:", "\n", "\t", 
   RowBox[{"SetDelayed", "[", 
    RowBox[{
     RowBox[{"AtomsetPartialCharges", "[", 
      RowBox[{"obj", ":", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{"MatchQ", "[", "ChemObjPattern", "]"}], ")"}]}]}], "]"}], 
     ",", "v_List"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", "=", 
       RowBox[{"ChemGet", "[", 
        RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Unevaluated", "[", "v", "]"}], "]"}], "===", 
        RowBox[{"Length", "[", "g", "]"}]}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"AtomPartialCharge", "[", "g", "]"}], ":=", "v"}], ",", "\n", 
       "\t\t\t\t", "$Failed"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{"AtomsetPartialCharges", "/:", "\n", "\t", 
  RowBox[{"SetDelayed", "[", 
   RowBox[{
    RowBox[{"AtomsetPartialCharges", "[", 
     RowBox[{"obj", ":", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{"MatchQ", "[", "ChemObjPattern", "]"}], ")"}]}]}], "]"}], ",",
     "v_"}], "]"}], ":=", "\n", "\t\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", "=", 
      RowBox[{"ChemGet", "[", 
       RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], ",", "\n", 
    "\t\t\t", 
    RowBox[{
     RowBox[{"AtomPartialCharge", "[", "g", "]"}], ":=", "v"}]}], "\n", 
   "\t\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.710174536925229*^9, 3.7101746603343363`*^9}, {
  3.710174706041024*^9, 3.710174744615582*^9}, {3.7183354828268538`*^9, 
  3.718335482844407*^9}},ExpressionUUID->"5a31f2df-4b79-4b94-875e-\
6688a94561a9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ElectricPotential\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694894829093796*^9, 
  3.69489483307681*^9}},ExpressionUUID->"6aa8150c-71d6-4625-8752-\
8f81cabf7ec2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetElectricPotential", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Cached\>\""}], "\n", "\t\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetElectricPotential", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"mode", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t", 
           RowBox[{"s_String", "\[RuleDelayed]", 
            RowBox[{"(", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ToUpperCase", "@", 
               RowBox[{"StringTake", "[", 
                RowBox[{"s", ",", "1"}], "]"}]}], "<>", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToLowerCase", "@", 
               RowBox[{"StringTake", "[", 
                RowBox[{"s", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "\n", "\t", 
             "\t\t\t\t", ")"}]}], "]"}], "@", 
          RowBox[{"OptionValue", "[", "\"\<Mode\>\"", "]"}]}], ",", "\n", 
         "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Except", "[", 
           RowBox[{
           "\"\<Cached\>\"", "|", "\"\<Gasteiger\>\"", "|", "\"\<Psi4\>\""}], 
           "]"}], "\[Rule]", "\"\<Cached\>\""}]}], "\n", "\t\t\t\t", "]"}]}], 
      "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Switch", "[", "\n", "\t\t\t", 
      RowBox[{
      "mode", ",", "\n", "\t", "\t\t", "\"\<Psi4\>\"", ",", "\n", "\t", 
       "\t\t\t", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$CubeFileCacheDepth", "=", "\[Infinity]"}], "}"}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{"esp", "=", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"$Psi4", "@", 
              RowBox[{"Psi4CubeElectrostaticPotential", "[", 
               RowBox[{"AtomsetElementPositions", "@", "obj"}], "]"}]}]}], 
            "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"CubeFileFunction", "@", 
            RowBox[{"CubeFileRead", "[", 
             RowBox[{"esp", "[", "\"\<ESP.cube\>\"", "]"}], "]"}]}]}], "\n", 
          "\t", "\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t", "]"}], ",", 
       "\n", "\t", "\t\t", "_", ",", "\n", "\t", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"AtomsetPartialCharges", "[", 
          RowBox[{"obj", ",", "mode"}], "]"}], ",", "\n", "\t", "\t", "\t", 
         "\t\t", 
         RowBox[{"c_List", ":>", "\n", "\t", "\t", "\t", "\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k", "=", "8.9875517873681764*^9"}], "}"}], ",", "\n", 
            "\t", "\t\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"charges", "=", 
                 RowBox[{"c", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
                RowBox[{"points", "=", 
                 RowBox[{"c", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
              "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t", 
              RowBox[{"Compile", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
                "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                RowBox[{
                "Total", "@", "\n", "\t", "\t", "\t", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{
                 "MapThread", "[", "\n", "\t", "\t", "\t", "\t", "\t", 
                  "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"k", "*", 
                    RowBox[{"#2", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Norm", "@", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "#"}], ")"}]}], "+", 
                    RowBox[{"10.", "^", 
                    RowBox[{"-", "15"}]}]}], ")"}]}]}], "&"}], ",", "\n", 
                   "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"points", ",", "charges"}], "}"}]}], "]"}]}]}], 
               "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", "]"}]}], "\n", 
             "\t", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t\t", 
           "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694894834143717*^9, 3.6948949156773033`*^9}, {
   3.700106794929763*^9, 3.7001068027432537`*^9}, {3.700193656952236*^9, 
   3.700193684783011*^9}, {3.700194350204685*^9, 3.700194393140081*^9}, {
   3.710175351197792*^9, 3.710175360069203*^9}, {3.710175510909684*^9, 
   3.710175515416931*^9}, {3.710204363508816*^9, 3.7102044378437777`*^9}, {
   3.710204510667779*^9, 3.710204538161672*^9}, {3.710204814292617*^9, 
   3.710204828634861*^9}, 3.710213535191492*^9, {3.710246335651148*^9, 
   3.710246469923723*^9}, {3.710282963973399*^9, 3.710282964636149*^9}, 
   3.718335482859807*^9},ExpressionUUID->"ef002e59-76a4-45fe-b599-\
d3591b624976"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ElectricPotentialMap\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694895264615986*^9, 
  3.694895267865209*^9}},ExpressionUUID->"76502319-51c7-4b6f-9d58-\
20cf00057dd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetElectricPotentialMap", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "ChemSurfacePlot"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "AtomsetElectricPotential", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetElectricPotentialMap", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"AtomsetElectricPotential", "[", 
      RowBox[{"obj", ",", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "[", "AtomsetElectricPotential", "]"}]}], "]"}]}],
       "\n", "\t\t\t", "]"}], ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"f_CompiledFunction", ":>", "\n", "\t\t\t", 
       RowBox[{"ChemSurfacePlot", "[", "\n", "\t\t\t\t", 
        RowBox[{
        "f", ",", "\n", "\t\t\t\t", "obj", ",", "\n", "\t\t\t\t", "ops", ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"ColorFunction", "\[Rule]", "\n", "\t\t\t\t\t", 
          RowBox[{"ColorData", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<DarkRainbow\>\"", ",", "\"\<Reverse\>\""}], 
            "}"}]}]}]}], "\n", "\t", "\t\t\t", "]"}]}], "\n", "\t\t", "}"}]}],
     "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694895266030457*^9, 3.694895364543195*^9}, {
   3.694895411021677*^9, 3.694895449673772*^9}, {3.6948955710517387`*^9, 
   3.6948955742006617`*^9}, {3.694895635155327*^9, 3.694895640405698*^9}, {
   3.694895708358149*^9, 3.694895709228119*^9}, {3.7001068082796907`*^9, 
   3.70010684471805*^9}, {3.7001095383903227`*^9, 3.700109539215003*^9}, {
   3.700193728015315*^9, 3.700193776924775*^9}, {3.701106848064748*^9, 
   3.701106851334194*^9}, {3.7101753665828047`*^9, 3.710175373844226*^9}, {
   3.710175527539166*^9, 3.710175529131216*^9}, 3.7102045700518827`*^9, {
   3.7102995124804077`*^9, 3.7102995438150043`*^9}, {3.710299586125054*^9, 
   3.71029959296662*^9}, 3.718335482871274*^9, 
   3.725663311179656*^9},ExpressionUUID->"6c25bca3-6f38-4ead-bce0-\
4528f0ba765e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PolarMoment\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6924755716099873`*^9, 3.692475586996117*^9}, {
  3.69257650429424*^9, 
  3.692576553083346*^9}},ExpressionUUID->"d16afac8-0c0c-4b0b-943a-\
af03b4506639"],

Cell["\<\
Rough measure of polarization of collection of atoms at a point (defaults to \
COM)\
\>", "Text",
 CellChangeTimes->{{3.692492881120756*^9, 3.6924928924785223`*^9}, {
  3.692572892798613*^9, 3.692572897909573*^9}, {3.692572973744462*^9, 
  3.692572974095788*^9}},ExpressionUUID->"c515625e-cb97-4eaa-a2db-\
c61af3df0b9c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"AtomsetPolarMoment", "[", 
     RowBox[{"system_String", ",", "id_", ",", "\n", "\t", 
      RowBox[{"point", ":", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], "|", "\"\<Center\>\"", 
        "|", "\"\<CenterOfMass\>\"", "|", "Function"}], ":", 
       "\"\<CenterOfMass\>\""}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"atoms", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"system", ",", "id", ",", "\"\<Atoms\>\""}], "]"}]}], "}"}], 
      ",", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"positions", "=", 
           RowBox[{
            RowBox[{"ChemGet", "[", "\"\<Position\>\"", "]"}], "/@", 
            "atoms"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"ens", "=", 
           RowBox[{
            RowBox[{"ChemGet", "[", "\"\<Electronegativity\>\"", "]"}], "/@", 
            "atoms"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"point", "===", "Function"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"center", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"ens", "*", "\n", "\t\t\t\t\t", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"v", "=", 
                    RowBox[{"Subtract", "[", 
                    RowBox[{"#", ",", "center"}], "]"}]}], "}"}], ",", 
                   RowBox[{"v", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"Norm", "@", "v"}]}], ")"}], "^", "2"}], 
                    ")"}]}]}], "]"}], "&"}], ",", "\n", "\t\t\t\t\t\t", 
                "positions"}], "]"}]}], "//", "Total"}]}], "\n", "\t\t\t\t\t",
            "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"center", "=", "\n", "\t\t\t\t\t", 
              RowBox[{"Switch", "[", 
               RowBox[{
               "point", ",", "\n", "\t\t\t\t\t\t", "\"\<Center\>\"", ",", 
                "\n", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"Mean", "@", "positions"}], ",", "\n", "\t", "\t", 
                "\t\t\t\t", "\"\<CenterOfMass\>\"", ",", "\n", "\t", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"Mean", "@", 
                 RowBox[{"WeightedData", "[", 
                  RowBox[{"positions", ",", 
                   RowBox[{
                    RowBox[{"QuantityMagnitude", "@*", 
                    RowBox[{"ChemGet", "[", "\"\<Mass\>\"", "]"}]}], "/@", 
                    "atoms"}]}], "]"}]}], ",", "\n", "\t", "\t", "\t\t\t\t", 
                "_", ",", "\n", "\t", "\t", "\t\t\t\t\t", "point"}], "\n", 
               "\t", "\t", "\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t", "\t", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"ens", "*", "\n", "\t", "\t", "\t\t\t\t", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"v", "=", 
                    RowBox[{"Subtract", "[", 
                    RowBox[{"#", ",", "center"}], "]"}]}], "}"}], ",", 
                   RowBox[{"v", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"Norm", "@", "v"}]}], ")"}], "^", "2"}], 
                    ")"}]}]}], "]"}], "&"}], ",", "\n", "\t", "\t", 
                "\t\t\t\t\t", "positions"}], "]"}]}], "//", "Total"}]}], "\n",
            "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
       "]"}]}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"AtomsetPolarMoment", "[", 
     RowBox[{
      RowBox[{"ChemObject", "[", 
       RowBox[{"system_", ",", "id_"}], "]"}], ",", "s___"}], "]"}], ":=", 
    "\n", "\t", 
    RowBox[{"AtomsetPolarMoment", "[", 
     RowBox[{"system", ",", "id", ",", "s"}], "]"}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.692492254967635*^9, 3.692492330250573*^9}, {
  3.692492571847786*^9, 3.692492637117793*^9}, {3.692492798717708*^9, 
  3.692492828845169*^9}, {3.692568615816206*^9, 3.692568618704843*^9}, {
  3.692568782572028*^9, 3.692568804008668*^9}, {3.692568854350128*^9, 
  3.69256885875204*^9}, {3.6925689732995577`*^9, 3.6925690499701147`*^9}, {
  3.692572489823093*^9, 3.692572505779274*^9}, {3.692572878256929*^9, 
  3.692572939097375*^9}, {3.692572969298194*^9, 3.692573156164439*^9}, {
  3.692573282245726*^9, 3.692573288045229*^9}, {3.692573326678857*^9, 
  3.6925733505058823`*^9}, {3.692573394447908*^9, 3.692573396599392*^9}, {
  3.692573453988967*^9, 3.692573484213372*^9}, {3.6925766264329576`*^9, 
  3.692576629400814*^9}, {3.692592680155119*^9, 3.692592693483103*^9}, {
  3.692592730322384*^9, 3.692592814087249*^9}, {3.692593860255066*^9, 
  3.692593874606909*^9}},ExpressionUUID->"a0d3b290-4b4e-4b39-a288-\
0e446b70c321"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PolarCenter\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6925751991740713`*^9, 
  3.692575200949272*^9}},ExpressionUUID->"1d628739-ddac-4fdf-a5dd-\
10786b594df8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"AtomsetPolarCenter", "[", 
     RowBox[{"system_String", ",", "id_", ",", "\n", "\t", 
      RowBox[{"testPoint", ":", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", "\"\<Center\>\"", 
        "|", "\"\<CenterOfMass\>\""}], ":", "\"\<Center\>\""}], ",", "\n", 
      "\t", 
      RowBox[{"steps_Integer:", "100"}], ",", "\n", "\t", 
      RowBox[{"convergence_Real:", ".1"}]}], "\n", "\t", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"pt", "=", "\n", "\t\t\t", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "testPoint", ",", "\n", "\t", "\t\t\t", "\"\<Center\>\"", ",", "\n",
            "\t", "\t\t\t\t", 
           RowBox[{"AtomsetCenter", "[", 
            RowBox[{"system", ",", "id"}], "]"}], ",", "\n", "\t", "\t\t\t", 
           "\"\<CenterOfMass\>\"", ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"AtomsetCenterOfMass", "[", 
            RowBox[{"system", ",", "id"}], "]"}], ",", "\n", "\t", "\t\t\t", 
           "_", ",", "\n", "\t", "\t\t\t\t", "testPoint"}], "\n", "\t\t\t\t", 
          "]"}]}], ",", "\n", "\t\t", 
        RowBox[{"pf", "=", 
         RowBox[{"AtomsetPolarMoment", "[", 
          RowBox[{"system", ",", "id", ",", "Function"}], "]"}]}]}], "\n", 
       "\t\t", "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"FixedPoint", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "+", 
          RowBox[{"convergence", "*", 
           RowBox[{"Normalize", "@", 
            RowBox[{"pf", "[", "#", "]"}]}]}]}], "&"}], ",", "\n", "\t\t\t\t",
         "pt", ",", "\n", "\t\t\t\t", "steps", ",", "\n", "\t\t\t\t", 
        RowBox[{"SameTest", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"(", 
              RowBox[{"#2", "-", "#"}], ")"}], "]"}], "<", "convergence"}], 
           "&"}], ")"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}],
    ";", "\n", 
   RowBox[{
    RowBox[{"AtomsetPolarCenter", "[", 
     RowBox[{
      RowBox[{"ChemObject", "[", 
       RowBox[{"system_", ",", "id_"}], "]"}], ",", "a___"}], "]"}], ":=", 
    "\n", "\t", 
    RowBox[{"AtomsetPolarCenter", "[", 
     RowBox[{"system", ",", "id", ",", "a"}], "]"}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.69257520644263*^9, 3.692575260711412*^9}, {
  3.6925753116547956`*^9, 3.692575700998825*^9}, {3.692576691102207*^9, 
  3.692576691669433*^9}, {3.692582321000876*^9, 3.692582344369005*^9}, {
  3.692582390332086*^9, 3.692582480132944*^9}, {3.692582585302394*^9, 
  3.692582614308893*^9}, {3.6925928340955477`*^9, 3.692592868755987*^9}, {
  3.692592915655676*^9, 
  3.6925929324617853`*^9}},ExpressionUUID->"974a29d6-718d-4f4f-a7df-\
b5a2709d15a6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PolarMomentPlot\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6925964464889383`*^9, 
  3.69259645204816*^9}},ExpressionUUID->"a5a59ebf-ec1a-4ceb-bc53-\
917235ed723f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"AtomsetPolarMomentPlot", "[", 
     RowBox[{"system_", ",", "id_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Show", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"ChemSurfacePlot", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"AtomsetVdWSurface", "[", 
         RowBox[{"system", ",", "id"}], "]"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"Norm", "@*", 
         RowBox[{"AtomsetPolarMoment", "[", 
          RowBox[{"system", ",", "id", ",", "Function"}], "]"}]}], ",", "\n", 
        "\t\t\t", "Mean", ",", "\n", "\t\t\t", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Hue", "[", 
             RowBox[{".8", "*", "#"}], "]"}], ",", 
            RowBox[{"Opacity", "[", ".8", "]"}]}], "}"}], "&"}], ")"}]}], 
       "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
      RowBox[{"ChemView", "[", 
       RowBox[{"system", ",", "id"}], "]"}]}], "\n", "\t\t", "]"}]}], ";", 
   "\n", 
   RowBox[{
    RowBox[{"AtomsetPolarMomentPlot", "[", 
     RowBox[{"ChemObject", "[", 
      RowBox[{"system_", ",", "id_"}], "]"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"AtomsetPolarMomentPlot", "[", 
     RowBox[{"system", ",", "id"}], "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.692596452925611*^9, 3.692596500502515*^9}, 
   3.692596587641595*^9, {3.6925969358376417`*^9, 3.692597048968712*^9}, {
   3.6925970866489687`*^9, 3.692597114595859*^9}, {3.692614633810549*^9, 
   3.6926146381269283`*^9}, {3.692616775361823*^9, 
   3.692616789066401*^9}},ExpressionUUID->"75e72665-d8cf-491c-b834-\
39aa7aa1ff6b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Polarization\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.692576643572781*^9, 
  3.692576646204487*^9}},ExpressionUUID->"d3346ea1-09d4-46f1-b589-\
b3dd806a657e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"AtomsetPolarization", "[", 
     RowBox[{"system_", ",", "id_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", "=", 
        RowBox[{"AtomsetCenter", "[", 
         RowBox[{"system", ",", "id"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"AtomsetPolarCenter", "[", 
        RowBox[{"system", ",", "id"}], "]"}], "-", "c"}]}], "\n", "\t\t", 
     "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"AtomsetPolarization", "[", 
     RowBox[{"ChemObject", "[", 
      RowBox[{"system_", ",", "id_"}], "]"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"AtomsetPolarization", "[", 
     RowBox[{"system", ",", "id"}], "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.692576646946096*^9, 
  3.692576717276829*^9}},ExpressionUUID->"0279a8a7-35e9-4630-8909-\
7c8374c493b8"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset QChem\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.710213438338729*^9, 
  3.710213443505438*^9}},ExpressionUUID->"b68787f2-1b08-4f18-83b2-\
6dd2243ed156"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Options", "[", "AtomsetPsi4Call", "]"}], "=", 
      RowBox[{"{", "\n", "\t", 
       RowBox[{"\"\<Function\>\"", "\[Rule]", "Automatic"}], "\n", "\t", 
       "}"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"AtomsetPsi4Scan", "[", "\n", "\t", 
       RowBox[{
        RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
        RowBox[{"specs", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ChemObjPattern", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"_List", "|", "_Integer"}], ")"}]}], ")"}], ".."}], 
          "}"}]}], ",", "\n", "\t", 
        RowBox[{"ops", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
      "Psi4ConfigureCall"}]}], "\n", "\t\t", "\n", "\t\t", ")"}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.7110660645115356`*^9, 3.711066073551839*^9}, {
  3.711066117960511*^9, 3.711066261004668*^9}, {3.7110663199605293`*^9, 
  3.711066333013921*^9}, {3.711066406732831*^9, 3.711066408769967*^9}, {
  3.718335482886116*^9, 
  3.718335482890511*^9}},ExpressionUUID->"57debf2e-ce13-4668-83b0-\
e00bb35b3528"],

Cell[CellGroupData[{

Cell["Orbitals", "CodeSubsubsection",
 CellChangeTimes->{{3.710214017553639*^9, 
  3.7102140205523148`*^9}},ExpressionUUID->"a75daa97-e054-4a5b-adb7-\
f1e42451e9cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetOrbitals", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Mode\>\"", "\[Rule]", "\"\<Psi4\>\""}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Orbitals\>\"", "\[Rule]", "All"}]}], "\n", "\t\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetOrbitals", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"mode", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t", 
            RowBox[{"s_String", "\[RuleDelayed]", 
             RowBox[{"(", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"ToUpperCase", "@", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"s", ",", "1"}], "]"}]}], "<>", "\n", "\t", 
               "\t\t\t\t\t\t", 
               RowBox[{"ToLowerCase", "@", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"s", ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "\n", "\t", 
              "\t\t\t\t", ")"}]}], "]"}], "@", 
           RowBox[{"OptionValue", "[", "\"\<Mode\>\"", "]"}]}], ",", "\n", 
          "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"\"\<Cached\>\"", "|", "\"\<Psi4\>\""}], "]"}], 
           "\[Rule]", "\"\<Psi4\>\""}]}], "\n", "\t\t\t\t", "]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{"which", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Orbitals\>\"", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_Span", "|", "_Integer", "|", "_String", "|", 
             RowBox[{"{", "__Integer", "}"}], "|", 
             RowBox[{"{", "__String", "}"}]}], "]"}], "\[Rule]", "All"}]}], 
         "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "mode", ",", "\n", "\t\t", "\"\<Cached\>\"", ",", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"orbitals", "=", "\n", "\t\t\t\t", 
           RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"ChemGet", "[", 
              RowBox[{"obj", ",", "\"\<Orbitals\>\""}], "]"}], ",", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Except", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"KeyValuePattern", "[", 
                 RowBox[{"{", 
                  RowBox[{"_", "\[Rule]", "_CompiledFunction"}], "}"}], "]"}],
                 "|", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"{", "__CompiledFunction", "}"}]}], "\n", 
               "\t\t\t\t\t\t", "]"}], ":>", "\n", "\t\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"orbs", "=", 
                  RowBox[{"AtomsetOrbitals", "[", "obj", "]"}]}], "}"}], ",", 
                "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"ChemSet", "[", 
                  RowBox[{"obj", ",", "\"\<Orbitals\>\"", ",", "orbs"}], 
                  "]"}], ";", "\n", "\t\t\t\t\t\t\t", "orbs"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n",
           "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "which", ",", "\n", "\t\t\t\t\t", "All", ",", "\n", "\t\t\t\t\t\t", 
           "orbitals", ",", "\n", "\t\t\t\t\t", "_Integer", ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"orbitals", "[", 
            RowBox[{"[", 
             RowBox[{"Range", "[", "which", "]"}], "]"}], "]"}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "__Integer", "}"}], "|", "_Span"}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"orbitals", "[", 
            RowBox[{"[", "which", "]"}], "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"_String", "|", 
            RowBox[{"{", "__String", "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"{", "which", "}"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{"orbitals", ",", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "which", "}"}]}]}], "]"}]}], "]"}], ",", "\n", 
           "\t\t\t\t\t", "_", ",", "\n", "\t\t\t\t\t\t", "$Failed"}], "\n", 
          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t", 
       "\"\<Psi4\>\"", ",", "\n", "\t\t\t", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$CubeFileCacheDepth", "=", "\[Infinity]"}], "}"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{"cube", "=", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"KeyMap", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"StringRiffle", "@", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"ToUpperCase", "@", 
                  RowBox[{"Rest", "@", 
                   RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{"#", ",", "\"\<.cube\>\""}], "]"}], ",", 
                    "\"\<_\>\""}], "]"}]}]}]}], "&"}], "\n", "\t", "\t", 
               "\t\t\t\t\t", "]"}], "@", "\n", "\t", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{"$Psi4", "[", 
                RowBox[{"Psi4CubeOrbitals", "[", 
                 RowBox[{"AtomsetElementPositions", "@", "obj"}], "]"}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "\"\<OutputFiles\>\""}], "]"}], "]"}]}]}], 
            "\n", "\t", "\t", "\t\t\t", "}"}], ",", "\n", "\t", "\t", 
           "\t\t\t", 
           RowBox[{
            RowBox[{"CubeFileFunction", "@*", "CubeFileRead"}], "/@", "\n", 
            "\t", "\t", "\t\t\t\t", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "which", ",", "\n", "\t", "\t", "\t\t\t\t\t", "All", ",", "\n", 
              "\t", "\t", "\t\t\t\t\t\t", "cube", ",", "\n", "\t\t\t\t\t\t\t",
               "_Integer", ",", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"cube", "[", 
               RowBox[{"[", 
                RowBox[{"Range", "[", "which", "]"}], "]"}], "]"}], ",", "\n",
               "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", "__Integer", "}"}], "|", "_Span"}], ",", "\n", 
              "\t\t\t\t\t\t\t\t", 
              RowBox[{"cube", "[", 
               RowBox[{"[", "which", "]"}], "]"}], ",", "\n", "\t", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"_String", "|", 
               RowBox[{"{", "__String", "}"}]}], ",", "\n", "\t", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", "which", "}"}]}], ",", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"cube", ",", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", "which", "}"}]}]}], "]"}]}], "]"}], ",", "\n",
               "\t", "\t", "\t\t\t\t\t", "_", ",", "\n", "\t", "\t", 
              "\t\t\t\t\t\t", "$Failed"}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], 
          "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.710213445483356*^9, 3.710213514530851*^9}, {
   3.710213573248576*^9, 3.710213610639718*^9}, {3.710213701437958*^9, 
   3.710214024449505*^9}, {3.710214802819723*^9, 3.71021480518437*^9}, {
   3.7102463077559223`*^9, 3.710246329492275*^9}, {3.7102464786535397`*^9, 
   3.710246649315786*^9}, {3.710246685063121*^9, 3.710246813555718*^9}, {
   3.710246921154448*^9, 3.7102469925573807`*^9}, 3.710247428286874*^9, 
   3.710249104161895*^9, {3.710249208992942*^9, 3.710249209526417*^9}, {
   3.710249240945904*^9, 3.710249243751007*^9}, {3.7102829250051327`*^9, 
   3.710282958525249*^9}, {3.710283244238452*^9, 3.710283295358428*^9}, {
   3.710283357481372*^9, 3.710283383029751*^9}, {3.710283770564888*^9, 
   3.710283813606172*^9}, {3.7102841874193687`*^9, 3.710284208329713*^9}, {
   3.71028452910892*^9, 3.710284554905869*^9}, {3.710285484210083*^9, 
   3.7102855299349403`*^9}, {3.7102855648219957`*^9, 3.710285576421444*^9}, 
   3.7183354829079523`*^9},ExpressionUUID->"0f849116-964b-452a-9394-\
66a1bb8e303d"]
}, Closed]],

Cell[CellGroupData[{

Cell["OrbitalsPlot", "CodeSubsubsection",
 CellChangeTimes->{{3.710214017553639*^9, 
  3.710214026888075*^9}},ExpressionUUID->"8d1066bb-aae2-460f-9903-\
1cb5726cf103"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetOrbitalsPlot", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "AtomsetOrbitals", "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<PlotFunction\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"\"\<ShowFunction\>\"", "\[Rule]", "Show"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Quiet", "\[Rule]", "True"}]}], "\n", "\t\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{"\"\<OpacityFunction\>\"", "->", "\n", "\t\t\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], ")"}]}], "\n", "\t\t\t", 
        "}"}], ","}], "*)"}], "\n", "\t\t", 
     RowBox[{"Options", "[", "DensityPlot3D", "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Contours", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".0005"}], ",", ".0005"}], "}"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"ContourStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", "Red"}], "}"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"Lighting", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<Ambient\>\"", ",", 
           RowBox[{"GrayLevel", "[", ".95", "]"}]}], "}"}], "}"}]}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"MeshStyle", "\[Rule]", 
        RowBox[{"GrayLevel", "[", 
         RowBox[{".5", ",", ".5"}], "]"}]}]}], "\n", "\t\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"Options", "[", "ContourPlot3D", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetOrbitalsPlot", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"orbs", ":", 
      RowBox[{"{", "__CompiledFunction", "}"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plotf", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<PlotFunction\>\"", "]"}], ",", 
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Density\>\"", "\[Rule]", "DensityPlot3D"}], ",", "\n",
            "\t\t\t", 
           RowBox[{"\"\<Lobes\>\"", "\[Rule]", "ContourPlot3D"}], ",", "\n", 
           "\t\t\t", 
           RowBox[{
            RowBox[{"Except", "[", 
             RowBox[{"DensityPlot3D", "|", "ContourPlot3D"}], "]"}], "->", 
            "ContourPlot3D"}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], "\n", 
      "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<ShowFunction\>\"", "]"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<GIF\>\"", "->", "\n", "\t\t\t\t\t\t", 
             RowBox[{"(", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"ListAnimate", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Rasterize", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"wfn", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageResolution", "\[Rule]", "120"}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{"wfn", ",", "1", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "-", "1"}]}], "}"}]}], 
                 "\n", "\t\t\t\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}], "&"}], "\n", "\t\t\t\t\t\t\t", ")"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Manipulate", "\[Rule]", 
             RowBox[{"(", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Manipulate", "[", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Show", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"wfn", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
                 "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"wfn", ",", "1", ",", "\"\<\[Psi]\>\""}], "}"}], 
                   ",", "1", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "-", "1"}], ",", "1"}],
                   "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], "&"}], "\n", 
              "\t\t\t\t\t\t", ")"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"List", "->", "\n", "\t\t\t\t\t\t", 
             RowBox[{"(", "Rest", ")"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], 
         "]"}], "@", "\n", "\t\t\t\t\t", 
        RowBox[{"Prepend", "[", "\n", "\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"Null", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "[", "Quiet", "]"}], "//", "TrueQ"}],
                  ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"CompiledFunction", "::", "cfta"}]}], "]"}], ",", 
                 "\n", "\t\t\t\t\t\t\t\t", "#"}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t", "HoldAllComplete"}], "\n",
               "\t\t\t\t\t\t\t", "]"}], "@", "\n", "\t\t\t\t\t\t", 
             RowBox[{"plotf", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], ",", "\n", 
               "\t", "\t", "\t\t\t\t\t", 
               RowBox[{"Evaluate", "[", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                "Sequence", "@@", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{
                 "MapThread", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "#2"}], "]"}], "&"}], ",", 
                   RowBox[{
                   "{", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"FirstCase", "[", 
                    RowBox[{
                    "#", ",", "_InterpolatingFunction", ",", "None", ",", 
                    "\[Infinity]"}], "]"}]}], ",", "\n", "\t", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "\n", "\t", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t", "}"}]}], "\n", "\t", 
                  "\t", "\t", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t", 
                "\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{"Evaluate", "@", 
                RowBox[{
                "FilterRules", "[", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", 
                    RowBox[{"ops", ",", 
                    RowBox[{"Options", "[", "AtomsetOrbitalsPlot", "]"}]}], 
                    "}"}]}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"Options", "[", "plotf", "]"}]}], "\n", "\t", "\t", 
                 "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t", 
              "]"}]}], "&"}], "/@", "orbs"}], ",", "\n", "\t", "\t", "\t", 
          "\t\t\t", 
          RowBox[{"ChemView", "[", "obj", "]"}]}], "\n", "\t", "\t\t\t\t\t", 
         "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetOrbitalsPlot", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", "a_Association",
      ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plot", "=", 
       RowBox[{"AtomsetOrbitalsPlot", "[", 
        RowBox[{"obj", ",", 
         RowBox[{"Values", "[", "a", "]"}], ",", "ops"}], "]"}]}], "}"}], ",",
      "\n", "\t\t", 
     RowBox[{"plot", "/;", 
      RowBox[{
       RowBox[{"Head", "[", "plot", "]"}], "=!=", "AtomsetOrbitalsPlot"}]}]}],
     "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetOrbitalsPlot", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"AtomsetOrbitalsPlot", "[", 
   RowBox[{"obj", ",", "\n", "\t\t", 
    RowBox[{"Values", "@", "\n", "\t\t\t", 
     RowBox[{"AtomsetOrbitals", "[", 
      RowBox[{"obj", ",", "\n", "\t\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "[", "AtomsetOrbitals", "]"}]}], "]"}]}], "]"}]}],
     ",", "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.710213445483356*^9, 3.710213514530851*^9}, {
   3.710213573248576*^9, 3.710213610639718*^9}, {3.710213701437958*^9, 
   3.710214050096055*^9}, {3.7102143514113483`*^9, 3.710214365991274*^9}, {
   3.710214578383912*^9, 3.7102146007354193`*^9}, {3.710214635037517*^9, 
   3.7102147126045218`*^9}, {3.7102148804033957`*^9, 3.710214953348359*^9}, {
   3.7102150712535667`*^9, 3.710215077898883*^9}, {3.710245536809041*^9, 
   3.710245618085334*^9}, {3.7102461972736597`*^9, 3.710246254335525*^9}, {
   3.71024681857373*^9, 3.710246916000992*^9}, {3.710247004819442*^9, 
   3.710247024825588*^9}, {3.710249536550316*^9, 3.710249665744337*^9}, {
   3.7102497106695633`*^9, 3.710249719695982*^9}, {3.710249784818622*^9, 
   3.710249845417994*^9}, {3.710250112583572*^9, 3.710250368223722*^9}, {
   3.710250602724021*^9, 3.7102506760632677`*^9}, {3.710250833995061*^9, 
   3.7102509595653143`*^9}, {3.710251587968535*^9, 3.710251679345673*^9}, {
   3.710251873895142*^9, 3.7102518752432013`*^9}, {3.7102833317470407`*^9, 
   3.71028334709303*^9}, {3.710284786285763*^9, 3.7102848507332783`*^9}, {
   3.710287329927342*^9, 3.710287342865828*^9}, 3.710287402527458*^9, {
   3.710287464269308*^9, 3.710287465562264*^9}, {3.710287569505982*^9, 
   3.7102875739658117`*^9}, {3.710289166912362*^9, 3.710289191193125*^9}, {
   3.710299093065164*^9, 3.7102991037575083`*^9}, {3.7183354829270687`*^9, 
   3.718335482939372*^9}},ExpressionUUID->"030178be-e8b5-4c05-ac57-\
918a1b0cb889"]
}, Closed]],

Cell[CellGroupData[{

Cell["Psi4Scan", "CodeSubsubsection",
 CellChangeTimes->{{3.711066062072016*^9, 
  3.711066063702971*^9}},ExpressionUUID->"0e718a5d-7f22-4458-a9e5-\
511413a01949"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetPsi4Scan", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Function\>\"", "\[Rule]", "Automatic"}], ",", "\n", "\t", 
       "\t", "\t", 
       RowBox[{"\"\<Configuration\>\"", "\[Rule]", "Automatic"}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "Psi4Scan", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetPsi4Scan", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"specs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ChemObjPattern", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], ")"}],
         ".."}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"atoms", "=", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"apos", "=", 
        RowBox[{"AtomsetElementPositions", "[", "obj", "]"}]}], ",", "\n", 
       "\t\t", "scans"}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"scans", "=", "\n", "\t\t\t", 
       RowBox[{"DeleteCases", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FirstPosition", "[", 
             RowBox[{"atoms", ",", 
              RowBox[{"First", "[", "#", "]"}], ",", "None"}], "]"}], 
            "\[Rule]", 
            RowBox[{"Last", "[", "#", "]"}]}], "&"}], "/@", "specs"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"None", "\[Rule]", "_"}]}], "\n", "\t\t\t\t", "]"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"apos", "=", "\n", "\t\t\t", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"apos", ",", "\n", "\t\t\t\t", 
         RowBox[{"MapIndexed", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", "2"}], "]"}], "->", 
             "\n", "\t\t\t\t\t\t", 
             RowBox[{"StringJoin", "/@", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
                  "}"}], ",", 
                 RowBox[{"ToString", "@", 
                  RowBox[{"First", "@", "#2"}]}]}], "}"}], "]"}]}]}], "&"}], 
           ",", "\n", "\t\t\t\t\t", "scans"}], "\n", "\t\t\t\t\t", "]"}]}], 
        "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Psi4Scan", "[", "\n", "\t\t\t", 
       RowBox[{"<|", "\n", "\t\t\t\t", 
        RowBox[{"ops", ",", "\n", "\t\t\t\t", 
         RowBox[{"\"\<Molecules\>\"", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{"\"\<mol\>\"", "->", "apos"}], ")"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"\"\<Scan\>\"", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"MapIndexed", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<pos_\>\"", "<>", 
                RowBox[{"ToString", "@", 
                 RowBox[{"First", "@", "#2"}]}]}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "}"}], "&"}], ",", "\n", 
            "\t\t\t\t\t\t", "scans"}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"\"\<Configuration\>\"", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<Configuration\>\"", "]"}], ",", 
            "\n", "\t\t\t\t\t\t", 
            RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"<|", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"\"\<basis\>\"", "\[Rule]", "\"\<cc-pvdz\>\""}], ",", 
               "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"\"\<scf_type\>\"", "\[Rule]", "\"\<pk\>\""}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "|>"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"\"\<Function\>\"", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"f", "=", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"ToSymbolicPython", "@", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "[", "\"\<Function\>\"", "]"}], ",", 
                  "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"Automatic", "\[RuleDelayed]", 
                   RowBox[{
                    RowBox[{"PyCall", "[", "\"\<energy\>\"", "]"}], "[", 
                    RowBox[{"PyString", "@", "\"\<scf\>\""}], "]"}]}]}], "\n",
                  "\t\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t\t\t\t", 
              
              RowBox[{"blocks", "=", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "StringTemplate", "[", 
                  "\"\<mol.x`1`, mol.y`1`, mol.z`1` = pos_`1`\>\"", "]"}], 
                 ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "@", "scans"}]}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t", "}"}], 
            ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"PyColumn", "@", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Append", "[", 
              RowBox[{"blocks", ",", "f"}], "]"}]}]}], "\n", "\t\t\t\t\t\t", 
           "]"}]}]}], "\n", "\t\t\t\t", "|>"}], "\n", "\t\t\t", "]"}]}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetPsi4Scan", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"specs", ":", 
     RowBox[{"(", 
      RowBox[{"ChemObjPattern", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], ")"}]}], 
    ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"AtomsetPsi4Scan", "[", 
   RowBox[{"obj", ",", 
    RowBox[{"{", "specs", "}"}], ",", "ops"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7110660645115356`*^9, 3.711066073551839*^9}, {
   3.711066117960511*^9, 3.711066196715144*^9}, {3.7110664223278923`*^9, 
   3.711066464821426*^9}, {3.711067463072822*^9, 3.711067812019764*^9}, {
   3.711067856295843*^9, 3.711067990374465*^9}, {3.711068033400371*^9, 
   3.711068230012808*^9}, {3.711068289512574*^9, 3.711068297045257*^9}, {
   3.711068336282806*^9, 3.711068487892023*^9}, {3.711068538628291*^9, 
   3.7110685550795317`*^9}, {3.7110689357447577`*^9, 3.711068969031333*^9}, {
   3.711069010370496*^9, 3.711069087978791*^9}, {3.711069402759439*^9, 
   3.711069534655155*^9}, {3.711069578631648*^9, 3.711069613252534*^9}, 
   3.711069778215251*^9, 3.7110699778872538`*^9, {3.711070013462037*^9, 
   3.711070042983324*^9}, {3.718335482955652*^9, 
   3.718335482971253*^9}},ExpressionUUID->"dcb4459e-99d1-4d06-84a8-\
aeef06b0e231"]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy", "CodeSubsubsection",
 CellChangeTimes->{{3.711070092506041*^9, 
  3.7110700933453197`*^9}},ExpressionUUID->"84da507e-5b60-4fca-aa36-\
243dca5783d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetEnergy", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "Psi4Energy", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetEnergy", "[", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"$Psi4", "@", "\n", "\t\t", 
   RowBox[{"Psi4Energy", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"AtomsetElementPositions", "@", "obj"}], ",", "\n", "\t", "\t\t",
      "ops"}], "\n", "\t", "\t\t", "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.711070095649179*^9, 3.711070142716873*^9}, {
   3.711070378996736*^9, 3.711070391011591*^9}, {3.711070548904565*^9, 
   3.711070552730029*^9}, 
   3.718335482980114*^9},ExpressionUUID->"8da58c88-2937-4a67-93e9-\
7b798c8df6cc"]
}, Closed]],

Cell[CellGroupData[{

Cell["AtomsetEnergyScan", "CodeSubsubsection",
 CellChangeTimes->{
  3.711070475792206*^9},ExpressionUUID->"649cd192-2105-4c52-a853-\
5148df714f10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atomsetEnergyScanPrepSpec", "[", 
    RowBox[{"p", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}], ".."}], "}"}]}], "]"}], ":=",
    "p"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"atomsetEnergyScanPrepSpec", "[", "\n", "\t", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xm_", ",", "xM_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ym_", ",", "yM_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zm_", ",", "zM_"}], "}"}]}], "}"}], ",", "\n", "\t", "\t", 
      RowBox[{"{", 
       RowBox[{"xD_Integer", ",", "yD_Integer", ",", "zD_Integer"}], "}"}]}], 
     "\n", "\t\t", "}"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Tuples", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Subdivide", "[", 
       RowBox[{"xm", ",", "xM", ",", "xD"}], "]"}], ",", 
      RowBox[{"Subdivide", "[", 
       RowBox[{"ym", ",", "yM", ",", "yD"}], "]"}], ",", 
      RowBox[{"Subdivide", "[", 
       RowBox[{"zm", ",", "zM", ",", "zD"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"atomsetEnergyScanPrepSpec", "[", 
    RowBox[{"p_", "\[Rule]", "f_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", "=", 
       RowBox[{"atomsetEnergyScanPrepSpec", "[", "p", "]"}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"f", "/@", "r"}], "/;", 
      RowBox[{"ListQ", "[", "r", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.711827673660891*^9, 
  3.711827913764493*^9}},ExpressionUUID->"412ccd5b-ca59-40ed-801e-\
ae2597f293a7"],

Cell[BoxData[
 RowBox[{"AtomsetEnergyScan", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.711828068172819*^9, 
  3.711828070683098*^9}},ExpressionUUID->"1f9c29f4-b3e1-47a1-8ae4-\
e120e169e9c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetEnergyScan", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "AtomsetPsi4Scan", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetEnergyScan", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
     RowBox[{"specs", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ChemObjPattern", "\[Rule]", "_"}], ")"}], ".."}], "}"}]}], 
     ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{"atomsetEnergyScanPrepSpec", "@*", "Last"}], "/@", 
        "specs"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "specs"}], ">", "1"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"Tuples", "[", "s", "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"First", "@", "s"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"Fold", "[", "\n", "\t", "\t\t\t", 
          RowBox[{"Lookup", ",", "\n", "\t", "\t\t\t", 
           RowBox[{"Psi4DataParseGeometry", "@", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"$Psi4", "[", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"AtomsetPsi4Scan", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"First", ",", "specs"}], "]"}], "\[Rule]", "s"}], 
                 "]"}], ",", "\n", "\t\t\t\t\t\t\t", "ops"}], "\n", 
               "\t\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t\t\t", "]"}], "[", 
             "\"\<output.dat\>\"", "]"}]}], ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"\"\<Properties\>\"", ",", "\"\<TotalEnergy\>\""}], 
            "}"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}], "]"}], 
      "/;", 
      RowBox[{"AllTrue", "[", 
       RowBox[{"s", ",", "ListQ"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetEnergyScan", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "ChemObjPattern"}], ",", "\n", "\t", 
    RowBox[{"specs", ":", 
     RowBox[{"(", 
      RowBox[{"ChemObjPattern", "\[Rule]", "_"}], ")"}]}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"AtomsetEnergyScan", "[", 
   RowBox[{"obj", ",", 
    RowBox[{"{", "specs", "}"}], ",", "ops"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.711070095649179*^9, 3.711070142716873*^9}, {
   3.711070378996736*^9, 3.711070391011591*^9}, {3.711070423663499*^9, 
   3.711070525008168*^9}, {3.7110706145957613`*^9, 3.7110706258882303`*^9}, {
   3.711070798962824*^9, 3.7110708025993767`*^9}, {3.711825298071192*^9, 
   3.711825322003409*^9}, {3.711825379350884*^9, 3.7118253938329353`*^9}, {
   3.7118254600180683`*^9, 3.711825470376322*^9}, {3.7118265475788116`*^9, 
   3.7118266114619627`*^9}, 3.7118266760354357`*^9, {3.7118279290196457`*^9, 
   3.711827956209455*^9}, {3.71182803556778*^9, 3.7118281042673473`*^9}, {
   3.711828186466937*^9, 3.711828187913847*^9}, {3.711828236372038*^9, 
   3.711828244873036*^9}, {3.718335482992255*^9, 
   3.718335483006176*^9}},ExpressionUUID->"1ea9f480-f806-4120-9b4f-\
93e87a3a4500"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Atomset Graphics\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.694870848876628*^9, 
  3.69487085131697*^9}},ExpressionUUID->"784daf6f-a170-4fec-a55f-\
d54bb3bdae25"],

Cell[CellGroupData[{

Cell["Graphic", "CodeSubsubsection",
 CellChangeTimes->{{3.692450645595366*^9, 3.6924506466042957`*^9}, 
   3.6924755671485977`*^9},ExpressionUUID->"c6cd5372-59cc-4702-bb18-\
b7a7a43d34c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetGraphic", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "AtomGraphic"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "BondGraphic"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraphic", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", "=", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{"#", ",", "\n", "\t\t\t\t", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{"a", ",", "#"}], "]"}]}], "\[Equal]", "2"}], "&"}],
                ",", 
               RowBox[{"ChemGet", "[", 
                RowBox[{"#", ",", "\"\<Atoms\>\""}], "]"}]}], "]"}]}], "\n", 
            "\t\t\t\t", "]"}], "&"}], "@", "\n", "\t\t\t\t\t", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"a", ",", "\"\<Bonds\>\""}], "]"}]}]}]}]}], "\n", 
        "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"BondGraphic", "[", 
          RowBox[{"b", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Options", "[", "BondGraphic", "]"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"AtomGraphic", "[", 
          RowBox[{"a", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Options", "[", "AtomGraphic", "]"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6924509000967417`*^9, 3.692450903528741*^9}, {
   3.692452075046392*^9, 3.69245208748639*^9}, 3.692453281116866*^9, {
   3.692470409915588*^9, 3.692470433566484*^9}, {3.692470480390459*^9, 
   3.692470487232288*^9}, {3.69247166221727*^9, 3.6924716695178127`*^9}, {
   3.700019741249839*^9, 3.7000197421213827`*^9}, {3.7001072326088123`*^9, 
   3.700107253030983*^9}, {3.7001072882734423`*^9, 3.700107415232959*^9}, {
   3.700198575082459*^9, 3.700198579210905*^9}, 3.718335483015916*^9, {
   3.7188443044476967`*^9, 3.7188443078679953`*^9}, {3.7203800531288223`*^9, 
   3.7203800746992817`*^9}},ExpressionUUID->"50104192-159e-421d-a141-\
34e748f25fb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["symmetryGraphics", "CodeSubsubsection",
 CellChangeTimes->{{3.693951652867004*^9, 3.693951660529348*^9}, {
  3.693951808078952*^9, 
  3.693951808884323*^9}},ExpressionUUID->"9ac12db2-fd19-402a-ad51-\
33407252a4a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"symmetryGraphics", "[", 
   RowBox[{"as_", ",", "\n", "\t", 
    RowBox[{"atoms_:", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Except", "@", 
        RowBox[{"_String", "?", 
         RowBox[{"(", 
          RowBox[{"StringMatchQ", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\"\<H\>\"", "|", "\"\<Hydrogen\>\""}], ")"}], "~~", 
            RowBox[{"(", 
             RowBox[{"NumberString", "|", "\"\<\>\""}], ")"}]}], "]"}], 
          ")"}]}]}], ",", "_"}], "}"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eps", "=", 
      RowBox[{"AtomsetElementPositions", "@", "as"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "eps", "]"}], ">", "2"}], ",", "\n", "\t\t\t", 
      RowBox[{"ChemUtilsSymmetryGraphicsObjects", "[", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{"eps", ",", "atoms"}], "]"}]}], ">", "3"}], ",", 
         RowBox[{"Cases", "[", 
          RowBox[{"eps", ",", "atoms"}], "]"}], ",", "eps"}], "]"}], "\n", 
       "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", "}"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6939460590997667`*^9, 3.69394609918746*^9}, {
  3.69394613489073*^9, 3.693946504624423*^9}, {3.6939465454541388`*^9, 
  3.693946707275655*^9}, {3.6939467809039917`*^9, 3.693946802902565*^9}, {
  3.693946866536255*^9, 3.693946871158441*^9}, {3.6939469567281027`*^9, 
  3.693946994408524*^9}, {3.6939491950229197`*^9, 3.6939492227654467`*^9}, {
  3.6939507129172573`*^9, 3.693950755097887*^9}, {3.6939516752730017`*^9, 
  3.6939517832455873`*^9}, {3.693952919044612*^9, 3.693952968192054*^9}, {
  3.71467004453421*^9, 3.714670089480071*^9}, {3.718841212162429*^9, 
  3.718841212480289*^9}, {3.718841294424631*^9, 
  3.71884129460802*^9}},ExpressionUUID->"ddca420b-f89b-4d34-bc7b-44b4b9b33260"]
}, Closed]],

Cell[CellGroupData[{

Cell["axesGraphics", "CodeSubsubsection",
 CellChangeTimes->{{3.6939519159112787`*^9, 
  3.693951918078307*^9}},ExpressionUUID->"bb7aee0b-0bd2-4af7-b40d-\
409545e5dcb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"axesGraphics", "[", 
   RowBox[{"as_", ",", "\n", "\t", 
    RowBox[{"drawAxes", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}], "|", 
      "\"\<Inertial\>\""}], ":", "\"\<Inertial\>\""}], ",", "\n", "\t", 
    RowBox[{"origin", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}], "|", "\"\<Center\>\"", "|", 
      "\"\<CenterOfMass\>\"", "|", "True", "|", "False"}], ":", 
     "\"\<Center\>\""}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"c", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"origin", ",", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<CenterOfMass\>\"", "|", "True"}], ":>", 
            RowBox[{"AtomsetCenterOfMass", "@", "as"}]}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<Center\>\"", "|", "False"}], ":>", 
            RowBox[{"AtomsetCenter", "@", "as"}]}]}], "\n", "\t\t\t\t\t", 
          "}"}]}], "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"axes", "=", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"drawAxes", "===", "\"\<Inertial\>\""}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Lookup", "[", 
          RowBox[{
           RowBox[{"AtomsetInertialSystem", "@", "as"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<AAxis\>\"", ",", "\"\<BAxis\>\"", ",", "\"\<CAxis\>\""}], 
            "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Normalize", "/@", "drawAxes"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"m", "=", 
       RowBox[{".5", "+", 
        RowBox[{"Max", "@", "\n", "\t", "\t\t\t\t", 
         RowBox[{"Map", "[", 
          RowBox[{"Abs", ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"Thread", "@", 
            RowBox[{"CoordinateBoundingBox", "[", 
             RowBox[{"ChemGet", "[", 
              RowBox[{
               RowBox[{"ChemGet", "[", 
                RowBox[{"as", ",", "\"\<Atoms\>\""}], "]"}], ",", 
               "\"\<Position\>\""}], "]"}], "]"}]}]}], "\n", "\t\t\t\t\t\t", 
          "]"}]}]}]}]}], "}"}], ",", "\n", "\t\t\t", 
    RowBox[{"{", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", "\n", "\t\t\t\t", 
      RowBox[{"Arrowheads", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", ".05"}], ",", ".05"}], "}"}], ",", 
        RowBox[{"Appearance", "->", "\"\<Projected\>\""}]}], "]"}], ",", "\n",
       "\t\t\t\t", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#2", ",", 
           RowBox[{"Arrow", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "-", 
               RowBox[{"m", "*", "#"}]}], ",", 
              RowBox[{"c", "+", 
               RowBox[{"m", "*", "#"}]}]}], "}"}]}], ",", 
           RowBox[{"Inset", "[", 
            RowBox[{"#3", ",", 
             RowBox[{"c", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{".1", "+", "m"}], ")"}], "*", "#"}]}]}], "]"}]}], 
          "}"}], "&"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
         RowBox[{"axes", ",", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Hue", "[", 
             RowBox[{".1", ",", ".5", ",", ".8"}], "]"}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".4", ",", ".5", ",", ".5"}], "]"}], ",", 
            RowBox[{"Hue", "[", 
             RowBox[{"0", ",", "1", ",", ".65"}], "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\""}], "}"}]}],
          "\n", "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.693951921252495*^9, 3.693951935957176*^9}, {
  3.693952661873248*^9, 3.693952676246477*^9}, {3.6939551110712137`*^9, 
  3.6939551223107977`*^9}, {3.694042484590465*^9, 3.694042488366417*^9}, {
  3.694042588638857*^9, 3.6940426012827177`*^9}, {3.694140132075845*^9, 
  3.694140164135995*^9}, {3.69448112540444*^9, 3.694481281137855*^9}, {
  3.700107215404622*^9, 
  3.7001072180409317`*^9}},ExpressionUUID->"219c8183-4d38-4aed-8e20-\
bdae46b91d07"]
}, Closed]],

Cell[CellGroupData[{

Cell["Graphic3D", "CodeSubsubsection",
 CellChangeTimes->{{3.6924506484112053`*^9, 
  3.6924506594885273`*^9}},ExpressionUUID->"11bd7edf-a446-4b68-bb64-\
e10445771643"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AtomsetGraphic3D", "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"Options", "[", "AtomsetGraphic3D", "]"}], "=", "\n", "\t", 
    RowBox[{"Normal", "@", "\n", "\t\t", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"Options", "@", "AtomGraphic3D"}], ",", "\n", "\t\t\t", 
          RowBox[{"Options", "@", "BondGraphic3D"}], ",", "\n", "\t\t\t", 
          RowBox[{"Options", "[", "AtomsetGraphic", "]"}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"\"\<UseAxes\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
          "\t", "\t\t", 
          RowBox[{"\"\<UseOrigin\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
          "\t", "\t\t", 
          RowBox[{"\"\<InertialAxes\>\"", "\[Rule]", "False"}], ",", "\n", 
          "\t", "\t\t", 
          RowBox[{"\"\<SymmetryElements\>\"", "\[Rule]", "None"}], ",", "\n", 
          "\t", "\t\t", 
          RowBox[{"\"\<SymmetryAtoms\>\"", "\[Rule]", "\n", "\t", "\t\t\t", 
           RowBox[{"Except", "[", 
            RowBox[{
            "\"\<H\>\"", "|", "\"\<D\>\"", "|", "\"\<H2\>\"", "|", 
             "\"\<T\>\"", "|", "\"\<H3\>\""}], "]"}]}], ",", "\n", "\t", 
          "\t\t", 
          RowBox[{
          "\"\<SymmetryCoordinates\>\"", "->", "\n", "\t", "\t\t\t", "_"}], 
          ",", "\n", "\t", "\t\t", 
          RowBox[{"\"\<CenterOfMass\>\"", "\[Rule]", "False"}], ",", "\n", 
          "\t", "\t\t", 
          RowBox[{"\"\<OriginFunction\>\"", "\[Rule]", "Point"}]}], "\n", 
         "\t", "\t\t", "}"}]}], ",", "\n", "\t\t", "Last"}], "\n", "\t\t", 
      "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetGraphic3D", "[", 
    RowBox[{
     RowBox[{"obj", ":", "ChemObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"ChemGet", "[", 
         RowBox[{"obj", ",", "\"\<Atoms\>\""}], "]"}]}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", "=", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{"#", ",", "\n", "\t\t\t\t", 
             RowBox[{"Map", "[", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{"a", ",", "#"}], "]"}]}], "\[Equal]", "2"}], "&"}],
                ",", "\n", "\t\t\t\t\t", 
               RowBox[{"ChemGet", "[", 
                RowBox[{"#", ",", " ", "\"\<Atoms\>\""}], "]"}]}], "]"}]}], 
            "\n", "\t\t\t\t", "]"}], "&"}], "@", "\n", "\t\t\t\t\t", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"ChemGet", "[", 
             RowBox[{"a", ",", "\"\<Bonds\>\""}], "]"}]}]}]}]}], "\n", 
        "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "a"}], ">", "0"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"AtomGraphic3D", "[", 
            RowBox[{"a", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{
               "{", "\n", "\t\t\t\t\t\t\t", "ops", "\n", "\t\t\t\t\t\t\t", 
                "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Options", "@", "AtomGraphic3D"}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", 
           "\n", "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", "]"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "b"}], ">", "0"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"BondGraphic3D", "[", 
            RowBox[{"b", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", 
               RowBox[{"Options", "@", "BondGraphic3D"}]}], "]"}]}], "]"}], 
           ",", "\n", "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", "]"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "a"}], ">", "0"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"OptionValue", "@", "\"\<UseAxes\>\""}], ",", 
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "Automatic", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "@", "\"\<InertialAxes\>\""}], "//",
                     "TrueQ"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    "axesGraphics", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "obj", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    "\"\<Inertial\>\"", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "\"\<UseOrigin\>\""}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Automatic", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"TrueQ", "@", 
                    RowBox[{
                    "OptionValue", "@", "\"\<CenterOfMass\>\""}]}]}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", "Nothing"}], "\n", "\t", 
                   "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{"l_List", ":>", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"axesGraphics", "[", 
                    RowBox[{
                    "obj", ",", "l", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "\"\<UseOrigin\>\""}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Automatic", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"TrueQ", "@", 
                    RowBox[{
                    "OptionValue", "@", "\"\<CenterOfMass\>\""}]}]}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", "_List", "]"}], "\[RuleDelayed]", 
                    "Nothing"}]}], "\n", "\t", "\t\t\t\t\t\t\t", "]"}]}], ",",
                  "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{"_", "\[Rule]", "Nothing"}]}], "\n", "\t", 
                "\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t", 
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{"OptionValue", "@", "\"\<SymmetryElements\>\""}], ",", 
               "\n", "\t", "\t\t\t\t\t", "All", ",", "\n", "\t", 
               "\t\t\t\t\t\t", 
               RowBox[{"Values", "@", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{"symmetryGraphics", "[", 
                 RowBox[{"obj", ",", 
                  RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"OptionValue", "@", "\"\<SymmetryAtoms\>\""}], 
                    ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    "OptionValue", "@", "\"\<SymmetryCoordinates\>\""}]}], 
                   "\n", "\t", "\t", "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", 
               "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"_List", "|", "_String"}], ",", "\n", "\t", 
               "\t\t\t\t\t\t", 
               RowBox[{"Lookup", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"symmetryGraphics", "[", 
                  RowBox[{"obj", ",", 
                   RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "\"\<SymmetryAtoms\>\""}], 
                    ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    "OptionValue", "@", "\"\<SymmetryCoordinates\>\""}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", "\n",
                  "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"OptionValue", "@", "\"\<SymmetryElements\>\""}], 
                 ",", "\n", "\t", "\t\t\t\t\t\t\t", "Null"}], "\n", "\t", 
                "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t\t", "_", 
               ",", "\n", "\t", "\t\t\t\t\t\t", "Nothing"}], "\n", "\t", 
              "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"OptionValue", "@", "\"\<UseOrigin\>\""}], ",", 
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Automatic", ":>", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"TrueQ", "@", 
                    RowBox[{"OptionValue", "@", "\"\<CenterOfMass\>\""}]}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\"\<OriginFunction\>\"", "]"}], "@", 
                    
                    RowBox[{"AtomsetCenterOfMass", "[", "obj", "]"}]}]}], 
                   "\n", "\t", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"l", ":", 
                   RowBox[{"{", 
                    RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ":>", "\n", 
                  "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                   "OptionValue", "[", "\"\<OriginFunction\>\"", "]"}], "@", 
                   "l"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", 
            "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", "Nothing"}], "\n", 
          "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t",
     "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.692450660892693*^9, 3.692450671002482*^9}, {
   3.69245073127918*^9, 3.692450770116993*^9}, {3.692450823059342*^9, 
   3.692450895799465*^9}, {3.692452049171167*^9, 3.6924520691585293`*^9}, {
   3.6924532731057577`*^9, 3.692453273946348*^9}, {3.692470440226995*^9, 
   3.692470472583674*^9}, {3.692470743382161*^9, 3.6924707486699553`*^9}, {
   3.6924711435026493`*^9, 3.692471147735923*^9}, 3.6924716589761343`*^9, {
   3.692471784645007*^9, 3.6924717871740837`*^9}, {3.6939516100009527`*^9, 
   3.6939516329566317`*^9}, {3.693951831663971*^9, 3.693951876783876*^9}, 
   3.69395190923842*^9, {3.693951946119596*^9, 3.693952016630403*^9}, {
   3.693952709247905*^9, 3.693952771027687*^9}, {3.693952837337089*^9, 
   3.6939528492464333`*^9}, 3.693952992799479*^9, {3.694140026988904*^9, 
   3.694140120018437*^9}, {3.694481302629388*^9, 3.6944813969021187`*^9}, {
   3.694481438916276*^9, 3.694481572905258*^9}, {3.694481624139246*^9, 
   3.6944817313049726`*^9}, {3.694482163348605*^9, 3.6944821936910877`*^9}, 
   3.694482242407115*^9, {3.6997476031175747`*^9, 3.699747652175748*^9}, {
   3.700019677623458*^9, 3.7000197306544952`*^9}, {3.700107379896961*^9, 
   3.7001073824204197`*^9}, {3.700107443644681*^9, 3.700107466288862*^9}, {
   3.7001075578729267`*^9, 3.700107604287264*^9}, {3.700145238729494*^9, 
   3.700145248313888*^9}, {3.7001452985120993`*^9, 3.7001453117253637`*^9}, {
   3.7001993862300034`*^9, 3.700199504489553*^9}, {3.700199895055656*^9, 
   3.700199976738586*^9}, {3.7010476378179197`*^9, 3.701047717365897*^9}, 
   3.718335483037294*^9, {3.71884435651016*^9, 3.718844370199493*^9}, {
   3.718844403406871*^9, 3.718844412778625*^9}, {3.718844487147765*^9, 
   3.718844495063077*^9}, {3.718844569950403*^9, 3.718844570604538*^9}, {
   3.718844686074288*^9, 3.718844707127404*^9}, {3.720371968723092*^9, 
   3.720372008529744*^9}, {3.7203721102966127`*^9, 3.720372115691407*^9}, {
   3.720372974265909*^9, 
   3.720372979453768*^9}},ExpressionUUID->"86e0ed38-85dc-4f0d-bde4-\
fe4ccadc9045"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Wrappers\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69448940917155*^9, 
  3.694489410117133*^9}},ExpressionUUID->"0f7b607e-7add-4523-8ea8-\
ea706fe363da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"validAtomsetWrapperQ", "[", "a_Association", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"a", "[", "\"\<Atoms\>\"", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_String", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], ".."}], "}"}]}],
      "]"}], "&&", "\n", "\t\t", 
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"a", "[", "\"\<Bonds\>\"", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_Integer", ",", "_Integer", ",", 
          RowBox[{"___", "?", "NumericQ"}]}], "}"}], "..."}], "}"}]}], 
     "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6997338289628553`*^9, 3.699733898713586*^9}, {
  3.699734150213003*^9, 
  3.699734191040901*^9}},ExpressionUUID->"764619dc-3175-4439-a1e6-\
468eb0a85442"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AtomsetWrapper", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", "\n", "\t\t", 
    RowBox[{"CreateAtomset", "[", 
     RowBox[{"AtomsetWrapper", "[", 
      RowBox[{"a_", "?", "validAtomsetWrapperQ"}], "]"}], "]"}], "\n", "\t\t",
     "]"}], ":=", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"atoms", "=", 
        RowBox[{"a", "[", "\"\<Atoms\>\"", "]"}]}], ",", 
       RowBox[{"bonds", "=", 
        RowBox[{"a", "[", "\"\<Bonds\>\"", "]"}]}]}], "}"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{"CreateAtomset", "[", 
      RowBox[{"$ChemDefaultSystem", ",", "\n", "\t\t\t\t", 
       RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "@", "atoms"}], ",", 
            RowBox[{"Length", "@", "bonds"}]}], "}"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "atoms", ",", "\n", "\t\t\t\t\t", "bonds"}], "\n", 
        "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6948293718541393`*^9, 3.694829476493095*^9}, {
  3.699734323032596*^9, 
  3.69973432545501*^9}},ExpressionUUID->"88ca41b3-3363-4bc9-809d-\
dfa2f44ee731"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetWrapper", "[", 
    RowBox[{"elements", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "_String", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_String", ",", "_"}], "}"}], ",", "___"}], "}"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", "___"}], "}"}]}], ")"}]}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"CreateAtomset", "[", 
      RowBox[{"$ChemDefaultSystem", ",", "elements"}], "]"}], ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Except", "[", "_ChemObject", "]"}], "->", "$Failed"}], ",", 
       "\n", "\t\t", 
       RowBox[{"co_", ":>", "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"w", "=", 
            RowBox[{"AtomsetWrapper", "@", "co"}]}], "}"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"ChemRemove", "@", "co"}], ";", "\n", "\t\t\t\t", "w"}]}], 
         "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"AtomsetWrapper", "[", 
   RowBox[{"co", ":", "ChemObjPattern"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", "=", 
      RowBox[{"AtomsetMolTable", "@", "co"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"t", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"b", "=", 
         RowBox[{"t", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"AtomsetWrapper", "@", 
       RowBox[{"<|", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<Atoms\>\"", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", ">", "0"}], ",", 
            RowBox[{"t", "[", 
             RowBox[{"[", " ", 
              RowBox[{"2", ";;", 
               RowBox[{"1", "+", "a"}]}], " ", "]"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"\"\<Bonds\>\"", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"b", ">", "0"}], ",", 
            RowBox[{"t", "[", 
             RowBox[{"[", " ", 
              RowBox[{
               RowBox[{"2", "+", "a"}], ";;"}], " ", "]"}], "]"}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t", "|>"}]}]}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6944895529373302`*^9, 3.6944895881383247`*^9}, {
   3.6944899762953978`*^9, 3.694490052794191*^9}, {3.694492395233042*^9, 
   3.69449247379633*^9}, {3.694492520011392*^9, 3.694492530106247*^9}, {
   3.694492707655733*^9, 3.694492776147077*^9}, 3.694492816422572*^9, {
   3.6945237730253*^9, 3.694523836432439*^9}, {3.69973353181815*^9, 
   3.699733537694235*^9}, {3.699733626219254*^9, 3.699733655354662*^9}, {
   3.7001091506741133`*^9, 3.7001091543490543`*^9}, 
   3.718335483050799*^9},ExpressionUUID->"41137ea8-112d-4f41-9319-\
794d2a85f9cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"atomsetWrapperAppliableQ", "[", "s_", "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"Unevaluated", "[", "s", "]"}], ",", "\n", "\t\t", 
      RowBox[{"Except", "[", 
       RowBox[{
       "CreateAtomset", "|", "_List", "|", "_Association", "|", "_Dataset"}], 
       "]"}]}], "\n", "\t\t", "]"}], "&&", "\n", "\t", 
    RowBox[{
     RowBox[{"Context", "[", 
      RowBox[{"Unevaluated", "@", "s"}], "]"}], "=!=", 
     "\"\<System`\>\""}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "atomsetWrapperAppliableQ", "~", "SetAttributes", "~", "HoldFirst"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694489430590681*^9, 3.694489549538084*^9}, {
   3.694490060438496*^9, 3.694490183078608*^9}, {3.694823815748995*^9, 
   3.694823823804172*^9}, {3.694829319153274*^9, 3.69482931944991*^9}, {
   3.6948294107936783`*^9, 3.6948294177446833`*^9}, 3.6948294526808968`*^9, {
   3.694829488126202*^9, 3.694829510794571*^9}, {3.699734302352809*^9, 
   3.699734312150292*^9}, {3.699734346455546*^9, 
   3.699734515257844*^9}},ExpressionUUID->"177a8e0d-de38-4c18-bfaa-\
3a6f21dbfee8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AtomsetWrapper", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c_", "?", "atomsetWrapperAppliableQ"}], ")"}], "[", "\n", 
     "\t\t\t", 
     RowBox[{
      RowBox[{"AtomsetWrapper", "[", 
       RowBox[{"a_", "?", "validAtomsetWrapperQ"}], "]"}], ",", "\n", 
      "\t\t\t", "args___"}], "\n", "\t\t\t", "]"}], "\n", "\t\t", "]"}], ":=",
    "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", "=", 
       RowBox[{"CreateAtomset", "@", 
        RowBox[{"AtomsetWrapper", "[", "a", "]"}]}]}], "}"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", 
         RowBox[{"c", "[", 
          RowBox[{"as", ",", "args"}], "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
       
       RowBox[{
        RowBox[{"ChemRemove", "@", "as"}], ";", "\n", "\t\t\t\t", "r"}]}], 
      "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], ";"}]], "CodeInput",
 
 CellChangeTimes->{{3.694489430590681*^9, 3.694489549538084*^9}, {
   3.694490060438496*^9, 3.694490183078608*^9}, {3.694823815748995*^9, 
   3.694823823804172*^9}, {3.694829319153274*^9, 3.69482931944991*^9}, {
   3.6948294107936783`*^9, 3.6948294177446833`*^9}, 3.6948294526808968`*^9, {
   3.694829488126202*^9, 3.694829510794571*^9}, {3.699734302352809*^9, 
   3.699734312150292*^9}, {3.699734346455546*^9, 
   3.6997344298195667`*^9}},ExpressionUUID->"ce9ea23e-abfc-46cd-8682-\
ed815b673ef0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Format\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732551678046493*^9, 
  3.7325516788691177`*^9}},ExpressionUUID->"4c537fd5-d0d2-4abf-aea5-\
008849521533"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AtomsetWrapper", "[", "s_String", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"ChemImport", "[", "s", "]"}], ",", "\n", "\t\t", 
     RowBox[{"o_ChemObject", ":>", "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", "=", 
          RowBox[{"AtomsetWrapper", "[", "o", "]"}]}], "}"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{
         RowBox[{"ChemRemove", "@", "o"}], ";", "\n", "\t\t\t\t", "a"}]}], 
       "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6997337041293287`*^9, 
  3.699733741926429*^9}},ExpressionUUID->"acc1b272-82b6-414c-b17a-\
5288fae9fa66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{"AtomsetWrapper", "[", 
      RowBox[{"a_", "?", "validAtomsetWrapperQ"}], "]"}], "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"RawBoxes", "@", 
     RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t", 
      RowBox[{"\"\<AtomsetWrapper\>\"", ",", "\n", "\t\t", 
       RowBox[{"AtomsetWrapper", "[", "a", "]"}], ",", "\n", "\t\t", "None", 
       ",", "\n", "\t\t", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"BoxForm`MakeSummaryItem", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Atom Count: \>\"", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"a", "[", "\"\<Atoms\>\"", "]"}]}]}], "}"}], ",", 
           "StandardForm"}], "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"BoxForm`MakeSummaryItem", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Bond Count: \>\"", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"a", "[", "\"\<Bonds\>\"", "]"}]}]}], "}"}], ",", 
           "StandardForm"}], "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
       "\t\t", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"BoxForm`MakeSummaryItem", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Atoms:\>\"", ",", 
             RowBox[{"a", "[", "\"\<Atoms\>\"", "]"}]}], "}"}], ",", 
           "StandardForm"}], "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"BoxForm`MakeSummaryItem", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Bonds: \>\"", ",", 
             RowBox[{"a", "[", "\"\<Bonds\>\"", "]"}]}], "}"}], ",", 
           "StandardForm"}], "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
       "\t\t", "StandardForm"}], "\n", "\t\t", "]"}]}]}], ";"}], 
  "\t"}]], "CodeInput",
 CellChangeTimes->{{3.699733806388213*^9, 3.699733817997436*^9}, {
   3.699733930236363*^9, 3.6997340181439257`*^9}, {3.699734059686056*^9, 
   3.699734114459846*^9}, {3.7203697381817837`*^9, 3.7203697701814537`*^9}, {
   3.7203698214684896`*^9, 3.720369821866825*^9}, {3.720369872910338*^9, 
   3.7203698763351316`*^9}, 3.720370229667355*^9, {3.72089592255501*^9, 
   3.720895924170989*^9}},ExpressionUUID->"d642d6a4-99e2-4fc4-92f8-\
c5b90c9c57d6"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"d877812a-c07a-41ff-8825-\
e2f5ca347f82"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"28d1ef8d-72d0-4b4b-b99b-\
0fef6b0a8fc3"]
},
WindowSize->{808, 755},
WindowMargins->{{Automatic, 261}, {Automatic, 49}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

