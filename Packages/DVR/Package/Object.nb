Notebook[{

Cell[CellGroupData[{
Cell["DVR", "CodeSection",
 CellChangeTimes->{{3.699193506559762*^9, 3.699193508534224*^9}, {
  3.7323031681209297`*^9, 3.732303175462882*^9}, {3.735190655752451*^9, 
  3.735190657057599*^9}},ExpressionUUID->"ce12fc74-14d9-4140-b8eb-\
f0dcebd187a1"],

Cell["\<\
\[LeftCeiling]
\tThis really needs to be reimplemented as an Interface. \
It\[CloseCurlyQuote]ll make it easier to store and cleaner to work with... \
Also no memory leaks! 
\t
\tFor the new DVRResultsObject we\[CloseCurlyQuote]ll use that as the primary \
container object throughout the entire calculation. It will guide the whole \
process and methods should be written with the expecation of getting one of \
them.
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"caee00b1-eb0a-4fec-af82-2db11f22aab1"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Management\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196695796316*^9, 3.6991966975641613`*^9}, {
  3.6993080953275414`*^9, 
  3.699308095820632*^9}},ExpressionUUID->"440a3234-5118-4669-b7ea-\
3c248d44eaaf"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]File Stuff\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"378ce84c-6f1c-44cb-b657-2ec92a1f9e77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDirectory", "::", "usage"}], "=", 
   "\"\<Directory finder\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRFile", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Simple combination of FileNameJoin and ChemDVRDirectory\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentials", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Lists all matching files in ChemDVRDirectory[\\\"PotentialEnergy\\\"]\
\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$ChemDVRPotentials", "::", "usage"}], "=", 
   "\"\<Alias for ChemDVRPotentials[\\\"*@.@*\\\"]\>\""}], 
  ";"}]}], \
"CodeInput",ExpressionUUID->"756090c3-c230-49e9-955a-a96090441b76"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Objects\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"3b714108-5acc-4b1e-af3e-31874fd39b06"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$ChemDVRManager", "::", "usage"}], "=", 
   "\"\<Manager interface for ChemDVR things\>\""}], 
  ";"}]], "CodeInput",ExpressionUUID->"36aa277b-e56b-499f-a846-3f89684c41df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "usage"}], "=", 
   "\"\<OOP constructor for a ChemDVR\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRAssociation", "::", "usage"}], "=", 
   "\"\<Returns the base association for the instance\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195104073802*^9, 3.6991952004002743`*^9}, {
   3.69919605384367*^9, 3.699196054154253*^9}, {3.699200962679698*^9, 
   3.69920097647511*^9}, {3.699303685439557*^9, 3.69930369605053*^9}, {
   3.700004723585022*^9, 3.700004723608583*^9}, 3.709487016572117*^9, {
   3.732302839589135*^9, 3.7323028407366047`*^9}, {3.732302899260148*^9, 
   3.732302899469336*^9}},ExpressionUUID->"b2496ee4-face-45fc-9386-\
ff1ee18bed13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "::", "usage"}], "=", 
   "\"\<Saves various ChemDVR components\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClear", "::", "usage"}], "=", 
   "\"\<Clears saved ChemDVR components\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195104073802*^9, 3.699195204534544*^9}, {
  3.699196176789201*^9, 3.699196182899107*^9}, {3.699743855063335*^9, 
  3.699743870905731*^9}, {3.7000047236127377`*^9, 
  3.700004723621628*^9}},ExpressionUUID->"1515556b-5d44-47ec-8d2d-\
f0863a75cf14"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Properties\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"712711ac-ca17-4a77-a5b8-54bfc4a9cf4d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Gets an attribute for a ChemDVR instance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSet", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Sets an attribute for a ChemDVR instance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROptions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the options associated with a particular DVR step\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "usage"}], "=", 
   "\"\<General form ChemDVR runner\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"915b5d27-a179-449f-87bb-eacf87a8df5c"]\

}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Usage\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196699948257*^9, 
  3.699196705364139*^9}},ExpressionUUID->"7d0459a3-8821-40a3-93a2-\
7602abaf24c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDimension", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the dimension of a ChemDVR object\>\""}], ";"}]], "CodeInput",
 
 CellChangeTimes->{{3.6992058058208523`*^9, 3.699205937966085*^9}, 
   3.6992063006686974`*^9, {3.699217771766521*^9, 3.6992177788107443`*^9}, {
   3.7000047236621523`*^9, 3.700004723700327*^9}, {3.716045483835588*^9, 
   3.7160454917549686`*^9}, {3.718048930135654*^9, 3.718048954876293*^9}, {
   3.718048994505734*^9, 3.7180490019036207`*^9}, {3.718052249108364*^9, 
   3.7180522653867683`*^9}, {3.7314327369280663`*^9, 3.731432756043549*^9}, {
   3.731787104723571*^9, 3.73178717926921*^9}, {3.7317872360118628`*^9, 
   3.731787237728244*^9}, 3.7317915001749697`*^9, {3.7323028643152514`*^9, 
   3.732302864615101*^9}, {3.7323048026633167`*^9, 3.732304802910129*^9}, {
   3.734897456293427*^9, 
   3.734897460502183*^9}},ExpressionUUID->"f0c9f99c-f6e4-4210-b01d-\
2c2d88e559f1"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Methods\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.734897461898624*^9, 
  3.734897462809533*^9}},ExpressionUUID->"0d771706-84f1-4462-8f63-\
861c6f23f7e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGrid", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the grid used in ChemDVR calculations\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRKineticEnergy", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the kinetic energy used in ChemDVR calculations\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentialEnergy", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the potential energy used in ChemDVR calculations\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGridPotentialEnergy", "::", "usage"}], "=", "\n", "\t\t", 
   "\"\<Returns the potential energy used in ChemDVR calculations on the grid\
\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentialOptimization", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns potential optimized DVR parameters\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGuessWavefunctions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns guess wavefunctions from uncoupled representation\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRWavefunctions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the wavefunctions computed in ChemDVR calculations\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGridWavefunctions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the wavefunction imposed on the grid\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRInterpolatingWavefunctions", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Returns the wavefunctions interpolating over a grid\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRExpectationValues", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the expectation values of a set of functions\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROperatorMatrix", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the cross-state expectation matrix of a set of \
states->function specs\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROperatorMatrixElements", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns specific elements of the expectation matrix for \
states->function specs\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRExtendWavefunctions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Extends the set of wavefunctions based on previous set\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRView", "::", "usage"}], "=", 
   "\"\<Displays the wavefunctions from a ChemDVR run\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"27629dad-8b76-4388-8d1d-ee32be10dfba"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Interfaces\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7348974657466173`*^9, 
  3.734897467065755*^9}},ExpressionUUID->"96b14e93-f3d7-481c-9ef9-\
b1a39bc64f7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRNotebook", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Opens a notebook for playing with a single ChemDVR instance\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992058058208523`*^9, 3.699205937966085*^9}, 
   3.6992063006686974`*^9, {3.699217771766521*^9, 3.699217787610001*^9}, {
   3.7000047237081833`*^9, 3.7000047237110777`*^9}, {3.732302871050003*^9, 
   3.7323028711239967`*^9}},ExpressionUUID->"a0653ae4-202b-49e1-8cbb-\
a656d8240fd0"]
}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"0e55d644-7d11-4200-87af-\
275b741b17e2"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Management\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699194685465564*^9, 3.6991946906240587`*^9}, {
  3.69919667227174*^9, 
  3.6991966738298597`*^9}},ExpressionUUID->"f1809134-7562-4f45-9ba6-\
eecec2bffabb"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Key Symbols\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"5f6b3324-8946-4264-9466-62f3809160f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$dvroot", "=", "\"\<Root\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvalt", "=", "\"\<ExtraDirs\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrinst", "=", "\"\<Instances\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrke", "=", "\"\<KineticEnergy\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrpe", "=", "\"\<PotentialEnergy\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrgp", "=", "\"\<GridPotentialEnergy\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrpo", "=", "\"\<PotentialOptimization\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrham", "=", "\"\<Hamiltonian\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvreng", "=", "\"\<Energies\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrwf", "=", "\"\<Wavefunctions\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrguwf", "=", "\"\<GuessWavefunctions\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrexwf", "=", "\"\<ExtendWavefunctions\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrgr", "=", "\"\<Grid\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrgrwf", "=", "\"\<GridWavefunctions\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrintwf", "=", "\"\<InterpolatingWavefunctions\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrexv", "=", "\"\<ExpectationValues\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrexm", "=", "\"\<OperatorMatrix\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrexmel", "=", "\"\<OperatorMatrixElements\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrfmgr", "=", "\"\<FormatGrid\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrvw", "=", "\"\<View\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"4a289317-6ac5-443c-a723-e6a37f57ef9b"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Manager\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7247964101546907`*^9, 
  3.724796412920726*^9}},ExpressionUUID->"f098a73f-5cbe-4c4c-9538-\
ba6e1da7a010"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"$ChemDVRManager", ",", "_Association"}], "]"}]}], ",", "\n", 
    "\t", 
    RowBox[{"$ChemDVRManager", "=", "\n", "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Directories\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"<|", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"$dvroot", "\[Rule]", 
           RowBox[{"ChemExtensionDir", "[", "\"\<DVR\>\"", "]"}]}], ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"$dvalt", "\[Rule]", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", " ", "\"\<DVR\>\""}], "}"}], "]"}], "&"}], 
             ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"$ChemExtensionsApp", ",", " ", "$ChemExtensionsDev"}], 
              "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"\"\<Classes\>\"", "\[Rule]", "\"\<Classes\>\""}], ",", 
          "\n", "\t", "\t\t\t\t", 
          RowBox[{"$dvrinst", "\[Rule]", "$dvrinst"}], ",", "\n", "\t", "\t", 
          "\t\t\t", 
          RowBox[{"$dvrpe", "\[Rule]", "$dvrpe"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"$dvrke", "\[Rule]", "$dvrke"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"$dvrwf", "\[Rule]", "$dvrwf"}]}], "\n", "\t", "\t\t\t\t", 
         "|>"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"<|", "\n", "\t\t\t\t\t", "|>"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Settings\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"<|", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Save\>\"", "<>", "$dvrke"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Save\>\"", "<>", "$dvrpe"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Save\>\"", "<>", "$dvrwf"}], "\[Rule]", "False"}]}], 
         "\n", "\t", "\t\t\t\t", "|>"}]}]}], "\n", "\t\t\t", "|>"}]}]}], "\n",
    "\t", "]"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699194692019228*^9, 3.699194765842435*^9}, {
   3.699194851128043*^9, 3.699194930434033*^9}, {3.69919752714707*^9, 
   3.699197555735075*^9}, {3.699212399625697*^9, 3.699212417013726*^9}, {
   3.6992148261517553`*^9, 3.699214912995949*^9}, {3.6992157919744453`*^9, 
   3.699215797060264*^9}, {3.699313651860648*^9, 3.6993136558073807`*^9}, {
   3.700004723723173*^9, 3.7000047237301598`*^9}, {3.707065568451046*^9, 
   3.707065569000152*^9}, {3.7072496730516644`*^9, 3.707249674712637*^9}, {
   3.715474155169467*^9, 3.715474161548007*^9}, {3.72116498033036*^9, 
   3.7211649936878366`*^9}, {3.721165073440366*^9, 3.721165091454728*^9}, 
   3.721165123534378*^9, {3.72116532113274*^9, 3.721165323335895*^9}, {
   3.721165423511046*^9, 3.721165440513072*^9}, {3.731786223837569*^9, 
   3.731786288456511*^9}},ExpressionUUID->"93f8042f-6833-41c5-b66f-\
f8d0000595b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Directory\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699195092148686*^9, 
  3.699195093379696*^9}},ExpressionUUID->"b8018517-ad37-43ef-a25e-\
27cea721b9d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$ChemDVRRoot", ":=", "\n", "\t", 
   RowBox[{"$ChemDVRManager", "[", 
    RowBox[{"\"\<Directories\>\"", ",", " ", "$dvroot"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"$ChemDVRPath", ":=", "\n", "\t", 
  RowBox[{"Prepend", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"$ChemDVRManager", "[", 
     RowBox[{"\"\<Directories\>\"", ",", " ", "$dvalt"}], "]"}], ",", "\n", 
    "\t\t", "$ChemDVRRoot"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.72575193059234*^9, 3.725751935891848*^9}, {
  3.725752006846558*^9, 
  3.725752023040498*^9}},ExpressionUUID->"2e3e6ae6-adeb-44f1-9b99-\
12b0e45337a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDirectory", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Root\>\"", ":>", "$ChemDVRRoot"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Path\>\"", ":>", "$ChemDVRPath"}]}], "\n", "\t\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDirectory", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"dSpec_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", "\"\<Directories\>\"", "]"}], ",", 
          "#"}], "]"}], "&"}], ")"}]}], ",", "\n", "\t", 
     RowBox[{"alt", ":", 
      RowBox[{"True", "|", "False"}], ":", "False"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", "=", 
       RowBox[{"$ChemDVRManager", "[", 
        RowBox[{"\"\<Directories\>\"", ",", " ", "dSpec"}], "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "alt"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"DirectoryQ", "@", 
           RowBox[{"ExpandFileName", "@", "d"}]}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "@", 
                RowBox[{"DirectoryQ", "@", "#"}]}], ",", "\n", "\t", "\t", 
               "\t\t\t\t", 
               RowBox[{"CreateDirectory", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{
                 "CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
                "]"}]}], "\n", "\t", "\t\t\t\t\t", "]"}], ";", "\n", 
             "\t\t\t\t\t", "#"}], "\n", "\t\t\t\t\t", ")"}], "&"}], "@", "\n",
           "\t\t\t\t\t\t", 
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<Root\>\"", "]"}], ",", " ", 
             "dSpec"}], "}"}]}]}], ",", "\n", "\t\t\t\t", "d"}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"{", 
           RowBox[{"#", ",", "dSpec"}], "}"}]}], "&"}], "/@", "\n", 
        "\t\t\t\t", 
        RowBox[{"OptionValue", "[", "\"\<Path\>\"", "]"}]}]}], "\n", "\t\t\t",
       "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.69919509461094*^9, 3.699195096659699*^9}, {
   3.699195208008222*^9, 3.699195336184588*^9}, {3.6992105882204857`*^9, 
   3.6992106217438183`*^9}, 3.699210669282516*^9, {3.700004723741538*^9, 
   3.700004723751171*^9}, {3.7211651553470573`*^9, 3.7211652454048433`*^9}, {
   3.721165879614119*^9, 3.721165884946512*^9}, {3.72575179917066*^9, 
   3.7257518710785847`*^9}, 3.7257519011681337`*^9, {3.725751940601488*^9, 
   3.725751968243597*^9}, {3.7257520022257*^9, 
   3.7257520471967077`*^9}},ExpressionUUID->"d379298d-0b30-46b7-a2bb-\
73d115f220ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]File\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6991962112416353`*^9, 
  3.6991962116160297`*^9}},ExpressionUUID->"a320c753-85b3-4267-8cd8-\
d631fd51046f"],

Cell[BoxData[
 RowBox[{"ChemDVRFile", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.725752657978743*^9, 
  3.7257526586449614`*^9}},ExpressionUUID->"9689d612-51de-4b6d-b973-\
36d4cad7f54e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRFile", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRDirectory"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRFile", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"dSpec_String", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", "\"\<Directories\>\"", "]"}], ",", 
          "#"}], "]"}], "&"}], ")"}]}], ",", "\n", "\t", "fspec__String", ",",
      "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"ops", "=", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"{", 
           RowBox[{"#", ",", "fspec"}], "}"}]}], "&"}], "/@", "\n", "\t", 
        "\t", "\t\t\t", 
        RowBox[{"ChemDVRDirectory", "[", 
         RowBox[{"dSpec", ",", " ", "True", ",", " ", "o"}], "]"}]}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"SelectFirst", "[", 
      RowBox[{"ops", ",", " ", "FileExistsQ", ",", " ", 
       RowBox[{"Last", "@", "ops"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRFile", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"dSpec_String", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"KeyMemberQ", "[", 
        RowBox[{
         RowBox[{"$ChemDVRManager", "[", "\"\<Directories\>\"", "]"}], ",", 
         "#"}], "]"}], "&"}], ")"}]}], ",", "\n", "\t", 
    RowBox[{"ChemDVRObject", "[", "uuid_", "]"}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemDVRFile", "[", "\n", "\t\t", 
   RowBox[{"dSpec", ",", "\n", "\t\t", 
    RowBox[{"uuid", "<>", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"dSpec", ",", 
         RowBox[{"$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], "]"}], ",", 
       "\"\<.mx\>\"", ",", "\"\<.m\>\""}], "]"}]}]}], "\n", "\t\t", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRFile", "[", 
    RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRFile", "[", 
    RowBox[{"$dvrinst", ",", 
     RowBox[{"uuid", "<>", "\"\<.m\>\""}]}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196249392866*^9, 3.6991963261796503`*^9}, {
   3.699197290906156*^9, 3.699197404258923*^9}, {3.699197654516735*^9, 
   3.6991976671531763`*^9}, 3.699211031719146*^9, {3.700004723760951*^9, 
   3.70000472378898*^9}, {3.7211657664875402`*^9, 3.721165853245195*^9}, {
   3.7257520623395853`*^9, 
   3.7257521069598*^9}},ExpressionUUID->"2cd17eba-daab-444c-b177-2dd12bcfc1f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Potentials\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992984509208803`*^9, 
  3.6992984527017813`*^9}},ExpressionUUID->"c0fe0765-71ff-42de-890f-\
b5d957b9a85c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentials", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"pat", ":", 
      RowBox[{"_", "?", "StringPattern`StringPatternQ"}], ":", 
      "\"\<*@.@*\>\""}], ",", "\n", "\t", 
     RowBox[{"nameTake", ":", 
      RowBox[{"True", "|", "False"}], ":", "True"}]}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"nameTake", ",", 
      RowBox[{"Map", "@", "FileNameTake"}], ",", "Identity"}], "]"}], "@", 
    "\n", "\t\t", 
    RowBox[{"FileNames", "[", 
     RowBox[{"pat", ",", 
      RowBox[{"ChemDVRDirectory", "[", "$dvrpe", "]"}]}], "]"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.699298456817053*^9, 3.699298510202167*^9}, 
   3.699298542931211*^9, {3.699298593967393*^9, 3.699298605444406*^9}, {
   3.7000047237976418`*^9, 3.700004723806407*^9}, {3.7110606959939404`*^9, 
   3.711060710065711*^9}, {3.711060747539021*^9, 3.711060782494885*^9}, {
   3.715474085025166*^9, 
   3.7154741124218082`*^9}},ExpressionUUID->"b2dab9c8-0272-4249-b317-\
d47ca5883c0d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Create\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699195345033104*^9, 3.699195347512597*^9}, {
  3.709488234157069*^9, 
  3.7094882350104856`*^9}},ExpressionUUID->"e6e68467-489e-48d7-b2b2-\
900867e3ce63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "norng"}], "=", 
   "\"\<No range function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "nogrid"}], "=", 
   "\"\<No grid function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "noke"}], "=", 
   "\"\<No kinetic energy function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "nope"}], "=", 
   "\"\<No potential energy function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "novw"}], "=", 
   "\"\<No view function provided\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195384114893*^9, 3.699195472726378*^9}, {
   3.699195527939288*^9, 3.699195631008417*^9}, {3.699195830104776*^9, 
   3.6991960236894627`*^9}, {3.699196060475307*^9, 3.699196106858914*^9}, {
   3.699196353854607*^9, 3.699196380644958*^9}, {3.699197563928157*^9, 
   3.699197568348712*^9}, {3.69920103659144*^9, 3.6992011313010597`*^9}, {
   3.699307651428116*^9, 3.699307687937377*^9}, {3.7000047238327627`*^9, 
   3.700004723903949*^9}, {3.709487016597534*^9, 3.709487016662925*^9}, {
   3.70948824485824*^9, 3.709488247093082*^9}, {3.71604517878148*^9, 
   3.716045185928104*^9}, {3.718047987857489*^9, 3.718047995821343*^9}, {
   3.718048044712254*^9, 3.718048047702251*^9}, {3.718049011573656*^9, 
   3.7180490115890903`*^9}, {3.731433538063773*^9, 3.731433547357687*^9}, {
   3.731702329759506*^9, 3.731702329948423*^9}, {3.731702364287512*^9, 
   3.731702417613299*^9}, {3.731703549725778*^9, 3.731703551018561*^9}, {
   3.731785798191135*^9, 3.731785901509429*^9}, 3.731791502462555*^9, {
   3.731988424516515*^9, 3.731988444086177*^9}, 3.732005214417302*^9, {
   3.7324208048317966`*^9, 3.732420843163108*^9}, {3.732421418786071*^9, 
   3.732421452492131*^9}},ExpressionUUID->"4af9c5e7-53f6-49ce-9ecb-\
5508e62cf35a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dvrAssoc", "=", "a"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{"a", ",", "\"\<Class\>\""}], "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRClass", "@", 
         RowBox[{"a", "[", "\"\<Class\>\"", "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", "\"\<UUID\>\""}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "\"\<UUID\>\"", "]"}], "=", 
         RowBox[{"CreateUUID", "[", "\"\<ChemDVR-\>\"", "]"}]}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", "\"\<Name\>\""}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "\"\<Name\>\"", "]"}], "=", 
         "\"\<ChemDVR Instance\>\""}]}], "\n", "\t\t\t", "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"Map", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"dvrAssoc", ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"dvrAssoc", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "\n", "\t", "\t\t\t", "]"}], 
         "&"}], ",", "\n", "\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"$dvrgr", ",", " ", "ChemDVRDefaultGrid"}], "}"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrke", ",", " ", "ChemDVRDefaultKineticEnergy"}], "}"}],
           ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrpe", ",", " ", "ChemDVRDefaultPotentialEnergy"}], 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrgp", ",", " ", "ChemDVRDefaultGridPotentialEnergy"}], 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrpo", ",", " ", "ChemDVRDefaultPotentialOptimize"}], 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrguwf", ",", " ", "ChemDVRDefaultGuessWavefunctions"}],
            "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrwf", ",", " ", "ChemDVRDefaultWavefunctions"}], "}"}],
           ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
           "$dvrexwf", ",", " ", "ChemDVRDefaultExtendWavefunctions"}], "}"}],
           ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrvw", ",", " ", "ChemDVRDefaultPlot"}], "}"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrgrwf", ",", " ", "ChemDVRDefaultGridWavefunctions"}], 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
           "$dvrintwf", ",", " ", 
            "ChemDVRDefaultInterpolatingWavefunctions"}], "}"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrexv", ",", " ", "ChemDVRDefaultExpectationValues"}], 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrexm", ",", " ", "ChemDVRDefaultOperatorMatrix"}], 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
           "$dvrexmel", ",", " ", "ChemDVRDefaultOperatorMatrixElements"}], 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"$dvrfmgr", ",", " ", "ChemDVRDefaultFormatGrid"}], 
           "}"}]}], "\n", "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{
       RowBox[{"$ChemDVRManager", "[", 
        RowBox[{"\"\<Objects\>\"", ",", 
         RowBox[{"dvrAssoc", "[", "\"\<UUID\>\"", "]"}]}], "]"}], "=", "\n", 
       "\t\t\t", "dvrAssoc"}], ";", "\n", "\t\t", 
      RowBox[{"ChemDVRObject", "[", 
       RowBox[{"dvrAssoc", "[", "\"\<UUID\>\"", "]"}], "]"}]}]}], "\n", 
    "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"c527430a-2f87-4f87-81b4-5a378156e0a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "nodvr"}], "=", 
   "\"\<No ChemDVR found at ``\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "[", 
    RowBox[{"dvr_String", "?", "FileExistsQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"Get", "@", "dvr"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "a"}], ",", "\n", "\t\t\t", 
       RowBox[{"ChemDVRCreate", "@", "a"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ChemDVRCreate", "::", "nodvr"}], ",", "dvr"}], "]"}], ";", 
        "\n", "\t\t\t", "$Failed"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "[", 
    RowBox[{"dvr_String", "?", 
     RowBox[{"(", 
      RowBox[{"Not", "@*", "FileExistsQ"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", "=", 
       RowBox[{"ChemDVRFile", "[", 
        RowBox[{"$dvrinst", ",", 
         RowBox[{
          RowBox[{"StringTrim", "[", 
           RowBox[{"dvr", ",", "\"\<.m\>\""}], "]"}], "<>", "\"\<.m\>\""}]}], 
        "]"}]}], "}"}], ",", "\t", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "@", "f"}], ",", "\n", "\t\t\t", 
       RowBox[{"ChemDVRCreate", "@", "f"}], ",", "\n", "\t\t\t", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"ChemDVRCreate", "::", "nodvr"}], ",", "f"}], "]"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195348711438*^9, 3.69919537695263*^9}, {
   3.699195668247119*^9, 3.69919582205576*^9}, {3.699197577429625*^9, 
   3.699197582995524*^9}, 3.699215968027686*^9, {3.699216194303919*^9, 
   3.699216228323208*^9}, {3.700004723913599*^9, 3.700004723939251*^9}, {
   3.7094870166742697`*^9, 
   3.709487016698371*^9}},ExpressionUUID->"d82dfaee-a3d9-44db-b967-\
4b99a77ee4c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Save\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196189299925*^9, 
  3.699196189898581*^9}},ExpressionUUID->"975f6e6a-ad61-41d6-8eff-\
a1db564b7d02"],

Cell[BoxData[
 RowBox[{"ChemDVRSave", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.72575264727064*^9, 
  3.725752650911756*^9}},ExpressionUUID->"280d4be7-d7a6-4f95-81ee-\
100d1649edc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRSave", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRFile"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
    "$dvrinst", ",", "\n", "\t", "name_String", ",", "\n", "\t", 
     "a_Association", ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$ContextPath", "=", 
       RowBox[{"{", "\"\<System`\>\"", "}"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"ChemDVRFile", "[", 
        RowBox[{"$dvrinst", ",", " ", "name", ",", " ", "o"}], "]"}], ",", 
       "a"}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], ",", " ", "\n", 
     "\t", "name_String", ",", " ", "\n", "\t", 
     RowBox[{"mx_List", "?", "MatrixQ"}], ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Export", "[", "\t", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ChemDVRFile", "[", 
      RowBox[{"prop", ",", " ", "name", ",", " ", "o"}], "]"}], ",", "\n", 
     "\t\t", "mx"}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196191812368*^9, 3.6991962448629293`*^9}, {
  3.699196331707597*^9, 3.699196347962112*^9}, {3.699196398434019*^9, 
  3.6991965558047523`*^9}, {3.699197590398986*^9, 3.699197614261018*^9}, {
  3.699308028186694*^9, 3.6993080333904753`*^9}, {3.6993081032627172`*^9, 
  3.699308104718812*^9}, {3.7000047239488697`*^9, 3.700004723969499*^9}, {
  3.725751735391014*^9, 3.7257517379363337`*^9}, {3.725752116308301*^9, 
  3.725752229691753*^9}, {3.7257526440673513`*^9, 
  3.725752645513895*^9}},ExpressionUUID->"89a3f36f-707a-458c-92b7-\
15cd0922f973"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Optional", "[", 
      RowBox[{"$dvrinst", ",", "$dvrinst"}], "]"}], ",", "\n", "\t", 
     RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRSave", "[", "\n", "\t\t", 
    RowBox[{"$dvrinst", ",", "\n", "\t\t", 
     RowBox[{"uuid", "<>", "\"\<.m\>\""}], ",", "\n", "\t\t", 
     RowBox[{"$ChemDVRManager", "[", 
      RowBox[{"\"\<Objects\>\"", ",", "uuid"}], "]"}], ",", "\n", "\t\t", 
     "o"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], ",", " ", "\n", 
     "\t", 
     RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], ",", "\n", "\t", 
     RowBox[{"mx_List", "?", "MatrixQ"}], ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRSave", "[", "\n", "\t\t", 
    RowBox[{"prop", ",", "\n", "\t\t", 
     RowBox[{"uuid", "<>", "\"\<.mx\>\""}], ",", "\n", "\t\t", "mx", ",", 
     "\n", "\t\t", "o"}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196191812368*^9, 3.6991962448629293`*^9}, {
  3.699196331707597*^9, 3.699196347962112*^9}, {3.699196398434019*^9, 
  3.699196646340361*^9}, {3.6991976174145107`*^9, 3.69919764293287*^9}, {
  3.7000047239809*^9, 3.700004724018681*^9}, {3.725752232253621*^9, 
  3.725752280547689*^9}, {3.72575261655831*^9, 
  3.7257526255219717`*^9}},ExpressionUUID->"64e30358-36f2-4133-a867-\
06c4a00e506b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Clear\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69974390220584*^9, 3.699743904107985*^9}, {
  3.725752750344768*^9, 
  3.725752750702795*^9}},ExpressionUUID->"1687a405-4b2d-4818-b52d-\
ad52783ec6b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRClear", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRFile"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClear", "[", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrinst", "|", "$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], 
     ",", " ", "name_String", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Quiet", "@", 
    RowBox[{"DeleteFile", "@", 
     RowBox[{"ChemDVRFile", "[", 
      RowBox[{"prop", ",", "name", ",", " ", "ops"}], "]"}]}]}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699743915918036*^9, 3.6997439714489717`*^9}, {
  3.7000047240281754`*^9, 3.700004724048818*^9}, {3.725752665788018*^9, 
  3.725752711288278*^9}},ExpressionUUID->"87f4cab0-783b-4d75-ac91-\
17014bac27a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClear", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrinst", "|", "$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], 
     ",", "$dvrinst", ",", "\n", "\t", 
     RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRClear", "[", 
    RowBox[{"prop", ",", "\n", "\t\t", 
     RowBox[{"uuid", "<>", "\"\<.m\>\""}], ",", "\n", "\t\t", "ops"}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699196191812368*^9, 3.6991962448629293`*^9}, {
   3.699196331707597*^9, 3.699196347962112*^9}, {3.699196398434019*^9, 
   3.699196646340361*^9}, {3.6991976174145107`*^9, 3.69919764293287*^9}, {
   3.699743991188962*^9, 3.699744039546144*^9}, 3.699744111140037*^9, {
   3.700004724057789*^9, 3.7000047240904217`*^9}, {3.725752717981954*^9, 
   3.725752741992021*^9}},ExpressionUUID->"129d92c7-910a-45f6-a26c-\
41b8390fd1db"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Helper Methods\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"dcc42bd4-fc39-4313-b4d7-2920f9bc832c"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Helpers\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7323141268114243`*^9, 
  3.7323141279783087`*^9}},ExpressionUUID->"8866e15a-efeb-4100-a898-\
2992c6a05fe3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRValidQ", "[", "uuid_String", "]"}], ":=", "\n", "\t", 
   RowBox[{"KeyMemberQ", "[", 
    RowBox[{
     RowBox[{"$ChemDVRManager", "[", "\"\<Objects\>\"", "]"}], ",", "uuid"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRValidQ", "[", 
    RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"chemDVRValidQ", "[", "uuid", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRValidQ", "[", "___", "]"}], ":=", "False"}], ";"}], "\n", 
 RowBox[{"dvrObjPattern", "=", 
  RowBox[{"ChemDVRObject", "[", 
   RowBox[{"uuid_", "?", "chemDVRValidQ"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6991970873879623`*^9, 3.699197114951487*^9}, {
   3.700004724149478*^9, 3.700004724152691*^9}, {3.707069854270802*^9, 
   3.707069855196086*^9}, {3.7094828545167627`*^9, 3.709482943502315*^9}, 
   3.7095084930456743`*^9},ExpressionUUID->"5a342f9f-abfb-4115-95b5-\
48c2f2d363b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dvrOpsLookup", "[", 
    RowBox[{"ops___", ",", "key_", ",", "default_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{
         RowBox[{"a_Association", "?", "AssociationQ"}], "\[RuleDelayed]", 
         RowBox[{"Normal", "[", "a", "]"}]}], ",", " ", "1"}], "]"}]}], ",", 
     "\n", "\t\t", "key", ",", "\n", "\t\t", "default"}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dvrOpsLookup", "~", "SetAttributes", "~", "HoldAll"}], 
  ";"}]}], "CodeInput",ExpressionUUID->"5836edc7-b8f8-4a36-8f2f-d4ab75b4bf4f"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Reloading\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699215853546481*^9, 3.699215865496324*^9}, {
  3.732303110910838*^9, 
  3.732303111139042*^9}},ExpressionUUID->"a32dac60-8496-498f-8b7c-\
afc75639578b"],

Cell[BoxData[
 RowBox[{"ChemDVRObject", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.732314122564632*^9, 
  3.732314123447558*^9}},ExpressionUUID->"93ae5292-f035-4cb6-b71e-\
0fa2e4cb2d52"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRObject", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRCreate", "[", "a", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRObject", "[", 
    RowBox[{"uuid_String", "?", 
     RowBox[{"(", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{
           RowBox[{"$ChemDVRManager", "[", "\"\<Objects\>\"", "]"}], ",", 
           "#"}], "]"}]}], "&&", "\n", "\t\t", 
        RowBox[{"FileExistsQ", "@", 
         RowBox[{"ChemDVRFile", "[", 
          RowBox[{"$dvrinst", ",", " ", 
           RowBox[{"#", "<>", "\"\<.m\>\""}]}], "]"}]}]}], "\n", "\t", "&"}], 
      ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRCreate", "[", "uuid", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRObject", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"s_String", "?", 
      RowBox[{"(", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"ChemDVRClass", "[", "#", "]"}], ",", " ", 
           RowBox[{"ChemDVRClass", "[", 
            RowBox[{"_Association", "?", "AssociationQ"}], "]"}]}], "]"}]}], 
        "&"}], "\n", "\t\t", ")"}]}], ",", " ", "\n", "\t", 
     RowBox[{"o___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "s", "]"}], "[", "o", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699215914328568*^9, 3.6992159234698963`*^9}, {
   3.700004724161327*^9, 3.700004724164465*^9}, 3.7094870167073936`*^9, {
   3.732302504111462*^9, 3.732302529972989*^9}, 3.732314119409726*^9, {
   3.732314161027429*^9, 
   3.732314166914674*^9}},ExpressionUUID->"2af9b5b3-af09-44e4-b89c-\
0e68a1dd7b06"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Association\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699211545202107*^9, 
  3.699211546617084*^9}},ExpressionUUID->"3c9f7060-15df-407a-9e7a-\
70819eaf8d07"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRAssociation", "[", 
    RowBox[{"obj", ":", "dvrObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"$ChemDVRManager", "[", 
    RowBox[{"\"\<Objects\>\"", ",", 
     RowBox[{"First", "@", "obj"}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69921154776952*^9, 3.6992115632579403`*^9}, {
   3.700004724191477*^9, 3.7000047241942883`*^9}, 
   3.7095084930563383`*^9},ExpressionUUID->"ab6934f5-2e78-49d8-a4f6-\
2b13b5db67af"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Get\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69919687184629*^9, 3.699196873004815*^9}, {
  3.699201166272868*^9, 
  3.69920116655901*^9}},ExpressionUUID->"54c128bc-80ba-43db-b132-\
4866f23f8a03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", "attribute_"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"$ChemDVRManager", "[", 
      RowBox[{"\"\<Objects\>\"", ",", 
       RowBox[{"First", "@", "obj"}]}], "]"}], ",", "attribute"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", "attribute_", ",", 
     "default_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"$ChemDVRManager", "[", 
      RowBox[{"\"\<Objects\>\"", ",", 
       RowBox[{"First", "@", "obj"}]}], "]"}], ",", "attribute", ",", 
     "default"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196874327071*^9, 3.6991969237260933`*^9}, {
  3.6991971263683977`*^9, 3.699197142208737*^9}, {3.699200987814231*^9, 
  3.699200987818199*^9}, {3.7000047242029953`*^9, 3.7000047242118196`*^9}, {
  3.709508493063735*^9, 
  3.7095084930679703`*^9}},ExpressionUUID->"cf66a048-82dd-4c1d-b33f-\
64a574cbf90f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", 
      RowBox[{"ChemDVRClass", "[", "a_Association", "]"}]}], ",", 
     "attribute_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"a", ",", "attribute"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", 
      RowBox[{"ChemDVRClass", "[", "a_Association", "]"}]}], ",", 
     "attribute_", ",", "default_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"a", ",", "attribute", ",", "default"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196874327071*^9, 3.6991969237260933`*^9}, {
  3.6991971263683977`*^9, 3.699197142208737*^9}, {3.699200987814231*^9, 
  3.699200987818199*^9}, {3.7000047242029953`*^9, 3.7000047242118196`*^9}, {
  3.7075054931792793`*^9, 
  3.707505508082748*^9}},ExpressionUUID->"4a3bcd97-84b3-4dc4-b65f-\
b464c357c319"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PackageAddAutocompletions", "[", "\n", "\t", 
   RowBox[{"ChemDVRGet", ",", "\n", "\t", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"None", ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
       "$dvrgr", ",", "\n", "\t\t\t", "$dvrke", ",", "$dvrpe", ",", "\n", 
        "\t\t\t", "$dvrwf", ",", "$dvrgrwf", ",", "\n", "\t\t\t", "$dvrintwf",
         ",", "$dvrexv", ",", "\n", "\t\t\t", "$dvrexm", ",", "$dvrvw"}], 
       "\n", "\t\t\t", "}"}]}], "\n", "\t\t", "}"}]}], "\n", "\t", "]"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.731944192197379*^9, 
  3.7319443124634647`*^9}},ExpressionUUID->"877a5c13-fe36-4ea5-ad84-\
1ed83d501d83"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Mutate\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699201167782341*^9, 3.699201168118986*^9}, {
  3.727732445412798*^9, 
  3.7277324477491903`*^9}},ExpressionUUID->"f3de83bd-f616-474e-88ba-\
1d14b8447e21"],

Cell[BoxData[{
 RowBox[{"ChemDVRMutate", "//", "ClearAll"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRMutate", "~", "SetAttributes", "~", "HoldAll"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"obPat", "=", "dvrObjPattern"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"ChemDVRMutate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", "obPat"}], ")"}], "[", "at___", "]"}], ",", " ",
         "fn_", ",", " ", "args___"}], "]"}], ":=", "\n", "\t", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k", "=", 
          RowBox[{"First", "@", "obj"}]}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"fn", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", 
           RowBox[{"\"\<Objects\>\"", ",", " ", "k", ",", " ", "at"}], "]"}], 
          ",", "\n", "\t", "\t\t\t", "args"}], "\n", "\t", "\t\t\t", "]"}]}], 
       "\n", "\t", "\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRMutate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", "obPat"}], ")"}], "[", 
         RowBox[{"[", "at___", "]"}], "]"}], ",", " ", "fn_", ",", " ", 
        "args___"}], "]"}], ":=", "\n", "\t", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k", "=", 
          RowBox[{"First", "@", "obj"}]}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"fn", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", 
           RowBox[{"[", 
            RowBox[{"\"\<Objects\>\"", ",", " ", "k", ",", " ", "at"}], "]"}],
            "]"}], ",", "\n", "\t", "\t\t\t", "args"}], "\n", "\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "]"}]}]}]}], "\n", "\t\t", "]"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699201181200038*^9, 3.6992011975899887`*^9}, {
   3.699212494340621*^9, 3.699212508082419*^9}, {3.699298683785789*^9, 
   3.699298685727716*^9}, {3.700004724221751*^9, 3.700004724224667*^9}, 
   3.709508493074862*^9, {3.727732417297453*^9, 3.727732459733604*^9}, {
   3.727732530628047*^9, 3.727732562885551*^9}, {3.7277326380771437`*^9, 
   3.7277326511953506`*^9}, {3.727732784722123*^9, 3.727732827882661*^9}, {
   3.7277329250089407`*^9, 3.727732928540719*^9}, {3.727732985542776*^9, 
   3.727732993803175*^9}, 3.727746177964987*^9, {3.7277464606995373`*^9, 
   3.7277465850180597`*^9}},ExpressionUUID->"60a67af8-e986-4af9-8991-\
228fce2adc64"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Set\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699201167782341*^9, 
  3.699201168118986*^9}},ExpressionUUID->"f76e80e9-cadc-46e7-8988-\
04f1ae9db263"],

Cell[BoxData[
 RowBox[{"ChemDVRSet", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.727732847778788*^9, 
  3.727732848577655*^9}},ExpressionUUID->"cbadf7c6-7ec8-41d8-9130-\
742bef98ab87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRSet", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "attribute__", ",", " ", 
    "value_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemDVRMutate", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"obj", "[", "attribute", "]"}], ",", "\n", "\t\t", "Set", ",", 
    "\n", "\t\t", "value"}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699201181200038*^9, 3.6992011975899887`*^9}, {
   3.699212494340621*^9, 3.699212508082419*^9}, {3.699298683785789*^9, 
   3.699298685727716*^9}, {3.700004724221751*^9, 3.700004724224667*^9}, 
   3.709508493074862*^9, {3.727732417297453*^9, 3.727732420017602*^9}, {
   3.7277325798158283`*^9, 3.727732580579913*^9}, {3.72773261154007*^9, 
   3.727732630162447*^9}, {3.7277326687336473`*^9, 3.727732681480076*^9}, {
   3.727732835276078*^9, 
   3.727732838817815*^9}},ExpressionUUID->"933df858-4c59-4994-8cff-\
5078cd63fb21"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Options\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718052275537813*^9, 
  3.71805227628936*^9}},ExpressionUUID->"76e675a6-136b-4638-94cf-\
4aa1e540a1e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROptions", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "method_String"}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"Options", "@", 
    RowBox[{"ChemDVRGet", "[", 
     RowBox[{"obj", ",", " ", "method"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROptions", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", 
     RowBox[{"methods", ":", 
      RowBox[{"{", "__String", "}"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AssociationMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ChemDVROptions", "[", 
       RowBox[{"obj", ",", "#"}], "]"}], "&"}], ",", " ", "methods"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVROptions", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", 
    RowBox[{"Optional", "[", 
     RowBox[{"All", ",", " ", "All"}], "]"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemDVROptions", "[", 
   RowBox[{"obj", ",", " ", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{
     "$dvrgr", ",", " ", "$dvrke", ",", " ", "\"\<PotentialEnergy\>\"", ",", 
      " ", "$dvrwf", ",", " ", "\"\<View\>\""}], "}"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.718052277162889*^9, 3.7180524333381844`*^9}, {
  3.7317861690846977`*^9, 
  3.731786186099976*^9}},ExpressionUUID->"23e267c4-57eb-4e3a-a6fd-\
d7b732a6d292"],

Cell[BoxData[
 RowBox[{"PackageAddAutocompletions", "[", "\n", "\t", 
  RowBox[{"ChemDVROptions", ",", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"None", ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "$dvrgr", ",", "\n", "\t\t\t", "$dvrke", ",", " ", "$dvrpe", ",", " ", 
       "$dvrwf", ",", "\n", "\t\t\t", "$dvrvw"}], "\n", "\t\t\t", "}"}]}], 
    "\n", "\t\t", "}"}]}], "\n", "\t", "]"}]], "CodeInput",
 CellChangeTimes->{{3.7292526878326817`*^9, 3.7292527370822287`*^9}, {
  3.729252772212078*^9, 
  3.729252781481769*^9}},ExpressionUUID->"843d70d0-891b-459a-9ab0-\
272d1aca4944"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Run Methods\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"b2a8d6f3-a9bf-40da-86d8-a07cda4eaee3"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Dimension\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196985185794*^9, 
  3.699196986312482*^9}},ExpressionUUID->"4515930b-a7a9-41dc-b2af-\
f94aa243e1a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDimension", "[", 
    RowBox[{"obj", ":", "dvrObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Length", "@", 
    RowBox[{"ChemDVRGet", "[", 
     RowBox[{"obj", ",", "\"\<Range\>\""}], "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699196987396916*^9, 3.699197012622686*^9}, {
   3.69919714646422*^9, 3.699197158092146*^9}, 3.699200987825506*^9, {
   3.700004724233077*^9, 3.700004724235886*^9}, 
   3.709508493087575*^9},ExpressionUUID->"99d8ed0b-a8f1-413c-a8d7-\
a4c9c805ac71"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Grid\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"6d9c36b7-ecd7-478f-9310-a7967588dac8"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]New Version\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"cc66b07a-38c9-4f00-9dcf-1514d58d8a57"],

Cell["\<\
\[LeftCeiling]
\tWe\[CloseCurlyQuote]ll just fallback on the old version... but at least it\
\[CloseCurlyQuote]ll provide a consistent interface if we want to change \
things up later.
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"8b3220a1-9bca-4108-b580-38b52e22f267"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGrid", "[", 
    RowBox[{"obj_ChemDVRResultsObject", ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRGrid", "[", 
    RowBox[{
     RowBox[{"obj", "[", "\"\<Object\>\"", "]"}], ",", " ", "ops"}], "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"4b2c6748-1f42-4e50-9909-f355c60f20cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Old Version\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c061d7f7-5ccf-4096-9d30-3b445561fdf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGrid", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"RunRange", "=", "None"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"RunPoints", "=", "None"}]}], "\n", "\t", "\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"RunRange", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"dvrOpsLookup", "[", 
          RowBox[{"ops", ",", " ", "\"\<Range\>\"", ",", " ", "None"}], "]"}],
          ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"l", ":", 
           RowBox[{"{", 
            RowBox[{"Repeated", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], "|", "_DirectedInfinity"}], 
              ",", " ", 
              RowBox[{"{", "2", "}"}]}], "]"}], "}"}]}], "\[RuleDelayed]", 
          RowBox[{"{", "l", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"RunRange", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Repeated", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", "_DirectedInfinity"}], 
               ",", " ", 
               RowBox[{"{", "2", "}"}]}], "]"}], "}"}], ".."}], "}"}]}], 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRSet", "[", 
         RowBox[{"obj", ",", " ", "\"\<Range\>\"", ",", " ", "RunRange"}], 
         "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunRange", "=", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", " ", "\"\<Range\>\""}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"RunRange", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Repeated", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"_", "?", "NumericQ"}], "|", "_DirectedInfinity"}], 
                ",", " ", 
                RowBox[{"{", "2", "}"}]}], "]"}], "}"}], ".."}], "}"}]}], 
          "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t", 
         RowBox[{
         "\"\<DVRRun\>\"", ",", "\n", "\t\t\t\t", 
          "\"\<\\\"Range\\\" `` isn't a valid DVR domain specification\>\"", 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"\"\<MessageParameters\>\"", "\[Rule]", 
           RowBox[{"{", "RunRange", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunPoints", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"dvrOpsLookup", "[", 
          RowBox[{"ops", ",", " ", "\"\<Points\>\"", ",", " ", "None"}], 
          "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"l", ":", 
           RowBox[{"_", "?", "IntegerQ"}]}], "\[RuleDelayed]", 
          RowBox[{"{", "l", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"RunPoints", ",", " ", 
          RowBox[{"{", 
           RowBox[{"__", "?", "IntegerQ"}], "}"}]}], "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"ChemDVRSet", "[", 
         RowBox[{"obj", ",", " ", "\"\<Points\>\"", ",", " ", "RunPoints"}], 
         "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunPoints", "=", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", " ", "\"\<Points\>\""}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"RunPoints", ",", " ", 
           RowBox[{"{", 
            RowBox[{"__", "?", "IntegerQ"}], "}"}]}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t", 
         RowBox[{
         "\"\<DVRRun\>\"", ",", "\n", "\t\t\t\t", 
          "\"\<\\\"Points\\\" `` isn't valid DVR division specification\>\"", 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"\"\<MessageParameters\>\"", "\[Rule]", 
           RowBox[{"{", "RunPoints", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", " ", "$dvrfmgr", ",", 
         RowBox[{"(", 
          RowBox[{"#", "&"}], ")"}]}], "]"}], "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", "$dvrgr"}], "]"}], "[", "\n", "\t\t\t\t", 
         RowBox[{
         "RunPoints", ",", "\n", "\t\t\t\t", "RunRange", ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", 
             RowBox[{"Options", "@", 
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", "$dvrgr"}], "]"}]}]}], "]"}]}]}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "RunPoints"}], "\n", 
       "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"16129866-6626-4a55-bed5-aaffae5731ea"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]KineticEnergy\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699197066071319*^9, 
  3.699197067831275*^9}},ExpressionUUID->"fda1b7b2-ce25-4311-92a5-\
0f815343198c"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]New Version\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"ccf0b3b6-f60b-4251-a2cf-1b16d26adcae"],

Cell["\<\
\[LeftCeiling]
\tClean way to get the kinetic energy off the new DVR results object
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"22efaf01-f2d4-4868-a751-a961d256fdef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRKineticEnergy", "[", 
    RowBox[{
     RowBox[{"obj", ":", "_ChemDVRResultsObject"}], ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"ChemDVRGet", "[", 
     RowBox[{
      RowBox[{"obj", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrke"}], 
     "]"}], "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"obj", "[", "\"\<Grid\>\"", "]"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<TransformationMatrix\>\"", "\[Rule]", 
      RowBox[{"obj", "[", "\"\<Transformation\>\"", "]"}]}], ",", "\n", 
     "\t\t", "ops"}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"f9fa7966-377c-4b9d-a5c5-c4985d268c10"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Old Version\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"e2b54182-ba29-439b-b5c6-6e43f97ad140"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrCalcKE", "[", 
   RowBox[{"obj_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", "=", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"ChemDVRGet", "[", 
      RowBox[{"obj", ",", "$dvrke"}], "]"}], "[", 
     RowBox[{"g", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "@", 
          RowBox[{"ChemDVRGet", "[", 
           RowBox[{"obj", ",", "$dvrke"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
   "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992026475303993`*^9, 3.6992026585309057`*^9}, 
   3.699204470799953*^9, {3.699212671352203*^9, 3.6992126771743193`*^9}, {
   3.7000047242849703`*^9, 3.7000047242909184`*^9}, {3.709508471814032*^9, 
   3.709508477969434*^9}, 
   3.731786179537806*^9},ExpressionUUID->"cfbc0fb1-1d54-4056-a1aa-\
3ead97507f59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRKineticEnergy", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dvrke", "=", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", " ", "$dvrke"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "dvrke"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", "dvrke"}], ",", 
         RowBox[{"Import", "@", "dvrke"}], ",", 
         RowBox[{"Import", "@", 
          RowBox[{"ChemDVRFile", "[", 
           RowBox[{"$dvrke", ",", "dvrke"}], "]"}]}]}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tryLoad", "=", "\n", "\t\t\t\t", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"dvrOpsLookup", "[", 
             RowBox[{"ops", ",", 
              RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"dvrOpsLookup", "[", 
               RowBox[{
               "ops", ",", "\"\<Load\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"$ChemDVRManager", "[", 
                 RowBox[{"\"\<Settings\>\"", ",", 
                  RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}]}], "]"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{"tryLoad", ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FileExistsQ", "@", 
              RowBox[{"ChemDVRFile", "[", 
               RowBox[{"$dvrke", ",", "obj"}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"Import", "@", 
              RowBox[{"ChemDVRFile", "[", 
               RowBox[{"$dvrke", ",", "obj"}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"ChemDVRKineticEnergy", "[", 
              RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}], "\[Rule]", 
                "False"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"\"\<Load\>\"", "\[Rule]", "False"}], ",", "\n", 
               "\t\t\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
            "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ke", "=", 
               RowBox[{"dvrCalcKE", "[", 
                RowBox[{"obj", ",", "ops"}], "]"}]}], "}"}], ",", "\n", "\t", 
             "\t", "\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatrixQ", "[", "ke", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"TrueQ", "@", 
                   RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{"ops", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrke"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{
                    "ops", ",", "\"\<Save\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"$ChemDVRManager", "[", 
                    RowBox[{"\"\<Settings\>\"", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrke"}]}], "]"}]}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"ChemDVRSave", "[", 
                   RowBox[{"$dvrke", ",", "obj", ",", "ke"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
              ";", "\n", "\t\t\t\t\t\t", "ke"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"ee2b44d7-956b-47ab-95cc-c90b4d4abaeb"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PotentialEnergy\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699197066071319*^9, 3.699197067831275*^9}, {
  3.699197929539864*^9, 
  3.6991979307301702`*^9}},ExpressionUUID->"8f6b21e1-2dae-433a-88ed-\
f28406f52387"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"b62ad5e2-7e97-4ecc-9313-e997ee483213"],

Cell["\<\
\[LeftCeiling]
\tClean way to get the potential energy off the new DVR results object
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"61793abf-8bff-4772-bd8e-2e40a351477b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRPotentialEnergy", "[", 
   RowBox[{
    RowBox[{"obj", ":", "_ChemDVRResultsObject"}], ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrpe"}], "]"}],
    "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"obj", "[", "\"\<Grid\>\"", "]"}], ",", "\n", "\t\t", "ops"}], 
   "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"6946d762-1d36-40e9-afd0-a91f59ae4db2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"068d65da-20eb-4da1-b3e2-e06dcd65fe02"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]dvrCalcPE\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.735137614008897*^9},ExpressionUUID->"2751725b-6713-40c2-b4b0-\
1e3818f53d17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrCalcPE", "[", 
   RowBox[{"obj_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", "=", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"ChemDVRGet", "[", 
      RowBox[{"obj", ",", "$dvrpe"}], "]"}], "[", 
     RowBox[{"g", ",", "\n", "\t\t\t", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "@", 
          RowBox[{"ChemDVRGet", "[", 
           RowBox[{"obj", ",", "$dvrpe"}], "]"}]}]}], "]"}]}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699202502378221*^9, 3.699202503064679*^9}, {
  3.6992025466963654`*^9, 3.699202585401987*^9}, {3.699202621390476*^9, 
  3.699202650490757*^9}, {3.699212691009399*^9, 3.6992126943009033`*^9}, {
  3.7000047243426037`*^9, 3.700004724348812*^9}, {3.709508471854788*^9, 
  3.709508477775098*^9}, {3.71106137079778*^9, 3.711061373545039*^9}, {
  3.7317859318661613`*^9, 
  3.731785938025778*^9}},ExpressionUUID->"9ad6a124-cd89-474b-bb85-\
e3188f6782e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]dvrLoadPotential\[RightFloor]", "CodeSubsubsubsubsection",
 
 Evaluatable->True,
 CellChangeTimes->{
  3.7351376085404167`*^9},ExpressionUUID->"71b5a18c-e086-446f-9ac1-\
0110e34809bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrLoadPotential", "[", 
   RowBox[{"obj_", ",", "file_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"DiagonalMatrix", "@", "\n", "\t\t", 
   RowBox[{"Flatten", "[", "\n", "\t\t\t", 
    RowBox[{"dvrImportAlignPotential", "[", "\n", "\t\t\t\t", 
     RowBox[{"obj", ",", "\n", "\t\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"gBase", "=", 
           RowBox[{"dvrOpsLookup", "[", 
            RowBox[{"ops", ",", " ", "$dvrgr", ",", 
             RowBox[{"ChemDVRGrid", "[", 
              RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"dim", "=", 
           RowBox[{"ChemDVRDimension", "[", "obj", "]"}]}]}], "\n", 
         "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"gBase", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "dim", "]"}], "]"}], "=!=", "dim"}], ",", "\n", 
          "\t\t\t\t\t\t", 
          RowBox[{"SelectFirst", "[", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"gBase", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"d2", "=", 
                 RowBox[{"Dimensions", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "d2", "]"}], ">=", "dim"}], "&&", 
                RowBox[{
                 RowBox[{"d2", "[", 
                  RowBox[{"[", "dim", "]"}], "]"}], "===", "dim"}]}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
           "]"}], ",", "\n", "\t\t\t\t\t\t", "gBase"}], "\n", "\t\t\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "file", 
      ",", "\n", "\t\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", 
        RowBox[{"Options", "@", "dvrImportAlignPotential"}]}], "]"}]}], "\n", 
     "\t\t\t\t", "]"}], "\n", "\t\t\t", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.715987439539275*^9, 3.71598748541973*^9}, {
  3.7159881524202757`*^9, 3.715988382478784*^9}, {3.7159884235465384`*^9, 
  3.715988514154049*^9}, {3.716001430877695*^9, 3.716001531775898*^9}, {
  3.716001591212276*^9, 3.716001608251238*^9}, {3.7160016444189568`*^9, 
  3.7160016490811*^9}, {3.716053017735896*^9, 3.716053048807095*^9}, {
  3.73178594087087*^9, 
  3.7317859412190742`*^9}},ExpressionUUID->"e31401a1-e986-4ae0-af21-\
80664d266b78"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Main\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7351376085404167`*^9, 
  3.73513762065285*^9}},ExpressionUUID->"cada3743-23f9-48ae-abfe-\
9a5a8ffc5d69"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentialEnergy", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dvrpe", "=", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"ops", ",", "$dvrpe", ",", 
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", "$dvrpe"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "dvrpe"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", "dvrpe"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"dvrLoadPotential", "[", 
          RowBox[{"obj", ",", "dvrpe", ",", "ops"}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"dvrLoadPotential", "[", 
          RowBox[{"obj", ",", 
           RowBox[{"ChemDVRFile", "[", 
            RowBox[{"$dvrpe", ",", " ", "dvrpe"}], "]"}], ",", "ops"}], 
          "]"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tryLoad", "=", "\n", "\t\t\t\t", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"dvrOpsLookup", "[", 
             RowBox[{"ops", ",", 
              RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"dvrOpsLookup", "[", 
               RowBox[{
               "ops", ",", "\"\<Load\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"$ChemDVRManager", "[", 
                 RowBox[{"\"\<Settings\>\"", ",", 
                  RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}]}], "]"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{"tryLoad", ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FileExistsQ", "@", 
              RowBox[{"ChemDVRFile", "[", 
               RowBox[{"$dvrpe", ",", "obj"}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"dvrLoadPotential", "[", 
              RowBox[{"obj", ",", 
               RowBox[{"ChemDVRFile", "[", 
                RowBox[{"$dvrpe", ",", "obj"}], "]"}], ",", "ops"}], "]"}], 
             ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"ChemDVRPotentialEnergy", "[", 
              RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}], "\[Rule]", 
                "False"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"\"\<Load\>\"", "\[Rule]", "False"}], ",", "\n", 
               "\t\t\t\t\t\t\t", "ops"}], "]"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}], ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pe", "=", 
               RowBox[{"dvrCalcPE", "[", 
                RowBox[{"obj", ",", "ops"}], "]"}]}], "}"}], ",", "\n", "\t", 
             "\t", "\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatrixQ", "[", "pe", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"TrueQ", "@", 
                   RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{"ops", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrpe"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{
                    "ops", ",", "\"\<Save\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"$ChemDVRManager", "[", 
                    RowBox[{"\"\<Settings\>\"", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrpe"}]}], "]"}]}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"ChemDVRSave", "[", 
                   RowBox[{"$dvrpe", ",", "obj", ",", "pe"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
              ";", "\n", "\t\t\t\t\t\t", "pe"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69919706340727*^9, 3.699197075407057*^9}, {
   3.699197180230233*^9, 3.699197282432089*^9}, {3.699197412117258*^9, 
   3.699197459880109*^9}, {3.699197687145479*^9, 3.699197738333351*^9}, {
   3.699197771332769*^9, 3.699197968117004*^9}, 3.699200987864172*^9, {
   3.699202682518722*^9, 3.699202685243787*^9}, {3.699207679861404*^9, 
   3.699207748536065*^9}, {3.6992126960403976`*^9, 3.699212704830653*^9}, {
   3.6992131365682163`*^9, 3.699213148861494*^9}, 3.699214579414061*^9, {
   3.6992150742077227`*^9, 3.6992151005586433`*^9}, {3.699298733613081*^9, 
   3.699298737142411*^9}, {3.69930167926392*^9, 3.699301692373331*^9}, {
   3.699324468280842*^9, 3.699324468456209*^9}, {3.700004724360675*^9, 
   3.700004724391506*^9}, {3.709508471621833*^9, 3.7095084929525843`*^9}, {
   3.715987076337344*^9, 3.7159871011873207`*^9}, {3.7159871838610487`*^9, 
   3.7159872158080263`*^9}, {3.715987256780138*^9, 3.715987300695809*^9}, {
   3.715987378821685*^9, 3.715987382684194*^9}, {3.715987492908499*^9, 
   3.715987524173087*^9}, {3.715987990647231*^9, 3.7159880241951857`*^9}, {
   3.719694602139135*^9, 3.71969462123132*^9}, {3.731785946405696*^9, 
   3.731785972027854*^9}},ExpressionUUID->"c85108af-993b-429f-9b75-\
8f70823bc7e7"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PotentialOptimization\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"ef5055a1-ae41-4dca-9f03-742ecbc2b108"],

Cell["\<\
\[LeftCeiling]
\tNeed to keep adding support for the new ChemDVRResultsObject (should be \
clean and simple but will drastically improve the state of things)
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"37dbf8b8-072b-4edb-bf96-2c00607843a7"],

Cell[BoxData[
 RowBox[{"ChemDVRPotentialOptimization", "//", 
  "Clear"}]], \
"CodeInput",ExpressionUUID->"6151793b-1612-40c2-bac6-c3710c4da1fc"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]New Version\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c7c94688-9b22-4a10-9dbe-abce92c526f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRPotentialOptimization", "[", "\n", "\t", 
   RowBox[{"obj_ChemDVRResultsObject", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"po", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{
        RowBox[{"obj", "[", "\"\<Object\>\"", "]"}], ",", "  ", "$dvrpo"}], 
       "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"po", "[", 
     RowBox[{
      RowBox[{"obj", "[", "\"\<Grid\>\"", "]"}], ",", " ", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{"Options", "@", "po"}]}], "]"}]}], "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"a2bb5f37-aa31-46fe-a626-db0f55251c2c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Old Version\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"a906fa42-b8f8-4f50-b895-645f76e4f721"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRPotentialOptimization", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"po", "=", "\n", "\t\t\t\t", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", "  ", "$dvrpo"}], "]"}]}], "\n", "\t\t\t", "}"}], 
    ",", "\n", "\t\t", 
    RowBox[{"po", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", " ", "ops"}], "]"}]}], "]"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{"Options", "@", "po"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"518f5b2b-dc69-42b3-bed5-4e908c2d639d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GuessWavefunctions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"9d34679d-36bb-460f-b8e5-457ebd81cc7c"],

Cell[BoxData[
 RowBox[{"ChemDVRGuessWavefunctions", "//", 
  "Clear"}]], \
"CodeInput",ExpressionUUID->"4d8eb2ac-47dd-4507-ac83-d8072a701113"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"54436346-cdc9-4cf7-bf33-1b0a6248c309"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRGuessWavefunctions", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"res", ":", "_ChemDVRResultsObject"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wf", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", "  ", "$dvrguwf"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"wf", "[", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ",", " ", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{"Options", "@", "wf"}]}], "]"}]}], "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"b7b58d42-d30e-4f20-a226-c8717796c1c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"5d37b5b6-88a5-4ae5-8902-557764b1c93d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRGuessWavefunctions", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"wf", "=", "\n", "\t\t\t\t", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", "  ", "$dvrguwf"}], "]"}]}], "\n", "\t\t\t", "}"}],
     ",", "\n", "\t\t", 
    RowBox[{"wf", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", " ", "ops"}], "]"}]}], "]"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{"Options", "@", "wf"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"e0e056bc-1f13-4b16-9570-eab65e45db4a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GridPotentialEnergy\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
  3.716044651921208*^9, 3.716044652615678*^9}, {3.718049011698127*^9, 
  3.7180490349269447`*^9}, {3.7314333747697363`*^9, 3.7314333785914497`*^9}, {
  3.734897576857779*^9, 3.734897578149321*^9}, {3.734897627418446*^9, 
  3.734897627746806*^9}},ExpressionUUID->"c913f137-db91-4fc8-8152-\
92eb06eb27d9"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"93072f73-11c1-4caa-a7f1-b45867385024"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRGridPotentialEnergy", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"res", ":", "_ChemDVRResultsObject"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gp", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrgp"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"gp", "[", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ",", " ", 
      RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{"Options", "@", "gp"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"d0262949-4aaa-4023-b580-b30d66b528be"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"a8e8396b-5f48-47b9-89fd-bea8d2e9ef85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRGridPotentialEnergy", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gp", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrgp"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"gp", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrpe", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRPotentialEnergy", "[", 
         RowBox[{"obj", ",", " ", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "gp"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718048971834189*^9, 3.718048980566161*^9}, {3.718052700316998*^9, 
   3.7180527280336647`*^9}, {3.731433382329239*^9, 3.731433478656146*^9}, {
   3.731702515443252*^9, 3.731702572399046*^9}, {3.731702621760159*^9, 
   3.731702630681596*^9}, {3.731782974758243*^9, 3.731782980919476*^9}, {
   3.7317860293571043`*^9, 3.731786044328086*^9}, {3.7348975814159317`*^9, 
   3.734897624621635*^9}, 3.735137584731188*^9, {3.735138296174987*^9, 
   3.7351382972429733`*^9}},ExpressionUUID->"3a7fb0b9-091b-4f38-b180-\
2b41986353a3"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Wavefunctions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 
  3.699201641474523*^9}},ExpressionUUID->"5a53e8b3-32a8-4855-a3a7-\
79924f81f362"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"93d2b5af-042e-4f17-80e0-3557c93c457e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRWavefunctions", "[", 
   RowBox[{"res_ChemDVRResultsObject", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ke", "=", 
       RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}]}], ",", "\n", "\t", 
      "\t\t", 
      RowBox[{"pe", "=", 
       RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}]}], ",", "\n", 
      "\t", "\t\t", 
      RowBox[{"wf", "=", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{
         RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrwf"}], 
        "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"wf", "[", 
     RowBox[{"ke", ",", " ", "pe", ",", " ", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{"Options", "@", "wf"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"049fcb2b-5e98-4eab-9ce4-fda2cabbd131"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"f670a95d-befa-4c15-acfe-a5a6a1cf7ba0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvrCalcWFs", "[", 
    RowBox[{"obj_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ke", "=", "\n", "\t\t\t", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{
         "ops", ",", "\n", "\t\t\t\t", "$dvrke", ",", "\n", "\t\t\t\t", 
          RowBox[{"ChemDVRKineticEnergy", "[", 
           RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"pe", "=", "\n", "\t\t\t", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{
         "ops", ",", "\n", "\t\t\t\t", "\"\<PotentialEnergy\>\"", ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"ChemDVRPotentialEnergy", "[", 
           RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"wf", "=", 
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "$dvrwf"}], "]"}]}]}], "\n", "\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"wf", "[", "\n", "\t\t\t", 
      RowBox[{"ke", ",", "\n", "\t\t\t", "pe", ",", "\n", "\t\t\t", 
       RowBox[{"Sequence", "@@", "\n", "\t\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t", "\t\t\t", 
          RowBox[{"Options", "@", "wf"}]}], "]"}]}]}], "\n", "\t", "\t", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992024004022408`*^9, 3.69920248733768*^9}, {
   3.699212624872706*^9, 3.699212625998097*^9}, {3.699212707000072*^9, 
   3.699212713582858*^9}, {3.699212911221856*^9, 3.699212916269256*^9}, {
   3.6992130160607023`*^9, 3.6992130169464006`*^9}, {3.699213084216807*^9, 
   3.69921309275019*^9}, {3.699213202635684*^9, 3.6992132029697523`*^9}, {
   3.700004724401084*^9, 3.700004724410631*^9}, {3.70950847165125*^9, 
   3.709508477812776*^9}, {3.72443521591695*^9, 3.7244352380073233`*^9}, 
   3.724437605757646*^9, 3.731786186106991*^9, {3.734904803619136*^9, 
   3.734904844774109*^9}},ExpressionUUID->"1047b326-eff4-44fe-b97a-\
dab553f970bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRWavefunctions", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tryLoad", "=", "\n", "\t\t", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{"ops", ",", 
          RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}], ",", "\n", "\t\t\t", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{"ops", ",", "\"\<Load\>\"", ",", "\n", "\t\t\t\t", 
            RowBox[{"$ChemDVRManager", "[", 
             RowBox[{"\"\<Settings\>\"", ",", 
              RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}]}], "]"}]}], "]"}]}], 
         "\n", "\t\t\t", "]"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"tryLoad", ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"ChemDVRFile", "[", 
           RowBox[{"$dvrwf", ",", "obj"}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Import", "@", 
          RowBox[{"ChemDVRFile", "[", 
           RowBox[{"$dvrwf", ",", "obj"}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"ChemDVRWavefunctions", "[", 
          RowBox[{"obj", ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}], "\[Rule]", "False"}], 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{"\"\<Load\>\"", "\[Rule]", "False"}], ",", "\n", 
           "\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wf", "=", 
           RowBox[{"dvrCalcWFs", "[", 
            RowBox[{"obj", ",", "ops"}], "]"}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "wf"}], "\[Equal]", "2"}], "&&", 
             RowBox[{"MatrixQ", "[", 
              RowBox[{
               RowBox[{"Last", "@", "wf"}], ",", "NumericQ"}], "]"}]}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "@", 
               RowBox[{"dvrOpsLookup", "[", 
                RowBox[{"ops", ",", 
                 RowBox[{"\"\<Save\>\"", "<>", "$dvrwf"}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"dvrOpsLookup", "[", 
                  RowBox[{
                  "ops", ",", "\"\<Save\>\"", ",", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"$ChemDVRManager", "[", 
                    RowBox[{"\"\<Settings\>\"", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrwf"}]}], "]"}]}], 
                  "]"}]}], "\n", "\t", "\t", "\t", "\t", "\t\t\t", "]"}]}], 
              ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"ChemDVRSave", "[", 
               RowBox[{"$dvrwf", ",", "obj", ",", "wf"}], "]"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ";", "\n", 
          "\t\t\t\t", "wf"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.719694641000502*^9, 3.7196946484795513`*^9}, {3.7244352424343224`*^9, 
   3.72443524269345*^9}, {3.72443586733749*^9, 3.724435868890486*^9}, 
   3.72443590889896*^9, {3.7317862799776487`*^9, 
   3.7317862878036222`*^9}},ExpressionUUID->"57a776b8-2551-470f-b838-\
ee4d541c9402"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GridWavefunctions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
   3.716044651921208*^9, 3.716044652615678*^9}, 
   3.718049011651156*^9},ExpressionUUID->"aea49a8f-aa11-4fde-b7c1-\
5dba5ec136e6"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"0d19ce27-f7c8-4654-8ce4-89225fef643e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRGridWavefunctions", "[", 
   RowBox[{"res_ChemDVRResultsObject", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gridwf", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrgrwf"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"gridwf", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", " ", 
        RowBox[{"Options", "@", "gridwf"}]}], "]"}]}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"1317ba93-5007-49a4-b632-3c1e2b6f2562"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"add3a64a-85dd-46f7-b8ec-07c5b88331ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRGridWavefunctions", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gridwf", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", "$dvrgrwf"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"gridwf", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrpe", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRPotentialEnergy", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t", 
        RowBox[{"Options", "@", "gridwf"}]}], "\n", "\t", "\t\t\t", "]"}]}], 
     "\n", "\t", "\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718049011670295*^9, 3.718049011675613*^9}, {3.718052731356646*^9, 
   3.7180527546232*^9}, {3.7317861583598413`*^9, 3.7317861795461903`*^9}, {
   3.735193262581439*^9, 
   3.7351932756729918`*^9}},ExpressionUUID->"4e815964-e0f2-4a23-82bc-\
db588bc73ddc"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]InterpolatingWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
  3.716044651921208*^9, 3.716044652615678*^9}, {3.718049011698127*^9, 
  3.7180490349269447`*^9}},ExpressionUUID->"47099584-f7cd-4e62-b9ac-\
a412ed83617e"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"09d2fec7-c7a1-4802-9f96-0b216a4d0308"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRInterpolatingWavefunctions", "[", 
   RowBox[{"res_ChemDVRResultsObject", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"interpf", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrintwf"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"interpf", "[", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ",", " ", 
      RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", " ", "\n", 
      "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "interpf"}]}], "\n", "\t\t\t\t", "]"}]}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"39abb636-7129-4dcf-9230-845bb6f1efa9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"346389ca-4554-4260-9ce9-f26d938da7dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRInterpolatingWavefunctions", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"interpf", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrintwf"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"interpf", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrpe", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRPotentialEnergy", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "interpf"}]}], "\n", "\t\t\t\t", "]"}]}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718048971834189*^9, 3.718048980566161*^9}, {3.718052700316998*^9, 
   3.7180527280336647`*^9}, {3.731702588533813*^9, 3.731702598349668*^9}, 
   3.731785908164795*^9, 3.731786090569401*^9, {3.7317861691064053`*^9, 
   3.731786179555431*^9}, {3.735193282920216*^9, 
   3.735193284333146*^9}},ExpressionUUID->"a31c0ade-159d-4ebe-9fe3-\
1a1e82112f84"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ExpectationValues\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
  3.716044651921208*^9, 3.716044652615678*^9}, {3.718049011698127*^9, 
  3.7180490349269447`*^9}, {3.7314333747697363`*^9, 
  3.7314333785914497`*^9}},ExpressionUUID->"4d53a8d5-a156-4483-8b9d-\
b69cc418159f"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"f15075f0-60e2-4e8f-b156-88de6d00a70f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRExpectationValues", "[", "\n", "\t", 
   RowBox[{"res_ChemDVRResultsObject", ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrexv"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ",", " ", "\n", "\t\t\t", 
      
      RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", " ", "\n", 
      "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"9873609e-1a2d-42ce-aa75-ab1012d3fd17"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"e38d3a57-1711-419d-9984-48dcb28953dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRExpectationValues", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrexv"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrpe", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRPotentialEnergy", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718048971834189*^9, 3.718048980566161*^9}, {3.718052700316998*^9, 
   3.7180527280336647`*^9}, {3.731433382329239*^9, 3.731433478656146*^9}, {
   3.731702515443252*^9, 3.731702572399046*^9}, {3.731702621760159*^9, 
   3.731702630681596*^9}, {3.731782974758243*^9, 3.731782980919476*^9}, {
   3.7317860293571043`*^9, 3.731786044328086*^9}, {3.735193293718824*^9, 
   3.7351932975676527`*^9}},ExpressionUUID->"8fff59da-f124-431c-8055-\
7f0aaac83398"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OperatorMatrix\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
   3.716044651921208*^9, 3.716044652615678*^9}, {3.718049011698127*^9, 
   3.7180490349269447`*^9}, {3.7314333747697363`*^9, 
   3.7314333785914497`*^9}, {3.731787197805335*^9, 3.731787198860034*^9}, 
   3.731791449699368*^9, {3.735193322313945*^9, 
   3.735193322599043*^9}},ExpressionUUID->"3460bcba-b1df-4e89-b1b6-\
40f4f4db6402"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c090eaa1-e375-4177-b22b-a61da7d17698"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVROperatorMatrix", "[", "\n", "\t", 
   RowBox[{"res_ChemDVRResultsObject", ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrexm"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", " ", "\n", 
      "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"5473d4c4-9f6a-416a-837e-b1ff6c5c8de7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"7314bfee-5896-47b5-a6af-46ee71d7eac0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVROperatorMatrix", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrexm"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrpe", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRPotentialEnergy", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"2572244a-ae7d-412e-9907-36aebd21cb01"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OperatorMatrixElements\[RightFloor]", "CodeSubsubsection",
 
 Evaluatable->True,ExpressionUUID->"e873364c-545a-48b1-8576-2a1ac994cf64"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"f39cccf1-caa7-432c-bfeb-7d774edbf2e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVROperatorMatrixElements", "[", "\n", "\t", 
   RowBox[{"res_ChemDVRResultsObject", ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", "\n", "\t\t", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", " ", "_"}], "}"}], "->", "_"}], ")"}], "|", "\n", 
       "\t\t", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", " ", "_"}], "}"}], "..."}], "}"}], "->", "_"}], 
        ")"}], "|", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", " ", "_"}], "}"}], "..."}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"_", ",", " ", "_"}], "}"}]}], ")"}], "->", "_"}], 
          ")"}], ".."}], "}"}]}], ")"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", " ", "$dvrexmel"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Normal", "@", 
       RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", " ", "\n", 
      "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"7c6aa526-ac98-4424-9094-c0953642c345"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"3d2e0a1c-6387-4c1b-b843-a419d08b928c"],

Cell[BoxData[
 RowBox[{"ChemDVROperatorMatrixElements", "//", 
  "Clear"}]], \
"CodeInput",ExpressionUUID->"ec6f1784-33a7-49b1-8314-041bb282c63b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVROperatorMatrixElements", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", "\n", "\t\t", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", " ", "_"}], "}"}], "->", "_"}], ")"}], "|", "\n", 
       "\t\t", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", " ", "_"}], "}"}], "..."}], "}"}], "->", "_"}], 
        ")"}], "|", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", " ", "_"}], "}"}], "..."}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"_", ",", " ", "_"}], "}"}]}], ")"}], "->", "_"}], 
          ")"}], ".."}], "}"}]}], ")"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", "  ", "$dvrexmel"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrpe", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRPotentialEnergy", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"5da9dddc-2991-47ac-bde0-eed7e3348166"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ExtendWavefunctions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"7b248628-51c2-466b-8b2e-ab1f99386303"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"116d84b7-dcf3-48f7-b6fb-31676d96da7d"],

Cell["\<\
\[LeftCeiling]
\tNot implemented yet...
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"71d4182f-7032-4e99-a177-21f24cdd5141"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"f544f3b1-20bc-4f05-981f-173f11055aaf"],

Cell[BoxData[
 RowBox[{"ChemDVRExtendWavefunctions", "//", 
  "Clear"}]], \
"CodeInput",ExpressionUUID->"f116e08b-146a-475a-851c-32ddc4a52d5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRExtendWavefunctions", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"exFun", "=", "\n", "\t\t\t\t", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", "  ", "$dvrexwf"}], "]"}]}], ",", "\n", "\t\t\t", 
      
      RowBox[{"wf", "=", "\n", "\t\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"ops", ",", " ", "$dvrwf", ",", " ", "None"}], "]"}]}]}], 
     "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"wf", ",", " ", "\n", "\t\t\t\t", 
          RowBox[{"_Hold", "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_List", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"VectorQ", "[", 
                 RowBox[{"#", ",", " ", "Internal`RealValuedNumberQ"}], "]"}],
                 "&"}], ")"}]}], ",", " ", 
             RowBox[{"_List", "?", "MatrixQ"}]}], "}"}]}]}], "\n", "\t\t\t\t",
          "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t", 
        RowBox[{
        "Automatic", ",", "\n", "\t\t\t\t", 
         "\"\<\\\"ExtendWavefunctions\\\" requires an initial set of \
wavefunctions\>\""}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ";", 
     "\n", "\t\t", 
     RowBox[{"exFun", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"ops", ",", " ", "$dvrke", ",", " ", 
         RowBox[{"ChemDVRKineticEnergy", "[", 
          RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"ops", ",", " ", "$dvrpe", ",", " ", 
         RowBox[{"ChemDVRPotentialEnergy", "[", 
          RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t\t\t", 
       "wf", ",", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n",
       "\t\t\t", "]"}]}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"28dfcee9-92ff-481c-b980-4e724965b7f4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]View\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69920235802768*^9, 
  3.699202359426248*^9}},ExpressionUUID->"fb4001c0-f4b0-4bd4-8088-\
b30ef2d8ac45"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"42c72d50-4de0-4f0e-8bbf-69ce7c1cf6e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRView", "[", 
    RowBox[{"res_ChemDVRResultsObject", ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"ChemDVRGet", "[", 
     RowBox[{
      RowBox[{"res", "[", "\"\<Object\>\"", "]"}], ",", " ", "\"\<View\>\""}],
      "]"}], "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", "\n", "\t\t", 
     RowBox[{"res", "[", "\"\<Grid\>\"", "]"}], ",", "\n", "\t\t", 
     RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}], ",", "\n", "\t\t", 
     
     RowBox[{"{", "ops", "}"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"eb454de1-42a6-41c8-8575-f2ee930ca8ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"b48012ae-c390-40fa-8d45-5fc7f77a70dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRView", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", "=", "\n", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pe", "=", "\n", "\t\t\t", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{"ops", ",", "\"\<PotentialEnergy\>\"", ",", "\n", "\t\t\t\t", 
          RowBox[{"ChemDVRPotentialEnergy", "[", 
           RowBox[{"obj", ",", 
            RowBox[{"$dvrgr", "\[Rule]", "g"}], ",", "ops"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"wfs", "=", "\n", "\t\t\t\t", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{
           "ops", ",", "\n", "\t\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t\t", 
            
            RowBox[{"ChemDVRWavefunctions", "[", 
             RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"$dvrgr", "\[Rule]", "g"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"\"\<PotentialEnergy\>\"", "\[Rule]", "pe"}], ",", "\n",
               "\t\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
           "\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", "\"\<View\>\""}], "]"}], "[", 
         RowBox[{"wfs", ",", "g", ",", "pe", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"{", "ops", "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699202363319469*^9, 3.6992023675458393`*^9}, {
   3.6992028250013866`*^9, 3.6992028317721567`*^9}, {3.699202872013734*^9, 
   3.699203011208631*^9}, 3.699203234542742*^9, {3.699212727904619*^9, 
   3.699212731496891*^9}, {3.700004724454616*^9, 3.700004724471876*^9}, {
   3.709508471689867*^9, 3.709508492976128*^9}, {3.7247981022662697`*^9, 
   3.7247981134808407`*^9}, {3.731786169113029*^9, 3.731786179575794*^9}, 
   3.732006640936161*^9},ExpressionUUID->"fa0e20f2-79bb-4dec-b848-\
ba00d5a1be3f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Notebook\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992164115355043`*^9, 
  3.699216412743689*^9}},ExpressionUUID->"b6375e8d-b58e-400c-bc15-\
b7c008a5c38b"],

Cell[BoxData[
 RowBox[{"ChemDVRNotebook", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.725750804339913*^9, 
  3.725750805168111*^9}},ExpressionUUID->"1a697234-c53b-4e79-a536-\
c9952d7c89bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRNotebook", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<SaveObject\>\"", "\[Rule]", "True"}], "\n", "\t\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "Notebook"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRNotebook", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"so", "=", 
      RowBox[{"OptionValue", "[", "\"\<SaveObject\>\"", "]"}]}], "\n", 
     "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"so", ",", "\n", "\t\t\t", 
       RowBox[{"ChemDVRSave", "@", "obj"}]}], "\n", "\t\t\t", "]"}], ";", 
     "\n", "\t\t", 
     RowBox[{"CreateDocument", "@", "\n", "\t\t\t", 
      RowBox[{"Notebook", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"First", "@", "\n", "\t", "\t\t\t\t", 
         RowBox[{"Get", "[", 
          RowBox[{"PackageFilePath", "[", 
           RowBox[{
           "\"\<Resources\>\"", ",", " ", "\"\<Templates\>\"", ",", " ", 
            "\"\<DVRNotebook.nb\>\""}], "]"}], "]"}]}], ",", "\n", "\t", 
        "\t\t\t", 
        RowBox[{"FilterRules", "[", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"ops", ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"WindowTitle", "\[Rule]", 
             RowBox[{"ChemDVRGet", "[", 
              RowBox[{"obj", ",", "\"\<UUID\>\""}], "]"}]}]}], "\n", "\t", 
           "\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"Options", "@", "Notebook"}]}], "\n", "\t", "\t\t\t\t", 
         "]"}]}], "\n", "\t", "\t\t\t", "]"}]}]}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6992164140005836`*^9, 3.6992164502732773`*^9}, {
   3.699216543161448*^9, 3.6992165757947474`*^9}, {3.69921702949203*^9, 
   3.699217119965397*^9}, {3.6992171652019577`*^9, 3.6992177523990793`*^9}, {
   3.6992178364829493`*^9, 3.699217870403246*^9}, {3.6992179315570993`*^9, 
   3.699218068469788*^9}, {3.699313762968474*^9, 3.699313806540395*^9}, {
   3.6993139255650883`*^9, 3.69931392578755*^9}, {3.700004724573234*^9, 
   3.7000047246249228`*^9}, 3.709508493025963*^9, {3.725750774614238*^9, 
   3.7257508124228277`*^9}, {3.725751085594125*^9, 3.7257511565373287`*^9}, {
   3.725751550408649*^9, 3.725751610074643*^9}, {3.725751644339746*^9, 
   3.725751686621216*^9}},ExpressionUUID->"d8de4986-047f-42cc-839b-\
bfcfb9bcc0e3"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Run\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"f5cbb795-430b-4dbd-be0b-421441a28da6"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRGetRuntimeOptions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420860018095*^9},ExpressionUUID->"da8213d9-1207-4c95-84f1-\
db674f087fab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRGetRuntimeOptions", "[", 
    RowBox[{
     RowBox[{"baseOpts_", "?", "OptionQ"}], ",", " ", "keys__String"}], "]"}],
    ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{"passedOpts", "=", "\n", "\t\t\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", "\n", "\t\t\t\t\t\t", 
        RowBox[{
        "baseOpts", ",", " ", "\n", "\t\t\t\t\t\t", "\"\<PassedOptions\>\"", 
         ",", "\n", "\t", "\t", "\t", "\t", "\t\t", 
         RowBox[{"{", "}"}]}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], "\n", 
      "\t", "\t", "\t\t", "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"Normal", "@", "\n", "\t\t\t\t", 
      RowBox[{"Merge", "[", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Fold", "[", "\n", "\t", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"KeyDrop", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "Merge", "[", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "{", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                   "dvrOpsLookup", "[", "\n", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "#", "}"}], ",", " ", "\n", "\t", "\t", "\t",
                     "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"#2", "<>", "\"\<Options\>\""}], ",", "\n", "\t", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t", 
                    RowBox[{"{", "}"}]}], "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                   "\t", "\t", "\t\t\t\t\t\t", "#"}], "\n", "\t", "\t", "\t", 
                  "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", 
                 "\t", "\t\t\t\t\t", "First"}], "\n", "\t", "\t", "\t", "\t", 
                "\t", "\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t", "\t", 
               "\t\t\t\t", 
               RowBox[{"#2", "<>", "\"\<Options\>\""}]}], "\n", "\t", "\t", 
              "\t", "\t", "\t\t\t\t", "]"}], "&"}], ",", "\n", "\t", "\t", 
            "\t\t\t\t\t", "passedOpts", ",", "\n", "\t", "\t", "\t\t\t\t\t", 
            RowBox[{"Reverse", "@", 
             RowBox[{"{", "keys", "}"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t", 
           "]"}], ",", "\n", "\t", "\t", "\t\t\t\t", 
          RowBox[{"Fold", "[", "\n", "\t", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"KeyDrop", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "Merge", "[", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "{", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                   "dvrOpsLookup", "[", "\n", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "#", "}"}], ",", " ", "\n", "\t", "\t", "\t",
                     "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"#2", "<>", "\"\<Options\>\""}], ",", "\n", "\t", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t", 
                    RowBox[{"{", "}"}]}], "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                   "\t", "\t", "\t\t\t\t\t\t", "#"}], "\n", "\t", "\t", "\t", 
                  "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", 
                 "\t", "\t\t\t\t\t", "First"}], "\n", "\t", "\t", "\t", "\t", 
                "\t", "\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t", "\t", 
               "\t\t\t\t", 
               RowBox[{"#2", "<>", "\"\<Options\>\""}]}], "\n", "\t", "\t", 
              "\t", "\t", "\t\t\t\t", "]"}], "&"}], ",", "\n", 
            "\t\t\t\t\t\t\t", "baseOpts", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Reverse", "@", 
             RowBox[{"{", "keys", "}"}]}]}], "\n", "\t", "\t\t\t\t\t\t", 
           "]"}]}], "\n", "\t", "\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t", 
        "First"}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"4612d177-c296-4073-bd31-326854372a07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRGetRuntimeOptions", "[", 
    RowBox[{"res_ChemDVRResultsObject", ",", " ", "keys__"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"iChemDVRGetRuntimeOptions", "[", 
    RowBox[{
     RowBox[{"res", "[", "\"\<Options\>\"", "]"}], ",", " ", "keys"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRGetRuntimeOptions", "[", "keys__String", "]"}], ":=", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "keys", "}"}], "===", 
        RowBox[{"{", "\"\<View\>\"", "}"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Echo", "@*", "List"}],
        ",", " ", 
       RowBox[{"##", "&"}]}], "]"}], "@"}], "*)"}], "\n", "\t", 
   RowBox[{
    RowBox[{"With", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"baseOpts", "=", 
        RowBox[{"{", "RunRuntimeOptions", "}"}]}], "\n", "\t\t\t", "}"}], ",",
       "\n", "\t\t", 
      RowBox[{"iChemDVRGetRuntimeOptions", "[", 
       RowBox[{"baseOpts", ",", " ", "keys"}], "]"}]}], "\n", "\t\t", "]"}], "//", 
    RowBox[{"Apply", "[", "Sequence", "]"}]}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"2a7fc280-6e69-4015-bf64-f3bad471dd16"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGrid\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"59401de7-5d77-4cdf-804e-ccce0bc8994c"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Version 2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"3d91b5ec-bb51-49c0-b4d9-544adf2d514f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunGrid", "[", "res_ChemDVRResultsObject", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemDVRGrid", "[", 
   RowBox[{"res", ",", " ", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", 
     RowBox[{"res", ",", " ", "$dvrgr"}], "]"}]}], 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"78d08dfb-f087-4db9-a457-1320b8dc5239"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunCalculateKEQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"eabe51a7-368c-4ce6-a7ec-ff1d6a035866"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Core\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"23e547b1-5ce5-46fa-b659-9f476dbcd09c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunCalculateKEQ", "[", 
   RowBox[{"end_", ",", " ", "wfs_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"!", 
   RowBox[{"(", "\n", "\t\t", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{"end", ",", " ", "$dvrpe"}], "]"}], "||", "\n", "\t\t\t", 
     RowBox[{"(", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", "end", "}"}], ",", " ", "1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{
         "$dvrwf", "|", "$dvrgrwf", "|", "$dvrintwf", "|", "$dvrexv", "|", 
          "$dvrexm", "|", "$dvrexmel", "|", "$dvrvw"}]}], "\n", "\t\t\t\t\t", 
        "]"}], "&&", "\n", "\t\t\t\t\t", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"wfs", ",", " ", 
         RowBox[{"_List", "|", "_Hold", "|", "_WavefunctionsObject"}]}], 
        "]"}]}], "\n", "\t\t\t\t", ")"}]}], "\n", "\t\t\t", 
    ")"}]}]}]], \
"CodeInput",ExpressionUUID->"c3ea790a-43b7-4bed-815e-c5d65b2558ee"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Version 2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"96cac456-35c3-4bc2-bf99-e33d189cf9a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunCalculateKEQ", "[", "res_", "]"}], ":=", "\n", "\t", 
  RowBox[{"iChemDVRRunCalculateKEQ", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"res", "[", 
     RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], ",", 
    "\n", "\t\t", 
    RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"572381f0-be1a-4134-b8b9-02e840076c33"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Version 1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"9b2be229-b642-4af2-9191-0c95424f04fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunCalculateKEQ", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"iChemDVRRunCalculateKEQ", "[", "\n", "\t\t", 
   RowBox[{"RunEndPoint", ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"RunWavefunctions", "===", "None"}], ",", "\n", "\t\t\t", 
      RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", 
         "RunWavefunctions"}], "]"}]}], ",", "\n", "\t\t\t", 
      "RunWavefunctions"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"eeeba5d8-a151-4a61-8874-785f2a800df2"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunKineticEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"e9ad0811-8b07-449b-b450-e241a4399a4f"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Version 2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"dee008ae-8c38-4c0b-b9e6-6351ae92392e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunKineticEnergy", "[", "res_ChemDVRResultsObject", "]"}], 
  ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"Replace", "[", 
    RowBox[{"l_List", "\[RuleDelayed]", 
     RowBox[{"Developer`ToPackedArray", "[", "l", "]"}]}], "]"}], "@", "\n", 
   "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"None", ":>", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRKineticEnergy", "[", 
         RowBox[{"res", ",", " ", 
          RowBox[{"iChemDVRGetRuntimeOptions", "[", 
           RowBox[{"res", ",", " ", "$dvrke"}], "]"}]}], "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"r", ":", 
         RowBox[{
          RowBox[{"_", "?", "SquareMatrixQ"}], "|", 
          RowBox[{"Hold", "[", 
           RowBox[{"_", "?", "SquareMatrixQ"}], "]"}]}]}], "\[RuleDelayed]", 
        "r"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"m", ":", 
         RowBox[{"{", 
          RowBox[{"__", "?", "SquareMatrixQ"}], "}"}]}], ":>", "\n", 
        "\t\t\t\t", 
        RowBox[{"ChemDVRKroeneckerProductKineticEnergy", "@", "m"}]}], ",", 
       "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"m", ":", 
         RowBox[{"Hold", "[", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"{", 
              RowBox[{"__", "?", "SquareMatrixQ"}], "}"}], "]"}], ")"}]}], 
          "]"}]}], ":>", "\n", "\t\t\t\t", 
        RowBox[{"Hold", "[", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"ChemDVRKroeneckerProductKineticEnergy", "@", "m"}]}], 
         "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"_", ":>", "\n", "\t\t\t\t", 
        RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
         "Automatic", ",", "\n", "\t", "\t\t\t\t", 
          "\"\<Kinetic energy isn't in valid format\>\""}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"b6f005f8-d818-4d18-9e72-e182c79e7675"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Version1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"97619773-ee7c-49e3-aaa1-0cd31302c1ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunKineticEnergy", "[", "obj_ChemDVRObject", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"Switch", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"RunKineticEnergy", "=", "\n", "\t\t\t", 
     RowBox[{"dvrOpsLookup", "[", 
      RowBox[{
      "RunRuntimeOptions", ",", " ", "$dvrke", ",", " ", "RunKineticEnergy"}],
       "]"}]}], ",", "\n", "\t\t", "None", ",", "\n", "\t\t\t", 
    RowBox[{"ChemDVRKineticEnergy", "[", "\n", "\t\t\t\t", 
     RowBox[{"obj", ",", "\n", "\t\t\t\t", 
      RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t\t\t", 
      RowBox[{"\"\<TransformationMatrix\>\"", "->", "RunTransforms"}], ",", 
      "\n", "\t\t\t\t", 
      RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrke", "]"}]}], "\n", 
     "\t\t\t\t", "]"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"_", "?", "SquareMatrixQ"}], "|", 
     RowBox[{"Hold", "[", 
      RowBox[{"_", "?", "SquareMatrixQ"}], "]"}]}], ",", "\n", "\t\t\t", 
    "RunKineticEnergy", ",", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{"__", "?", "SquareMatrixQ"}], "}"}], ",", "\n", "\t\t\t", 
    RowBox[{
    "ChemDVRKroeneckerProductKineticEnergy", "@", "RunKineticEnergy"}], ",", 
    "\n", "\t\t", 
    RowBox[{"Hold", "[", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"{", 
         RowBox[{"__", "?", "SquareMatrixQ"}], "}"}], "]"}], ")"}]}], "]"}], 
    ",", "\n", "\t\t\t", 
    RowBox[{"Hold", "[", 
     RowBox[{"Evaluate", "@", 
      RowBox[{
      "ChemDVRKroeneckerProductKineticEnergy", "@", "RunKineticEnergy"}]}], 
     "]"}], ",", "\n", "\t\t", "True", ",", "\n", "\t\t\t", 
    RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t", 
     RowBox[{
     "Automatic", ",", "\n", "\t\t\t\t", 
      "\"\<Kinetic energy isn't in valid format\>\""}], "\n", "\t\t\t\t", 
     "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"3135f1cf-e677-4d74-bac5-07a059b65e13"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunCalculatePEQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"d21a131e-b310-49dd-aada-f219585d0a17"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Core\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"715c4b1b-3824-42b3-99f7-a92825f7bc7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunCalculatePEQ", "[", 
   RowBox[{"end_", ",", " ", "wf_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"!", 
   RowBox[{"(", "\n", "\t\t", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{"end", ",", " ", "\n", "\t\t\t", 
       RowBox[{
       "$dvrwf", "|", "$dvrgrwf", "|", "$dvrintwf", "|", "$dvrexv", "|", 
        "$dvrexm", "|", " ", "$dvrexmel"}]}], "\n", "\t", "\t\t", "]"}], "&&",
      "\n", "\t\t", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"wf", ",", " ", 
       RowBox[{"_List", "|", "_Hold", "|", "_WavefunctionsObject"}]}], 
      "]"}]}], "\n", "\t\t", 
    ")"}]}]}]], \
"CodeInput",ExpressionUUID->"a0c8033e-e332-495f-82a2-e947c99bef3e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"2419bfec-5bcb-4261-823d-eae5634a477d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunCalculatePEQ", "[", "res_", "]"}], ":=", "\n", "\t", 
  RowBox[{"iChemDVRRunCalculatePEQ", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"res", "[", 
     RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], ",", 
    "\n", "\t\t", 
    RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"e07fbe2d-2ab1-419d-86ad-e77c3c919421"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"302a9fce-91a5-48a2-8899-8662d72f4ec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunCalculatePEQ", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"iChemDVRRunCalculatePEQ", "[", "\n", "\t\t", 
   RowBox[{"RunEndPoint", ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"RunWavefunctions", "===", "None"}], ",", "\n", "\t\t\t\t", 
      RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", 
         "RunWavefunctions"}], "]"}]}], ",", "\n", "\t\t\t\t", 
      "RunWavefunctions"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"8eb68d5c-2bad-402e-8613-068e632249ae"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunPotentialEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"8323fc42-e187-436c-b6c2-3cb89ac0e283"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c94f8cba-df0f-4e0f-97e4-9785d6fb7e35"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "iChemDVRRunPotentialEnergy", "[", "res_ChemDVRResultsObject", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{
   RowBox[{"Replace", "[", 
    RowBox[{"l_List", "\[RuleDelayed]", 
     RowBox[{"Developer`ToPackedArray", "[", "l", "]"}]}], "]"}], "@", "\n", 
   "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}], ",", "\n", "\t\t", 
     
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"None", ":>", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRPotentialEnergy", "[", 
         RowBox[{"res", ",", " ", 
          RowBox[{"iChemDVRGetRuntimeOptions", "[", 
           RowBox[{"res", ",", " ", "$dvrpe"}], "]"}]}], "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"r", ":", 
         RowBox[{
          RowBox[{"_", "?", "SquareMatrixQ"}], "|", 
          RowBox[{"Hold", "[", 
           RowBox[{"_", "?", "SquareMatrixQ"}], "]"}]}]}], "\[RuleDelayed]", 
        "r"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"m", ":", 
         RowBox[{"{", 
          RowBox[{"__", "?", "SquareMatrixQ"}], "}"}]}], ":>", "\n", 
        "\t\t\t\t", 
        RowBox[{"ChemDVRDefaultDirectProductPotentialEnergy", "@", "m"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"m", ":", 
         RowBox[{"Hold", "[", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"{", 
              RowBox[{"__", "?", "SquareMatrixQ"}], "}"}], "]"}], ")"}]}], 
          "]"}]}], ":>", "\n", "\t\t\t\t", 
        RowBox[{"Hold", "[", 
         RowBox[{"Evaluate", "@", 
          RowBox[{"ChemDVRDefaultDirectProductPotentialEnergy", "@", "m"}]}], 
         "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"_", ":>", "\n", "\t\t\t\t", 
        RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
         "Automatic", ",", "\n", "\t\t\t\t\t", 
          "\"\<Potential energy isn't in valid format\>\""}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"af464c94-c809-43cb-be0f-d1a7acb56e9f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c9bb44f7-b133-4c11-bc18-336ae90ffdc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunPotentialEnergy", "[", "obj_ChemDVRObject", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Switch", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"RunPotentialEnergy", "=", "\n", "\t\t\t", 
     RowBox[{"dvrOpsLookup", "[", 
      RowBox[{
      "RunRuntimeOptions", ",", " ", "$dvrpe", ",", " ", 
       "RunPotentialEnergy"}], "]"}]}], ",", "\n", "\t\t", "None", ",", "\n", 
    "\t\t\t", 
    RowBox[{"ChemDVRPotentialEnergy", "[", "\n", "\t\t\t\t", 
     RowBox[{"obj", ",", "\n", "\t\t\t\t", 
      RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t\t\t", 
      RowBox[{"\"\<TransformationMatrix\>\"", "->", "RunTransformation"}], 
      ",", "\n", "\t\t\t\t", 
      RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrpe", "]"}]}], "\n", 
     "\t\t\t\t", "]"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"_", "?", "SquareMatrixQ"}], "|", 
     RowBox[{"Hold", "[", 
      RowBox[{"_", "?", "SquareMatrixQ"}], "]"}]}], ",", "\n", "\t\t\t", 
    "RunPotentialEnergy", ",", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{"__", "?", "SquareMatrixQ"}], "}"}], ",", "\n", "\t\t\t\t", 
    RowBox[{
    "ChemDVRDefaultDirectProductPotentialEnergy", "@", "RunPotentialEnergy"}],
     ",", "\n", "\t\t", 
    RowBox[{"Hold", "[", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"{", 
         RowBox[{"__", "?", "SquareMatrixQ"}], "}"}], "]"}], ")"}]}], "]"}], 
    ",", "\n", "\t\t\t", 
    RowBox[{"Hold", "[", "\n", "\t\t\t\t", 
     RowBox[{"Evaluate", "@", "\n", "\t\t\t\t\t", 
      RowBox[{
      "ChemDVRDefaultDirectProductPotentialEnergy", "@", "\n", "\t\t\t\t\t\t",
        "RunPotentialEnergy"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t", 
    "True", ",", "\n", "\t\t\t", 
    RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t", 
     RowBox[{
     "Automatic", ",", "\n", "\t\t\t\t", 
      "\"\<Potential energy isn't in valid format\>\""}], "\n", "\t\t\t\t", 
     "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"92fbc2d0-84e5-4c54-adee-da38cee4de17"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunHamiltonian\[RightFloor]", "CodeSubsubsection",
 
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208626033487`*^9, {3.735159731362295*^9, 
   3.735159733144512*^9}},ExpressionUUID->"42507787-f351-4a4e-b283-\
65f7f270678a"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"ceafac95-08c1-4c3f-ac76-037d5eeb3f2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunHamiltonian", "[", "res_ChemDVRResultsObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"ChemDVRDefaultPrepareHamiltonian", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"res", "@", "\"\<KineticEnergy\>\""}], ",", " ", "\n", "\t\t", 
      RowBox[{"res", "@", "\"\<PotentialEnergy\>\""}], ",", " ", "\n", "\t\t", 
      RowBox[{"FilterRules", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"iChemDVRGetRuntimeOptions", "[", 
          RowBox[{"res", ",", " ", "$dvrwf"}], "]"}], "}"}], ",", " ", "\n", 
        "\t\t\t", 
        RowBox[{"Options", "[", "ChemDVRDefaultPrepareHamiltonian", "]"}]}], 
       "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"c915730a-67c4-4a0d-bb34-130c52620075"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"067cf143-0393-448b-a3ce-8d27722b1cc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunHamiltonian", "[", "obj_ChemDVRObject", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{
    RowBox[{"ChemDVRDefaultPrepareHamiltonian", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Hold", "@", "RunKineticEnergy"}], ",", " ", "\n", "\t\t", 
      RowBox[{"Hold", "@", "RunPotentialEnergy"}], ",", " ", "\n", "\t\t", 
      RowBox[{"FilterRules", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrwf", "]"}], "}"}], 
        ",", " ", "\n", "\t\t\t", 
        RowBox[{"Options", "[", "ChemDVRDefaultPrepareHamiltonian", "]"}]}], 
       "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"4767ae2a-2777-4d0d-9acf-297f34356609"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunCalculateWFQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"29c4efac-442b-46cf-97f9-02296eaf1170"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iiChemDVRRunCalculateWFQ", "[", "end_", "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"Length", "@", "\n", "\t\t", 
     RowBox[{"Complement", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", "end", "}"}], ",", " ", "1"}], "]"}], ",", " ", "\n", 
       "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
        "$dvrham", ",", " ", "$dvrke", ",", " ", "$dvrpe", ",", " ", 
         "$dvrgr"}], "}"}]}], "\n", "\t\t\t", "]"}]}], ">", "0"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"a1d0b43f-b78a-4afa-bc91-a9d7d8e45f14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunCalculateWFQ", "[", "res_", "]"}], ":=", "\n", "\t", 
  RowBox[{"iiChemDVRRunCalculateWFQ", "@", 
   RowBox[{"res", "[", 
    RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"6f691e3d-c657-4b4e-b0f0-4a5d27a3311a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunCalculateWFQ", "[", "]"}], ":=", "\n", "\t", 
   RowBox[{"iiChemDVRRunCalculateWFQ", "@", "RunEndPoint"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"5eeb24da-35df-45a1-b90b-c2e09e99dd9c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGridPotentialEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208626033487`*^9, {3.734897704653696*^9, 
   3.734897707034191*^9}},ExpressionUUID->"ad5b64a8-e2ca-4be3-aa6b-\
50cd078a7c67"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"06c9e241-a01b-4a82-b64a-d6fb457fe9fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "iChemDVRRunGridPotentialEnergy", "[", "res_ChemDVRResultsObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemDVRGridPotentialEnergy", "[", "\n", "\t\t", 
    RowBox[{"res", ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"res", ",", " ", "$dvrgp", ",", " ", "$dvrpe"}], "]"}]}], "\n", 
    "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"ee98e19a-1e64-404a-a0c7-fab2891c86ee"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"daf92320-a439-4934-91cf-3febf74f5dc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunGridPotentialEnergy", "[", "obj_ChemDVRObject", "]"}], 
   ":=", "\n", "\t", 
   RowBox[{"ChemDVRGridPotentialEnergy", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "\"\<GridPotentialEnergy\>\""}], "]"}], "===",
          "ChemDVRDefaultGridPotentialEnergy"}], ",", " ", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"$dvrgp", ",", " ", "$dvrpe"}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"bc2b7f34-76ac-4133-b51b-34c852250db4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGridKineticEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208626033487`*^9, {3.734897704653696*^9, 3.734897707034191*^9}, {
   3.735229150591166*^9, 
   3.735229154293038*^9}},ExpressionUUID->"75ef65f8-4b67-4c44-8950-\
5ac4f6224975"],

Cell["\<\
\[LeftCeiling]
\tThis is such a hack...
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"14f445c6-603a-45c2-a043-fee2ef9fae67"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"17e96013-ad8a-4697-b0d5-62f96186672b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "iChemDVRRunGridKineticEnergy", "[", "res_ChemDVRResultsObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemDVRGridPotentialEnergy", "[", 
    RowBox[{"res", ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"res", ",", " ", "$dvrgp", ",", " ", "$dvrpe"}], "]"}]}], "\n", 
    "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"32ef10af-9910-4d26-94ab-0d3fc1edf222"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"2f1f9a26-37b3-4729-b53b-9411e5cc67f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunGridKineticEnergy", "[", "obj_ChemDVRObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemDVRGridPotentialEnergy", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "\"\<GridPotentialEnergy\>\""}], "]"}], "===",
          "ChemDVRDefaultGridPotentialEnergy"}], ",", " ", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunKineticEnergy", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunKineticEnergy", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunKineticEnergy", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunKineticEnergy"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"$dvrgp", ",", " ", "$dvrpe"}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"b49898ce-f1e3-4c0d-a0f6-53f61a9f0cca"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunPOQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"d57d98da-67e0-48e9-bf73-bd240b7231b4"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Core\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"6c0bd104-86b3-4e0e-a312-9f0331bbcfd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunPOQ", "[", 
   RowBox[{"end_", ",", " ", "wf_", ",", " ", "poQ_", ",", " ", "poOps_"}], 
   "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"end", "===", "$dvrpo"}], "||", "\n", "\t\t", 
   RowBox[{"(", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"(", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"wf", "===", "None"}], "||", "\n", "\t\t\t\t", 
       RowBox[{"MemberQ", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "end", "}"}]}], ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"Alternatives", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
          "$dvrgrwf", ",", " ", "$dvrintwf", ",", "\n", "\t\t\t\t\t\t", 
           "$dvrexv", ",", " ", "$dvrexm", ",", "\n", "\t\t\t\t\t\t", 
           "$dvrexmel"}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t\t", ")"}], "&&", "\n", "\t\t\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
      RowBox[{"poQ", ",", "\n", "\t\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Length", "@", "poOps"}], ">", "0"}]}], ",", "\n", 
         "\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Except", "[", 
           RowBox[{"True", "|", "False"}], "]"}], "\[Rule]", "False"}]}], 
        "\n", "\t", "\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t", "]"}]}], 
    "\n", "\t\t\t", 
    ")"}]}]}]], \
"CodeInput",ExpressionUUID->"b69dc5bd-0eb3-46b7-ab12-327db03e61c9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"157a4ca2-3c6a-4f58-9c02-0713e06c6f45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunPOQ", "[", "res_ChemDVRResultsObject", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"iChemDVRRunPOQ", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"res", "[", 
     RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], ",", 
    "\n", "\t\t", 
    RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", "\n", "\t\t", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"res", "[", 
       RowBox[{"\"\<Options\>\"", ",", " ", "\"\<PotentialOptimize\>\""}], 
       "]"}], ",", " ", 
      RowBox[{"_Missing", "->", "Automatic"}]}], "]"}], ",", "\n", "\t\t", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"res", "[", 
       RowBox[{
       "\"\<Options\>\"", ",", " ", "\"\<PotentialOptimizationOptions\>\""}], 
       "]"}], ",", " ", 
      RowBox[{"_Missing", "->", "None"}]}], "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"1a5a9ec5-09a9-4515-a025-3b062a31c334"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"4e353c23-5306-4b7c-b355-e593ad85337c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunPOQ", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"iChemDVRRunPOQ", "[", "\n", "\t\t", 
   RowBox[{
   "RunEndPoint", ",", "\n", "\t\t", "RunWavefunctions", ",", "\n", "\t\t", 
    RowBox[{"dvrOpsLookup", "[", 
     RowBox[{
     "RunRuntimeOptions", ",", " ", "\"\<PotentialOptimize\>\"", ",", " ", 
      "Automatic"}], "]"}], ",", "\n", "\t\t", 
    RowBox[{"dvrOpsLookup", "[", 
     RowBox[{
     "RunRuntimeOptions", ",", " ", "\"\<PotentialOptimizationOptions\>\"", 
      ",", " ", "None"}], "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"ec7ad00c-3912-4e83-9417-b8df23ae372a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunPotentialOptimization\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"89e1ce39-9f02-42d9-a066-16b72e2377c9"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"7bb12a4c-a591-4217-bed5-dcff6b9ff4d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "iChemDVRRunPotentialOptimization", "[", "res_ChemDVRResultsObject", "]"}], 
  ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"po", ",", " ", "gr", ",", " ", "ke"}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"po", "=", "\n", "\t\t\t", 
      RowBox[{"ChemDVRPotentialOptimization", "[", "\n", "\t\t\t\t", 
       RowBox[{"res", ",", "\n", "\t\t\t\t", 
        RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<OptimizedComponents\>\"", "\[Rule]", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"$dvrgr", ",", " ", "\n", "\t\t\t\t\t\t\t", "$dvrke"}], 
              "\n", "\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"iChemDVRGetRuntimeOptions", "[", 
             RowBox[{
             "res", ",", " ", "$dvrpo", ",", " ", "$dvrke", ",", " ", 
              "$dvrpe"}], "]"}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Options", "@", "ChemDVRDefaultPotentialOptimize"}]}], "\n",
          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"gr", "=", "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l", "=", 
          RowBox[{"po", "[", "$dvrgr", "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "l"}], ">", "1"}], ",", "\n", "\t\t\t\t\t", 
          
          RowBox[{"ChemDVRDirectProductGrid", "@", "l"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"l", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
       "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"ke", "=", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], "=!=",
          "$dvrgr"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l", "=", 
            RowBox[{"po", "[", "$dvrke", "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "l"}], ">", "1"}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"ChemDVRKroeneckerProductKineticEnergy", "@", "l"}], ",", 
            "\n", "\t\t\t\t\t\t", 
            RowBox[{"l", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
         "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "None"}], "\n", 
       "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"po", ",", " ", "gr", ",", " ", "ke"}], "}"}]}]}], "\n", "\t\t",
    "]"}]}]], \
"CodeInput",ExpressionUUID->"fb722bd8-c287-470e-8771-8304d14ee33e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"b5af245e-9774-452a-82d2-ef9427b25a1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunPotentialOptimization", "[", "obj_", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"po", ",", " ", "gr", ",", " ", "ke"}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"po", "=", "\n", "\t\t\t", 
      RowBox[{"ChemDVRPotentialOptimization", "[", "\n", "\t\t\t\t", 
       RowBox[{"obj", ",", "\n", "\t\t\t\t", 
        RowBox[{"$dvrgr", "->", "\n", "\t\t\t\t\t", "RunGrid"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<OptimizedComponents\>\"", "\[Rule]", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"$dvrgr", ",", " ", "\n", "\t\t\t\t\t\t\t", "$dvrke"}], 
              "\n", "\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{
            "iChemDVRGetRuntimeOptions", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
             "$dvrpo", ",", "\n", "\t\t\t\t\t\t\t", "$dvrke", ",", "\n", 
              "\t\t\t\t\t\t\t", "$dvrpe"}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
           "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Options", "@", "ChemDVRDefaultPotentialOptimize"}]}], "\n",
          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"gr", "=", "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l", "=", 
          RowBox[{"po", "[", "$dvrgr", "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "l"}], ">", "1"}], ",", "\n", "\t\t\t\t\t", 
          
          RowBox[{"ChemDVRDirectProductGrid", "@", "l"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"l", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
       "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"ke", "=", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "=!=", "$dvrgr"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l", "=", 
            RowBox[{"po", "[", "$dvrke", "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "l"}], ">", "1"}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"ChemDVRKroeneckerProductKineticEnergy", "@", "l"}], ",", 
            "\n", "\t\t\t\t\t\t", 
            RowBox[{"l", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
         "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "None"}], "\n", 
       "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"po", ",", " ", "gr", ",", " ", "ke"}], "}"}]}]}], "\n", "\t\t",
    "]"}]}]], \
"CodeInput",ExpressionUUID->"d7056ee2-2a84-4ee0-b8ca-c67ba699a11e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGWQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"1050ae22-c51c-4cce-9565-5385de0d84f0"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Core\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"1acf1737-b446-41d2-b68a-bcf3e1666113"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunGWQ", "[", 
   RowBox[{"end_", ",", " ", "ugwf_", ",", " ", "ugwfO_"}], "]"}], ":=", "\n",
   "\t", 
  RowBox[{
   RowBox[{"end", "===", "$dvrguwf"}], "||", "\n", "\t\t", 
   RowBox[{"Replace", "[", "\n", "\t\t\t", 
    RowBox[{"ugwf", ",", "\n", "\t\t\t", 
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Length", "@", "ugwfO"}], ">", "0"}]}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{
        RowBox[{"Except", "[", 
         RowBox[{"True", "|", "False"}], "]"}], "\[Rule]", "False"}]}], "\n", 
      "\t\t\t\t", "}"}]}], "\n", "\t\t\t", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"f7cad83a-c31e-466e-b6f0-9f7ad83ae28a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"bb388901-ad80-403f-a093-d0ddf16861d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunGWQ", "[", "res_", "]"}], ":=", "\n", "\t", 
   RowBox[{"iChemDVRRunGWQ", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"res", "[", 
      RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], ",", 
     "\n", "\t\t", 
     RowBox[{"res", "[", 
      RowBox[{"\"\<Options\>\"", ",", " ", "\"\<UseGuessWavefunctions\>\""}], 
      "]"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"Missing", "\[Rule]", "None"}], "]"}], "@", "\n", "\t\t\t", 
      RowBox[{"res", "[", 
       RowBox[{
       "\"\<Options\>\"", ",", " ", "\"\<GuessWavefunctionsOptions\>\""}], 
       "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"0ae12cf7-e6e2-4041-aa2a-8ed29d23cf9e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"876bee94-b176-4662-a866-250afdfb4a41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunGWQ", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"iChemDVRRunGWQ", "[", "\n", "\t\t", 
   RowBox[{"RunEndPoint", ",", "\n", "\t\t", 
    RowBox[{"dvrOpsLookup", "[", 
     RowBox[{
     "RunRuntimeOptions", ",", " ", "\"\<UseGuessWavefunctions\>\"", ",", " ",
       "False"}], "]"}], ",", "\n", "\t\t", 
    RowBox[{"dvrOpsLookup", "[", "\n", "\t\t\t", 
     RowBox[{
     "RunRuntimeOptions", ",", " ", "\n", "\t\t\t", 
      "\"\<GuessWavefunctionsOptions\>\"", ",", " ", "\n", "\t\t\t", "None"}],
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"e5c98cc7-7a8a-48cc-b6d0-e955cb3d4aad"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGuessWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"cfd0ed5a-279a-475d-9240-b241884472cb"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGuessWavefunctionsComponents\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"183d2e44-68d4-433a-9385-890cd60e0fb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunGuessWavefunctionsComponents", "[", "end_", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "end", ",", "\n", "\t\t\t\t", "$dvreng", ",", "\n", "\t", "\t\t\t\t", 
    RowBox[{
    "\"\<GuessWavefunctionsComponents\>\"", "->", "\n", "\t", "\t\t\t\t\t", 
     RowBox[{
     "{", "\n", "\t", "\t\t\t\t\t\t", "\"\<Energies\>\"", "\n", "\t", 
      "\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t", "\t\t\t", 
    RowBox[{"$dvrwf", "|", "$dvrgrwf", "|", "$dvrintwf"}], ",", "\n", "\t", 
    "\t\t\t\t", 
    RowBox[{
    "\"\<GuessWavefunctionsComponents\>\"", "->", "\n", "\t", "\t\t\t\t\t", 
     RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
      RowBox[{
      "\"\<Grid\>\"", ",", "\n", "\t", "\t", "\t\t\t\t\t", 
       "\"\<Wavefunctions\>\""}], "\n", "\t", "\t\t\t\t\t\t", "}"}]}], ",", 
    "\n", "\t", "\t\t\t", "$dvrguwf", ",", "\n", "\t", "\t\t\t\t", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"{", "}"}]}], ",", "\n", "\t", "\t\t\t", "_", ",", "\n", "\t", 
    "\t\t\t\t", 
    RowBox[{
    "\"\<GuessWavefunctionsComponents\>\"", "\[Rule]", "\n", "\t", 
     "\t\t\t\t\t", 
     RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
      RowBox[{
      "\"\<Grid\>\"", ",", "\n", "\t", "\t", "\t\t\t\t\t", 
       "\"\<Wavefunctions\>\"", ",", "\n", "\t", "\t", "\t\t\t\t\t", 
       "\"\<KineticEnergy\>\"", ",", "\n", "\t", "\t", "\t\t\t\t\t", 
       "\"\<PotentialEnergy\>\""}], "\n", "\t", "\t", "\t\t\t\t\t", "}"}]}]}],
    "\n", "\t", "\t\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"9799d1d8-9da3-400a-961b-e9dc06e5de82"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"bf4c56c8-9407-4d47-946c-f8f4a4792c63"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "iChemDVRRunGuessWavefunctions", "[", "res_ChemDVRResultsObject", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"ChemDVRGuessWavefunctions", "[", "\n", "\t\t", 
   RowBox[{"res", ",", "\n", "\t\t", 
    RowBox[{"iChemDVRRunGuessWavefunctionsComponents", "[", 
     RowBox[{"res", "[", 
      RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], "]"}],
     ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "\n", "\t\t\t", 
     RowBox[{
     "res", ",", "\n", "\t\t\t", "$dvrguwf", ",", "\n", "\t\t\t", "$dvrke", 
      ",", "\n", "\t\t\t", "$dvrpe"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"6ec23b4b-27e3-4fe4-a1c9-5c5d506f1b08"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"2448f50d-b7ef-4956-814f-33b22e886166"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunGuessWavefunctions", "[", "obj_ChemDVRObject", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"ChemDVRGuessWavefunctions", "[", "\n", "\t\t", 
   RowBox[{"obj", ",", "\n", "\t\t", 
    RowBox[{"$dvrgr", "->", "\n", "\t\t\t", "RunGrid"}], ",", "\n", "\t\t", 
    RowBox[{
    "iChemDVRRunGuessWavefunctionsComponents", "@", "\n", "\t\t\t", 
     "RunEndPoint"}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "\n", "\t\t\t", 
     RowBox[{
     "$dvrguwf", ",", "\n", "\t\t\t", "$dvrke", ",", "\n", "\t\t\t", 
      "$dvrpe"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"56f2b85d-6ad8-4622-82be-db17d7804892"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208626033487`*^9, {3.735159731362295*^9, 3.735159733144512*^9}, {
   3.735160103804511*^9, 
   3.735160105530314*^9}},ExpressionUUID->"2ac2601e-e35e-464a-9f5e-\
5534dc799fb1"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"d9f0560b-c0e2-4c38-ab6f-264af7a0695c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunWavefunctions", "[", "res_ChemDVRResultsObject", "]"}], 
  ":=", "\n", "\t", 
  RowBox[{"Developer`ToPackedArray", "/@", "\n", "\t\t", 
   RowBox[{"ChemDVRWavefunctions", "[", 
    RowBox[{"res", ",", "\n", "\t", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"res", ",", " ", "$dvrwf"}], "]"}]}], "\n", "\t", "\t\t", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"34df0bbc-d479-4d0c-9731-ee8106d2461b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"d98934ac-7472-4601-a5ee-ab4ab7d2ff34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunWavefunctions", "[", "obj_ChemDVRObject", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemDVRWavefunctions", "[", 
   RowBox[{"obj", ",", "\n", "\t\t", 
    RowBox[{"$dvrke", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", " ", "\"\<Wavefunctions\>\""}], "]"}], "===", 
        "ChemDVRDefaultWavefunctions"}], ",", " ", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunKineticEnergy", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunKineticEnergy", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunKineticEnergy", "]"}]}], "\n", "\t\t\t\t\t",
         "]"}], ",", "\n", "\t\t\t\t", "RunKineticEnergy"}], "\n", "\t\t\t\t",
       "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", " ", "\"\<Wavefunctions\>\""}], "]"}], "===", 
        "ChemDVRDefaultWavefunctions"}], ",", " ", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
      "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrwf", "]"}]}], "\n", "\t\t",
    "]"}]}]], \
"CodeInput",ExpressionUUID->"fa304e8f-3c3e-4c57-9ba9-7d31e65b5dea"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunExtendWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"9f17f4ab-eac6-4f99-9c88-58a6bbfdacbc"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"0938441f-2d78-4f37-952f-38523cb0fa63"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "iChemDVRRunExtendWavefunctions", "[", "res_ChemDVRResultsObject", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"ChemDVRExtendWavefunctions", "[", 
   RowBox[{"res", ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", 
     RowBox[{"res", ",", " ", "$dvrexwf"}], "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"47745c16-ee3e-4f2b-82e5-23b4d18ee97d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"eedf5c10-82c2-406e-ba4e-8ab1368b7687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunExtendWavefunctions", "[", "obj_ChemDVRObject", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"ChemDVRExtendWavefunctions", "[", 
   RowBox[{"obj", ",", "\n", "\t\t", 
    RowBox[{"$dvrke", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "  ", "$dvrexwf"}], "]"}], "===", 
        "ChemDVRDefaultExtendWavefunctions"}], ",", " ", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunKineticEnergy", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunKineticEnergy", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunKineticEnergy", "]"}]}], "\n", "\t\t\t\t\t",
         "]"}], ",", "\n", "\t\t\t\t", "RunKineticEnergy"}], "\n", "\t\t\t\t",
       "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "  ", "$dvrexwf"}], "]"}], "===", 
        "ChemDVRDefaultExtendWavefunctions"}], ",", " ", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
      "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"$dvrwf", "->", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "  ", "$dvrexwf"}], "]"}], "===", 
        "ChemDVRDefaultExtendWavefunctions"}], ",", " ", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunWavefunctions", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunWavefunctions", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunWavefunctions", "]"}]}], "\n", "\t\t\t\t\t",
         "]"}], ",", "\n", "\t\t\t\t", "RunWavefunctions"}], "\n", "\t\t\t\t",
       "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", " ", "$dvrexwf", "]"}]}], "\n", 
   "\t\t", "]"}]}]], \
"CodeInput",ExpressionUUID->"a9f84289-725d-45c7-b8a5-c2b36ec5352f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunEnergies\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"4b12901a-da2f-4bfb-8d0a-13bfcbeb2666"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c525af61-59a6-4611-9ee6-093971ca50f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunEnergies", "[", "res_ChemDVRResultsObject", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], ",", " ", 
      "_WavefunctionsObject"}], "]"}], ",", " ", "\n", "\t\t", 
    RowBox[{
     RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], "[", 
     "\"\<Energies\>\"", "]"}], ",", "\n", "\t\t", 
    RowBox[{"ChemDVRWavefunctions", "[", 
     RowBox[{"res", ",", "\n", "\t\t\t", 
      RowBox[{"\"\<WavefunctionEigensolver\>\"", "\[Rule]", "Eigenvalues"}], 
      ",", "\n", "\t", "\t\t", 
      RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrwf", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"3d33647e-e0c4-455a-9342-383bacc8702a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"cca2e7b7-ee24-416c-afcd-7f353d8568f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunEnergies", "[", "obj_", "]"}], ":=", "\n", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "[", "RunEnergies", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"RunWavefunctions", ",", " ", "\n", "\t", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_List", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"VectorQ", "[", 
              RowBox[{"#", ",", " ", "Internal`RealValuedNumericQ"}], "]"}], 
             "&"}], ")"}]}], ",", " ", "_"}], "}"}]}], "\n", "\t", "\t\t\t", 
       "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"RunWavefunctions", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"ChemDVRWavefunctions", "[", 
       RowBox[{"obj", ",", "\n", "\t", "\t", "\t\t", 
        RowBox[{"$dvrke", "\[Rule]", "\n", "\t", "\t", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ChemDVRGet", "[", 
             RowBox[{"obj", ",", " ", "\"\<Wavefunctions\>\""}], "]"}], "===",
             "ChemDVRDefaultWavefunctions"}], ",", " ", "\n", "\t", "\t", 
           "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "RunKineticEnergy", "]"}], "===", "Hold"}],
              ",", "\n", "\t", "\t", "\t\t\t\t\t", "RunKineticEnergy", ",", 
             "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"Hold", "[", "RunKineticEnergy", "]"}]}], "\n", "\t", 
            "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t\t\t", 
           "RunKineticEnergy"}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], ",", 
        "\n", "\t", "\t", "\t\t", 
        RowBox[{"$dvrpe", "\[Rule]", "\n", "\t", "\t", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ChemDVRGet", "[", 
             RowBox[{"obj", ",", " ", "\"\<Wavefunctions\>\""}], "]"}], "===",
             "ChemDVRDefaultWavefunctions"}], ",", " ", "\n", "\t", "\t", 
           "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", 
              "Hold"}], ",", "\n", "\t", "\t", "\t\t\t\t\t", 
             "RunPotentialEnergy", ",", "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", "\t", 
            "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t\t\t", 
           "RunPotentialEnergy"}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], ",",
         "\n", "\t", "\t", "\t\t", 
        RowBox[{"\"\<WavefunctionEigensolver\>\"", "\[Rule]", "Eigenvalues"}],
         ",", "\n", "\t", "\t", "\t\t", 
        RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrwf", "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
    "RunEnergies"}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"15a77167-f5ab-4f32-b73b-981e7b826f63"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGridWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208626033487`*^9},ExpressionUUID->"f16a0d28-84dc-4cce-bf57-\
0bdd38d02b21"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"533394d5-d226-4d2c-ba31-5046e8f02c84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "iChemDVRRunGridWavefunctions", "[", "res_ChemDVRResultsObject", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"ChemDVRGridWavefunctions", "[", 
   RowBox[{"res", ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", 
     RowBox[{"res", ",", " ", "$dvrgrwf", ",", " ", "$dvrwf"}], "]"}]}], "\n",
    "\t\t", "]"}]}]], \
"CodeInput",ExpressionUUID->"561eb44d-b8c2-4ba8-931f-e64634793cab"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"3b87c598-9004-4d80-b536-569f5bcd78f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunGridWavefunctions", "[", "obj_ChemDVRObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemDVRGridWavefunctions", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"$dvrwf", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "$dvrgrwf"}], "]"}], "===", 
         "ChemDVRDefaultGridWavefunctions"}], ",", " ", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunWavefunctions", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunWavefunctions", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunWavefunctions", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunWavefunctions"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "$dvrgrwf"}], "]"}], "===", 
         "ChemDVRDefaultGridWavefunctions"}], ",", " ", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"$dvrgrwf", ",", " ", "$dvrwf"}], "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], \
"CodeInput",ExpressionUUID->"b7176fab-afcd-4649-b2af-1c1adffa5d71"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunInterpolatingWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208692026443`*^9},ExpressionUUID->"e5df2a6e-9676-4f01-97df-\
7b9506d8383a"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"5a2a347b-efac-4cd8-9308-c27e8555a526"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "iChemDVRRunInterpolatingWavefunctions", "[", "res_ChemDVRResultsObject", 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRInterpolatingWavefunctions", "[", 
    RowBox[{"res", ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"res", ",", " ", "$dvrintwf"}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"6b04da21-6b74-487e-82bc-a5a914b9d6db"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"92ccddad-186c-49bb-b1ef-73660d2a90f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "iChemDVRRunInterpolatingWavefunctions", "[", "obj_ChemDVRObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemDVRInterpolatingWavefunctions", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"$dvrwf", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "$dvrintwf"}], "]"}], "===", 
         "ChemDVRDefaultInterpolatingWavefunctions"}], ",", " ", "\n", 
        "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunWavefunctions", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunWavefunctions", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunWavefunctions", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunWavefunctions"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "$dvrintwf"}], "]"}], "===", 
         "ChemDVRDefaultInterpolatingWavefunctions"}], ",", " ", "\n", 
        "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrintwf", "]"}]}], "\n", 
    "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"bab9416a-6279-4fa2-9ac0-a6135924d514"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunExpectationValues\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420876842416*^9},ExpressionUUID->"caaab80e-53f5-408e-89ca-\
5b4283bd2812"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]getExpectValueFns\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"8e87329f-1b1f-43b3-8e0a-b9ae3563bd26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getExpectValueFns", "[", "end_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"Rest", "@", "end"}], ",", "\n", "\t\t", 
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ":", 
         RowBox[{"Except", "[", "_List", "]"}]}], "}"}], "\[RuleDelayed]", 
       "f"}], ",", "\n", "\t\t\t", 
      RowBox[{"e_", "\[RuleDelayed]", 
       RowBox[{"Flatten", "[", "e", "]"}]}]}], "\n", "\t\t\t", "}"}]}], "\n", 
   "\t\t", "]"}]}]], \
"CodeInput",ExpressionUUID->"d5115954-a5bd-4e23-a75c-c13b0325dfa1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"35b32feb-3013-4d2c-b8ec-fe0a3790df99"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "iChemDVRRunExpectationValues", "[", "res_ChemDVRResultsObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemDVRExpectationValues", "[", 
    RowBox[{"res", ",", "\n", "\t\t", 
     RowBox[{"getExpectValueFns", "@", 
      RowBox[{"res", "[", 
       RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}]}], 
     ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", 
      RowBox[{"res", ",", " ", "$dvrexv"}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"1c36d0fb-032c-4f07-8590-4ce1620accd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"3baf3b38-d6af-4298-be80-e5615b6429c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunExpectationValues", "[", "obj_ChemDVRObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"ChemDVRExpectationValues", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"getExpectValueFns", "@", "RunEndPoint"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrwf", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "$dvrexv"}], "]"}], "===", 
         "ChemDVRDefaultExpectationValues"}], ",", " ", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunWavefunctions", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunWavefunctions", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunWavefunctions", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunWavefunctions"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", " ", "$dvrexv"}], "]"}], "===", 
         "ChemDVRDefaultExpectationValues"}], ",", " ", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
          ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrexv", "]"}]}], "\n", 
    "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"b2caac88-0e22-4d9e-903a-a7a39082e7de"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunOperatorMatrix\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420883642754*^9},ExpressionUUID->"1a7bd58b-6ec1-4bea-a16f-\
8055a7c1ef80"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"a0f81a68-589e-4d9a-9fa0-e22bfd051752"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunOperatorMatrix", "[", "res_ChemDVRResultsObject", "]"}],
   ":=", "\n", "\t", 
  RowBox[{"ChemDVROperatorMatrix", "[", "\n", "\t\t", 
   RowBox[{"res", ",", "\n", "\t\t", 
    RowBox[{"getExpectValueFns", "@", 
     RowBox[{"res", "[", "\"\<EndPoint\>\"", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "\n", "\t\t\t", 
     RowBox[{
     "res", ",", "\n", "\t\t\t", "$dvrexm", ",", "\n", "\t\t\t", "$dvrexv"}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"9ef2cde1-9870-4862-9a3a-e30fea2fe180"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"7949c06d-477b-41c4-9015-06bbebd73a1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunOperatorMatrix", "[", "obj_ChemDVRObject", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemDVROperatorMatrix", "[", 
   RowBox[{"obj", ",", "\n", "\t\t", 
    RowBox[{"getExpectValueFns", "@", "RunEndPoint"}], ",", "\n", "\t\t", 
    RowBox[{"$dvrwf", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", " ", "$dvrexm"}], "]"}], "===", 
        "ChemDVRDefaultOperatorMatrix"}], ",", " ", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunWavefunctions", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunWavefunctions", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunWavefunctions", "]"}]}], "\n", "\t\t\t\t\t",
         "]"}], ",", "\n", "\t\t\t\t", "RunWavefunctions"}], "\n", "\t\t\t\t",
       "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
    RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", " ", "$dvrexm"}], "]"}], "===", 
        "ChemDVRDefaultOperatorMatrix"}], ",", " ", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
      "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "\n", "\t\t\t ", 
     RowBox[{"$dvrexm", ",", "\n", "\t\t\t ", "$dvrexv"}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"7fdf74ea-54fb-4e0a-abd2-a50b7621f9a0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunOperatorMatrixElements\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"2336b4cc-865e-4a89-8dbc-2e70f87734de"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V2\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"598f3c63-1ebf-48b7-928e-1d9360b954f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunOperatorMatrix", "[", "res_ChemDVRResultsObject", "]"}],
   ":=", "\n", "\t", 
  RowBox[{"ChemDVROperatorMatrixElements", "[", "\n", "\t\t", 
   RowBox[{"res", ",", "\n", "\t\t", 
    RowBox[{"getExpectValueFns", "@", 
     RowBox[{"res", "[", "\"\<EndPoint\>\"", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "\n", "\t\t\t", 
     RowBox[{
     "res", ",", "\n", "\t\t\t", "$dvrexmel", ",", "\n", "\t\t\t", "$dvrexm", 
      ",", "\n", "\t\t\t", "$dvrexv"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t",
    "]"}]}]], \
"CodeInput",ExpressionUUID->"f7c47e6f-e6b1-4462-828f-85a89fc80a4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]V1\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"6d54502b-94ba-41df-a494-6fd8baec52ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "iChemDVRRunOperatorMatrixElements", "[", "obj_ChemDVRObject", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemDVROperatorMatrixElements", "[", 
   RowBox[{"obj", ",", "\n", "\t\t", 
    RowBox[{"Replace", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Rest", "@", "RunEndPoint"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ":", 
           RowBox[{"Except", "[", "_List", "]"}]}], "}"}], "\[RuleDelayed]", 
         "f"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"e_", "\[RuleDelayed]", 
         RowBox[{"Flatten", "[", "e", "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], 
     "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
    RowBox[{"$dvrwf", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "  ", "$dvrexmel"}], "]"}], "===", "\n", 
        "\t\t\t\t\t", "ChemDVRDefaultOperatorMatrixElements"}], ",", " ", 
       "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunWavefunctions", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunWavefunctions", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunWavefunctions", "]"}]}], "\n", "\t\t\t\t\t",
         "]"}], ",", "\n", "\t\t\t\t", "RunWavefunctions"}], "\n", "\t\t\t\t",
       "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
    RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "  ", "$dvrexmel"}], "]"}], "===", "\n", 
        "\t\t\t\t\t", "ChemDVRDefaultOperatorMatrixElements"}], ",", " ", 
       "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", "Hold"}], 
         ",", "\n", "\t\t\t\t\t", "RunPotentialEnergy", ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "RunPotentialEnergy"}], 
      "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "\n", "\t\t\t ", 
     RowBox[{
     "$dvrexmel", ",", "\n", "\t\t\t ", "$dvrexm", ",", "\n", "\t\t\t ", 
      "$dvrexv"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"43b1673d-97a3-4974-bc58-154f4c0c6499"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRReturnHamiltonianQ\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"470b98d1-d204-4e6f-b574-f0c6ad4fde1b"],

Cell[BoxData["iChemDVRReturnHamiltonianQ"], \
"CodeInput",ExpressionUUID->"3820dc33-8c59-49c3-bc84-b53b3690ebb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]checkResults\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"a275f790-2795-49b7-afee-8a863edc587b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkResults", "[", "res_", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"ChemDVRResultsObjectQ", "@", "res"}]}], ",", "\n", "\t\t\t", 
     RowBox[{"PackageRaiseException", "[", 
      RowBox[{
      "Automatic", ",", "\n", "\t\t\t\t", 
       "\"\<Bad intermediate result object\>\""}], "\n", "\t\t\t\t", "]"}]}], 
    "\n", "\t\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"dd2537d3-f786-4035-8381-a7532161a450"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRun\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420888067032*^9},ExpressionUUID->"71364a2d-f264-4063-8d15-\
0137d8f4ca23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRun", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"meth", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "1"}], "]"}], ",", " ", 
        "Method"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"meth", "===", "\"\<Legacy\>\""}], ",", "\n", "\t\t\t", 
      RowBox[{"iChemDVRRun1", "[", 
       RowBox[{"obj", ",", " ", "ops"}], "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"iChemDVRRun2", "[", 
       RowBox[{"obj", ",", " ", "ops"}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"29003783-9842-44f3-90e9-494045221507"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]New\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"150475ce-b070-42c1-9965-8d82c1c12f6a"],

Cell["\<\
\[LeftCeiling]
\tThe idea here is *only* return the core data and push all other stuff into \
the DVRResultsObject
\[RightFloor]\
\>", "Text",
 Evaluatable->True,ExpressionUUID->"ce2af0ef-9c3c-4fc1-9408-6e1d4a593ad7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRun2", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"RunCheckPoint", "=", "None"}], "}"}], ",", "\n", "\t", 
    RowBox[{"Module", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"res", ",", "\n", "\t\t\t", 
        RowBox[{"object", "=", "obj"}], ",", "\n", "\t\t\t", "grid", ",", 
        "\n", "\t\t\t", "tf", ",", "\n", "\t\t\t", 
        RowBox[{"options", "=", "\n", "\t\t\t\t", 
         RowBox[{"Normal", "@", "\n", "\t\t\t\t\t", 
          RowBox[{"Merge", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"\"\<PassedOptions\>\"", "\[Rule]", 
               RowBox[{"{", "ops", "}"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<RuntimeOptions\>\"", ",", " ", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<Defaults\>\"", ",", " ", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
              "ops"}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", 
            "\t\t\t\t\t\t", "First"}], "\n", "\t\t\t\t\t\t", "]"}]}]}]}], 
       "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"OptionQ", "[", "options", "]"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t", 
          RowBox[{
          "Automatic", ",", "\n", "\t", "\t\t\t", 
           "\"\<Options `` aren't valid for ChemDVRRun (OptionQ failed)\>\"", 
           ",", "\n", "\t\t\t\t", "options"}], "\n", "\t\t\t\t", "]"}]}], 
        "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
       RowBox[{"res", "=", 
        RowBox[{"NewDVRResultsObject", "@", 
         RowBox[{"<|", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Object\>\"", "\[Rule]", "object"}], ",", "\n", 
           "\t\t\t", 
           RowBox[{"\"\<Options\>\"", "\[Rule]", 
            RowBox[{"Association", "@", "options"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"\"\<Extensions\>\"", "\[Rule]", 
            RowBox[{"<|", "|>"}]}]}], "\n", "\t\t\t", "|>"}]}]}], ";", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"res", "[", 
         RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], 
        "=", "\n", "\t\t\t", 
        RowBox[{"Lookup", "[", 
         RowBox[{"options", ",", " ", "Return", ",", " ", "\"\<View\>\""}], 
         "]"}]}], ";", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"\"\<Options\>\"", ",", " ", "\"\<Save\>\""}], "]"}], ",", 
         " ", 
         RowBox[{"ChemDVRSave", "@", "obj"}]}], "]"}], ";", "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DEFAULTS", " ", "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"-", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
        "**)"}], "\n", "\t\t", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Grid\>\"", "]"}], "=", "\n", "\t\t\t", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"res", "[", "\"\<Options\>\"", "]"}], ",", " ", "$dvrgr", 
          ",", " ", 
          RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], "]"}]}], ";", "\n", 
       "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{
        RowBox[{"res", "[", 
         RowBox[{"\"\<Options\>\"", ",", " ", "$dvrgr"}], "]"}], "=."}], ";", 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}], "=", "\n", 
        "\t\t\t", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"res", "[", "\"\<Options\>\"", "]"}], ",", " ", "$dvrke", 
          ",", " ", 
          RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}]}], "]"}]}], ";", 
       "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{
        RowBox[{"res", "[", 
         RowBox[{"\"\<Options\>\"", ",", " ", "$dvrke"}], "]"}], "=."}], ";", 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}], "=", "\n", 
        "\t\t\t", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"res", "[", "\"\<Options\>\"", "]"}], ",", " ", "$dvrpe", 
          ",", " ", 
          RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}]}], "]"}]}], 
       ";", "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{
        RowBox[{"res", "[", 
         RowBox[{"\"\<Options\>\"", ",", " ", "$dvrpe"}], "]"}], "=."}], ";", 
       "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"GRID", " ", "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
        "**)"}], "\n", "\t\t", 
       RowBox[{"grid", "=", 
        RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}], ";", "\n", "\t\t", 
       RowBox[{"Switch", "[", 
        RowBox[{"grid", ",", "\n", "\t\t\t", "None", ",", "\n", "\t\t\t\t", 
         RowBox[{"grid", "=", 
          RowBox[{"iChemDVRRunGrid", "[", "res", "]"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"{", 
          RowBox[{"__", "?", "VectorQ"}], "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"grid", "=", "\n", "\t\t\t\t\t", 
          RowBox[{"ChemDVRDirectProductGrid", "@", 
           RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}]}]}], "\n", 
        "\t\t\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "this", " ", "should", " ", "honestly", " ", "be", " ", "a", " ", 
           "Grid", " ", "object", " ", "where", " ", "this", " ", "would", 
           " ", "be", " ", "a", " ", "method"}], "..."}], " ", "*)"}], "\n", 
        "\t\t\t", "]"}], ";", "\n", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "test", " ", "if", " ", "grid", " ", "also", " ", "has", " ", "a", 
         " ", "Transformation", " ", "matrix"}], " ", "*)"}], "\n", "\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"g", "=", "grid"}], "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"Which", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"VectorQ", "@", 
             RowBox[{"g", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SquareMatrixQ", "@", 
               RowBox[{"g", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "||", 
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "===", "None"}]}], ")"}]}], 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"res", "[", "\"\<Grid\>\"", "]"}], "=", 
             RowBox[{"grid", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"res", "[", "\"\<Transformation\>\"", "]"}], "=", 
             RowBox[{"grid", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";"}], ",", "\n", "\t\t\t\t", 
           
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"{", "__List", "}"}]}], "]"}], "&&", "\n", "\t\t\t\t\t", 
            RowBox[{"AllTrue", "[", 
             RowBox[{
              RowBox[{"g", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "===", "None"}], "||", 
                RowBox[{"SquareMatrixQ", "@", "#"}]}], "&"}]}], "]"}]}], ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"res", "[", "\"\<Grid\>\"", "]"}], "=", 
             RowBox[{"grid", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"res", "[", "\"\<Transformation\>\"", "]"}], "=", 
             RowBox[{"grid", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";"}], ",", "\n", "\t\t\t\t", 
           "True", ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"res", "[", "\"\<Grid\>\"", "]"}], "=", "g"}]}], "\n", 
          "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{"TRANSFORM", " ", "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
        "**)"}], "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", 
           RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], 
          "===", "\"\<Transform\>\""}], ",", " ", 
         RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", "GUESS"}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
          " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"WAVEFUNCTIONS", " ", "--"}], "--"}], "--"}], "--"}]}], 
         "-", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
       "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iChemDVRRunGWQ", "[", "res", "]"}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"res", "[", 
            RowBox[{
            "\"\<Extensions\>\"", ",", " ", "\"\<GuessWavefunctions\>\""}], 
            "]"}], "=", "\n", "\t\t\t\t", 
           RowBox[{"iChemDVRRunGuessWavefunctions", "[", "res", "]"}]}], ";", 
          "\n", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res", "[", 
              RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], 
              "]"}], "===", "$dvrguwf"}], ",", " ", 
            RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"res", "[", 
            RowBox[{
            "\"\<Options\>\"", ",", " ", "\"\<UseGuessWavefunctions\>\""}], 
            "]"}], "=", "\n", "\t\t\t\t", 
           RowBox[{"Lookup", "[", 
            RowBox[{
             RowBox[{"res", "[", "\"\<Options\>\"", "]"}], ",", " ", 
             "\"\<UseGuessWavefunctions\>\"", ",", " ", "False"}], "]"}]}], 
          ";", "\n", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{
             "\"\<Options\>\"", ",", " ", "\"\<UseGuessWavefunctions\>\""}], 
             "]"}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], "=", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"WavefunctionsObject", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"res", "[", 
                 RowBox[{
                 "\"\<Extensions\>\"", ",", " ", "\"\<GuessWavefunctions\>\"",
                   ",", " ", "\"\<Wavefunctions\>\""}], "]"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"res", "[", 
                   RowBox[{
                   "\"\<Extensions\>\"", ",", " ", 
                    "\"\<GuessWavefunctions\>\"", ",", " ", "\"\<Grid\>\""}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"_Missing", "\[RuleDelayed]", 
                   RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
             ";", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}], ":=", 
              "\n", "\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"res", "[", 
                 RowBox[{
                 "\"\<Extensions\>\"", ",", " ", "\"\<GuessWavefunctions\>\"",
                   ",", " ", "\"\<PotentialEnergy\>\""}], "]"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"_Missing", "\[RuleDelayed]", 
                 RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}]}]}], 
               "\n", "\t\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}], ":=", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"res", "[", 
                 RowBox[{
                 "\"\<Extensions\>\"", ",", " ", "\"\<GuessWavefunctions\>\"",
                   ",", " ", "\"\<KineticEnergy\>\""}], "]"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"_Missing", "\[RuleDelayed]", 
                 RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}]}]}], "\n",
                "\t\t\t\t\t\t", "]"}]}], ";"}]}], "\n", "\t\t\t\t", "]"}]}]}],
         "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", 
           RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], 
          "===", "\"\<GuessWavefunctions\>\""}], ",", " ", 
         RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", " ", "POTENTIAL"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"OPTIMIZATION", " ", "--"}], "--"}], "--"}], "--"}]}], 
         "-", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"res", "[", 
         RowBox[{"\"\<Options\>\"", ",", " ", "\"\<PotentialOptimize\>\""}], 
         "]"}], "=", 
        RowBox[{"iChemDVRRunPOQ", "[", "res", "]"}]}], ";", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"\"\<Options\>\"", ",", " ", "\"\<PotentialOptimize\>\""}], 
          "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"po", "=", 
             RowBox[{"iChemDVRRunPotentialOptimization", "[", "res", "]"}]}], 
            "}"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"res", "[", 
              RowBox[{
              "\"\<Extensions\>\"", ",", " ", 
               "\"\<PotentialOptimization\>\""}], "]"}], "=", 
             RowBox[{"po", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"res", "[", "\"\<Grid\>\"", "]"}], "=", 
             RowBox[{"po", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}], "=", 
             RowBox[{"po", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "\n", "\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", 
           RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], "===",
           "$dvrpo"}], ",", " ", 
         RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", " ", "RETURN"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GRID", " ", "--"}], "--"}], "--"}], "--"}], 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], 
       "\n", "\t\t", 
       RowBox[{"RunCheckPoint", "=", "$dvrgr"}], ";", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Complement", "[", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"res", "[", 
                RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], 
                "]"}], "}"}], ",", " ", "1"}], "]"}], ",", " ", "\n", 
            "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"$dvrgr", ",", " ", "\"\<Transform\>\""}], "}"}]}], "\n",
            "\t\t\t\t", "]"}], "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", " ", "\n", "\t\t\t", 
         RowBox[{"Return", "@", "res"}]}], "\n", "\t\t\t", "]"}], ";", "\n", 
       "\t\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", " ", "KINETIC"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ENERGY", " ", "--"}], "--"}], "--"}], "--"}], 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], 
       "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iChemDVRRunCalculateKEQ", "[", "res", "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"res", "[", "\"\<KineticEnergy\>\"", "]"}], "=", 
           RowBox[{"iChemDVRRunKineticEnergy", "[", "res", "]"}]}], ";"}]}], 
        "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", 
           RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], "===",
           "$dvrke"}], ",", " ", 
         RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t", 
       RowBox[{"RunCheckPoint", "=", "$dvrke"}], ";", "\n", "\t\t", "\n", 
       "\t\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", " ", "POTENTIAL"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ENERGY", " ", "--"}], "--"}], "--"}], "--"}], 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], 
       "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iChemDVRRunCalculatePEQ", "[", "res", "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}], "=", "\n", 
          "\t\t\t\t", 
          RowBox[{"iChemDVRRunPotentialEnergy", "[", "res", "]"}]}]}], "\n", 
        "\t\t\t", "]"}], ";", "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", 
           RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], "===",
           "$dvrpe"}], ",", " ", 
         RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t", 
       RowBox[{"RunCheckPoint", "=", "$dvrpe"}], ";", "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{"(*", 
         RowBox[{"*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"-", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"HAMILTONIAN", " ", "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"-", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], 
        "\n", "\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"iChemDVRReturnHamiltonianQ", "[", "res", "]"}], ",", "\n",
            "\t\t\t", 
           RowBox[{
            RowBox[{"res", "[", "\"\<PotentialEnergy\>\"", "]"}], "=", "\n", 
            "\t\t\t\t", 
            RowBox[{"iChemDVRRunPotentialEnergy", "[", "res", "]"}]}]}], "\n",
           "\t\t\t", "]"}], ";", "\n", "\t\t", 
         RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}],
             "===", "$dvrpe"}], ",", " ", 
           RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"RunCheckPoint", "=", "$dvrpe"}], ";"}], "*)"}], "\n", 
       "\t\t", 
       RowBox[{"(*", 
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "EXTENDED"}]}]}]}]}]}]}]}]}]}]}]}]}], 
         " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"WAVEFUNCTIONS", " ", "--"}], "--"}], "--"}], 
                 "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], 
         RowBox[{"--", "-"}]}], " ", "**)"}], "\n", "\t\t", 
       RowBox[{"(*", " ", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Need", " ", "better", " ", "support", " ", "for", " ", 
          RowBox[{"this", ".", " ", "It"}], " ", "should", " ", "be", " ", 
          "used", " ", "in", " ", "place", " ", "of", " ", "the", " ", 
          "Wavefunctions", " ", "or", " ", "something"}], "..."}], " ", "\n", 
        "\t", "*)"}], "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", 
           RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], "]"}], "===",
           "$dvrexwf"}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], "=", 
           RowBox[{"iChemDVRRunExtendWavefunctions", "[", "res", "]"}]}], ";",
           "\n", "\t\t\t", 
          RowBox[{"Return", "@", "res"}]}]}], "\n", "\t\t\t", "]"}], ";", 
       "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"WAVEFUNCTIONS", " ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
       "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iChemDVRRunCalculateWFQ", "[", "res", "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"res", "[", "\"\<Wavefunctions\>\"", "]"}], "=", "\n", 
           "\t\t\t\t", 
           RowBox[{"WavefunctionsObject", "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Evaluate", "@", 
              RowBox[{"iChemDVRRunWavefunctions", "[", "res", "]"}]}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{"Evaluate", "@", 
              RowBox[{"res", "[", "\"\<Grid\>\"", "]"}]}]}], "\n", 
            "\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res", "[", 
              RowBox[{"\"\<Options\>\"", ",", " ", "\"\<EndPoint\>\""}], 
              "]"}], "===", "$dvrwf"}], ",", " ", 
            RowBox[{"Return", "@", "res"}]}], "]"}], ";", "\n", "\t\t\t", 
          RowBox[{"RunCheckPoint", "=", "$dvrwf"}]}]}], "\n", "\t\t\t", "]"}],
        ";", "\n", "\t\t", 
       RowBox[{"checkResults", "[", "res", "]"}], ";", "\n", "\t\t", 
       "res"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"6d4a9adc-d4ac-4d43-841c-5fc9770f889e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Old\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c7683721-4774-4917-a965-88c0a264ab6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRun1", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"RunObject", "=", "obj"}], ",", "\n", "\t\t", 
       RowBox[{"RunRuntimeOptions", "=", "\n", "\t\t\t", 
        RowBox[{"Sequence", "@@", "\n", "\t\t\t\t", 
         RowBox[{"Normal", "@", "\n", "\t\t\t\t\t", 
          RowBox[{"Merge", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"\"\<PassedOptions\>\"", "\[Rule]", 
               RowBox[{"{", "ops", "}"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<RuntimeOptions\>\"", ",", " ", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<Defaults\>\"", ",", " ", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
              "ops"}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", 
            "\t\t\t\t\t\t", "First"}], "\n", "\t\t\t\t\t\t", "]"}]}]}]}], ",",
        "\n", "\t\t", 
       RowBox[{"RunCheckPoint", "=", "None"}], ",", "\n", "\t\t", 
       "RunEndPoint", ",", "\n", "\t\t", 
       RowBox[{"RunGrid", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunTransforms", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunKineticEnergy", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunPotentialEnergy", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunEnergies", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunWavefunctions", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunPotentialOptimize", "=", "Automatic"}], ",", "\n", "\t\t", 
       
       RowBox[{"RunGuessWavefunctions", "=", "Automatic"}], ",", "\n", "\t\t", 
       RowBox[{"RunUseGuessWavefunctions", "=", "False"}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"OptionQ", "[", 
          RowBox[{"{", "RunRuntimeOptions", "}"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"PackageRaiseException", "[", "\n", "\t\t\t\t", 
         RowBox[{
         "Automatic", ",", "\n", "\t", "\t\t\t", 
          "\"\<Options `` aren't valid for ChemDVRRun (OptionQ failed)\>\"", 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"{", "RunRuntimeOptions", "}"}]}], "\n", "\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunEndPoint", "=", "\n", "\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "Return", ",", " ", "\"\<View\>\""}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{
         "RunRuntimeOptions", ",", " ", "\"\<Save\>\"", ",", " ", "False"}], 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRSave", "@", "obj"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{"*", " ", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DEFAULTS", " ", "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
       "**)"}], "\n", "\t\t", 
      RowBox[{"RunGrid", "=", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "$dvrgr", ",", " ", "RunGrid"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"RunWavefunctions", "=", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", 
         "RunWavefunctions"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"RunKineticEnergy", "=", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "$dvrke", ",", " ", 
         "RunKineticEnergy"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"RunPotentialEnergy", "=", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "$dvrpe", ",", " ", 
         "RunPotentialEnergy"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"GRID", " ", "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"-", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
       "**)"}], "\n", "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "RunGrid", ",", "\n", "\t\t\t", "None", ",", "\n", "\t\t\t\t", 
        RowBox[{"RunGrid", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"ChemDVRGrid", "[", 
          RowBox[{"obj", ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrgr", "]"}]}], "\n", 
          "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"__", "?", "VectorQ"}], "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"RunGrid", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"ChemDVRDirectProductGrid", "@", "RunGrid"}]}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"Which", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"VectorQ", "@", 
          RowBox[{"RunGrid", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SquareMatrixQ", "@", 
            RowBox[{"RunGrid", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "||", 
           RowBox[{
            RowBox[{"RunGrid", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "===", "None"}]}], ")"}]}], ",", 
        "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"RunGrid", ",", " ", "RunTransforms"}], "}"}], "=", 
         "RunGrid"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"RunGrid", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"{", "__List", "}"}]}], "]"}], "&&", "\n", "\t\t\t\t", 
         RowBox[{"AllTrue", "[", 
          RowBox[{
           RowBox[{"RunGrid", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "===", "None"}], "||", 
             RowBox[{"SquareMatrixQ", "@", "#"}]}], "&"}]}], "]"}]}], ",", 
        "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"RunGrid", ",", " ", "RunTransforms"}], "}"}], "=", 
         "RunGrid"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{"*", " ", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{"TRANSFORM", " ", "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"-", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
       "**)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "\"\<Transform\>\""}], ",", " ", 
        RowBox[{"Return", "@", "RunTransforms"}]}], "]"}], ";", "\n", "\t\t", 
      "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", "GUESS"}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
         " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"WAVEFUNCTIONS", " ", "--"}], "--"}], "--"}], "--"}]}], 
        "-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"-", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iChemDVRRunGWQ", "[", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"RunGuessWavefunctions", "=", 
          RowBox[{"iChemDVRRunGuessWavefunctions", "[", "obj", "]"}]}], ";", 
         "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RunEndPoint", "===", "$dvrguwf"}], ",", " ", "\n", 
           "\t\t\t\t", 
           RowBox[{"Return", "@", "RunGuessWavefunctions"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"RunUseGuessWavefunctions", "=", "\n", "\t\t\t\t", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{
           "RunRuntimeOptions", ",", " ", "\"\<UseGuessWavefunctions\>\"", 
            ",", " ", "False"}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{"RunUseGuessWavefunctions", ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"RunEnergies", "=", "\n", "\t\t\t\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{
              "RunGuessWavefunctions", ",", " ", "\"\<Energies\>\"", ",", " ",
                "RunEnergies"}], "]"}]}], ";", "\n", "\t\t\t\t", 
            RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{
              "RunGuessWavefunctions", ",", " ", "\"\<Wavefunctions\>\"", ",",
                " ", "RunWavefunctions"}], "]"}]}], ";", "\n", "\t\t\t\t", 
            RowBox[{"RunGrid", "=", "\n", "\t\t\t\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{
              "RunGuessWavefunctions", ",", " ", "\"\<Grid\>\"", ",", " ", 
               "RunGrid"}], "]"}]}], ";", "\n", "\t\t\t\t", 
            RowBox[{"RunPotentialEnergy", "=", "\n", "\t\t\t\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{
              "RunGuessWavefunctions", ",", " ", "\"\<PotentialEnergy\>\"", 
               ",", " ", "RunPotentialEnergy"}], "]"}]}], ";", "\n", 
            "\t\t\t\t", 
            RowBox[{"RunKineticEnergy", "=", "\n", "\t\t\t\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{
              "RunGuessWavefunctions", ",", " ", "\"\<KineticEnergy\>\"", ",",
                " ", "RunKineticEnergy"}], "]"}]}]}]}], "\n", "\t\t\t\t", 
          "]"}]}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", " ", "POTENTIAL"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"OPTIMIZATION", " ", "--"}], "--"}], "--"}], "--"}]}], 
        "-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
      "\t\t", 
      RowBox[{"RunPotentialOptimize", "=", 
       RowBox[{"iChemDVRRunPOQ", "[", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{"RunPotentialOptimize", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
          "RunPotentialOptimize", ",", "\n", "\t\t\t\t", "RunGrid", ",", "\n",
            "\t\t\t\t", "RunKineticEnergy"}], "\n", "\t\t\t\t", "}"}], "=", 
         RowBox[{"iChemDVRRunPotentialOptimization", "[", "obj", "]"}]}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrpo"}], ",", " ", "\n", "\t\t\t", 
        RowBox[{"Return", "@", "RunPotentialOptimize"}]}], "\n", "\t\t\t", 
       "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{"*", " ", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", " ", "RETURN"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
        
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"GRID", " ", "--"}], "--"}], "--"}], "--"}], 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], 
      "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrgr"}], ",", " ", 
        RowBox[{"Return", "@", "RunGrid"}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunCheckPoint", "=", "$dvrgr"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "RunEndPoint", "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"$dvrgr", ",", " ", "\"\<Transform\>\""}], "}"}]}], "]"}],
          "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", " ", "\n", "\t\t\t", 
        RowBox[{"Return", "@", "\n", "\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "RunEndPoint", "}"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"$dvrgr", "\[RuleDelayed]", "RunGrid"}], ",", " ", 
             RowBox[{
             "\"\<Transform\>\"", "\[RuleDelayed]", "RunTransform"}]}], "}"}],
            ",", " ", "\n", "\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t", 
          "]"}]}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{"*", " ", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", " ", "KINETIC"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ENERGY", " ", "--"}], "--"}], "--"}], "--"}], 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], 
      "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iChemDVRRunCalculateKEQ", "[", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"RunKineticEnergy", "=", "\n", "\t\t\t\t", 
          RowBox[{"iChemDVRRunKineticEnergy", "[", "obj", "]"}]}], ";"}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrke"}], ",", " ", 
        RowBox[{"Return", "@", "RunKineticEnergy"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"RunCheckPoint", "=", "$dvrke"}], ";", "\n", "\t\t", "\n", 
      "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "GRID"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
         " ", "KINETIC", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ENERGY", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}]}], "-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "-"}]}]}]}]}]}]}]}], " ", "**)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "\"\<GridKineticEnergy\>\""}], ",", " ",
         "\n", "\t\t\t", 
        RowBox[{"Return", "@", 
         RowBox[{"iChemDVRRunGridKineticEnergy", "[", "obj", "]"}]}]}], "]"}],
       ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{"*", " ", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", " ", "POTENTIAL"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ENERGY", " ", "--"}], "--"}], "--"}], "--"}], 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], 
      "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iChemDVRRunCalculatePEQ", "[", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"RunPotentialEnergy", "=", "\n", "\t\t\t\t", 
         RowBox[{"iChemDVRRunPotentialEnergy", "[", "obj", "]"}]}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrpe"}], ",", " ", 
        RowBox[{"Return", "@", "RunPotentialEnergy"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"RunCheckPoint", "=", "$dvrpe"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", "GRID"}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         "POTENTIAL", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"ENERGY", " ", "--"}], "--"}], "--"}]}], "-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrgp"}], ",", " ", "\n", "\t\t\t", 
        RowBox[{"Return", "@", 
         RowBox[{"iChemDVRRunGridPotentialEnergy", "[", "obj", "]"}]}]}], 
       "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", " ", "$dvrexwf"}], ",", "\n", "\t\t\t", 
        
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RunWavefunctions", "===", "None"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t\t\t", 
            RowBox[{"dvrOpsLookup", "[", 
             RowBox[{
             "RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", 
              "RunWavefunctions"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}], ";", 
         "\n", "\t\t\t", 
         RowBox[{"Return", "@", 
          RowBox[{"iChemDVRRunExtendWavefunctions", "[", "obj", "]"}]}]}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"HAMILTONIAN", " ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"-", 
           RowBox[{"--", 
            RowBox[{"-", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrham"}], ",", " ", "\n", "\t\t\t", 
        RowBox[{"Return", "[", 
         RowBox[{"iChemDVRRunHamiltonian", "[", "obj", "]"}], "]"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ENERGIES", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
        RowBox[{"-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvreng"}], ",", " ", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RunWavefunctions", "===", "None"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t\t\t", 
            RowBox[{"dvrOpsLookup", "[", 
             RowBox[{
             "RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", 
              "RunWavefunctions"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}], ";", 
         "\n", "\t\t\t", 
         RowBox[{"Return", "@", 
          RowBox[{"iChemDVRRunEnergies", "[", "obj", "]"}]}]}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"WAVEFUNCTIONS", " ", "--"}], "--"}], "--"}], 
                    "--"}], "--"}], "--"}], 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
        RowBox[{"-", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iChemDVRRunCalculateWFQ", "[", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RunWavefunctions", "===", "None"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t\t\t", 
            RowBox[{"dvrOpsLookup", "[", 
             RowBox[{
             "RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", 
              "RunWavefunctions"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}], ";", 
         "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RunWavefunctions", "===", "None"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"RunWavefunctions", "=", 
             RowBox[{"iChemDVRRunWavefunctions", "[", "obj", "]"}]}], ";"}]}],
           "\n", "\t", "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RunEndPoint", "===", "$dvrwf"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Return", "@", "RunWavefunctions"}]}], "\n", "\t\t\t\t", 
          "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"RunCheckPoint", "=", "$dvrwf"}]}]}], "\n", "\t\t\t", "]"}], 
      ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "RUN"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
         " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ENDPOINTS", " ", "--"}], "--"}], "--"}], "--"}], 
           "--"}], "--"}]}], "-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
      "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{"RunEndPoint", ",", "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "MULTIPLE"}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
           " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"RETURN", " ", "--"}], "--"}], "--"}], "--"}], "--"}],
             "--"}]}], "-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
        "\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"(", "\n", "\t\t\t\t\t", 
           RowBox[{
           "$dvrgr", "|", "$dvrke", "|", "$dvrpe", "|", "$dvrwf", "|", 
            "$dvrham", "|", "$dvreng", "|", "\n", "\t\t\t\t\t\t", "$dvrgrwf", 
            "|", "$dvrintwf", "|", "\n", "\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"$dvrexv", ",", " ", "__"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"$dvrexm", ",", " ", "__"}], "}"}], "|", 
            RowBox[{"{", " ", 
             RowBox[{"$dvrexmel", ",", " ", "__"}], "}"}]}], "\n", 
           "\t\t\t\t\t", ")"}], ".."}], "\n", "\t\t\t\t", "}"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "@", "RunEndPoint"}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"k", ":", "$dvrgr"}], "\[RuleDelayed]", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrgr", "->", "RunGrid"}], ")"}]}], "\n", 
                "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", "$dvrke"}], "\[RuleDelayed]", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrke", "->", "RunKineticEnergy"}], ")"}]}], "\n",
                 "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", "$dvrpe"}], "\[RuleDelayed]", "\n", 
               "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrpe", "->", "RunPotentialEnergy"}], ")"}]}], 
                "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", "$dvrwf"}], "\[RuleDelayed]", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrwf", "->", "RunWavefunctions"}], ")"}]}], "\n",
                 "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", "$dvrham"}], ":>", "\n", "\t\t\t\t\t\t\t\t", 
               
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrham", "->", 
                   RowBox[{"RunPotentialEnergy", "+", "RunKineticEnergy"}]}], 
                  ")"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", "$dvreng"}], ":>", "\n", "\t\t\t\t\t\t\t\t", 
               
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvreng", "->", 
                   RowBox[{"RunWavefunctions", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "\n", 
                "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", "$dvrgrwf"}], "\[RuleDelayed]", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrgrwf", "->", 
                   RowBox[{
                   "iChemDVRRunGridWavefunctions", "[", "obj", "]"}]}], 
                  ")"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n",
               "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", "$dvrintwf"}], "\[RuleDelayed]", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrintwf", "->", 
                   RowBox[{
                   "iChemDVRRunInterpolatingWavefunctions", "[", "obj", 
                    "]"}]}], ")"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", "]"}]}],
               ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", 
                RowBox[{"{", 
                 RowBox[{"$dvrexv", ",", " ", "__"}], "}"}]}], ":>", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrexv", "->", 
                   RowBox[{
                   "iChemDVRRunExpectationValues", "[", "obj", "]"}]}], 
                  ")"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n",
               "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", 
                RowBox[{"{", 
                 RowBox[{"$dvrexm", ",", " ", "__"}], "}"}]}], ":>", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"$dvrexm", "->", 
                   RowBox[{"iChemDVRRunOperatorMatrix", "[", "obj", "]"}]}], 
                  ")"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"k", ":", 
                RowBox[{"{", " ", 
                 RowBox[{"$dvrexmel", ",", " ", "__"}], "}"}]}], ":>", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"RunEndPoint", "=", "k"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", " ", 
                  RowBox[{"$dvrexmel", "->", 
                   RowBox[{
                   "iChemDVRRunOperatorMatrixElements", "[", "obj", "]"}]}], 
                  ")"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
             "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", "1"}], "\n", 
           "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"o", ":", 
            RowBox[{"{", "__Rule", "}"}]}], "\[RuleDelayed]", 
           RowBox[{"Merge", "[", 
            RowBox[{"o", ",", " ", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"{", "v_", "}"}], "\[RuleDelayed]", "v"}], "]"}]}], 
            "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{"*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", " ", "GRID"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"WAVEFUNCTIONS", " ", "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}], "--"}], 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}], " ", "**)"}], "\n", "\t\t\t", 
        "$dvrgrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunGridWavefunctions", "[", "obj", "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", "INTERPOLATING"}]}]}]}]}]}]}]}]}]}]}], 
           " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"WAVEFUNCTIONS", " ", "--"}], "--"}], "--"}], 
                "--"}], "--"}], "--"}], "--"}], "--"}]}], "-", 
          RowBox[{"--", "--"}]}], " ", "**)"}], "\n", "\t\t\t", "$dvrintwf", 
        ",", "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunInterpolatingWavefunctions", "[", "obj", "]"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    "--", " ", "EXPECTATION"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"VALUES", " ", "--"}], "--"}], "--"}], "--"}], "--"}],
             "--"}]}], "-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"-", 
               RowBox[{"--", "--"}]}]}]}]}]}]}], " ", "**)"}], "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"$dvrexv", ",", " ", "__"}], "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunExpectationValues", "[", "obj", "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{"*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "-", " ", "OPERATOR"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MATRIX", " ", "--"}], "--"}], "--"}], "--"}], "--"}],
             "--"}], "--"}], 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "--"}]}]}]}]}]}]}], " ", "**)"}], "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"$dvrexm", ",", " ", "__"}], "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunOperatorMatrix", "[", "obj", "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", "OPERATOR"}]}]}]}]}]}]}]}]}]}]}]}], 
           " ", "MATRIX", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ELEMENTS", " ", "--"}], "--"}], "--"}]}], "-", 
          RowBox[{"-", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "--"}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
        "\t\t\t", 
        RowBox[{"{", " ", 
         RowBox[{"$dvrexmel", ",", " ", "__"}], "}"}], ",", "\n", "\t\t\t\t", 
        
        RowBox[{"iChemDVRRunOperatorMatrixElements", "[", "obj", "]"}], ",", 
        "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", " ", "FULL"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}],
            " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"RESULTS", " ", "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}]}], "-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "--"}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
        "\t\t\t", "\"\<FullResults\>\"", ",", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", "RunWavefunctions"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"<|", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"$dvrgr", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunGrid"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", "RunGrid"}], "]"}], ",", 
               "\n", "\t\t\t\t\t\t\t\t", "RunGrid"}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"$dvrpe", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunPotentialEnergy"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", "RunPotentialEnergy"}], 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", "RunPotentialEnergy"}], 
              "\n", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"$dvrke", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunKineticEnergy"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", "RunKineticEnergy"}], 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", "RunKineticEnergy"}], 
              "\n", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"$dvreng", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunWavefunctions"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", 
                 RowBox[{"RunWavefunctions", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RunWavefunctions", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"$dvrwf", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunWavefunctions"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", 
                 RowBox[{"RunWavefunctions", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RunWavefunctions", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}]}]}], "\n", "\t\t\t\t\t\t", "|>"}]}], "\n", "\t\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PLOT", " ", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}], " ", "**)"}], "\n", 
        "\t\t\t", "_", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRView", "[", 
         RowBox[{"obj", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"$dvrwf", "\[Rule]", "\n", "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<View\>\""}], "]"}], "===", 
              "ChemDVRDefaultPlot"}], ",", " ", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "RunWavefunctions", "]"}], "===", 
                "Hold"}], ",", "\n", "\t\t\t\t\t\t\t\t", "RunWavefunctions", 
               ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Hold", "[", "RunWavefunctions", "]"}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
             "RunWavefunctions"}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"$dvrpe", "\[Rule]", "\n", "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<View\>\""}], "]"}], "===", 
              "ChemDVRDefaultPlot"}], ",", " ", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "RunPotentialEnergy", "]"}], "===", 
                "Hold"}], ",", "\n", "\t\t\t\t\t\t\t\t", "RunPotentialEnergy",
                ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Hold", "[", "RunPotentialEnergy", "]"}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
             "RunPotentialEnergy"}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", 
          "\n", "\t\t\t\t\t", 
          RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"\"\<TransformationMatrix\>\"", "->", "RunTransformation"}],
           ",", "\n", "\t\t\t\t\t", 
          RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrvw", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], \
"CodeInput",ExpressionUUID->"e53cbbaf-08e7-46a1-8cbd-d83cf2f4a678"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRRun\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"4d51b935-7081-4162-84d9-5481143fcda6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"PackageExceptionBlock", "[", "\"\<DVRRun\>\"", "]"}], "@", "\n", 
    "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", "=", 
        RowBox[{"If", "[", 
         RowBox[{"$Notebooks", ",", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{"ops", ",", "Monitor", ",", "False"}], "]"}], ",", 
          "False"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{"m", ",", "\n", "\t\t\t", 
        RowBox[{"Automatic", "|", "True"}], ",", "\t", "\n", "\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "Now"}], ",", 
            RowBox[{"clock", "=", 
             RowBox[{"Unique", "@", "\"\<clock$\>\""}]}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"iChemDVRRun", "[", 
             RowBox[{"obj", ",", " ", "ops"}], "]"}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p", "=", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Position", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "$dvrgr", ",", "$dvrke", ",", "$dvrpe", ",", "$dvrwf"}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", "RunCheckPoint"}],
                    "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "i_", "}"}], "}"}], "\[RuleDelayed]", "i"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"_", "\[Rule]", 
                    RowBox[{"-", "1"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t", 
                   "}"}]}], "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"Panel", "@", 
               RowBox[{"Grid", "[", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Time Elapsed:\>\"", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "4"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"clock", ";", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"Now", "-", "start"}], ",", ".02"}], "]"}]}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Invisible", "@", 
                    RowBox[{"Pane", "[", 
                    RowBox[{
                    RowBox[{"Animator", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "clock"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", ".1"}], "}"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}]}], "}"}]}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Now", "-", "start"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Grid:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "1"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}], ",", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Kinetic Energy:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "2"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}], ",", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Potential Energy:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "3"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}], ",", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Wavefunctions:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "4"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}]}], 
                  "\n", "\t", "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"Alignment", "\[Rule]", "Left"}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", "_Function", ",", "\n", "\t\t\t\t", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"iChemDVRRun", "[", 
           RowBox[{"obj", ",", " ", "ops"}], "]"}], ",", " ", 
          RowBox[{"m", "@", "RunCheckPoint"}]}], "]"}], ",", "\n", "\t\t\t", 
        "_", ",", "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRun", "[", 
         RowBox[{"obj", ",", " ", "ops"}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
     "\n", "\t\t", "]"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"4f751eef-826d-4ae2-b5de-783aa1910291"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OOP Interface\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.711059468448546*^9, 3.711059470712175*^9}, {
  3.727732155572032*^9, 
  3.727732158730432*^9}},ExpressionUUID->"a8d8cd6b-d076-4306-a4e0-\
3971cd9348be"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Call\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.73178728951991*^9, 
  3.731787289902672*^9}},ExpressionUUID->"6e5b44d8-ea0b-43b6-bc08-\
ea2bc254b869"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$dvrBasicKeys", "=", "\n", "\t", 
   RowBox[{"$dvrgr", "|", "$dvrpe", "|", "$dvrke", "|", "$dvrwf"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrSimpleKeys", "=", "\n", "\t", 
   RowBox[{
   "$dvrgp", "|", "$dvrgrwf", "|", "$dvrintwf", "|", "\n", "\t\t", "$dvrham", 
    "|", "$dvreng", "|", "$dvrpo", "|", "\n", "\t\t", "$dvrexwf", "|", 
    "$dvrguwf", "|", "\"\<FullResults\>\""}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrExVKeys", "=", "\n", "\t", 
   RowBox[{"$dvrexv", "|", "$dvrexm", "|", "$dvrexmel"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"3c27a477-ffa8-4c78-9900-861f412349c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRObject", "[", 
     RowBox[{"uuid_", "?", "chemDVRValidQ"}], "]"}], "[", 
    RowBox[{"a___", "?", "OptionQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRRun", "[", 
    RowBox[{
     RowBox[{"ChemDVRObject", "[", "uuid", "]"}], ",", "a"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{
     RowBox[{"k", ":", "$dvrBasicKeys"}], ",", " ", 
     RowBox[{"args___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"ChemDVRRun", "[", 
      RowBox[{"obj", ",", " ", 
       RowBox[{"Return", "\[Rule]", "k"}], ",", " ", "args"}], "]"}], ",", 
     "\n", "\t\t", 
     RowBox[{"c_ChemDVRResultsObject", "\[RuleDelayed]", 
      RowBox[{"c", "[", "k", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{
     RowBox[{"k", ":", "$dvrSimpleKeys"}], ",", " ", 
     RowBox[{"args___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"ChemDVRRun", "[", 
      RowBox[{"obj", ",", " ", 
       RowBox[{"Return", "\[Rule]", "k"}], ",", " ", "args"}], "]"}], ",", 
     "\n", "\t\t", 
     RowBox[{"c_ChemDVRResultsObject", "\[RuleDelayed]", 
      RowBox[{"c", "[", "k", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"k", ":", "$dvrExVKeys"}], ",", " ", "\n", "\t\t", 
     RowBox[{"efuns", ":", 
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", 
     RowBox[{"args___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRRun", "[", 
    RowBox[{"obj", ",", " ", 
     RowBox[{"Return", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"k", ",", " ", "efuns"}], "}"}]}], ",", " ", "args"}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    "\"\<Properties\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Keys", "@", 
    RowBox[{"ChemDVRAssociation", "[", "obj", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    "\"\<Association\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Keys", "@", 
    RowBox[{"ChemDVRAssociation", "[", "obj", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{"\"\<Options\>\"", ",", " ", "thing___"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ChemDVROptions", "[", 
    RowBox[{"obj", ",", " ", "thing"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{"k", ":", 
     RowBox[{
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{"obj", ",", " ", "k"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRObject", "/:", "\n", "\t", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"k", ":", 
      RowBox[{
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "]"}], ":=", 
   "\n", "\t\t", 
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{"obj", ",", " ", "k"}], "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"ce6292b3-9e8c-492e-a319-e7edc3dd1dd2"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Mutate\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731787281343988*^9, 
  3.731787283718527*^9}},ExpressionUUID->"e0f0ad4a-4252-46ce-bc09-\
d941b1947e24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemDVRObjMutate", "//", "ClearAll"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRObjMutate", "~", "SetAttributes", "~", "HoldAllComplete"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$ChemDVROneArgMutators", "=", "\n", "\t", 
   RowBox[{
   "Set", "|", "SetDelayed", "|", "TimesBy", "|", "DivideBy", "|", "AddTo", 
    "|", "SubtractFrom", "|", "\n", "\t\t", "PrependTo", "|", "AppendTo", "|",
     "AssociateTo", "|", "KeyDropFrom"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$ChemDVRBaseNoArgMutators", "=", "\n", "\t", 
   RowBox[{"Increment", "|", "Decrement"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRObject", "/:", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", ":", 
      RowBox[{"Set", "|", "SetDelayed"}]}], ")"}], "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"obj_ChemDVRObject", "?", "chemDVRValidQ"}], "[", 
      RowBox[{"k", ":", 
       RowBox[{
        RowBox[{"Except", "[", 
         RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], ",", "\n", 
     "\t", "v_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRMutate", "[", 
    RowBox[{
     RowBox[{"obj", "[", "k", "]"}], ",", " ", "m", ",", " ", "v"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"oneArgs", "=", "$ChemDVROneArgMutators"}], ",", " ", 
      RowBox[{"noArg", "=", "$ChemDVRNoArgMutators"}]}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "oneArgs"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"obj", ":", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
             "chemDVRValidQ"}]}], ")"}], "[", 
          RowBox[{"k", ":", 
           RowBox[{
            RowBox[{"Except", "[", 
             RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], ",", "\n",
          "\t", "\t\t", "a_"}], "\n", "\t", "\t\t", "]"}], "\n", "\t\t", 
       "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", "k", "]"}], ",", " ", "m", ",", " ", "a"}], 
         "]"}]}], "\n", "\t\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "oneArgs"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"obj", ":", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
             "chemDVRValidQ"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"k", ":", 
            RowBox[{
             RowBox[{"Except", "[", 
              RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "]"}], 
         ",", "\n", "\t", "\t\t", "a_"}], "\n", "\t", "\t\t", "]"}], "\n", 
       "\t\t", "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", " ", "m", ",", " ", "a"}], 
         "]"}]}], "\n", "\t\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "noArg"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
            "chemDVRValidQ"}]}], ")"}], "[", 
         RowBox[{"k", ":", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "\n", "\t",
         "\t\t", "]"}], "\n", "\t\t", "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", "k", "]"}], ",", " ", "m"}], "]"}]}], "\n", 
       "\t\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "noArg"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
            "chemDVRValidQ"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ":", 
           RowBox[{
            RowBox[{"Except", "[", 
             RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "]"}], 
        "\n", "\t", "\t\t", "]"}], "\n", "\t\t", "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", " ", "m"}], "]"}]}], "\n", 
       "\t\t\t", "]"}]}], ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.727732153253992*^9, 3.727732195962308*^9}, {
  3.727732236991886*^9, 3.727732328282538*^9}, {3.72773238782777*^9, 
  3.727732394239332*^9}, {3.727732696691856*^9, 3.7277327781747637`*^9}, {
  3.727732856958026*^9, 3.727732901948389*^9}, {3.727746201440668*^9, 
  3.727746271519067*^9}, {3.727746313224814*^9, 3.7277463417970667`*^9}, {
  3.727746678860036*^9, 3.7277466801765203`*^9}, {3.727748592051979*^9, 
  3.727748605406838*^9}, {3.7277489603112164`*^9, 
  3.727749062613564*^9}},ExpressionUUID->"9720f9bf-46ab-4aa3-b867-\
8db86a85c5dc"],

Cell[BoxData[
 RowBox[{"Language`SetMutationHandler", "[", 
  RowBox[{"ChemDVRObject", ",", " ", "ChemDVRObjMutate"}], "]"}]], "CodeInput",
 CellChangeTimes->{{3.727732352529777*^9, 
  3.727732360933573*^9}},ExpressionUUID->"d293b01f-3f5d-464d-a4b0-\
c22cb7adc485"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Formatting\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699197077686358*^9, 
  3.699197078654756*^9}},ExpressionUUID->"96625e5d-36f5-479b-a1de-\
695a383d52c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$dvrimg", "=", "\n", "\t", 
   RowBox[{"Pane", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"PackageFilePath", "[", 
       RowBox[{
       "\"\<Resources\>\"", ",", " ", "\"\<Icons\>\"", ",", " ", 
        "\"\<DVRIcon.png\>\""}], "]"}], "]"}], ",", " ", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"28", ",", "28"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"ImageSizeAction", "\[Rule]", "\"\<ShrinkToFit\>\""}]}], "\n", 
    "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"ea9290b7-d9b3-4821-9183-435a9d1512c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"obj", ":", 
     RowBox[{"dvrObjPattern", "?", "chemDVRValidQ"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"RawBoxes", "@", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", "=", 
          RowBox[{"ChemDVRAssociation", "[", "obj", "]"}]}], "}"}], ",", "\n",
         "\t\t\t", 
        RowBox[{"$$$wtf", ":>", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TrueQ", "[", 
            RowBox[{"chemDVRValidQ", "[", "obj", "]"}], "]"}], ",", " ", 
           "obj", ",", " ", 
           RowBox[{"ChemDVRObject", "@", "a"}]}], "]"}]}]}], "\n", "\t\t\t", 
       "]"}], "\n", "\t\t", "]"}], "@", "\n", "\t\t", 
     RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t\t", 
      RowBox[{
      "\"\<ChemDVRObject\>\"", ",", "\n", "\t\t\t", "$$$wtf", ",", "\n", 
       "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", "\"\<Icon\>\""}], "]"}], ",", " ", 
         RowBox[{"_Missing", "\[Rule]", "$dvrimg"}]}], "]"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"BoxForm`MakeSummaryItem", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Name: \>\"", ",", 
             RowBox[{"ChemDVRGet", "[", 
              RowBox[{"obj", ",", "\"\<Name\>\""}], "]"}]}], "}"}], ",", 
           "StandardForm"}], "]"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"ChemDVRGet", "[", 
            RowBox[{"obj", ",", " ", "\"\<Description\>\""}], "]"}], ",", 
           "\n", "\t\t\t\t\t\t", 
           RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"s_String", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringLength", "[", "#", "]"}], ">", "0"}], "&"}], 
                ")"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Pane", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"s", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", " ", "250"}], "}"}], ",", " ", 
                  "Automatic"}], "}"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}],
              ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"_", "\[Rule]", "Nothing"}]}], "\n", "\t\t\t\t\t\t\t", 
            "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", 
        "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Prepend", "[", "\n", "\t\t\t\t", 
         RowBox[{"BoxForm`MakeSummaryItem", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<UUID: \>\"", ",", 
             RowBox[{"ChemDVRGet", "[", 
              RowBox[{"obj", ",", "\"\<UUID\>\""}], "]"}]}], "}"}], ",", "\n",
            "\t\t\t\t\t", "StandardForm"}], "\n", "\t\t\t\t\t", "]"}], "\n", 
         "\t\t\t\t", "]"}], "@", "\n", "\t\t\t", 
        RowBox[{"Internal`WithLocalSettings", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"System`Private`NewContextPath", "@", 
           RowBox[{"{", "\"\<System`\>\"", "}"}]}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Map", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"BoxForm`MakeSummaryItem", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", "\"\<: \>\""}], "}"}]}], ",", 
                 RowBox[{"ChemDVRGet", "[", 
                  RowBox[{"obj", ",", "#"}], "]"}]}], "}"}], ",", 
               "StandardForm"}], "]"}], "&"}], ",", 
            RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t", 
             RowBox[{
             "\"\<Range\>\"", ",", "\n", "\t", "\t\t\t\t\t", "\"\<Points\>\"",
               ",", "\n", "\t\t\t\t\t\t", "$dvrgr", ",", "\n", "\t\t\t\t\t\t",
               "$dvrke", ",", "\n", "\t\t\t\t\t\t", "$dvrpe", ",", "\n", 
              "\t\t\t\t\t\t", "$dvrwf"}], "\n", "\t\t\t\t\t", "}"}]}], "\n", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"System`Private`RestoreContextPath", "[", "]"}]}], "\t", 
         "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", "StandardForm"}], 
      "\n", "\t\t\t", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{"\t\t"}]}], \
"CodeInput",ExpressionUUID->"bbe07467-5b8a-4157-ba3a-7a5978392431"]
}, Open  ]]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"fdeebcf6-8c06-4eff-91a0-\
04c994bffda0"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"9009c70d-1aad-415c-9701-\
edff1eaf5262"]
},
WindowSize->{788, 764},
WindowMargins->{{105, Automatic}, {Automatic, 0}},
TaggingRules->{
 "UUIDButtons" -> {
   "Active" -> {
     "Button-89ffd2c3-ec41-4179-a9b1-8e28670bca2c" -> False, 
      "Button-ca46e5e0-4fd1-47e8-8cf6-72998922b757" -> False, 
      "Button-a6d68254-3684-4d32-83fc-e5ef6f443930" -> False}}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

