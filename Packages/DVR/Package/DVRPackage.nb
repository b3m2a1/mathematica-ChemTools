Notebook[{

Cell[CellGroupData[{
Cell["ChemTools`DVR`Package", "CodeSection",
 CellChangeTimes->{{3.699193506559762*^9, 3.699193508534224*^9}, {
  3.7323031681209297`*^9, 
  3.732303175462882*^9}},ExpressionUUID->"ce12fc74-14d9-4140-b8eb-\
f0dcebd187a1"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Management\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196695796316*^9, 3.6991966975641613`*^9}, {
  3.6993080953275414`*^9, 
  3.699308095820632*^9}},ExpressionUUID->"440a3234-5118-4669-b7ea-\
3c248d44eaaf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$ChemDVRManager", "::", "usage"}], "=", 
   "\"\<Manager interface for ChemDVR things\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDirectory", "::", "usage"}], "=", 
   "\"\<Directory finder\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRFile", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Simple combination of FileNameJoin and ChemDVRDirectory\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentials", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Lists all matching files in ChemDVRDirectory[\\\"PotentialEnergy\\\"]\
\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$ChemDVRPotentials", "::", "usage"}], "=", 
   "\"\<Alias for ChemDVRPotentials[\\\"*@.@*\\\"]\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195104073802*^9, 3.699195199567478*^9}, {
  3.699196135925055*^9, 3.699196170540544*^9}, {3.69919621524492*^9, 
  3.6991962295117073`*^9}, {3.699298413442045*^9, 3.699298442380221*^9}, {
  3.699298516095749*^9, 3.699298534818309*^9}, {3.6992986158636093`*^9, 
  3.699298617638948*^9}, {3.700004723554742*^9, 3.7000047235797873`*^9}, {
  3.732302877310513*^9, 
  3.732302878692136*^9}},ExpressionUUID->"756090c3-c230-49e9-955a-\
a96090441b76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "usage"}], "=", 
   "\"\<OOP constructor for a ChemDVR\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRAssociation", "::", "usage"}], "=", 
   "\"\<Returns the base association for the instance\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195104073802*^9, 3.6991952004002743`*^9}, {
   3.69919605384367*^9, 3.699196054154253*^9}, {3.699200962679698*^9, 
   3.69920097647511*^9}, {3.699303685439557*^9, 3.69930369605053*^9}, {
   3.700004723585022*^9, 3.700004723608583*^9}, 3.709487016572117*^9, {
   3.732302839589135*^9, 3.7323028407366047`*^9}, {3.732302899260148*^9, 
   3.732302899469336*^9}},ExpressionUUID->"b2496ee4-face-45fc-9386-\
ff1ee18bed13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "::", "usage"}], "=", 
   "\"\<Saves various ChemDVR components\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClear", "::", "usage"}], "=", 
   "\"\<Clears saved ChemDVR components\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195104073802*^9, 3.699195204534544*^9}, {
  3.699196176789201*^9, 3.699196182899107*^9}, {3.699743855063335*^9, 
  3.699743870905731*^9}, {3.7000047236127377`*^9, 
  3.700004723621628*^9}},ExpressionUUID->"1515556b-5d44-47ec-8d2d-\
f0863a75cf14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClass", "::", "usage"}], "=", 
   "\"\<Template interface for a ChemDVR\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClasses", "::", "usage"}], "=", 
   "\"\<Lists the available classes\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRNewClass", "::", "usage"}], "=", 
   "\"\<Opens up a template notebook for a new class\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699206303141232*^9, 3.6992063339781017`*^9}, {
  3.700004723626295*^9, 3.700004723632313*^9}, {3.709512931954008*^9, 
  3.709512945169693*^9}},ExpressionUUID->"d4789c1f-d650-4a56-8f56-\
c658790e5fac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRBegin", "::", "usage"}], "=", 
   "\"\<Wrapper for all BeginPackage stuff\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVREnd", "::", "usage"}], "=", 
   "\"\<Wrapper for all EndPackage stuff\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$ChemDVRLoaded", "::", "usage"}], "=", 
   "\"\<The set of packages loaded already\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRNeeds", "::", "usage"}], "=", 
   "\"\<Needs type loader for stuff\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRReload", "::", "usage"}], "=", 
   "\"\<Reloads a ChemDVR file\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699239324492299*^9, 3.6992393725629377`*^9}, {
   3.699239719010161*^9, 3.69923972676486*^9}, {3.699242525647093*^9, 
   3.699242533881804*^9}, {3.699817508046831*^9, 3.6998175284491587`*^9}, {
   3.700004723637341*^9, 3.700004723653447*^9}, 3.709487016582574*^9, 
   3.7094886288906307`*^9},ExpressionUUID->"f6497751-1f45-45fa-a6cf-\
49770b92b0e1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Defaults\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732303215263864*^9, 
  3.732303216686178*^9}},ExpressionUUID->"7038598c-1cd9-416a-88b0-\
dae27fcbca78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultFormatGrid", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultGrid", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Default DVR grid function\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedGrid", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDirectProductGrid", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Creates a direct product grid from two grid functions\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDirectProductKineticEnergy", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Creates a direct product ke from two ke functions\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRKroneckerProductKineticEnergy", "::", "usage"}], "=", "\n",
    "\t", "\"\<Calculates the kinetic energy as a Kronecker product\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultKineticEnergy", "::", "usage"}], "=", "\n", "\t", 
  "\"\<Calculates the kinetic energy as a product of kes\>\""}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedPotential", "::", "usage"}], "=", "\"\<\>\""}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPotentialEnergy", "::", "usage"}], "=", 
   "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultWavefunctions", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlot", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultGridWavefunctions", "::", "usage"}], "=", 
   "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultInterpolatingWavefunctions", "::", "usage"}], "=", 
   "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultExpectationValues", "::", "usage"}], "=", 
   "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultOperatorMatrix", "::", "usage"}], "=", "\"\<\>\""}],
   ";"}]}], "CodeInput",
 CellChangeTimes->{{3.719787111239002*^9, 3.719787180779767*^9}, {
   3.7197882642541027`*^9, 3.7197882700760813`*^9}, {3.719788464329248*^9, 
   3.719788470679223*^9}, {3.7292285158943157`*^9, 3.729228527892273*^9}, {
   3.731161960273127*^9, 3.731161967843996*^9}, 3.731162000404421*^9, 
   3.731162033727303*^9, {3.731432695863593*^9, 3.7314327049157667`*^9}, {
   3.731785718909966*^9, 3.7317857342039537`*^9}, 3.731791504505604*^9, {
   3.731988398037353*^9, 3.73198840174786*^9}, {3.73206607777111*^9, 
   3.732066118598529*^9}, {3.732066654427018*^9, 3.732066656463282*^9}, {
   3.7323024211289883`*^9, 3.732302426014752*^9}, {3.732302743522944*^9, 
   3.732302781622141*^9}, {3.7323042575680943`*^9, 3.732304260683733*^9}, {
   3.732305069988263*^9, 3.732305083780917*^9}, {3.7324215197548923`*^9, 
   3.7324215593981533`*^9}, {3.732422115931074*^9, 
   3.732422120751442*^9}},ExpressionUUID->"648d799f-64d0-4bf1-864c-\
cb9c7b6283bc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Usage\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196699948257*^9, 
  3.699196705364139*^9}},ExpressionUUID->"7d0459a3-8821-40a3-93a2-\
7602abaf24c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDimension", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the dimension of a ChemDVR object\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGrid", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the grid used in ChemDVR calculations\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRKineticEnergy", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the kinetic energy used in ChemDVR calculations\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentialEnergy", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the potential energy used in ChemDVR calculations\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRWavefunctions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the wavefunctions computed in ChemDVR calculations\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGridWavefunctions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the wavefunction imposed on the grid\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRInterpolatingWavefunctions", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Returns the wavefunctions interpolating over a grid\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRExpectationValues", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the expectation values of a set of functions\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROperatorMatrix", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the cross-state expectation matrix of a set of \
states->function specs\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRView", "::", "usage"}], "=", 
   "\"\<Displays the wavefunctions from a ChemDVR run\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6992058058208523`*^9, 3.699205937966085*^9}, 
   3.6992063006686974`*^9, {3.699217771766521*^9, 3.6992177788107443`*^9}, {
   3.7000047236621523`*^9, 3.700004723700327*^9}, {3.716045483835588*^9, 
   3.7160454917549686`*^9}, {3.718048930135654*^9, 3.718048954876293*^9}, {
   3.718048994505734*^9, 3.7180490019036207`*^9}, {3.718052249108364*^9, 
   3.7180522653867683`*^9}, {3.7314327369280663`*^9, 3.731432756043549*^9}, {
   3.731787104723571*^9, 3.73178717926921*^9}, {3.7317872360118628`*^9, 
   3.731787237728244*^9}, 3.7317915001749697`*^9, {3.7323028643152514`*^9, 
   3.732302864615101*^9}, {3.7323048026633167`*^9, 
   3.732304802910129*^9}},ExpressionUUID->"f0c9f99c-f6e4-4210-b01d-\
2c2d88e559f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRNotebook", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Opens a notebook for playing with a single ChemDVR instance\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992058058208523`*^9, 3.699205937966085*^9}, 
   3.6992063006686974`*^9, {3.699217771766521*^9, 3.699217787610001*^9}, {
   3.7000047237081833`*^9, 3.7000047237110777`*^9}, {3.732302871050003*^9, 
   3.7323028711239967`*^9}},ExpressionUUID->"a0653ae4-202b-49e1-8cbb-\
a656d8240fd0"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"0e55d644-7d11-4200-87af-\
275b741b17e2"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Management\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699194685465564*^9, 3.6991946906240587`*^9}, {
  3.69919667227174*^9, 
  3.6991966738298597`*^9}},ExpressionUUID->"f1809134-7562-4f45-9ba6-\
eecec2bffabb"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]KeyWords\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.724796415784959*^9, 
  3.72479641790486*^9}},ExpressionUUID->"5f6b3324-8946-4264-9466-\
62f3809160f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$dvroot", "=", "\"\<Root\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvalt", "=", "\"\<ExtraDirs\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrinst", "=", "\"\<Instances\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrke", "=", "\"\<KineticEnergy\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrpe", "=", "\"\<PotentialEnergy\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrwf", "=", "\"\<Wavefunctions\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrgr", "=", "\"\<Grid\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrgrwf", "=", "\"\<GridWavefunctions\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrintwf", "=", "\"\<InterpolatingWavefunctions\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrexv", "=", "\"\<ExpectationValues\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrexm", "=", "\"\<OperatorMatrix\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$dvrvw", "=", "\"\<View\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699197490356634*^9, 3.699197536260509*^9}, {
   3.699197711919973*^9, 3.69919771286185*^9}, {3.699309092725204*^9, 
   3.699309093225613*^9}, {3.7211651317303457`*^9, 3.7211651421811333`*^9}, {
   3.729252663493005*^9, 3.729252680850198*^9}, {3.729252760038621*^9, 
   3.729252765182849*^9}, {3.731785768570859*^9, 3.7317857865419283`*^9}, {
   3.731786090560952*^9, 3.731786163426529*^9}, 3.731787187218285*^9, 
   3.731791501320939*^9},ExpressionUUID->"4a289317-6ac5-443c-a723-\
e6a37f57ef9b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Manager\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7247964101546907`*^9, 
  3.724796412920726*^9}},ExpressionUUID->"f098a73f-5cbe-4c4c-9538-\
ba6e1da7a010"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"$ChemDVRManager", ",", "_Association"}], "]"}]}], ",", "\n", 
    "\t", 
    RowBox[{"$ChemDVRManager", "=", "\n", "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Directories\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"<|", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"$dvroot", "\[Rule]", 
           RowBox[{"ChemExtensionDir", "[", "\"\<DVR\>\"", "]"}]}], ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"$dvalt", "\[Rule]", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", " ", "\"\<DVR\>\""}], "}"}], "]"}], "&"}], 
             ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"$ChemExtensionsApp", ",", " ", "$ChemExtensionsDev"}], 
              "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"\"\<Classes\>\"", "\[Rule]", "\"\<Classes\>\""}], ",", 
          "\n", "\t", "\t\t\t\t", 
          RowBox[{"$dvrinst", "\[Rule]", "$dvrinst"}], ",", "\n", "\t", "\t", 
          "\t\t\t", 
          RowBox[{"$dvrpe", "\[Rule]", "$dvrpe"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"$dvrke", "\[Rule]", "$dvrke"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"$dvrwf", "\[Rule]", "$dvrwf"}]}], "\n", "\t", "\t\t\t\t", 
         "|>"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<Objects\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"<|", "\n", "\t\t\t\t\t", "|>"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Settings\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"<|", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Save\>\"", "<>", "$dvrke"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Save\>\"", "<>", "$dvrpe"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}], "\[Rule]", "False"}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Save\>\"", "<>", "$dvrwf"}], "\[Rule]", "False"}]}], 
         "\n", "\t", "\t\t\t\t", "|>"}]}]}], "\n", "\t\t\t", "|>"}]}]}], "\n",
    "\t", "]"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699194692019228*^9, 3.699194765842435*^9}, {
   3.699194851128043*^9, 3.699194930434033*^9}, {3.69919752714707*^9, 
   3.699197555735075*^9}, {3.699212399625697*^9, 3.699212417013726*^9}, {
   3.6992148261517553`*^9, 3.699214912995949*^9}, {3.6992157919744453`*^9, 
   3.699215797060264*^9}, {3.699313651860648*^9, 3.6993136558073807`*^9}, {
   3.700004723723173*^9, 3.7000047237301598`*^9}, {3.707065568451046*^9, 
   3.707065569000152*^9}, {3.7072496730516644`*^9, 3.707249674712637*^9}, {
   3.715474155169467*^9, 3.715474161548007*^9}, {3.72116498033036*^9, 
   3.7211649936878366`*^9}, {3.721165073440366*^9, 3.721165091454728*^9}, 
   3.721165123534378*^9, {3.72116532113274*^9, 3.721165323335895*^9}, {
   3.721165423511046*^9, 3.721165440513072*^9}, {3.731786223837569*^9, 
   3.731786288456511*^9}},ExpressionUUID->"93f8042f-6833-41c5-b66f-\
f8d0000595b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Directory\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699195092148686*^9, 
  3.699195093379696*^9}},ExpressionUUID->"b8018517-ad37-43ef-a25e-\
27cea721b9d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$ChemDVRRoot", ":=", "\n", "\t", 
   RowBox[{"$ChemDVRManager", "[", 
    RowBox[{"\"\<Directories\>\"", ",", " ", "$dvroot"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"$ChemDVRPath", ":=", "\n", "\t", 
  RowBox[{"Prepend", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"$ChemDVRManager", "[", 
     RowBox[{"\"\<Directories\>\"", ",", " ", "$dvalt"}], "]"}], ",", "\n", 
    "\t\t", "$ChemDVRRoot"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.72575193059234*^9, 3.725751935891848*^9}, {
  3.725752006846558*^9, 
  3.725752023040498*^9}},ExpressionUUID->"2e3e6ae6-adeb-44f1-9b99-\
12b0e45337a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDirectory", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Root\>\"", ":>", "$ChemDVRRoot"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Path\>\"", ":>", "$ChemDVRPath"}]}], "\n", "\t\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDirectory", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"dSpec_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", "\"\<Directories\>\"", "]"}], ",", 
          "#"}], "]"}], "&"}], ")"}]}], ",", "\n", "\t", 
     RowBox[{"alt", ":", 
      RowBox[{"True", "|", "False"}], ":", "False"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", "=", 
       RowBox[{"$ChemDVRManager", "[", 
        RowBox[{"\"\<Directories\>\"", ",", " ", "dSpec"}], "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "alt"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"DirectoryQ", "@", 
           RowBox[{"ExpandFileName", "@", "d"}]}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "@", 
                RowBox[{"DirectoryQ", "@", "#"}]}], ",", "\n", "\t", "\t", 
               "\t\t\t\t", 
               RowBox[{"CreateDirectory", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{
                 "CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
                "]"}]}], "\n", "\t", "\t\t\t\t\t", "]"}], ";", "\n", 
             "\t\t\t\t\t", "#"}], "\n", "\t\t\t\t\t", ")"}], "&"}], "@", "\n",
           "\t\t\t\t\t\t", 
          RowBox[{"FileNameJoin", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<Root\>\"", "]"}], ",", " ", 
             "dSpec"}], "}"}]}]}], ",", "\n", "\t\t\t\t", "d"}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"{", 
           RowBox[{"#", ",", "dSpec"}], "}"}]}], "&"}], "/@", "\n", 
        "\t\t\t\t", 
        RowBox[{"OptionValue", "[", "\"\<Path\>\"", "]"}]}]}], "\n", "\t\t\t",
       "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.69919509461094*^9, 3.699195096659699*^9}, {
   3.699195208008222*^9, 3.699195336184588*^9}, {3.6992105882204857`*^9, 
   3.6992106217438183`*^9}, 3.699210669282516*^9, {3.700004723741538*^9, 
   3.700004723751171*^9}, {3.7211651553470573`*^9, 3.7211652454048433`*^9}, {
   3.721165879614119*^9, 3.721165884946512*^9}, {3.72575179917066*^9, 
   3.7257518710785847`*^9}, 3.7257519011681337`*^9, {3.725751940601488*^9, 
   3.725751968243597*^9}, {3.7257520022257*^9, 
   3.7257520471967077`*^9}},ExpressionUUID->"d379298d-0b30-46b7-a2bb-\
73d115f220ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]File\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6991962112416353`*^9, 
  3.6991962116160297`*^9}},ExpressionUUID->"a320c753-85b3-4267-8cd8-\
d631fd51046f"],

Cell[BoxData[
 RowBox[{"ChemDVRFile", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.725752657978743*^9, 
  3.7257526586449614`*^9}},ExpressionUUID->"9689d612-51de-4b6d-b973-\
36d4cad7f54e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRFile", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRDirectory"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRFile", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"dSpec_String", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", "\"\<Directories\>\"", "]"}], ",", 
          "#"}], "]"}], "&"}], ")"}]}], ",", "\n", "\t", "fspec__String", ",",
      "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"ops", "=", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"{", 
           RowBox[{"#", ",", "fspec"}], "}"}]}], "&"}], "/@", "\n", "\t", 
        "\t", "\t\t\t", 
        RowBox[{"ChemDVRDirectory", "[", 
         RowBox[{"dSpec", ",", " ", "True", ",", " ", "o"}], "]"}]}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"SelectFirst", "[", 
      RowBox[{"ops", ",", " ", "FileExistsQ", ",", " ", 
       RowBox[{"Last", "@", "ops"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRFile", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"dSpec_String", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"KeyMemberQ", "[", 
        RowBox[{
         RowBox[{"$ChemDVRManager", "[", "\"\<Directories\>\"", "]"}], ",", 
         "#"}], "]"}], "&"}], ")"}]}], ",", "\n", "\t", 
    RowBox[{"ChemDVRObject", "[", "uuid_", "]"}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"ChemDVRFile", "[", "\n", "\t\t", 
   RowBox[{"dSpec", ",", "\n", "\t\t", 
    RowBox[{"uuid", "<>", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"dSpec", ",", 
         RowBox[{"$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], "]"}], ",", 
       "\"\<.mx\>\"", ",", "\"\<.m\>\""}], "]"}]}]}], "\n", "\t\t", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRFile", "[", 
    RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRFile", "[", 
    RowBox[{"$dvrinst", ",", 
     RowBox[{"uuid", "<>", "\"\<.m\>\""}]}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196249392866*^9, 3.6991963261796503`*^9}, {
   3.699197290906156*^9, 3.699197404258923*^9}, {3.699197654516735*^9, 
   3.6991976671531763`*^9}, 3.699211031719146*^9, {3.700004723760951*^9, 
   3.70000472378898*^9}, {3.7211657664875402`*^9, 3.721165853245195*^9}, {
   3.7257520623395853`*^9, 
   3.7257521069598*^9}},ExpressionUUID->"2cd17eba-daab-444c-b177-2dd12bcfc1f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Potentials\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992984509208803`*^9, 
  3.6992984527017813`*^9}},ExpressionUUID->"c0fe0765-71ff-42de-890f-\
b5d957b9a85c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentials", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"pat", ":", 
      RowBox[{"_", "?", "StringPattern`StringPatternQ"}], ":", 
      "\"\<*@.@*\>\""}], ",", "\n", "\t", 
     RowBox[{"nameTake", ":", 
      RowBox[{"True", "|", "False"}], ":", "True"}]}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"nameTake", ",", 
      RowBox[{"Map", "@", "FileNameTake"}], ",", "Identity"}], "]"}], "@", 
    "\n", "\t\t", 
    RowBox[{"FileNames", "[", 
     RowBox[{"pat", ",", 
      RowBox[{"ChemDVRDirectory", "[", "$dvrpe", "]"}]}], "]"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.699298456817053*^9, 3.699298510202167*^9}, 
   3.699298542931211*^9, {3.699298593967393*^9, 3.699298605444406*^9}, {
   3.7000047237976418`*^9, 3.700004723806407*^9}, {3.7110606959939404`*^9, 
   3.711060710065711*^9}, {3.711060747539021*^9, 3.711060782494885*^9}, {
   3.715474085025166*^9, 
   3.7154741124218082`*^9}},ExpressionUUID->"b2dab9c8-0272-4249-b317-\
d47ca5883c0d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Create\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699195345033104*^9, 3.699195347512597*^9}, {
  3.709488234157069*^9, 
  3.7094882350104856`*^9}},ExpressionUUID->"e6e68467-489e-48d7-b2b2-\
900867e3ce63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "norng"}], "=", 
   "\"\<No range function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "nogrid"}], "=", 
   "\"\<No grid function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "noke"}], "=", 
   "\"\<No kinetic energy function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "nope"}], "=", 
   "\"\<No potential energy function provided\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "novw"}], "=", 
   "\"\<No view function provided\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195384114893*^9, 3.699195472726378*^9}, {
   3.699195527939288*^9, 3.699195631008417*^9}, {3.699195830104776*^9, 
   3.6991960236894627`*^9}, {3.699196060475307*^9, 3.699196106858914*^9}, {
   3.699196353854607*^9, 3.699196380644958*^9}, {3.699197563928157*^9, 
   3.699197568348712*^9}, {3.69920103659144*^9, 3.6992011313010597`*^9}, {
   3.699307651428116*^9, 3.699307687937377*^9}, {3.7000047238327627`*^9, 
   3.700004723903949*^9}, {3.709487016597534*^9, 3.709487016662925*^9}, {
   3.70948824485824*^9, 3.709488247093082*^9}, {3.71604517878148*^9, 
   3.716045185928104*^9}, {3.718047987857489*^9, 3.718047995821343*^9}, {
   3.718048044712254*^9, 3.718048047702251*^9}, {3.718049011573656*^9, 
   3.7180490115890903`*^9}, {3.731433538063773*^9, 3.731433547357687*^9}, {
   3.731702329759506*^9, 3.731702329948423*^9}, {3.731702364287512*^9, 
   3.731702417613299*^9}, {3.731703549725778*^9, 3.731703551018561*^9}, {
   3.731785798191135*^9, 3.731785901509429*^9}, 3.731791502462555*^9, {
   3.731988424516515*^9, 3.731988444086177*^9}, 3.732005214417302*^9, {
   3.7324208048317966`*^9, 3.732420843163108*^9}, {3.732421418786071*^9, 
   3.732421452492131*^9}},ExpressionUUID->"4af9c5e7-53f6-49ce-9ecb-\
5508e62cf35a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dvrAssoc", "=", "a"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"KeyMemberQ", "[", 
         RowBox[{"a", ",", "\"\<Class\>\""}], "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRClass", "@", 
         RowBox[{"a", "[", "\"\<Class\>\"", "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", "\"\<UUID\>\""}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "\"\<UUID\>\"", "]"}], "=", 
         RowBox[{"CreateUUID", "[", "\"\<ChemDVR-\>\"", "]"}]}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", "\"\<Name\>\""}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "\"\<Name\>\"", "]"}], "=", 
         "\"\<ChemDVR Instance\>\""}]}], "\n", "\t\t\t", "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"MapThread", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"KeyMemberQ", "[", 
               RowBox[{"dvrAssoc", ",", "#"}], "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"Replace", "[", 
               RowBox[{"#2", ",", 
                RowBox[{
                 RowBox[{"Hold", "[", "m_", "]"}], ":>", "\n", "\t\t\t\t\t", 
                 RowBox[{"Message", "[", "m", "]"}]}]}], "]"}], ";", "\n", 
              "\t\t\t\t", 
              RowBox[{
               RowBox[{"dvrAssoc", "[", "#", "]"}], "=", "None"}], ";"}]}], 
            "\n", "\t\t\t\t", "]"}], "&"}], ",", 
          RowBox[{"{", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"{", "}"}], ",", "\n", "\t\t\t", 
            RowBox[{"Thread", "@", "\n", "\t\t\t\t", 
             RowBox[{"Hold", "[", "\n", "\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", "}"}], "\n", "\t\t\t\t\t", 
              "]"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}], ";"}], "*)"}], "\n", 
      "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"KeyMemberQ", "[", 
            RowBox[{"dvrAssoc", ",", "\"\<Points\>\""}], "]"}]}], ",", "\n", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"dvrAssoc", "[", "\"\<Points\>\"", "]"}], "=", "\n", 
           "\t\t\t\t", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"10", ",", " ", 
             RowBox[{"Length", "@", 
              RowBox[{"dvrAssoc", "[", "\"\<Range\>\"", "]"}]}]}], "]"}]}]}], 
         "\n", "\t\t\t", "]"}], ";"}], "*)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrgr"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrgr", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultGrid"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrke"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrke", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultKineticEnergy"}]}], "\n", "\t\t\t", "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrpe"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrpe", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultPotentialEnergy"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrwf"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrwf", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultWavefunctions"}]}], "\n", "\t\t\t", "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrvw"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrvw", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultPlot"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrgrwf"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrgrwf", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultGridWavefunctions"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrintwf"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrintwf", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultInterpolatingWavefunctions"}]}], "\n", "\t\t\t", 
       "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrexv"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrexv", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultExpectationValues"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", " ", "$dvrexm"}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "$dvrexm", "]"}], "=", "\n", "\t\t\t\t", 
         "ChemDVRDefaultOperatorMatrix"}]}], "\n", "\t\t\t", "]"}], ";", "\n",
       "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"dvrAssoc", ",", "\"\<FormatGrid\>\""}], "]"}]}], ",", "\n",
         "\t\t\t", 
        RowBox[{
         RowBox[{"dvrAssoc", "[", "\"\<FormatGrid\>\"", "]"}], "=", "\n", 
         "\t\t\t\t", "ChemDVRDefaultFormatGrid"}]}], "\n", "\t\t\t", "]"}], 
      ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"$ChemDVRManager", "[", 
        RowBox[{"\"\<Objects\>\"", ",", 
         RowBox[{"dvrAssoc", "[", "\"\<UUID\>\"", "]"}]}], "]"}], "=", "\n", 
       "\t\t\t", "dvrAssoc"}], ";", "\n", "\t\t", 
      RowBox[{"ChemDVRObject", "[", 
       RowBox[{"dvrAssoc", "[", "\"\<UUID\>\"", "]"}], "]"}]}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699195384114893*^9, 3.699195472726378*^9}, {
   3.699195527939288*^9, 3.699195631008417*^9}, {3.699195830104776*^9, 
   3.6991960236894627`*^9}, {3.699196060475307*^9, 3.699196106858914*^9}, {
   3.699196353854607*^9, 3.699196380644958*^9}, {3.699197563928157*^9, 
   3.699197568348712*^9}, {3.69920103659144*^9, 3.6992011313010597`*^9}, {
   3.699307651428116*^9, 3.699307687937377*^9}, {3.7000047238327627`*^9, 
   3.700004723903949*^9}, {3.709487016597534*^9, 3.709487016662925*^9}, {
   3.70948824485824*^9, 3.709488247093082*^9}, {3.71604517878148*^9, 
   3.716045185928104*^9}, {3.718047987857489*^9, 3.718047995821343*^9}, {
   3.718048044712254*^9, 3.718048047702251*^9}, {3.718049011573656*^9, 
   3.7180490115890903`*^9}, {3.731433538063773*^9, 3.731433547357687*^9}, {
   3.731702329759506*^9, 3.731702329948423*^9}, {3.731702364287512*^9, 
   3.731702417613299*^9}, {3.731703549725778*^9, 3.731703551018561*^9}, {
   3.731785798191135*^9, 3.731785901509429*^9}, 3.731791502462555*^9, {
   3.731988424516515*^9, 3.731988444086177*^9}, 3.732005214417302*^9, {
   3.7324208048317966`*^9, 3.732420843163108*^9}, {3.732421418786071*^9, 
   3.732421452492131*^9}},ExpressionUUID->"c527430a-2f87-4f87-81b4-\
5a378156e0a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "::", "nodvr"}], "=", 
   "\"\<No ChemDVR found at ``\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "[", 
    RowBox[{"dvr_String", "?", "FileExistsQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", 
       RowBox[{"Get", "@", "dvr"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "a"}], ",", "\n", "\t\t\t", 
       RowBox[{"ChemDVRCreate", "@", "a"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ChemDVRCreate", "::", "nodvr"}], ",", "dvr"}], "]"}], ";", 
        "\n", "\t\t\t", "$Failed"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRCreate", "[", 
    RowBox[{"dvr_String", "?", 
     RowBox[{"(", 
      RowBox[{"Not", "@*", "FileExistsQ"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", "=", 
       RowBox[{"ChemDVRFile", "[", 
        RowBox[{"$dvrinst", ",", 
         RowBox[{
          RowBox[{"StringTrim", "[", 
           RowBox[{"dvr", ",", "\"\<.m\>\""}], "]"}], "<>", "\"\<.m\>\""}]}], 
        "]"}]}], "}"}], ",", "\t", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "@", "f"}], ",", "\n", "\t\t\t", 
       RowBox[{"ChemDVRCreate", "@", "f"}], ",", "\n", "\t\t\t", 
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"ChemDVRCreate", "::", "nodvr"}], ",", "f"}], "]"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699195348711438*^9, 3.69919537695263*^9}, {
   3.699195668247119*^9, 3.69919582205576*^9}, {3.699197577429625*^9, 
   3.699197582995524*^9}, 3.699215968027686*^9, {3.699216194303919*^9, 
   3.699216228323208*^9}, {3.700004723913599*^9, 3.700004723939251*^9}, {
   3.7094870166742697`*^9, 
   3.709487016698371*^9}},ExpressionUUID->"d82dfaee-a3d9-44db-b967-\
4b99a77ee4c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Save\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196189299925*^9, 
  3.699196189898581*^9}},ExpressionUUID->"975f6e6a-ad61-41d6-8eff-\
a1db564b7d02"],

Cell[BoxData[
 RowBox[{"ChemDVRSave", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.72575264727064*^9, 
  3.725752650911756*^9}},ExpressionUUID->"280d4be7-d7a6-4f95-81ee-\
100d1649edc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRSave", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRFile"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
    "$dvrinst", ",", "\n", "\t", "name_String", ",", "\n", "\t", 
     "a_Association", ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$ContextPath", "=", 
       RowBox[{"{", "\"\<System`\>\"", "}"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"ChemDVRFile", "[", 
        RowBox[{"$dvrinst", ",", " ", "name", ",", " ", "o"}], "]"}], ",", 
       "a"}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], ",", " ", "\n", 
     "\t", "name_String", ",", " ", "\n", "\t", 
     RowBox[{"mx_List", "?", "MatrixQ"}], ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Export", "[", "\t", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ChemDVRFile", "[", 
      RowBox[{"prop", ",", " ", "name", ",", " ", "o"}], "]"}], ",", "\n", 
     "\t\t", "mx"}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196191812368*^9, 3.6991962448629293`*^9}, {
  3.699196331707597*^9, 3.699196347962112*^9}, {3.699196398434019*^9, 
  3.6991965558047523`*^9}, {3.699197590398986*^9, 3.699197614261018*^9}, {
  3.699308028186694*^9, 3.6993080333904753`*^9}, {3.6993081032627172`*^9, 
  3.699308104718812*^9}, {3.7000047239488697`*^9, 3.700004723969499*^9}, {
  3.725751735391014*^9, 3.7257517379363337`*^9}, {3.725752116308301*^9, 
  3.725752229691753*^9}, {3.7257526440673513`*^9, 
  3.725752645513895*^9}},ExpressionUUID->"89a3f36f-707a-458c-92b7-\
15cd0922f973"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Optional", "[", 
      RowBox[{"$dvrinst", ",", "$dvrinst"}], "]"}], ",", "\n", "\t", 
     RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRSave", "[", "\n", "\t\t", 
    RowBox[{"$dvrinst", ",", "\n", "\t\t", 
     RowBox[{"uuid", "<>", "\"\<.m\>\""}], ",", "\n", "\t\t", 
     RowBox[{"$ChemDVRManager", "[", 
      RowBox[{"\"\<Objects\>\"", ",", "uuid"}], "]"}], ",", "\n", "\t\t", 
     "o"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRSave", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], ",", " ", "\n", 
     "\t", 
     RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], ",", "\n", "\t", 
     RowBox[{"mx_List", "?", "MatrixQ"}], ",", "\n", "\t", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRSave", "[", "\n", "\t\t", 
    RowBox[{"prop", ",", "\n", "\t\t", 
     RowBox[{"uuid", "<>", "\"\<.mx\>\""}], ",", "\n", "\t\t", "mx", ",", 
     "\n", "\t\t", "o"}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196191812368*^9, 3.6991962448629293`*^9}, {
  3.699196331707597*^9, 3.699196347962112*^9}, {3.699196398434019*^9, 
  3.699196646340361*^9}, {3.6991976174145107`*^9, 3.69919764293287*^9}, {
  3.7000047239809*^9, 3.700004724018681*^9}, {3.725752232253621*^9, 
  3.725752280547689*^9}, {3.72575261655831*^9, 
  3.7257526255219717`*^9}},ExpressionUUID->"64e30358-36f2-4133-a867-\
06c4a00e506b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Clear\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69974390220584*^9, 3.699743904107985*^9}, {
  3.725752750344768*^9, 
  3.725752750702795*^9}},ExpressionUUID->"1687a405-4b2d-4818-b52d-\
ad52783ec6b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRClear", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRFile"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClear", "[", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrinst", "|", "$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], 
     ",", " ", "name_String", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Quiet", "@", 
    RowBox[{"DeleteFile", "@", 
     RowBox[{"ChemDVRFile", "[", 
      RowBox[{"prop", ",", "name", ",", " ", "ops"}], "]"}]}]}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699743915918036*^9, 3.6997439714489717`*^9}, {
  3.7000047240281754`*^9, 3.700004724048818*^9}, {3.725752665788018*^9, 
  3.725752711288278*^9}},ExpressionUUID->"87f4cab0-783b-4d75-ac91-\
17014bac27a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClear", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"prop", ":", 
      RowBox[{"$dvrinst", "|", "$dvrke", "|", "$dvrpe", "|", "$dvrwf"}]}], 
     ",", "$dvrinst", ",", "\n", "\t", 
     RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRClear", "[", 
    RowBox[{"prop", ",", "\n", "\t\t", 
     RowBox[{"uuid", "<>", "\"\<.m\>\""}], ",", "\n", "\t\t", "ops"}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699196191812368*^9, 3.6991962448629293`*^9}, {
   3.699196331707597*^9, 3.699196347962112*^9}, {3.699196398434019*^9, 
   3.699196646340361*^9}, {3.6991976174145107`*^9, 3.69919764293287*^9}, {
   3.699743991188962*^9, 3.699744039546144*^9}, 3.699744111140037*^9, {
   3.700004724057789*^9, 3.7000047240904217`*^9}, {3.725752717981954*^9, 
   3.725752741992021*^9}},ExpressionUUID->"129d92c7-910a-45f6-a26c-\
41b8390fd1db"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Defaults\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.724795278381548*^9, 
  3.7247952816361103`*^9}},ExpressionUUID->"498d4274-9e46-4872-88c9-\
66d665c6c165"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FormatGrid\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718047631253413*^9, 3.7180476325647182`*^9}, 
   3.724795287514295*^9},ExpressionUUID->"4516bcf2-fd24-4959-86d1-\
d883a725bd3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultFormatGrid", "[", 
    RowBox[{"grid_", ",", "points_", ",", "___"}], "]"}], ":=", "\n", "\t", 
   "grid"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699200604333715*^9, 3.69920065436515*^9}, 
   3.699228071685454*^9, {3.69922862652458*^9, 3.6992286278518543`*^9}, {
   3.699233954784215*^9, 3.699233956109192*^9}, 3.699236026259272*^9, {
   3.700004723815454*^9, 3.70000472381841*^9}, {3.716044877331047*^9, 
   3.716044936875804*^9}, {3.716045053593833*^9, 3.716045172219779*^9}, {
   3.718047639055377*^9, 3.718047655840177*^9}, {3.718047709916031*^9, 
   3.7180479700932703`*^9}, {3.718048198088847*^9, 
   3.718048462412904*^9}},ExpressionUUID->"36845978-d538-43bc-936d-\
e32c0f0f8abd"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]DefaultGridPointList\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.727731400821661*^9, 
  3.7277314261174*^9}},ExpressionUUID->"325fc124-0aad-4e2f-afda-171b99c57177"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultGridPointList", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"\"\<GridPrepFunction\>\"", "\[Rule]", "Identity"}], "\n", "\t\t",
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultGridPointList", "[", 
    RowBox[{"grid_", ",", " ", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dims", "=", 
       RowBox[{"Dimensions", "[", "grid", "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Depth", "@", "grid"}], "<=", "3"}], ",", "\n", "\t", "\t\t", 
       
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<GridPrepFunction\>\"", "]"}], "@", 
        "grid"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"Flatten", "[", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<GridPrepFunction\>\"", "]"}], "@", 
          "grid"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Depth", "[", "grid", "]"}], "-", "3"}]}], "\n", "\t\t\t\t",
         "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7277314096463203`*^9, 3.727731452374588*^9}, {
   3.7277314998621473`*^9, 3.727731503398785*^9}, {3.7277315358287687`*^9, 
   3.727731541054201*^9}, 3.727731576810924*^9, {3.72773187739285*^9, 
   3.727731890516594*^9}},ExpressionUUID->"f3dc70cb-643d-49d9-8ab4-\
8e1440faeaf6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDirectProductGrid\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.72772649488496*^9, 3.727726526863521*^9}, {
  3.732066671238274*^9, 3.732066673699185*^9}, {3.7323017547179937`*^9, 
  3.7323017552362328`*^9}},ExpressionUUID->"f0a6cba7-3f0f-457b-927f-\
1b565df8e694"],

Cell["\<\
\[LeftCeiling]Alas this is best implemented procedurally owing to lack of \
FoldTuple\[RightFloor]\
\>", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.732302043296379*^9, 
  3.732302072535481*^9}},ExpressionUUID->"914de9a0-5f32-4825-b3e2-\
bc2068107da4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chemDVRComputeGrid", "[", 
   RowBox[{"fn_", ",", " ", "pt_", ",", " ", "reg_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"fn", "[", 
   RowBox[{"pt", ",", " ", "reg", ",", " ", 
    RowBox[{"FilterRules", "[", 
     RowBox[{
      RowBox[{"{", "opts", "}"}], ",", " ", 
      RowBox[{"Options", "[", "fn", "]"}]}], "]"}]}], "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.732302263763823*^9, 
  3.732302311062009*^9}},ExpressionUUID->"9b720d08-097e-41b6-a74f-\
cde6a09069e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDirectProductGrid", "[", 
    RowBox[{"{", "grids__", "}"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"Outer", "[", 
    RowBox[{"List", ",", " ", "grids"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDirectProductGrid", "[", "\n", "\t", 
   RowBox[{
   "fns_", ",", "\n", "\t", "pts_", ",", "\n", "\t", "regions_", ",", "\n", 
    "\t", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDirectProductGrid", "@", "\n", "\t\t", 
   RowBox[{"MapThread", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"#2", ",", " ", "#3", ",", " ", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "#", "]"}]}], "]"}]}], "]"}], "&"}], ",", 
     "\n", "\t\t\t", 
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{
      "fns", ",", "\n", "\t\t\t\t", "pts", ",", "\n", "\t\t\t\t", "regions"}],
       "\n", "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.727726588967136*^9, 3.727726626597754*^9}, 
   3.72773166068155*^9, {3.72822823994071*^9, 3.728228243339076*^9}, {
   3.732301756596129*^9, 3.732301767539969*^9}, {3.7323018793387403`*^9, 
   3.732301942422942*^9}, {3.732302027575333*^9, 3.732302033009302*^9}, {
   3.7323020911796837`*^9, 3.732302156309366*^9}, {3.732302242376899*^9, 
   3.7323023170141068`*^9}, {3.732420378468354*^9, 
   3.7324204934079247`*^9}},ExpressionUUID->"7b423d48-e1b3-4d34-8bcf-\
d2ba5d23268f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultGrid\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.72772649488496*^9, 3.727726526863521*^9}, {
  3.732066671238274*^9, 3.732066673699185*^9}, {3.7323017547179937`*^9, 
  3.7323017552362328`*^9}, {3.7323969131145363`*^9, 3.732396915440076*^9}, {
  3.732421980298258*^9, 
  3.732421982103204*^9}},ExpressionUUID->"a2c34bfc-3885-4680-bf56-\
6c2e786a21e3"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultNamedGrid\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732396982414033*^9, 3.732396985440037*^9}, 
   3.7324201297784157`*^9},ExpressionUUID->"e39e85e5-c484-49c4-8d20-\
20d3a57687ea"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]RegularSubdivision\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732396995847362*^9, 3.732397001983787*^9}, {
  3.7323971414806843`*^9, 3.7323971473731947`*^9}, {3.732398444969429*^9, 
  3.732398445896202*^9}, {3.732398544077197*^9, 
  3.732398566549446*^9}},ExpressionUUID->"f6df9bf2-6a5a-4795-b8eb-\
dc099e6357b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedGrid", "[", "\n", "\t", 
    RowBox[{
    "\"\<RegularSubdivision\>\"", ",", " ", "\n", "\t", "pt_Integer", ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"min_", ",", " ", "max_"}], "}"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Subdivide", "@@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{"min", ",", " ", "max", ",", " ", 
       RowBox[{"pt", "-", "1"}]}], "}"}]}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.732396989589134*^9, 3.732397093769566*^9}, 
   3.7323971489126596`*^9, 3.732398449183454*^9, {3.732398524093149*^9, 
   3.7323985646458273`*^9}, {3.73242202856642*^9, 
   3.7324220319139957`*^9}},ExpressionUUID->"c8fe8845-f4cf-41a3-8784-\
b8226648e55d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]InteriorSubdivision\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732396995847362*^9, 3.732397001983787*^9}, {
  3.7323971414806843`*^9, 3.7323971473731947`*^9}, {3.732398547614887*^9, 
  3.732398569965201*^9}},ExpressionUUID->"37ac7d3b-955b-4c4a-ab93-\
17bdce39cd29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedGrid", "[", "\n", "\t", 
    RowBox[{
    "\"\<InteriorSubdivision\>\"", ",", " ", "\n", "\t", "pt_Integer", ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"min_", ",", " ", "max_"}], "}"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"max", "-", "min"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"pt", "+", "1"}], ")"}]}], "*", 
      RowBox[{"Range", "[", "pt", "]"}]}], ")"}], "+", "min"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.732396989589134*^9, 3.732397093769566*^9}, 
   3.7323971489126596`*^9, {3.732398455945573*^9, 3.732398466167584*^9}, {
   3.732398521248809*^9, 3.732398522358704*^9}, {3.732398555860317*^9, 
   3.732398574967497*^9}, {3.7324220352043457`*^9, 3.732422038202054*^9}, {
   3.7324290821207333`*^9, 
   3.732429097493587*^9}},ExpressionUUID->"3b4e23af-f469-40e6-9419-\
f5573e7f00c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]AzimuthalSubdivision\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732396995847362*^9, 3.732397001983787*^9}, {
  3.7323971414806843`*^9, 3.7323971473731947`*^9}, {3.732398444969429*^9, 
  3.732398445896202*^9}, {3.732398544077197*^9, 3.7323985946496887`*^9}, {
  3.732398673069306*^9, 
  3.732398681299217*^9}},ExpressionUUID->"c62be3e2-0f35-47e3-9921-\
9caf75d95420"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRDefaultNamedGrid", "[", "\n", "\t", 
   RowBox[{
   "\"\<AzimuthalSubdivision\>\"", ",", " ", "\n", "\t", "pt_Integer", ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"min_", ",", " ", "max_"}], "}"}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{
   RowBox[{"DeleteDuplicatesBy", "[", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"#", ",", 
       RowBox[{"2", "\[Pi]"}]}], "]"}], "&"}], "]"}], "@", "\n", "\t\t", 
   RowBox[{"ChemDVRDefaultNamedGrid", "[", "\n", "\t\t\t", 
    RowBox[{
    "\"\<RegularSubdivision\>\"", ",", " ", "\n", "\t\t\t", "pt", ",", " ", 
     RowBox[{"{", 
      RowBox[{"min", ",", " ", "max"}], "}"}]}], "\n", "\t\t\t", 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.732398642723968*^9, 3.732398648214239*^9}, {
  3.732398685453044*^9, 3.7323987165953693`*^9}, {3.73242204058654*^9, 
  3.732422048354006*^9}},ExpressionUUID->"fa01c63d-993d-4bf9-b3f0-\
b2ab04ca11fe"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PolarSubdivision\[RightFloor]", "CodeSubsubsubsubsection",
 
 Evaluatable->True,
 CellChangeTimes->{{3.732396995847362*^9, 3.732397001983787*^9}, {
   3.7323971414806843`*^9, 3.7323971473731947`*^9}, {3.732398444969429*^9, 
   3.732398445896202*^9}, {3.732398544077197*^9, 3.7323985946496887`*^9}, {
   3.732398673069306*^9, 3.732398694130725*^9}, 
   3.732398742203006*^9},ExpressionUUID->"a338d65f-fb21-4248-8401-\
09d28fea679c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRDefaultNamedGrid", "[", "\n", "\t", 
   RowBox[{
   "\"\<PolarSubdivision\>\"", ",", " ", "\n", "\t", "pt_Integer", ",", " ", 
    RowBox[{"{", 
     RowBox[{"min_", ",", " ", "max_"}], "}"}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{
   RowBox[{"DeleteDuplicatesBy", "[", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"#", ",", " ", "\[Pi]"}], "]"}], "&"}], "]"}], "@", "\n", 
   "\t\t", 
   RowBox[{"ChemDVRDefaultNamedGrid", "[", "\n", "\t\t\t", 
    RowBox[{
    "\"\<RegularSubdivision\>\"", ",", " ", "\n", "\t\t\t", "pt", ",", " ", 
     RowBox[{"{", 
      RowBox[{"min", ",", " ", "max"}], "}"}]}], "\n", "\t\t\t", 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.732398642723968*^9, 3.732398648214239*^9}, 
   3.732398685453044*^9, {3.7323987210435457`*^9, 3.732398743872141*^9}, {
   3.73242205509026*^9, 
   3.7324220627540627`*^9}},ExpressionUUID->"bdb7351e-c76c-494d-a896-\
a81d913182a3"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultGrid\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7323984848431463`*^9, 
  3.732398487937194*^9}},ExpressionUUID->"43bc8fcc-5713-40e5-aa99-\
74cafffcc894"],

Cell["\<\
\[LeftCeiling]

\tTODO: 
\t\tinclude default grids; 
\t\tallow for easy specification in DVR template files;
\t\thandle NonCommutativeMultiply for direct product grids;
\t\thandle arbitrary op matrix el func for determining change of basis;

\[RightFloor]\
\>", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.732401091216526*^9, 3.7324011043256073`*^9}, {
  3.732401135982733*^9, 
  3.732401240370591*^9}},ExpressionUUID->"0e9cd278-9edb-4f85-bba0-\
f169e0d76e78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "grdimfn"}], "=", "\n", "\t", 
   "\"\<Dimensions of grid (``) and number of grid types (``) don't \
match\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "ungrid"}], "=", "\n", "\t", 
   "\"\<\\\"GridType\\\" `` not known\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.732419909668929*^9, 3.73241995563767*^9}, {
  3.73242005218132*^9, 
  3.732420058117425*^9}},ExpressionUUID->"8dd24eab-2f8c-4c25-9b13-\
40ba412a5b7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultGrid", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"\"\<GridType\>\"", "\[Rule]", "\"\<RegularSubdivision\>\""}], 
    "\n", "\t\t", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultGrid", "[", "\n", "\t", 
   RowBox[{"pts_", ",", "\n", "\t", "regions_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"gfs", "=", "\n", "\t\t\t\t", 
      RowBox[{"List", "@@", "\n", "\t\t\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<GridType\>\"", "]"}], ",", " ", 
         "\n", "\t\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"s_", "?", "AtomQ"}], "\[RuleDelayed]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"s", ",", " ", 
            RowBox[{"Length", "@", "pts"}]}], "]"}]}]}], "\n", "\t\t\t\t\t\t",
         "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"{", "gfs", "}"}], ",", " ", "1"}], "]"}]}], "=!=", 
        RowBox[{"Length", "@", "pts"}]}], ",", " ", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ChemDVRRun", "::", "grdimfn"}], ",", " ", 
          RowBox[{"Length", "@", "pts"}], ",", " ", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"{", "gfs", "}"}], ",", " ", "1"}], "]"}]}]}], "]"}], 
        ";", "\n", "\t\t\t", 
        RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\n", "\t\t\t", "]"}], 
     ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"MapThread", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{
          "#", ",", "\n", "\t\t\t\t", "_String", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"ChemDVRDefaultNamedGrid", "[", 
              RowBox[{"#", ",", " ", "#2", ",", " ", "#3"}], "]"}], ",", "\n",
              "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ChemDVRDefaultNamedGrid", "[", 
               RowBox[{"s_", ",", " ", "__"}], "]"}], ":>", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Message", "[", 
                 RowBox[{
                  RowBox[{"ChemDVRRun", "::", "ungrid"}], ",", " ", "s"}], 
                 "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Throw", "[", "$Failed", "]"}]}], "\n", 
               "\t\t\t\t\t\t\t\t", ")"}]}]}], "\n", "\t\t\t\t\t\t", "]"}], 
           ",", "\n", "\t\t\t\t", "_", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"#", "[", 
            RowBox[{"#2", ",", " ", "#3"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
         "&"}], ",", "\n", "\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
         "gfs", ",", "\n", "\t\t\t\t", "pts", ",", "\n", "\t\t\t\t", 
          "regions"}], "\n", "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}], "//",
       "\n", "\t\t\t", 
      RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "l_", "}"}], "\[RuleDelayed]", "l"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"l", ":", 
           RowBox[{"{", "__", "}"}]}], ":>", 
          RowBox[{"ChemDVRDirectProductGrid", "[", "l", "]"}]}]}], "\n", 
        "\t\t\t\t\t", "}"}], "\n", "\t\t\t\t", "]"}]}]}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.732396842509378*^9, 3.7323968505821257`*^9}, {
   3.732396965331862*^9, 3.732396977752389*^9}, {3.732398529916191*^9, 
   3.7323985397984123`*^9}, {3.732398761383811*^9, 3.732398790565381*^9}, {
   3.732398955627776*^9, 3.732398978191824*^9}, {3.732399013084043*^9, 
   3.732399026978743*^9}, {3.732399064426015*^9, 3.732399095839439*^9}, {
   3.732401083984981*^9, 3.7324011294761877`*^9}, {3.732419959866748*^9, 
   3.73242000478271*^9}, {3.7324200853834887`*^9, 3.732420344038039*^9}, {
   3.732420557795519*^9, 3.732420600160469*^9}, {3.732420643940814*^9, 
   3.732420658137434*^9}, {3.732421999939419*^9, 3.732422000127563*^9}, {
   3.7324220826250772`*^9, 3.732422111377037*^9}, 
   3.732422753094709*^9},ExpressionUUID->"fc4f85bb-db86-4ac1-9460-\
d6f56701040f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NamedPotential\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718047631253413*^9, 3.7180476325647182`*^9}, {
  3.724795287514295*^9, 
  3.724795292850572*^9}},ExpressionUUID->"dd47dca5-6862-4a1f-bd04-\
02037f0c7301"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRObject", "::", "nonpot"}], "=", 
   "\"\<Named potential `` unknown\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7311599137670507`*^9, 
  3.731159933141715*^9}},ExpressionUUID->"39d85116-43a3-47c2-854d-\
cb2086324a9a"],

Cell[BoxData[
 RowBox[{"ChemDVRDefaultNamedPotential", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.731703292528319*^9, 
  3.7317032931651287`*^9}},ExpressionUUID->"43b357ed-5eb8-4d8f-9f8c-\
965a66cca63f"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]HarmonicOscillator\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.731989260037402*^9},ExpressionUUID->"9635072c-e94b-4afd-b7ed-\
6d42960c45aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedPotential", "[", 
    RowBox[{"\"\<HarmonicOscillator\>\"", ",", " ", 
     RowBox[{"ops___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<ForceConstant\>\"", ",", 
          " ", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"re", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", 
          "\"\<EquilibriumBondLength\>\"", ",", " ", "0"}], "]"}]}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"k", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "-", "re"}], ")"}], "^", "2"}]}], "]"}], "&"}]}], "\n",
     "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731159945959352*^9, 3.7311599804576063`*^9}, {
  3.731160961022451*^9, 3.731161000121834*^9}, {3.731161272993369*^9, 
  3.731161286068269*^9}, {3.731702654808814*^9, 3.731702709772344*^9}, {
  3.7317027614272003`*^9, 3.73170279026587*^9}, {3.731703044125525*^9, 
  3.731703130206279*^9}, {3.7317032576034*^9, 3.731703284843528*^9}, {
  3.7317037103783283`*^9, 3.731703739124189*^9}, {3.7317868044773617`*^9, 
  3.731786807209291*^9}, {3.731989249775194*^9, 
  3.7319892534757233`*^9}},ExpressionUUID->"f1839273-76a3-4be2-b476-\
34b6e76d7d85"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]MorseOscillator\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.731989256604802*^9},ExpressionUUID->"6a335a92-fe9c-4116-8798-\
68e0d96c86a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedPotential", "[", 
    RowBox[{"\"\<MorseOscillator\>\"", ",", " ", 
     RowBox[{"ops___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"de", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<DissociationEnergy\>\"", 
          ",", " ", "10"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"a", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<WellWidth\>\"", ",", " ", 
          "1"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"re", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", 
          "\"\<EquilibriumBondLength\>\"", ",", " ", "0"}], "]"}]}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"(", 
        RowBox[{"de", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"1", "/", "a"}], ")"}]}], "*", 
              RowBox[{"(", 
               RowBox[{"#", "-", "re"}], ")"}]}], "]"}]}], ")"}], "^", 
          "2"}]}], ")"}], "]"}], "&"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.731159945959352*^9, 3.7311599804576063`*^9}, {
  3.731160961022451*^9, 3.731161000121834*^9}, {3.731161272993369*^9, 
  3.731161286068269*^9}, {3.731702654808814*^9, 3.731702709772344*^9}, {
  3.7317027614272003`*^9, 3.73170279026587*^9}, {3.731703044125525*^9, 
  3.731703130206279*^9}, {3.7317032576034*^9, 3.731703284843528*^9}, {
  3.7317037103783283`*^9, 3.731703739124189*^9}, {3.7317868044773617`*^9, 
  3.731786807209291*^9}, {3.731989249775194*^9, 3.731989265325032*^9}, {
  3.7324292506282673`*^9, 3.7324292544019957`*^9}, {3.73242943515804*^9, 
  3.732429435324175*^9}, {3.732429680848701*^9, 3.7324296823883038`*^9}, {
  3.7324679372674017`*^9, 
  3.732467937937348*^9}},ExpressionUUID->"ecfcc71b-da60-404a-b102-\
fab3a6fe3485"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]MultiWellPolynomial\[RightFloor]", "CodeSubsubsubsection",
 
 Evaluatable->True,
 CellChangeTimes->{3.731989256604802*^9, 
  3.732467977108077*^9},ExpressionUUID->"48db298b-f7d7-445e-9301-\
c3e0007e9ec6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedPotential", "[", 
    RowBox[{"\"\<MultiWellPolynomial\>\"", ",", " ", 
     RowBox[{"ops___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<TurningPoints\>\"", ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"dep", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<Depth\>\"", ",", " ", 
          "5"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"min", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<Minimum\>\"", ",", " ", 
          "0"}], "]"}]}], ",", "\n", "\t\t\t", "mainPol", ",", "\n", "\t\t\t",
        "minValPos", ",", "\n", "\t\t\t", "minPos", ",", "\n", "\t\t\t", 
       "minVal", ",", "\n", "\t\t\t", "minDiff"}], "\n", "\t\t\t", "}"}], ",",
      "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "@", 
         RowBox[{"Length", "@", "pos"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"pos", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{"pos", ",", " ", 
           RowBox[{"MovingAverage", "[", 
            RowBox[{"pos", ",", " ", "2"}], "]"}]}], "]"}]}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"mainPol", "=", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"\[FormalX]p", "-", "t"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "pos"}], "}"}]}], "]"}], ",", " ", 
         "\[FormalX]p"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"minValPos", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[FormalI]pol", ",", " ", "mainPol"}], "}"}], "/.", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[FormalX]p", "\[Rule]", "#"}], ",", " ", 
             RowBox[{"\[FormalI]pol", "\[Rule]", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "&"}], ",", " ", 
          "pos"}], "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minPos", ",", " ", "minVal"}], "}"}], "=", "\n", "\t\t\t", 
       RowBox[{"First", "@", 
        RowBox[{"MinimalBy", "[", 
         RowBox[{
          RowBox[{"minValPos", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"Length", "@", "pos"}], ",", " ", "2"}], "]"}], "]"}], 
           "]"}], ",", " ", "Last"}], "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"minDiff", "=", "\n", "\t\t\t", 
       RowBox[{"Min", "@", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"minPos", ">", "1"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"minValPos", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"minPos", "-", "1"}], ",", " ", "2"}], "]"}], "]"}], 
             "-", "minVal"}], ",", "\n", "\t\t\t\t\t", "\[Infinity]"}], "\n", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"minPos", "<", 
             RowBox[{"Length", "@", "pos"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"minValPos", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"minPos", "+", "1"}], ",", " ", "2"}], "]"}], "]"}], 
             "-", "minVal"}], ",", "\n", "\t\t\t\t\t", "\[Infinity]"}], "\n", 
           "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "}"}]}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"minDiff", ">", "0"}], ",", " ", "\n", "\t\t\t", 
        RowBox[{"dep", "=", 
         RowBox[{"dep", "/", "minDiff"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"dep", "=", "1"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"dep", 
          RowBox[{"(", 
           RowBox[{"mainPol", "/.", 
            RowBox[{"\[FormalX]p", "\[Rule]", "#"}]}], ")"}]}], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dep", "*", "minVal"}], "-", "min"}], ")"}]}], "]"}], 
       "&"}]}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzbzZrnD+mdeO25b0lYLo19sVPoBogWfMX0H0upPy
4guAtJP+IQkQfe7hzfwVZ187cm/fUQaiF6zWrQXRTE0nGkC0L0vLAhB9babb
ahDN52+8G0Tr/Zu1D0S7SJ/5DKKjfyZ/B9E9bv1tF4F086ZnYDrlnEWCybnX
jqvStJJA9BGpEAvu868d1e6eAdOr+FL9QfSS+Cww3a8hnQei/+T4gOkJUVG3
ZID0s3LvuyD6nX3jHVkgnc1/7C2Itnuz7COInmS/gFMOSN8RWsIHonXZZ5qB
6Ia4x1YgWosl0RpM8x+3B4sLzXQA0QuW63mA6NyrWxNANAA2sKsZ
  
  "],ExpressionUUID->"408fcd88-a639-4689-aa26-a7848a5041f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]HinderedRotor\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731989260037402*^9, 3.7319892746085253`*^9}, {
  3.731989589886169*^9, 
  3.731989591515553*^9}},ExpressionUUID->"24ee5ffb-67bf-4881-a417-\
c3c2f8af8a60"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedPotential", "[", 
    RowBox[{"\"\<HinderedRotor\>\"", ",", " ", 
     RowBox[{"ops___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"w", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<WellNumber\>\"", ",", " ",
           "3"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"d", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", "\"\<WellDepth\>\"", ",", " ", 
          "5."}], "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"d", "*", 
        RowBox[{"Cos", "[", 
         RowBox[{
          FractionBox["w", "2"], "*", "#"}], "]"}]}], "]"}], "&"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731159945959352*^9, 3.7311599804576063`*^9}, {
  3.731160961022451*^9, 3.731161000121834*^9}, {3.731161272993369*^9, 
  3.731161286068269*^9}, {3.731702654808814*^9, 3.731702709772344*^9}, {
  3.7317027614272003`*^9, 3.73170279026587*^9}, {3.731703044125525*^9, 
  3.731703130206279*^9}, {3.7317032576034*^9, 3.731703284843528*^9}, {
  3.7317037103783283`*^9, 3.731703739124189*^9}, {3.7317868044773617`*^9, 
  3.731786807209291*^9}, {3.731989249775194*^9, 3.731989277085188*^9}, {
  3.7319895096145153`*^9, 3.731989558748035*^9}, {3.732070881274988*^9, 
  3.732070882623251*^9}, {3.732074524009158*^9, 
  3.732074524380455*^9}},ExpressionUUID->"00d75572-686a-44b0-b973-\
22376492e15a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Fallback\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731989283615492*^9, 
  3.7319892852873487`*^9}},ExpressionUUID->"4f784278-5967-4872-9262-\
cec04b407c73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultNamedPotential", "[", 
    RowBox[{"name_String", ",", " ", 
     RowBox[{"ops___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileExistsQ", "[", "name", "]"}], "||", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"ChemDVRPotentials", "[", "]"}], ",", " ", "name"}], "]"}]}], 
     ",", "\n", "\t\t", "name", ",", "\n", "\t\t", 
     RowBox[{"With", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"pe", "=", 
          RowBox[{"PhysicalSystemData", "[", 
           RowBox[{"name", ",", " ", "\"\<PotentialEnergy\>\""}], "]"}]}], 
         ",", "\n", "\t", "\t\t\t", 
         RowBox[{"crds", "=", 
          RowBox[{"PhysicalSystemData", "[", 
           RowBox[{"name", ",", " ", "\"\<Coordinates\>\""}], "]"}]}], ",", 
         "\n", "\t", "\t\t\t", 
         RowBox[{"vars", "=", 
          RowBox[{"PhysicalSystemData", "[", 
           RowBox[{"name", ",", " ", "\"\<Variables\>\""}], "]"}]}]}], "\n", 
        "\t", "\t\t\t", "}"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MissingQ", "@", "pe"}], "||", 
          RowBox[{"MissingQ", "@", "crds"}]}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"ChemDVRObject", "::", "nonpot"}], ",", " ", "name"}], 
           "]"}], ";", "\n", "\t", "\t", "\t\t", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"With", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"potExpr", "=", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"pe", "/.", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"MapIndexed", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "Sequence", "@@", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Slot", ",", " ", "#2"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"#", "[", "___", "]"}], "\[Rule]", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Slot", ",", " ", "#2"}], "]"}]}]}], "}"}]}], 
                   "&"}], ",", "\n", "\t", "\t", "\t", "\t", "\t", 
                  "\t\t\t\t\t", "crds"}], "\n", "\t", "\t", "\t", "\t", "\t", 
                 "\t\t\t\t\t", "]"}], ",", " ", "\n", "\t", "\t", "\t", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"Flatten", "@", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", "ops", "}"}], ",", " ", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "ops", "}"}]}], ",", "\n", "\t", "\t", "\t", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"s_String", "\[Rule]", "v_"}], ")"}], 
                    "\[RuleDelayed]", "\n", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"QuantityVariable", "[", 
                    RowBox[{"_", ",", " ", "s"}], "]"}], "\[Rule]", "v"}], 
                    ",", " ", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"QuantityVariable", "[", 
                    RowBox[{"s", ",", " ", "_"}], "]"}], "\[Rule]", "v"}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "1"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                  "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "\[Rule]", "1"}], "]"}]}], "\n", "\t", 
               "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t\t\t\t", 
            "}"}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Function", "[", "potExpr", "]"}]}], "\n", "\t", 
          "\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultNamedPotential", "[", "e___", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"ChemDVRObject", "::", "nonpot"}], ",", " ", 
      RowBox[{"{", "e", "}"}]}], "]"}], ";", 
    RowBox[{"Throw", "[", "$Failed", "]"}]}], ")"}]}]}], "CodeInput",
 CellChangeTimes->{{3.731159945959352*^9, 3.7311599804576063`*^9}, {
   3.731160961022451*^9, 3.731161000121834*^9}, {3.731161272993369*^9, 
   3.731161286068269*^9}, {3.731702654808814*^9, 3.731702709772344*^9}, {
   3.7317027614272003`*^9, 3.73170279026587*^9}, {3.731703044125525*^9, 
   3.731703130206279*^9}, {3.7317032576034*^9, 3.731703284843528*^9}, {
   3.7317037103783283`*^9, 3.731703739124189*^9}, {3.7317868044773617`*^9, 
   3.731786807209291*^9}, 3.731989249775194*^9, {3.732074084874954*^9, 
   3.732074100504568*^9}},ExpressionUUID->"f1757c79-debf-4bd8-a2d5-\
3d2fccecfe55"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPotentialEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.7247952957921553`*^9, 
  3.731703347748749*^9},ExpressionUUID->"640c65fb-c1c2-4d75-a4ae-\
44d398e03b2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRObject", "::", "badpot"}], "=", "\n", "\t", 
    "\"\<Potential function `` didn't return a numerical vector over the \
gridpoints\>\""}], ";"}], " "}]], "CodeInput",
 CellChangeTimes->{{3.731158644702427*^9, 
  3.731158666133348*^9}},ExpressionUUID->"bea79571-9aa8-460f-a99e-\
4cdb6cf3ec26"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRDefaultPotentialFunction\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7323086233019333`*^9},ExpressionUUID->"874bd405-6d02-41b6-8023-\
6ed943622ade"],

Cell["\<\
\[LeftCeiling]Need good symbolic representation for a direct product of \
potential functions, which can also work for the grid and for the kinetic \
energy too.\[RightFloor]\
\>", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.732313986113139*^9, 
  3.7323140144250193`*^9}},ExpressionUUID->"e322b52c-1783-4d7e-bc7a-\
baeab36803f3"],

Cell[BoxData[
 RowBox[{"iChemDVRDefaultPotentialFunction", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.732308620348827*^9, 
  3.732308620946097*^9}},ExpressionUUID->"6b1243ee-7843-4bd2-8a89-\
fc386b8706ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultPotentialFunction", "[", 
    RowBox[{"s_String", ",", " ", "ops___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRDefaultNamedPotential", "[", 
    RowBox[{"s", ",", " ", "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultPotentialFunction", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s_String", ",", " ", 
       RowBox[{"op___", "?", "OptionQ"}]}], "}"}], ",", "\n", "\t", "___"}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRDefaultNamedPotential", "[", 
    RowBox[{"s", ",", " ", "op"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultPotentialFunction", "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"NonCommutativeMultiply", "|", "List"}], ")"}], "[", 
      RowBox[{"Repeated", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Except", "[", 
          RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"2", ",", " ", "\[Infinity]"}], "}"}]}], "]"}], "]"}], ",", 
     " ", "\n", "\t", "ops___"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Function", "[", "\n", "\t\t", 
    RowBox[{"Evaluate", "@", "\n", "\t\t\t", 
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"Slot", "@@", "#2"}], "]"}], "&"}], ",", " ", "\n", 
       "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"iChemDVRDefaultPotentialFunction", "[", 
          RowBox[{"#", ",", " ", "ops"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "b"}], "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"iChemDVRDefaultPotentialFunction", "[", 
   RowBox[{"e_", ",", " ", "___"}], "]"}], ":=", "\n", "\t", 
  "e"}]}], "CodeInput",
 CellChangeTimes->{{3.732307840622902*^9, 3.7323079181443768`*^9}, {
  3.732308523850862*^9, 3.7323085763388243`*^9}, {3.732308617701934*^9, 
  3.732308648054762*^9}, {3.7323962429814177`*^9, 3.7323963063262587`*^9}, {
  3.732396372206493*^9, 3.7323964648404207`*^9}, {3.73242168827665*^9, 
  3.732421722863482*^9}},ExpressionUUID->"6eabf2f0-7834-4ccd-970c-\
84de60599af4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPotentialEnergy\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732308631126637*^9, 
  3.732308636105748*^9}},ExpressionUUID->"60d50ce4-43fe-43d3-b6b5-\
40da14a529f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPotentialEnergy", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<PotentialFunction\>\"", "\[Rule]", "Automatic"}], ",", 
       "\n", "\t", "\t\t", 
       RowBox[{"Function", "\[Rule]", "Automatic"}]}], "\n", "\t\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPotentialEnergy", "[", 
    RowBox[{"grid_", ",", " ", 
     RowBox[{"ops___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"pf", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
          "iChemDVRDefaultPotentialFunction", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Lookup", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"{", "ops", "}"}]}], ",", " ", 
             "\"\<PotentialFunction\>\"", ",", " ", "\n", "\t", "\t", "\t", 
             "\t", "\t", "\t\t", 
             RowBox[{"Lookup", "[", 
              RowBox[{
               RowBox[{"Options", "[", "ChemDVRDefaultPotentialEnergy", "]"}],
                ",", " ", "\"\<PotentialFunction\>\""}], "]"}]}], "\n", "\t", 
            "\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
            "_Function", "|", "_InterpolatingFunction", "|", "\n", 
             "\t\t\t\t\t\t", "_CompiledFunction", "|", 
             RowBox[{"_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{"DownValues", "[", "#", "]"}], ">", "0"}], "]"}], 
                "&"}], ")"}]}]}], "]"}], ":>", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "iChemDVRDefaultPotentialFunction", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Lookup", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"{", "ops", "}"}]}], ",", " ", "Function", ",", " ", 
              "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Lookup", "[", 
               RowBox[{
                RowBox[{
                "Options", "[", "ChemDVRDefaultPotentialEnergy", "]"}], ",", 
                " ", "Function"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}], 
            "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"gp", "=", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRDefaultGridPointList", "[", 
         RowBox[{"grid", ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], "\n", 
           "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", 
      "\t\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"gpVec", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"Quiet", "@", 
            RowBox[{"pf", "@", "gp"}]}], ",", " ", 
           RowBox[{
            RowBox[{"Except", "[", "_List", "]"}], ":>", 
            RowBox[{"Map", "[", 
             RowBox[{"pf", ",", " ", "gp"}], "]"}]}]}], "]"}]}], "\n", 
        "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"VectorQ", "@", "gpVec"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"ChemDVRObject", "::", "badpot"}], ",", " ", "pf"}], 
           "]"}], ";", "\n", "\t\t\t\t", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"Band", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1"}], "}"}], "]"}], "->", "gpVec"}], 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699200604333715*^9, 3.69920065436515*^9}, 
   3.699228071685454*^9, {3.69922862652458*^9, 3.6992286278518543`*^9}, {
   3.699233954784215*^9, 3.699233956109192*^9}, 3.699236026259272*^9, {
   3.700004723815454*^9, 3.70000472381841*^9}, {3.716044877331047*^9, 
   3.716044936875804*^9}, {3.716045053593833*^9, 3.716045172219779*^9}, {
   3.718047639055377*^9, 3.718047655840177*^9}, {3.718047709916031*^9, 
   3.7180479700932703`*^9}, {3.718048198088847*^9, 3.718048462412904*^9}, {
   3.718048499432167*^9, 3.718048580482065*^9}, {3.7180514962992773`*^9, 
   3.718051498934264*^9}, {3.718051591926693*^9, 3.7180516583028107`*^9}, {
   3.7277265075922527`*^9, 3.727726520287879*^9}, 3.7277317599198933`*^9, {
   3.7277317956500797`*^9, 3.727731809806579*^9}, {3.731158275580161*^9, 
   3.73115844918017*^9}, {3.731158504203574*^9, 3.7311586387019567`*^9}, {
   3.731158714188323*^9, 3.7311587412025347`*^9}, {3.731159884118897*^9, 
   3.731159886400958*^9}, {3.731161014366889*^9, 3.731161042475547*^9}, {
   3.7317033497071743`*^9, 3.731703400814232*^9}, {3.731703571460451*^9, 
   3.731703593145343*^9}, {3.731703755185617*^9, 3.7317037830556593`*^9}, {
   3.7323078378564587`*^9, 3.732307873762175*^9}, {3.732308583784424*^9, 
   3.732308609962387*^9}, {3.7325120256455793`*^9, 3.732512029508812*^9}, {
   3.732515889975792*^9, 3.732515897023177*^9}, {3.732515952794894*^9, 
   3.732515953806324*^9}},ExpressionUUID->"e8baee08-cf00-4f85-a457-\
ac95fb6d1f87"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRKroeneckerProductKineticEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.72772649488496*^9, 3.727726526863521*^9}, {
  3.732066671238274*^9, 3.732066673699185*^9}, {3.7323023608602667`*^9, 
  3.7323023628165007`*^9}},ExpressionUUID->"88830f9a-0f3a-4524-bdc1-\
929e58de9ef5"],

Cell["\<\
\[LeftCeiling]Many, many, many thanks to Henrik Schumacher for this wonderful \
implementation:
\thttps://mathematica.stackexchange.com/a/165953/38205\[RightFloor]\
\>", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.727726588967136*^9, 3.727726626597754*^9}, 
   3.72773166068155*^9, {3.72822823994071*^9, 
   3.728228243339076*^9}},ExpressionUUID->"56e18733-d234-4beb-858d-\
72556b5dda91"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Imp\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7320667512096043`*^9, 
  3.732066756089809*^9}},ExpressionUUID->"b98c4a04-76c6-430a-ac65-\
137aaad4b73d"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]dvrKGetValues\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732066691135359*^9},ExpressionUUID->"54be5a62-b506-46a0-bcc8-\
dd4963c38ce5"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{"OwnValues", "[", "dvrKGetValues", "]"}]}], "\[Equal]", "0"}], 
   ",", "\n", "\t", 
   RowBox[{"dvrKGetValues", " ", ":=", " ", "\n", "\t\t", 
    RowBox[{"dvrKGetValues", "=", "\n", "\t", "\t\t", 
     RowBox[{"Compile", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1row", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"blockvals", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",",
          " ", "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"diagidx", ",", " ", "_Integer", ",", " ", "1"}], "}"}], 
         ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "_Integer"}], "}"}]}], "\n", "\t\t\t\t\t", 
        "}"}], ",", "\n", "\t\t   ", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "A", "}"}], ",", "\n", "\t\t    ", 
         RowBox[{
          RowBox[{"A", " ", "=", "\n", "\t\t    \t", 
           RowBox[{"Join", "[", "\n", "\t\t\t      ", 
            RowBox[{
             RowBox[{"Table", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"k1row", ",", " ", "k"}], "]"}], ",", " ", "\n", "\t",
                "\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"l", ",", " ", "1", ",", " ", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "blockvals", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", "\n", 
               "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"k", ",", " ", "1", ",", " ", "i"}], "}"}]}], "\n", 
              "\t", "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t      ", 
             "blockvals", ",", "\n", "\t", "\t\t      ", 
             RowBox[{"Table", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"k1row", ",", " ", "k"}], "]"}], ",", " ", "\n", "\t",
                "\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"l", ",", " ", "1", ",", " ", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "blockvals", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", " ", "\n", 
               "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"k", ",", " ", 
                 RowBox[{"i", " ", "+", " ", "2"}], ",", " ", 
                 RowBox[{"Length", "[", "k1row", "]"}]}], "}"}]}], "\n", "\t",
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t      ", "2"}], 
            "\n", "\t", "\t\t      ", "]"}]}], ";", "\n", "\t\t    ", 
          RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", " ", 
                RowBox[{
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"diagidx", ",", " ", "k"}], "]"}], " ", "+", " ", 
                 "i"}]}], "]"}], "]"}], " ", "+=", " ", "\n", "\t\t\t\t\t\t", 
             
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"k1row", ",", " ", 
               RowBox[{"i", " ", "+", " ", "1"}]}], "]"}]}], ",", " ", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"k", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "[", "blockvals", "]"}]}], "}"}]}], "\n", 
           "\t\t\t\t\t", "]"}], ";", "\n", "\t\t    ", "A"}]}], "\n", 
        "\t\t    ", "]"}], ",", "\n", "\t", "\t", "   ", 
       RowBox[{"RuntimeAttributes", " ", "->", " ", 
        RowBox[{"{", "Listable", "}"}]}], ",", "\n", "\t", "\t", "   ", 
       RowBox[{"Parallelization", " ", "->", " ", "True"}], ",", "\n", "\t", 
       "\t", "   ", 
       RowBox[{"CompilationTarget", " ", "->", " ", "\"\<C\>\""}], ",", "\n", 
       "\t", "\t", "   ", 
       RowBox[{"RuntimeOptions", " ", "->", " ", "\"\<Speed\>\""}]}], "\n", 
      "\t", "\t   ", "]"}]}]}]}], "\n", "\t", "]"}]], "CodeInput",
 CellChangeTimes->{{3.728228164522757*^9, 3.72822823208564*^9}, {
  3.72822850787564*^9, 
  3.7282285735910788`*^9}},ExpressionUUID->"14d3f449-ff95-4676-99c3-\
f5925d71ea27"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]dvrKGetColumnIndices\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7320666985687227`*^9},ExpressionUUID->"7a8bc86a-4686-40bd-b86a-\
d5fe4163505a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "@", 
      RowBox[{"OwnValues", "[", "dvrKGetColumnIndices", "]"}]}], "\[Equal]", 
     "0"}], ",", "\n", "\t", 
    RowBox[{"dvrKGetColumnIndices", " ", ":=", " ", "\n", "\t\t", 
     RowBox[{"dvrKGetColumnIndices", "=", "\n", "\t\t\t", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t", "\t    ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"blockci", ",", " ", "_Integer", ",", " ", "3"}], "}"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "diagci", ",", " ", "_Integer", ",", " ", "\n", "\t", "\t", 
            "     ", "3"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", " ", "_Integer"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", " ", "_Integer"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "_Integer"}], "}"}]}], "\n", "\t", "\t", 
         "    ", "}"}], ",", "\n", "\t", "\t", "   ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", " ", ">", " ", "0"}], ",", "\n", "\t", "\t", "    ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", " ", "<", " ", 
             RowBox[{"m", " ", "-", " ", "1"}]}], ",", "\n", "\t\t     ", 
            RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"diagci", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", " ", 
                 RowBox[{"1", " ", ";;", " ", "i"}]}], "]"}], "]"}], ",", " ",
               "\n", "\t\t\t\t\t\t", 
              RowBox[{"blockci", " ", "+", " ", 
               RowBox[{"i", " ", "n"}]}], ",", " ", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"diagci", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", " ", 
                  RowBox[{
                   RowBox[{"i", " ", "+", " ", "1"}], " ", ";;", " ", 
                   RowBox[{"m", " ", "-", " ", "1"}]}]}], "]"}], "]"}], " ", 
               "+", " ", 
               RowBox[{"(", "n", ")"}]}], ",", " ", "\n", "\t\t\t\t\t\t", 
              "2"}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t     ", 
            RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"diagci", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", " ", 
                 RowBox[{"1", " ", ";;", " ", "i"}]}], "]"}], "]"}], ",", " ",
               "\n", "\t\t\t\t\t\t", 
              RowBox[{"blockci", " ", "+", " ", 
               RowBox[{"i", " ", "n"}]}], ",", " ", "\n", "\t\t\t\t\t\t", 
              "2"}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t     ", "]"}], 
          ",", "\n", "\t\t    ", 
          RowBox[{"Join", "[", "\n", "\t\t    \t", 
           RowBox[{
            RowBox[{"blockci", " ", "+", " ", 
             RowBox[{"i", " ", "n"}]}], ",", " ", "\n", "\t\t    \t", 
            RowBox[{
             RowBox[{"diagci", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", 
                RowBox[{
                 RowBox[{"i", " ", "+", " ", "1"}], " ", ";;", " ", 
                 RowBox[{"m", " ", "-", " ", "1"}]}]}], "]"}], "]"}], " ", 
             "+", " ", 
             RowBox[{"(", "n", ")"}]}], ",", " ", "\n", "\t\t    \t", "2"}], 
           "\n", "\t\t    \t", "]"}]}], "\n", "\t\t    ", "]"}], ",", "\n", 
        "\t\t   ", 
        RowBox[{"RuntimeAttributes", " ", "->", " ", 
         RowBox[{"{", "Listable", "}"}]}], ",", "\n", "\t", "\t", "   ", 
        RowBox[{"Parallelization", " ", "->", " ", "True"}], ",", "\n", "\t", 
        "\t", "   ", 
        RowBox[{"CompilationTarget", " ", "->", " ", "\"\<C\>\""}], ",", "\n",
         "\t", "\t", "   ", 
        RowBox[{"RuntimeOptions", " ", "->", " ", "\"\<Speed\>\""}]}], "\n", 
       "\t\t   ", "]"}]}]}]}], "\n", "\t", "]"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.728228164522757*^9, 3.7282282066584377`*^9}, {
  3.728228238148632*^9, 3.728228260012741*^9}, {3.728228367643873*^9, 
  3.728228367655983*^9}, {3.728228469062359*^9, 
  3.7282284986803102`*^9}},ExpressionUUID->"ebd4b780-9fcf-49b1-b0af-\
55b30c14da78"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]dvrKToSparseArray\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7320667069448767`*^9, 
  3.732066722575148*^9}},ExpressionUUID->"0f9aa5d0-173f-471e-9098-\
cb3e4f1ced0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dvrKToSparseArrayData", "[", 
    RowBox[{"b_", "?", "MatrixQ"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", "\n", "  ", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SparseArray", "[", "b", "]"}], "[", "\"\<ColumnIndices\>\"", 
        "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", "b", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", "  ", "b", ",", 
     "\n", "  ", 
     RowBox[{
      RowBox[{"Dimensions", "[", "b", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "\n", "  ", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"Dimensions", "[", "b", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "\n", "  ", "}"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"dvrKToSparseArray", "[", "X_", "]"}], " ", ":=", " ", "\n", " ", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d1", " ", "=", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"X", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
      RowBox[{"d2", " ", "=", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"X", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "\n", "  ", 
    RowBox[{"SparseArray", " ", "@@", " ", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", " ", 
       RowBox[{"{", 
        RowBox[{"d1", ",", " ", "d1"}], "}"}], ",", " ", "0", ",", "\n", 
       "    ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", " ", 
             RowBox[{"d1", " ", "d2"}], ",", " ", "d2"}], "]"}], ",", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", "1"}], "]"}]}], "}"}],
          ",", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"X", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}]}]}], "\n", 
   "  ", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.728228164522757*^9, 3.728228169368814*^9}, {
  3.728228267736788*^9, 3.728228270979926*^9}, {3.728228385265861*^9, 
  3.728228386903335*^9}},ExpressionUUID->"210173d3-2e24-4951-a965-\
d3f65d29552e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]dvrKIteration\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7320667255524597`*^9},ExpressionUUID->"3f017319-ad7f-494b-ae15-\
16028a7b12ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrKIteration", "[", 
   RowBox[{"X_", ",", " ", "a_"}], "]"}], " ", ":=", " ", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "   ", 
     RowBox[{
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"Length", "[", "a", "]"}]}], ",", "\n", "   ", 
      RowBox[{"blockci", " ", "=", " ", 
       RowBox[{"X", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "   ", 
      RowBox[{"blockvals", " ", "=", " ", 
       RowBox[{"X", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "   ", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"X", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "   ", 
      RowBox[{"diagidx", " ", "=", " ", 
       RowBox[{"X", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}]}], "\n", "   ", "}"}], ",", "\n", 
    "  ", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ran", " ", "=", " ", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"m", " ", "-", " ", "1"}]}], "]"}]}], "}"}], ",", "\n", 
      "   ", 
      RowBox[{"{", "\n", "    ", 
       RowBox[{
        RowBox[{"Join", " ", "@@", " ", "\n", "    \t", 
         RowBox[{"dvrKGetColumnIndices", "[", 
          RowBox[{"blockci", ",", " ", "\n", "    \t\t", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", " ", "-", " ", "1"}], ")"}], " ", "n"}], 
                 "]"}], ",", " ", "1"}], "]"}], ",", " ", "n"}], "]"}], "]"}],
            ",", " ", "\n", "    \t\t", "m", ",", " ", "\n", "    \t\t", "n", 
           ",", " ", "\n", "    \t\t", "ran"}], "\n", "    \t\t", "]"}]}], 
        ",", "\n", "    ", 
        RowBox[{"Join", " ", "@@", " ", 
         RowBox[{"dvrKGetValues", "[", 
          RowBox[{
          "a", ",", " ", "blockvals", ",", " ", "diagidx", ",", " ", "ran"}], 
          "]"}]}], ",", "\n", "    ", 
        RowBox[{"m", " ", "n"}], ",", "\n", "    ", 
        RowBox[{"Join", " ", "@@", " ", 
         RowBox[{"Outer", "[", 
          RowBox[{"Plus", ",", " ", "ran", ",", " ", "diagidx"}], "]"}]}]}], 
       "\n", "    ", "}"}]}], "\n", "   ", "]"}]}], "\n", "  ", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.728228164522757*^9, 3.7282281671780977`*^9}, 
   3.7282282879164248`*^9, {3.728228367634501*^9, 3.728228410009253*^9}, {
   3.728228449492806*^9, 
   3.728228459568502*^9}},ExpressionUUID->"9be4df07-5269-4cda-8116-\
9440f055e8db"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDirectProductKineticEnergy\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732066746770686*^9},ExpressionUUID->"69513c6c-729d-44ad-ba69-\
6a5afaff5a6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRKroeneckerProductKineticEnergy", "[", 
   RowBox[{"keMats", ":", 
    RowBox[{"{", "__List", "}"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"dvrKToSparseArray", "[", "\n", "\t\t", 
   RowBox[{"Fold", "[", 
    RowBox[{"dvrKIteration", ",", " ", "\n", "\t\t\t", 
     RowBox[{"dvrKToSparseArrayData", "[", 
      RowBox[{"keMats", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", "\n", "\t\t\t", 
     RowBox[{"Rest", "[", "keMats", "]"}]}], "\n", "\t\t\t", "]"}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.727726528860077*^9, 3.727726580792251*^9}, {
   3.727731180934949*^9, 3.727731193490567*^9}, {3.727731242914007*^9, 
   3.727731247097042*^9}, {3.7282284061759768`*^9, 3.728228441391821*^9}, {
   3.732066733883779*^9, 3.7320667415678673`*^9}, 
   3.732302371640963*^9},ExpressionUUID->"f151fe7b-7de6-4719-9ec8-\
306b20c49e85"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDirectProductKineticEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.72772649488496*^9, 3.727726526863521*^9}, {
  3.732066671238274*^9, 3.732066673699185*^9}, {3.7323017547179937`*^9, 
  3.7323017552362328`*^9}, {3.7323028256078043`*^9, 3.7323028276462507`*^9}, {
  3.732303203466049*^9, 
  3.7323032044784803`*^9}},ExpressionUUID->"1d49bcf7-d36e-46e8-aa56-\
dde2dc796448"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRKeOptValue", "[", 
    RowBox[{"k_", ",", " ", "opts_", ",", " ", "fns_"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"opts", ",", " ", "k", ",", "\n", "\t\t", 
     RowBox[{"Lookup", "[", 
      RowBox[{
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"Options", "/@", "fns"}], ",", " ", "First"}], "]"}], ",", 
       " ", "k", ",", "\n", "\t\t\t", 
       RowBox[{"Lookup", "[", 
        RowBox[{
         RowBox[{"Options", "[", "ChemDVRDirectProductKineticEnergy", "]"}], 
         ",", " ", "k"}], "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.732303456510405*^9, 
  3.7323035209737463`*^9}},ExpressionUUID->"46622dda-91a4-489d-af19-\
c2a9af1cb67e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDirectProductKineticEnergy", "]"}], "=", 
   "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Masses\>\"", "\[Rule]", "Automatic"}], ",", "\n", "\t", 
       "\t\t", 
       RowBox[{"\"\<HBars\>\"", "\[Rule]", "Automatic"}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<ScalingFactors\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Precision", "\[Rule]", "MachinePrecision"}]}], "\n", "\t\t\t",
       "}"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ChemDVRDefaultGridPointList", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDirectProductKineticEnergy", "[", "\n", "\t", 
   RowBox[{"fns_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"subgrids", "=", "\n", "\t\t\t\t", 
       RowBox[{"Map", "[", "\n", "\t", "\t", "\t\t\t", 
        RowBox[{"DeleteDuplicates", ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"Transpose", "@", "\n", "\t\t\t\t\t\t", 
          RowBox[{"ChemDVRDefaultGridpointList", "[", 
           RowBox[{"grid", ",", " ", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], ",", " ", 
              RowBox[{"Options", "[", "ChemDVRDefaultGridpointList", "]"}]}], 
             "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"masses", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"chemDVRKeOptValue", "[", 
          RowBox[{"\"\<Masses\>\"", ",", " ", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "opts", "}"}]}], ",", " ", "fns"}], "]"}], ",", "\n",
          "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"n_", "?", "NumericQ"}], "\[RuleDelayed]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"n", ",", " ", 
              RowBox[{"Length", "@", "fns"}]}], "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n__", "?", "NumericQ"}], "}"}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"n", ",", " ", 
                RowBox[{"Length", "@", "fns"}]}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"Length", "@", "fns"}]}], "]"}], "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"_", ":>", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"Length", "@", "fns"}]}], "]"}]}]}], "\n", 
          "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"hbars", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"chemDVRKeOptValue", "[", 
          RowBox[{"\"\<HBars\>\"", ",", " ", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "opts", "}"}]}], ",", " ", "fns"}], "]"}], ",", "\n",
          "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"n_", "?", "NumericQ"}], "\[RuleDelayed]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"n", ",", " ", 
              RowBox[{"Length", "@", "fns"}]}], "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n__", "?", "NumericQ"}], "}"}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"n", ",", " ", 
                RowBox[{"Length", "@", "fns"}]}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"Length", "@", "fns"}]}], "]"}], "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"_", ":>", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"Length", "@", "fns"}]}], "]"}]}]}], "\n", 
          "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"sfacs", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"chemDVRKeOptValue", "[", 
          RowBox[{"\"\<ScalingFactors\>\"", ",", " ", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "opts", "}"}]}], ",", " ", "fns"}], "]"}], ",", "\n",
          "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"n_", "?", "NumericQ"}], "\[RuleDelayed]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"n", ",", " ", 
              RowBox[{"Length", "@", "fns"}]}], "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n__", "?", "NumericQ"}], "}"}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"n", ",", " ", 
                RowBox[{"Length", "@", "fns"}]}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"Length", "@", "fns"}]}], "]"}], "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"_", ":>", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"Length", "@", "fns"}]}], "]"}]}]}], "\n", 
          "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"prec", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"chemDVRKeOptValue", "[", 
          RowBox[{"Precision", ",", " ", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "opts", "}"}]}], ",", " ", "fns"}], "]"}], ",", "\n",
          "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Except", "[", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], "|", "\[Infinity]"}], "]"}], 
          "\[Rule]", "MachinePrecision"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], 
     "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"ChemDVRKroneckerProductKineticEnergy", "[", "\n", "\t\t\t", 
     RowBox[{"(*", "\n", "\t\t\t\t", 
      RowBox[{
      "Compute", " ", "the", " ", "individual", " ", "KEs", " ", "to", " ", 
       "feed", " ", "into", " ", "Henriks", " ", "Kronecker", " ", "Product", 
       " ", "KE"}], "\n", "\t\t\t", "*)"}], "\n", "\t\t\t", 
     RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"opt", "=", 
            RowBox[{"Association", "@", 
             RowBox[{"Options", "[", "fns", "]"}]}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"opt", ",", " ", "\"\<ScalingFactor\>\""}], "]"}], ",", 
             "\n", "\t\t\t\t\t\t", "Identity", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"f", "=", "#5"}], "}"}], ",", " ", 
               RowBox[{
                RowBox[{"f", "*", "#"}], "&"}]}], "]"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}], "@", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"opt", ",", " ", "Precision"}], "]"}], ",", "\n", 
              "\t\t\t\t\t\t\t", "Identity", ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"N", "[", 
               RowBox[{"#", ",", " ", "prec"}], "]"}]}], "\n", 
             "\t\t\t\t\t\t\t", "]"}], "@", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"#", "[", 
             RowBox[{"#2", ",", " ", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\"\<Mass\>\"", "\[Rule]", "#3"}], ",", " ", 
                  RowBox[{"\"\<HBar\>\"", "\[Rule]", "#4"}], ",", " ", 
                  RowBox[{"\"\<ScalingFactor\>\"", "\[Rule]", "#5"}], ",", 
                  " ", 
                  RowBox[{"Precision", "\[Rule]", "prec"}]}], "}"}], ",", 
                "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"Options", "[", "#", "]"}]}], "\n", 
               "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
             "]"}]}]}]}], "\n", "\t\t\t\t\t", "]"}], "&"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
        "fns", ",", "\n", "\t\t\t\t\t", "subgrids", ",", "\n", "\t\t\t\t\t", 
         "masses", ",", "\n", "\t\t\t\t\t", "hbars", ",", "\n", "\t\t\t\t\t", 
         "sfacs"}], "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.727726588967136*^9, 3.727726626597754*^9}, 
   3.72773166068155*^9, {3.72822823994071*^9, 3.728228243339076*^9}, {
   3.732301756596129*^9, 3.732301767539969*^9}, {3.7323018793387403`*^9, 
   3.732301942422942*^9}, {3.732302027575333*^9, 3.732302033009302*^9}, {
   3.7323020911796837`*^9, 3.732302156309366*^9}, {3.732302242376899*^9, 
   3.7323023170141068`*^9}, {3.732303271599111*^9, 3.732303454063621*^9}, {
   3.7323035244253263`*^9, 3.732303662395685*^9}, {3.732303711586133*^9, 
   3.7323037911536207`*^9}, {3.732303823601671*^9, 3.7323040480436068`*^9}, 
   3.732304087287846*^9, {3.7323041551398077`*^9, 3.73230425242659*^9}, {
   3.7323042908575077`*^9, 
   3.732304291455995*^9}},ExpressionUUID->"e69fcb5b-66a4-437f-9866-\
46329bfb33d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultKineticEnergy\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.72772649488496*^9, 3.727726526863521*^9}, {
  3.732066671238274*^9, 3.732066673699185*^9}, {3.7323017547179937`*^9, 
  3.7323017552362328`*^9}, {3.7323028256078043`*^9, 3.7323028276462507`*^9}, {
  3.732303203466049*^9, 3.7323032044784803`*^9}, {3.7323042804529333`*^9, 
  3.73230428545313*^9}},ExpressionUUID->"7c1b4b2d-0100-4e69-a0e6-\
1442526f8d98"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRDefaultKineticEnergy1D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732306447518417*^9},ExpressionUUID->"694071f9-3543-4916-8f2e-\
e7928198643e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "badkeel"}], "=", "\n", "\t", 
   "\"\<Couldn't determine arguments for element function ``. \\\nExpected to \
take (i, j), (i, j, N) or (i, j, N, x[i], x[j])\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7323048271574*^9, 3.732304896530672*^9}, {
   3.73230494097934*^9, 3.732304962643544*^9}, 
   3.7324229688501*^9},ExpressionUUID->"b98674bb-2d57-47d6-98ba-d836f274d2a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "badke"}], "=", "\n", "\t", 
   "\"\<Kinetic energy function returned non-numerical KE\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.7323048271574*^9, 3.732304896530672*^9}, {
  3.73230494097934*^9, 
  3.732304962643544*^9}},ExpressionUUID->"8b5984c6-410f-4f26-ba67-\
0567a1a85a77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "iChemDVRDefaultKineticEnergy1D", "]"}], "=", "\n",
    "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Mass\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<HBar\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ScalingFactor\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t", 
     RowBox[{"Precision", "\[Rule]", "MachinePrecision"}]}], "\n", "\t\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultKineticEnergy1D", "[", "\n", "\t", 
    RowBox[{"elementFunction_", ",", "\n", "\t", 
     RowBox[{"gridpoints", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "NumericQ"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"gn", "=", 
        RowBox[{"Length", "@", "gridpoints"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"dx", "=", 
        RowBox[{
         RowBox[{"gridpoints", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"gridpoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\n", "\t\t\t", 
       RowBox[{"hb", "=", 
        RowBox[{"OptionValue", "[", "\"\<HBar\>\"", "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"m", "=", 
        RowBox[{"OptionValue", "[", "\"\<Mass\>\"", "]"}]}], ",", "\n", 
       "\t\t\t", "coeff", ",", "\n", "\t\t\t", "ke"}], "\n", "\t\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"coeff", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "@", 
           RowBox[{"OptionValue", "[", "\"\<ScalingFactor\>\"", "]"}]}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"OptionValue", "[", "\"\<ScalingFactor\>\"", "]"}], ",", 
          "\n", "\t\t\t\t", "1"}], "\n", "\t\t\t\t", "]"}], "*", 
        RowBox[{
         RowBox[{"hb", "^", "2"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "m", "*", 
           RowBox[{"dx", "^", "2"}]}], ")"}]}]}]}], ";", "\n", "\t\t", 
      RowBox[{"ke", "=", "\n", "\t\t\t", 
       RowBox[{"Which", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"NumericQ", "@", 
           RowBox[{"elementFunction", "[", 
            RowBox[{"1", ",", " ", "1"}], "]"}]}]}], ",", "\n", "\t\t\t\t\t", 
         
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"coeff", "*", 
            RowBox[{"elementFunction", "[", 
             RowBox[{"i", ",", " ", "j"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "gn"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "gn"}], "}"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"Quiet", "@", 
          RowBox[{"NumericQ", "@", 
           RowBox[{"elementFunction", "[", 
            RowBox[{"1", ",", " ", "1", ",", " ", "gn"}], "]"}]}]}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"coeff", "*", 
            RowBox[{"elementFunction", "[", 
             RowBox[{"i", ",", " ", "j", ",", " ", "gn"}], "]"}]}], ",", " ", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "gn"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "gn"}], "}"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"Quiet", "@", 
          RowBox[{"NumericQ", "@", 
           RowBox[{"elementFunction", "[", 
            RowBox[{"1", ",", " ", "1", ",", " ", "gn", ",", " ", 
             RowBox[{"gridpoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"gridpoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"coeff", "*", 
            RowBox[{"elementFunction", "[", 
             RowBox[{"i", ",", " ", "j", ",", " ", "gn", ",", " ", 
              RowBox[{"gridpoints", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
              RowBox[{"gridpoints", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", " ", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "gn"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "gn"}], "}"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", "True", ",", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"ChemDVRRun", "::", "badkeel"}], ",", " ", 
            "elementFunction"}], "]"}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\n", "\t\t\t\t", 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatrixQ", "[", 
          RowBox[{"ke", ",", " ", "NumericQ"}], "]"}]}], ",", " ", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"ChemDVRRun", "::", "badke"}], ";", "\n", "\t\t\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\n", "\t\t\t", "]"}], 
      ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "Precision", "]"}], "===", 
         "\[Infinity]"}], ",", "\n", "\t\t\t", "ke", ",", "\n", "\t\t\t", 
        RowBox[{"N", "[", 
         RowBox[{"ke", ",", " ", 
          RowBox[{"OptionValue", "[", "Precision", "]"}]}], "]"}]}], "\n", 
       "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.732304326661312*^9, 3.7323044329945183`*^9}, {
  3.7323044720662413`*^9, 3.7323047819669037`*^9}, {3.732304816480308*^9, 
  3.732304821774274*^9}, {3.732304900476348*^9, 3.732305059838354*^9}, {
  3.732305103372595*^9, 3.732305117223804*^9}, {3.732305426911302*^9, 
  3.732305432322577*^9}, {3.732305512024581*^9, 3.7323055467286*^9}, {
  3.732305707470067*^9, 3.732305769029565*^9}, {3.7323062232800903`*^9, 
  3.7323062282633953`*^9}, {3.732422978192111*^9, 3.732423018785892*^9}, {
  3.732424829698866*^9, 
  3.7324248432216063`*^9}},ExpressionUUID->"04b7b754-5776-401a-b6e8-\
b81df13973f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultKineticEnergyElementFunction\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732306457620776*^9},ExpressionUUID->"223d6a0a-7699-4485-bfb5-\
779db309e284"],

Cell[BoxData[
 RowBox[{"ChemDVRDefaultKineticEnergyElementFunction", "//", 
  "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.73230659151262*^9, 
  3.732306592486142*^9}},ExpressionUUID->"2f1d5d80-b6b8-43f7-89c5-\
aaab918a0a18"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColbertMillerCartesian\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732306462140473*^9},ExpressionUUID->"41295b5c-56b6-4d2c-8a9f-\
9490c6ca54d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "ChemDVRDefaultKineticEnergyElementFunction", "[", 
    "\"\<ColbertMillerCartesian\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Function", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", "\[Equal]", "#2"}], ",", " ", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"\[Pi]", "^", "2"}], "/", "3"}], ",", " ", "\n", "\t\t\t", 
       RowBox[{"2", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "-", "#2"}], ")"}], "^", "2"}]}]}], "\n", "\t\t\t", 
      "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"#", "-", "#2"}], ")"}]}], ")"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.732304326661312*^9, 3.7323044329945183`*^9}, {
  3.7323044720662413`*^9, 3.7323047819669037`*^9}, {3.732304816480308*^9, 
  3.732304821774274*^9}, {3.732304900476348*^9, 3.732305059838354*^9}, {
  3.732305103372595*^9, 3.732305117223804*^9}, {3.732305426911302*^9, 
  3.732305432322577*^9}, {3.732305512024581*^9, 3.732305601674129*^9}, {
  3.732305681712768*^9, 3.732305696383099*^9}, {3.73230578229959*^9, 
  3.732305826471333*^9}, {3.732305950245553*^9, 3.732306012440419*^9}, {
  3.732306106707663*^9, 3.732306114668222*^9}, {3.73230615436681*^9, 
  3.732306164348983*^9}, {3.732306211549629*^9, 3.732306215541771*^9}, {
  3.732306249653275*^9, 3.732306259115436*^9}, {3.732306293869852*^9, 
  3.732306315533745*^9}, {3.732306367091919*^9, 
  3.732306431948894*^9}},ExpressionUUID->"744c23a0-9d02-4c64-967e-\
fda7e8cdc32f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColbertMillerRadial\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732306465102538*^9, 
  3.7323064677302847`*^9}},ExpressionUUID->"90902009-f17b-4d38-a6ea-\
120871d97f39"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "ChemDVRDefaultKineticEnergyElementFunction", "[", 
    "\"\<ColbertMillerRadial\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Function", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", "\[Equal]", "#2"}], ",", " ", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Pi]", "^", "2"}], "/", "3"}], "-", 
        RowBox[{"1", "/", 
         SuperscriptBox["#", "2"]}]}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"2", "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", "#2"}], ")"}], "^", "2"}]}], "-", 
        RowBox[{"2", "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "+", "#2"}], ")"}], "^", "2"}]}]}]}], "\n", "\t\t\t", 
      "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"#", "-", "#2"}], ")"}]}], ")"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.732304326661312*^9, 3.7323044329945183`*^9}, {
  3.7323044720662413`*^9, 3.7323047819669037`*^9}, {3.732304816480308*^9, 
  3.732304821774274*^9}, {3.732304900476348*^9, 3.732305059838354*^9}, {
  3.732305103372595*^9, 3.732305117223804*^9}, {3.732305426911302*^9, 
  3.732305432322577*^9}, {3.732305512024581*^9, 3.732305601674129*^9}, {
  3.732305681712768*^9, 3.732305696383099*^9}, {3.73230578229959*^9, 
  3.732305826471333*^9}, {3.732305950245553*^9, 3.732306012440419*^9}, {
  3.732306106707663*^9, 3.732306114668222*^9}, {3.73230615436681*^9, 
  3.732306164348983*^9}, {3.732306211549629*^9, 3.732306215541771*^9}, {
  3.732306249653275*^9, 3.732306259115436*^9}, {3.732306293869852*^9, 
  3.732306315533745*^9}, {3.732306367091919*^9, 
  3.73230643298936*^9}},ExpressionUUID->"83adb91d-9def-48ad-9c03-b2fb9bbfdc8e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColbertMillerPolar\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7323064753957043`*^9},ExpressionUUID->"1ef8d9e1-5618-4eb6-838d-\
a05afb5d7875"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "ChemDVRDefaultKineticEnergyElementFunction", "[", 
    "\"\<ColbertMillerPolar\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Function", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#3", "/", "Pi"}], ")"}], "^", "2"}], "/", "2"}], "*", "\n", 
     "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", "\[Equal]", "#2"}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"#3", "^", "2"}]}], "+", "1"}], ")"}], "/", "3"}], "-", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"Pi", "*", 
              RowBox[{"#", "/", "#3"}]}], "]"}], "&"}], "2"}], ")"}]}]}], ",",
        "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"#", "-", "#2"}], ")"}]}], ")"}], "/", "\n", "\t\t\t\t\t", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Pi]", "*", 
               RowBox[{"(", 
                RowBox[{"#", "-", "#2"}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "#3"}], ")"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Pi]", "*", 
               RowBox[{"(", 
                RowBox[{"#", "+", "#2"}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "#3"}], ")"}]}], "]"}], "^", "2"}]}], 
         ")"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.732304326661312*^9, 3.7323044329945183`*^9}, {
  3.7323044720662413`*^9, 3.7323047819669037`*^9}, {3.732304816480308*^9, 
  3.732304821774274*^9}, {3.732304900476348*^9, 3.732305059838354*^9}, {
  3.732305103372595*^9, 3.732305117223804*^9}, {3.732305426911302*^9, 
  3.732305432322577*^9}, {3.732305512024581*^9, 3.732305601674129*^9}, {
  3.732305681712768*^9, 3.732305696383099*^9}, {3.73230578229959*^9, 
  3.732305826471333*^9}, {3.732305950245553*^9, 3.732306012440419*^9}, {
  3.732306106707663*^9, 3.732306114668222*^9}, {3.73230615436681*^9, 
  3.732306164348983*^9}, {3.732306211549629*^9, 3.732306215541771*^9}, {
  3.732306249653275*^9, 3.732306259115436*^9}, {3.732306293869852*^9, 
  3.732306315533745*^9}, {3.732306367091919*^9, 
  3.732306433972761*^9}},ExpressionUUID->"9ec6939c-ba54-4a0a-816e-\
9c8fc62c4ccb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]MeyerAzimuthal\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.7323064813794603`*^9, 
  3.732424361706252*^9},ExpressionUUID->"d15ecff6-9de2-437d-992e-\
a1b5dca86ee5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "ChemDVRDefaultKineticEnergyElementFunction", "[", 
    "\"\<MeyerAzimuthal\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Function", "[", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#", "\[Equal]", "#2"}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#3", "^", "2"}], "/", "2"}], "+", "1"}], ")"}], "*", 
       RowBox[{"1", "/", "6"}]}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"#", "-", "#2"}], ")"}]}], ")"}], "/", "\n", "\t\t\t\t", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Pi]", "*", 
              RowBox[{"(", 
               RowBox[{"#", "-", "#2"}], ")"}]}], ")"}], "/", "#3"}], "]"}], 
          "^", "2"}]}], ")"}]}]}], "\n", "\t\t\t", "]"}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.732304326661312*^9, 3.7323044329945183`*^9}, {
  3.7323044720662413`*^9, 3.7323047819669037`*^9}, {3.732304816480308*^9, 
  3.732304821774274*^9}, {3.732304900476348*^9, 3.732305059838354*^9}, {
  3.732305103372595*^9, 3.732305117223804*^9}, {3.732305426911302*^9, 
  3.732305432322577*^9}, {3.732305512024581*^9, 3.732305601674129*^9}, {
  3.732305681712768*^9, 3.732305696383099*^9}, {3.73230578229959*^9, 
  3.732305826471333*^9}, {3.732305950245553*^9, 3.732306012440419*^9}, {
  3.732306106707663*^9, 3.732306114668222*^9}, {3.73230615436681*^9, 
  3.732306164348983*^9}, {3.732306211549629*^9, 3.732306215541771*^9}, {
  3.732306249653275*^9, 3.732306259115436*^9}, {3.732306293869852*^9, 
  3.732306315533745*^9}, {3.732306367091919*^9, 3.73230643557211*^9}, {
  3.732424358139061*^9, 
  3.732424359244968*^9}},ExpressionUUID->"eed6c411-815c-4494-b3b0-\
c528d79ab7f7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Fallback\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732306551347673*^9, 
  3.7323065553753233`*^9}},ExpressionUUID->"cd6fa980-29e9-4b3d-bb0f-\
bcd874770c04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRDefaultKineticEnergyElementFunction", "[", "___", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"(", "\n", "\t\t", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"ChemDVRRun", "::", "nokel"}], ",", " ", 
      "\"\<Unknown kinetic energy element function ``\>\""}], "]"}], ";", 
    "\n", "\t\t", 
    RowBox[{"Throw", "[", "$Failed", "]"}]}], "\n", "\t\t", 
   ")"}]}]], "CodeInput",
 CellChangeTimes->{{3.732306556031723*^9, 
  3.732306587879046*^9}},ExpressionUUID->"30a543e0-ffd5-4764-8bfd-\
c12fbb907383"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultKineticEnergy\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7323064908841543`*^9},ExpressionUUID->"7f7094e1-ef7f-488f-a67b-\
409530a487a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "kedimx"}], "=", "\n", "\t", 
   "\"\<Dimension of grid (``) doesn't match number of kinetic energy element\
\\\n functions (``)\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.732306908486438*^9, 
  3.732306963071641*^9}},ExpressionUUID->"55468b83-144d-4647-92d1-\
fe0c12b62101"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultKineticEnergy", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "\"\<KineticEnergyElementFunction\>\"", "\[Rule]", "Automatic"}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "iChemDVRDefaultKineticEnergy1D", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultKineticEnergy", "[", "\n", "\t", 
   RowBox[{"gridpoints_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"keel", "=", "\n", "\t\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{
        "OptionValue", "[", "\"\<KineticEnergyElementFunction\>\"", "]"}], 
        ",", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"k", ":", 
          RowBox[{"_Cross", "|", "_NonCommutativeMultiply"}]}], 
         "\[RuleDelayed]", 
         RowBox[{"List", "@@", "k"}]}]}], "\n", "\t", "\t", "\t\t\t", "]"}]}],
      "\n", "\t", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"Switch", "[", 
     RowBox[{"keel", ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{"Repeated", "[", 
        RowBox[{
         RowBox[{"Except", "[", 
          RowBox[{"_", "?", "OptionQ"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"2", ",", " ", "\[Infinity]"}], "}"}]}], "]"}], "}"}], ",", 
      "\n", "\t\t\t\t", 
      RowBox[{"With", "[", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t\t", 
         RowBox[{"subgrids", "=", "\n", "\t\t\t\t\t\t\t", 
          RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
            "ChemDVRDefaultGridPointList", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
             RowBox[{"gridpoints", ",", " ", "\n", "\t\t\t\t\t\t\t\t\t", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", "ops", "}"}], ",", " ", 
                RowBox[{
                "Options", "[", "ChemDVRDefaultGridPointList", "]"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
            "\t\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"l", ":", 
              RowBox[{"{", "__List", "}"}]}], ":>", "\n", 
             "\t\t\t\t\t\t\t\t\t", 
             RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
              RowBox[{
              "DeleteDuplicates", ",", " ", "\n", "\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{"Transpose", "@", "l"}]}], "\n", 
              "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
           "]"}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "subgrids"}], "=!=", 
            RowBox[{"Length", "@", "keel"}]}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"ChemDVRRun", "::", "kedimx"}], ",", " ", 
              RowBox[{"Length", "@", "subgrids"}], ",", " ", 
              RowBox[{"Length", "@", "keel"}]}], "]"}], ";", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
          "]"}], ";", "\n", "\t\t\t\t\t", 
         RowBox[{
         "ChemDVRKroeneckerProductKineticEnergy", "@", "\n", "\t\t\t\t\t\t", 
          RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"iChemDVRDefaultKineticEnergy1D", "[", 
              RowBox[{"#", ",", " ", "#2", ",", " ", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", " ", 
                 RowBox[{
                 "Options", "[", "iChemDVRDefaultKineticEnergy1D", "]"}]}], 
                "]"}]}], "\n", "\t", "\t", "\t", "\t\t\t\t\t", "]"}], "&"}], 
            ",", "\n", "\t", "\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
             RowBox[{"keel", ",", "\n", "\t", "\t\t\t\t\t\t\t", "subgrids"}], 
             "\n", "\t", "\t\t\t\t\t\t\t", "}"}]}], "\n", "\t", 
           "\t\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
      "\t\t\t", "_String", ",", "\n", "\t\t\t\t", 
      RowBox[{"ChemDVRDefaultKineticEnergy", "[", "\n", "\t\t\t\t\t", 
       RowBox[{"gridpoints", ",", "\n", "\t\t\t\t\t", 
        RowBox[{
        "\"\<KineticEnergyElementFunction\>\"", "->", "\n", "\t\t\t\t\t\t", 
         RowBox[{
         "ChemDVRDefaultKineticEnergyElementFunction", "[", "keel", "]"}]}], 
        ",", "\n", "\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{"_String", ",", " ", 
        RowBox[{"___", "?", "OptionQ"}]}], "}"}], ",", "\n", "\t\t\t\t", 
      RowBox[{"ChemDVRDefaultKineticEnergy", "[", "\n", "\t\t\t\t\t", 
       RowBox[{"gridpoints", ",", "\n", "\t\t\t\t\t", 
        RowBox[{
        "\"\<KineticEnergyElementFunction\>\"", "->", "\n", "\t\t\t\t\t\t", 
         RowBox[{"Apply", "[", 
          RowBox[{
          "ChemDVRDefaultKineticEnergyElementFunction", ",", " ", "keel"}], 
          "]"}]}], ",", "\n", "\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t", 
       "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", "_", "}"}], ",", "\n", "\t\t\t\t", 
      RowBox[{"iChemDVRDefaultKineticEnergy1D", "[", 
       RowBox[{
        RowBox[{"First", "@", "keel"}], ",", " ", "gridpoints", ",", " ", 
        "\n", "\t\t\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", 
          RowBox[{"Options", "[", "iChemDVRDefaultKineticEnergy1D", "]"}]}], 
         "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "_", ",", 
      "\n", "\t\t\t\t", 
      RowBox[{"iChemDVRDefaultKineticEnergy1D", "[", 
       RowBox[{"keel", ",", " ", "gridpoints", ",", " ", "\n", "\t\t\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", 
          RowBox[{"Options", "[", "iChemDVRDefaultKineticEnergy1D", "]"}]}], 
         "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
   "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7323051264591007`*^9, 3.732305207720023*^9}, 
   3.73230530475836*^9, {3.732305404546653*^9, 3.732305415124303*^9}, {
   3.732305455889134*^9, 3.732305499855644*^9}, {3.732306513453114*^9, 
   3.732306545823832*^9}, {3.732306654768217*^9, 3.732306721241197*^9}, 
   3.73230678456282*^9, {3.732306815008149*^9, 3.732306902672139*^9}, {
   3.732306969228294*^9, 3.732306975848778*^9}, {3.732307273046331*^9, 
   3.732307356651196*^9}, {3.7324216348182077`*^9, 3.732421660564908*^9}, {
   3.7324227273110027`*^9, 3.732422734602519*^9}, {3.732422781458602*^9, 
   3.7324228045182953`*^9}, {3.732422872507553*^9, 3.732422940752428*^9}, {
   3.732423092404846*^9, 3.732423115361535*^9}, {3.732423150388412*^9, 
   3.732423156481235*^9}, 3.732517052282962*^9, {3.732517088905349*^9, 
   3.732517090558765*^9}, {3.732517125778096*^9, 3.7325171816681843`*^9}, 
   3.7325172168188972`*^9},ExpressionUUID->"6b69030e-ef42-4002-9cd4-\
9e76af5523ff"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]WavefunctionSelection\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7314328449319057`*^9, 
  3.731432847539864*^9}},ExpressionUUID->"39673ad7-3a4a-40ad-ba48-\
c962311a84f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chemDVRScaledWavefunctionSpan", "[", 
   RowBox[{"s_", ",", " ", "len_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Which", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"s", ">=", "1"}], ",", " ", "\n", "\t\t\t", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
    RowBox[{"s", "==", "0"}], ",", "\n", "\t\t\t", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
    RowBox[{"s", "<", "0"}], ",", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"Ceiling", "[", 
      RowBox[{"s", "*", "len"}], "]"}], ";;"}], ",", "\n", "\t\t", "True", 
    ",", "\n", "\t\t\t", 
    RowBox[{";;", 
     RowBox[{"Floor", "[", 
      RowBox[{"s", "*", "len"}], "]"}]}]}], " ", "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.732423489260847*^9, 3.732423517468217*^9}, {
  3.73242373378449*^9, 3.732423752340508*^9}, {3.732424010043816*^9, 
  3.7324240110646477`*^9}},ExpressionUUID->"622e24b7-7e89-41a5-b2e7-\
85b575a7f095"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultWavefunctionSelection", "]"}], "=", 
   "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"\"\<WavefunctionSelection\>\"", "\[Rule]", "All"}], "\n", "\t\t",
     "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultWavefunctionSelection", "[", 
    RowBox[{"wfs_", ",", " ", "\n", "\t", 
     RowBox[{"sel", ":", 
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"sel", "=!=", "All"}], ",", "\n", "\t\t", 
     RowBox[{"wfs", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"sel", ",", "\n", "\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"i_Integer", "?", "Positive"}], "\[RuleDelayed]", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", ">", 
                RowBox[{"Length", "@", 
                 RowBox[{"wfs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", "All", ",", 
               " ", 
               RowBox[{";;", "i"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"i_Integer", "?", "Negative"}], "\[RuleDelayed]", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "i"}], ">", 
                RowBox[{"Length", "@", 
                 RowBox[{"wfs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", "All", ",", 
               " ", 
               RowBox[{"i", ";;"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Scaled", "[", 
              RowBox[{"s_", "?", "NumericQ"}], "]"}], ":>", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"chemDVRScaledWavefunctionSpan", "[", 
              RowBox[{"s", ",", " ", 
               RowBox[{"Length", "@", 
                RowBox[{"wfs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"min_", "?", "NumericQ"}], ",", " ", 
                RowBox[{"max_", "?", "NumericQ"}]}], "}"}], "]"}], ":>", "\n",
              "\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"minMax", "=", 
                 RowBox[{"Sort", "@", 
                  RowBox[{"{", 
                   RowBox[{"min", ",", " ", "max"}], "}"}]}]}], "}"}], ",", 
               "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"chemDVRScaledWavefunctionSpan", "[", 
                    RowBox[{
                    RowBox[{"minMax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"Length", "@", 
                    RowBox[{"wfs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"chemDVRScaledWavefunctionSpan", "[", 
                    RowBox[{
                    RowBox[{"minMax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"Length", "@", 
                    RowBox[{"wfs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "}"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"M_", ";;"}], ",", " ", 
                    RowBox[{";;", "m_"}]}], "}"}], "|", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m_", ";;"}], ",", " ", 
                    RowBox[{"M_", ";;"}]}], "}"}], "|", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{";;", "m_"}], ",", " ", 
                    RowBox[{";;", "M_"}]}], "}"}]}], "\[RuleDelayed]", 
                    RowBox[{"m", ";;", "M"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", "e_", "}"}], "\[RuleDelayed]", "e"}]}], "\n",
                   "\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
           "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
       "]"}], "]"}], ",", "\n", "\t\t", "wfs"}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultWavefunctionSelection", "[", 
   RowBox[{"wfs_", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemDVRDefaultWavefunctionSelection", "[", 
   RowBox[{"wfs", ",", "\n", "\t\t", 
    RowBox[{"OptionValue", "[", "\"\<WavefunctionSelection\>\"", "]"}]}], 
   "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.731432848241715*^9, 3.731432937222567*^9}, {
  3.731787382310871*^9, 3.7317874155589447`*^9}, {3.732423208458268*^9, 
  3.732423706331007*^9}, {3.7324237604788313`*^9, 3.732423853932827*^9}, {
  3.732423985468999*^9, 
  3.732424002527217*^9}},ExpressionUUID->"55eaed55-a8ed-49ec-ae8b-\
e40be7635b13"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.724795302183313*^9},ExpressionUUID->"76843220-7806-415f-a772-\
de79c02cd6a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "badham"}], "=", 
   "\"\<The computed Hamiltonian is not a square numerical matrix\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.732422604409165*^9, 
  3.732422621720605*^9}},ExpressionUUID->"8eb6fb85-508b-4d21-a3e4-\
f06c4f878847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultWavefunctions", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "Eigensystem"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<NumberOfWavefunctions\>\"", "\[Rule]", "Automatic"}], ",",
        "\n", "\t\t\t", 
       RowBox[{"\"\<CorrectPhase\>\"", "\[Rule]", "True"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"\"\<SortEnergies\>\"", "\[Rule]", "True"}]}], "\n", "\t\t\t", 
      "}"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultWavefunctions", "[", 
    RowBox[{"T_", ",", "V_", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"ham", "=", 
        RowBox[{"T", "+", "V"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"nwfs", "=", 
        RowBox[{"OptionValue", "[", "\"\<NumberOfWavefunctions\>\"", "]"}]}], 
       ",", "\n", "\t", "\t\t", 
       RowBox[{"sort", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<SortEnergies\>\"", "]"}], "=!=", 
         "False"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"rephase", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<CorrectPhase\>\"", "]"}], "=!=", 
         "False"}]}], ",", "\n", "\t", "\t\t", "wfns", ",", "\n", "\t", 
       "\t\t", "phase"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"SquareMatrixQ", "[", "ham", "]"}]}], "||", 
         RowBox[{"!", 
          RowBox[{"MatrixQ", "[", 
           RowBox[{"ham", ",", " ", "NumericQ"}], "]"}]}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"ChemDVRRun", "::", "badham"}], "]"}], ";", "\n", "\t\t\t", 
         
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\n", "\t\t\t", "]"}], 
      ";", " ", "\n", "\t\t", 
      RowBox[{"wfns", "=", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"sort", ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], ",", 
              RowBox[{"Ordering", "[", 
               RowBox[{"First", "@", "#"}], "]"}]}], "]"}], "]"}], ",", " ", 
           "#"}], "]"}], "&"}], "@", "\n", "\t\t\t\t\t", 
        RowBox[{"Eigensystem", "[", "\n", "\t\t\t\t\t\t", 
         RowBox[{"ham", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"nwfs", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "@", "ham"}], "===", "SparseArray"}], ",", 
                 " ", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"-", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "ham"}], "/", "10"}], ",", " ", 
                    "20"}], "}"}]}], ",", " ", 
                    RowBox[{"Length", "@", "ham"}], ",", " ", "25"}], "}"}]}],
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", 
                "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"i_Integer", "\[RuleDelayed]", 
               RowBox[{"-", "i"}]}], ",", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"_", ":>", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", "}"}]}]}]}], "\n", "\t\t\t\t\t\t\t\t", "}"}]}], 
           "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Method", "\[Rule]", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Method", "]"}], ",", " ", "\n", 
             "\t\t\t\t\t\t\t\t", 
             RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "@", "ham"}], "===", "SparseArray"}], ",", 
                " ", "\n", "\t\t\t\t\t\t\t\t\t\t", "Automatic", ",", "\n", 
                "\t\t\t\t\t\t\t\t\t\t", "\"\<FEAST\>\""}], "\n", 
               "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
            "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "ops", "}"}], ",", 
              RowBox[{"Alternatives", "@@", 
               RowBox[{"Keys", "@", 
                RowBox[{"Options", "@", "Eigensystem"}]}]}]}], "]"}], ",", 
            "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Except", "[", "Method", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
           "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{"rephase", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"phase", "=", 
          RowBox[{"Sign", "@", 
           RowBox[{"wfns", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", " ", 
              RowBox[{
               RowBox[{"Ordering", "[", 
                RowBox[{"First", "@", "wfns"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", "\n", 
         "\t", "\t\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"First", "@", "wfns"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"phase", "*", "#"}], "&"}], "/@", 
            RowBox[{"Last", "@", "wfns"}]}]}], "}"}]}], ",", "\n", "\t\t\t", 
        "wfns"}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699200604333715*^9, 3.69920065436515*^9}, 
   3.699228071685454*^9, {3.69922862652458*^9, 3.6992286278518543`*^9}, {
   3.699233954784215*^9, 3.699233956109192*^9}, 3.699236026259272*^9, {
   3.700004723815454*^9, 3.70000472381841*^9}, {3.716044877331047*^9, 
   3.716044936875804*^9}, {3.716045053593833*^9, 3.716045172219779*^9}, {
   3.718047639055377*^9, 3.718047655840177*^9}, {3.718047709916031*^9, 
   3.7180479700932703`*^9}, {3.718048198088847*^9, 3.7180484643377733`*^9}, {
   3.71805108263029*^9, 3.718051418792109*^9}, {3.718051501895123*^9, 
   3.71805158442178*^9}, {3.718051807796692*^9, 3.718051818570958*^9}, {
   3.718051939155568*^9, 3.718051954747117*^9}, {3.7180521348364267`*^9, 
   3.718052175925763*^9}, {3.719855405542396*^9, 3.719855435777013*^9}, {
   3.719855810046487*^9, 3.7198558628499937`*^9}, {3.7198741226820707`*^9, 
   3.719874150574786*^9}, {3.727652122527961*^9, 3.727652221116576*^9}, {
   3.729194918612468*^9, 3.72919492332187*^9}, {3.729194999208186*^9, 
   3.7291950002052383`*^9}, {3.729195705359674*^9, 3.7291957173690968`*^9}, {
   3.731091836238999*^9, 3.731091853724534*^9}, {3.732422526730199*^9, 
   3.732422534578055*^9}, {3.732422573255947*^9, 
   3.7324226301158648`*^9}},ExpressionUUID->"b93e39a8-ea03-4b90-9d91-\
5eb5d82de70e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultGridWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.724795308679735*^9},ExpressionUUID->"3faffae1-8b52-4623-a73d-\
7a1b8e8e156c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultGridWavefunctions", "]"}], "=", 
   "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<ReturnEnergies\>\"", "\[Rule]", "False"}], "\n", "\t\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ChemDVRDefaultWavefunctionSelection", "]"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ChemDVRDefaultGridPointList", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultGridWavefunctions", "[", 
    RowBox[{"grid_", ",", "wfs_", ",", " ", 
     RowBox[{"o", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"coreGridPoints", "=", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRDefaultGridPointList", "[", 
         RowBox[{"grid", ",", " ", "\n", "\t", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "o", "}"}], ",", " ", 
            RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"wfns", "=", "\n", "\t\t\t\t", 
        RowBox[{
        "ChemDVRDefaultWavefunctionSelection", "[", "\n", "\t\t\t\t\t", 
         RowBox[{"wfs", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "o", "}"}], ",", " ", 
            RowBox[{
            "Options", "[", "ChemDVRDefaultWavefunctionSelection", "]"}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"retE", "=", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<ReturnEnergies\>\"", "]"}]}]}]}], 
      "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"retE", ",", " ", "\n", "\t\t\t", 
       RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "->", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"coreGridPoints", ",", "#2"}], "}"}], "]"}]}], "&"}], 
         ",", "\n", "\t", "\t\t\t", "wfns"}], "\n", "\t", "\t\t\t", "]"}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"coreGridPoints", ",", "#"}], "}"}], "]"}], "&"}], ",", 
         " ", 
         RowBox[{"wfns", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699200604333715*^9, 3.69920065436515*^9}, 
   3.699228071685454*^9, {3.69922862652458*^9, 3.6992286278518543`*^9}, {
   3.699233954784215*^9, 3.699233956109192*^9}, 3.699236026259272*^9, {
   3.700004723815454*^9, 3.70000472381841*^9}, {3.716044877331047*^9, 
   3.716044936875804*^9}, {3.716045053593833*^9, 3.716045172219779*^9}, {
   3.718047639055377*^9, 3.718047655840177*^9}, {3.718047709916031*^9, 
   3.7180479700932703`*^9}, {3.718048198088847*^9, 3.718048466505234*^9}, {
   3.718051665945264*^9, 3.718051688387249*^9}, {3.718051737884864*^9, 
   3.718051768952922*^9}, {3.7180525864505997`*^9, 3.7180526208329144`*^9}, {
   3.718052779782776*^9, 3.7180528043212233`*^9}, {3.718052914616517*^9, 
   3.718052926775758*^9}, {3.727731469092826*^9, 3.727731495123589*^9}, {
   3.727731592997616*^9, 3.727731618160809*^9}, {3.731432943673647*^9, 
   3.731432972372878*^9}, {3.731872660923718*^9, 
   3.731872791253338*^9}},ExpressionUUID->"1b8834c0-af8e-44c6-b0e0-\
afd4db9417fe"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultInterpolatingWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.724795314403144*^9},ExpressionUUID->"b99cdb95-38ed-4f0a-9b3a-\
c17c238a369c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultInterpolatingWavefunctions", "]"}], 
   "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRDefaultGridWavefunctions"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultInterpolatingWavefunctions", "[", "\n", "\t", 
    RowBox[{"grid_", ",", "\n", "\t", "wfs_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"coreGridPoints", "=", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRDefaultGridPointList", "[", 
         RowBox[{"grid", ",", " ", "\n", "\t", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", " ", 
            RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"wfns", "=", "\n", "\t\t\t\t", 
        RowBox[{
        "ChemDVRDefaultWavefunctionSelection", "[", "\n", "\t\t\t\t\t", 
         RowBox[{"wfs", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", " ", 
            RowBox[{
            "Options", "[", "ChemDVRDefaultWavefunctionSelection", "]"}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"retE", "=", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<ReturnEnergies\>\"", "]"}]}]}]}], 
      "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"retE", ",", " ", "\n", "\t\t\t", 
       RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "->", 
           RowBox[{"Interpolation", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{"Flatten", "@*", "List"}], ",", 
              RowBox[{"{", 
               RowBox[{"coreGridPoints", ",", "#2"}], "}"}]}], "]"}]}]}], 
          "&"}], ",", "\n", "\t", "\t\t\t", "wfns"}], "\n", "\t", "\t\t\t", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Interpolation", "@", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{"Flatten", "@*", "List"}], ",", 
             RowBox[{"{", 
              RowBox[{"coreGridPoints", ",", " ", "#"}], "}"}]}], "]"}]}], 
          "&"}], ",", " ", 
         RowBox[{"wfns", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699200604333715*^9, 3.69920065436515*^9}, 
   3.699228071685454*^9, {3.69922862652458*^9, 3.6992286278518543`*^9}, {
   3.699233954784215*^9, 3.699233956109192*^9}, 3.699236026259272*^9, {
   3.700004723815454*^9, 3.70000472381841*^9}, {3.716044877331047*^9, 
   3.716044936875804*^9}, {3.716045053593833*^9, 3.716045172219779*^9}, {
   3.718047639055377*^9, 3.718047655840177*^9}, {3.718047709916031*^9, 
   3.7180479700932703`*^9}, {3.718048198088847*^9, 3.718048466505234*^9}, {
   3.7180516944346323`*^9, 3.718051727382465*^9}, 3.718051775275611*^9, {
   3.7180525956771917`*^9, 3.718052620816251*^9}, {3.718052666389908*^9, 
   3.718052668757285*^9}, {3.718052772612356*^9, 3.718052775410055*^9}, {
   3.718052810171159*^9, 3.71805283240731*^9}, {3.718052877749238*^9, 
   3.718052921497954*^9}, {3.7247953337026653`*^9, 3.7247953356293297`*^9}, {
   3.724796428692997*^9, 3.724796430859977*^9}, {3.724797345433033*^9, 
   3.724797358381427*^9}, {3.731432982747671*^9, 3.731433003962302*^9}, {
   3.731872805691423*^9, 3.731872843032605*^9}, 3.731944374564184*^9, {
   3.731944462728465*^9, 
   3.731944463204837*^9}},ExpressionUUID->"823c7587-f077-4505-8f21-\
c0295b5a1a2f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultExpectationValues\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.724795314403144*^9, {3.731432771580377*^9, 3.731432776098288*^9}, 
   3.731704203049971*^9},ExpressionUUID->"b6f3cabd-26b8-4466-b805-\
bfbc55ef99c4"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]chemDVRCalcExpectationValue\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7318728678577757`*^9, 
  3.7318728701394367`*^9}},ExpressionUUID->"c536089d-153c-4c96-9286-\
63f0955d43bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRCalcExpectationValueVec", "[", 
    RowBox[{"func_", ",", " ", "grid_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"func", "@", "grid"}], ",", " ", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Except", "[", 
       RowBox[{"_List", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "\[Equal]", 
           RowBox[{"Length", "@", "grid"}]}], "&"}], ")"}]}], "]"}], ":>", 
      RowBox[{"Map", "[", 
       RowBox[{"func", ",", " ", "grid"}], "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRCalcExpectationValueVec", "[", 
    RowBox[{"func_", ",", " ", "grid_", ",", " ", "wf_"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"func", "[", 
      RowBox[{"grid", ",", " ", "wf"}], "]"}], ",", " ", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Except", "[", 
       RowBox[{"_List", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "\[Equal]", 
           RowBox[{"Length", "@", "grid"}]}], "&"}], ")"}]}], "]"}], ":>", 
      "\n", "\t\t\t", 
      RowBox[{"MapThread", "[", 
       RowBox[{"func", ",", " ", 
        RowBox[{"{", 
         RowBox[{"grid", ",", " ", "wf"}], "}"}]}], "]"}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRCalcExpectationValue", "[", 
    RowBox[{
    "func_Function", ",", " ", "grid_", ",", " ", "wfL_", ",", " ", "wfR_"}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"wfL", ".", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"func", ",", " ", 
        RowBox[{"Slot", "[", "2", "]"}], ",", " ", "\[Infinity]"}], "]"}], 
      ",", "\n", "\t", "\t\t", 
      RowBox[{"chemDVRCalcExpectationValueVec", "[", 
       RowBox[{"func", ",", " ", "grid", ",", " ", "wfR"}], "]"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"wfR", "*", 
       RowBox[{"chemDVRCalcExpectationValueVec", "[", 
        RowBox[{"func", ",", " ", "grid"}], "]"}]}]}], "\n", "\t", "\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"chemDVRCalcExpectationValue", "[", 
   RowBox[{
    RowBox[{"func", ":", 
     RowBox[{"Except", "[", "_Function", "]"}]}], ",", " ", "grid_", ",", " ",
     "wfL_", ",", " ", "wfR_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"wfL", ".", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"chemDVRCalcExpectationValueVec", "[", 
      RowBox[{"func", ",", " ", "grid", ",", " ", "wfR"}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"{", "__func", "}"}], "\[RuleDelayed]", 
      RowBox[{"wfR", "*", 
       RowBox[{"chemDVRCalcExpectationValueVec", "[", 
        RowBox[{"func", ",", " ", "grid"}], "]"}]}]}]}], "\n", "\t\t", 
    "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.73178329800983*^9, 3.731783619418199*^9}, 
   3.7317836927178297`*^9, {3.7317845388331614`*^9, 3.7317845617074957`*^9}, 
   3.731784627734921*^9},ExpressionUUID->"15b97a3e-a413-4958-8246-\
a2b89a5e1116"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultExpectationValues\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7317846940930567`*^9},ExpressionUUID->"c0e0f6d5-c534-49f1-909f-\
6a49285a657b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultExpectationValues", "]"}], "=", 
   "\n", "\t", 
   RowBox[{"Options", "@", "ChemDVRDefaultGridWavefunctions"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultExpectationValues", "[", "\n", "\t", 
    RowBox[{
    "grid_", ",", "\n", "\t", "wfs_", ",", "\n", "\t", "evs_", ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"coreGridPoints", "=", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRDefaultGridPointList", "[", 
         RowBox[{"grid", ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", " ", 
            RowBox[{"Options", "[", "ChemDVRDefaultGridPointList", "]"}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"exfns", "=", "\n", "\t\t\t\t", 
        RowBox[{"Flatten", "@", 
         RowBox[{"List", "@", "evs"}]}]}], ",", "\n", "\t\t\t", 
       RowBox[{"wfns", "=", "\n", "\t\t\t\t", 
        RowBox[{
        "ChemDVRDefaultWavefunctionSelection", "[", "\n", "\t\t\t\t\t", 
         RowBox[{"wfs", ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", " ", 
            RowBox[{
            "Options", "[", "ChemDVRDefaultWavefunctionSelection", "]"}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"retE", "=", "\n", "\t\t\t\t", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<ReturnEnergies\>\"", "]"}]}]}]}], 
      "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"retE", ",", " ", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"wfns", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "#"}], "&"}], ",", "\n",
         "\t\t\t", "Identity"}], "\n", "\t\t\t", "]"}], "@", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"ListQ", "@", "evs"}]}], ",", " ", 
         RowBox[{"Map", "[", "First", "]"}], ",", " ", "Identity"}], "]"}], 
       "@", "\n", "\t\t\t\t\t", 
       RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"chemDVRCalcExpectationValue", "[", 
             RowBox[{
             "#", ",", " ", "coreGridPoints", ",", " ", "wf", ",", " ", 
              "wf"}], "]"}], "&"}], ",", "\n", "\t\t\t\t\t\t\t", "exfns"}], 
          "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"wf", ",", " ", 
           RowBox[{"wfns", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\n", "\t\t\t\t\t\t", 
        "]"}]}]}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699200604333715*^9, 3.69920065436515*^9}, 
   3.699228071685454*^9, {3.69922862652458*^9, 3.6992286278518543`*^9}, {
   3.699233954784215*^9, 3.699233956109192*^9}, 3.699236026259272*^9, {
   3.700004723815454*^9, 3.70000472381841*^9}, {3.716044877331047*^9, 
   3.716044936875804*^9}, {3.716045053593833*^9, 3.716045172219779*^9}, {
   3.718047639055377*^9, 3.718047655840177*^9}, {3.718047709916031*^9, 
   3.7180479700932703`*^9}, {3.718048198088847*^9, 3.718048466505234*^9}, {
   3.7180516944346323`*^9, 3.718051727382465*^9}, 3.718051775275611*^9, {
   3.7180525956771917`*^9, 3.718052620816251*^9}, {3.718052666389908*^9, 
   3.718052668757285*^9}, {3.718052772612356*^9, 3.718052775410055*^9}, {
   3.718052810171159*^9, 3.71805283240731*^9}, {3.718052877749238*^9, 
   3.718052921497954*^9}, {3.7247953337026653`*^9, 3.7247953356293297`*^9}, {
   3.724796428692997*^9, 3.724796430859977*^9}, {3.724797345433033*^9, 
   3.724797358381427*^9}, {3.7314327814324503`*^9, 3.731432839903988*^9}, {
   3.731433019694282*^9, 3.731433059495531*^9}, {3.7314331900058403`*^9, 
   3.7314333578052387`*^9}, {3.7317042043542833`*^9, 3.731704275789824*^9}, {
   3.7317043137888947`*^9, 3.731704332096822*^9}, {3.731704510952454*^9, 
   3.731704521292954*^9}, {3.731704644961685*^9, 3.731704795090238*^9}, {
   3.731704983510269*^9, 3.731705106848145*^9}, {3.731705219343458*^9, 
   3.7317053255123243`*^9}, {3.731705369575761*^9, 3.731705417019446*^9}, {
   3.7317056216809387`*^9, 3.731705624135168*^9}, {3.7317830860161343`*^9, 
   3.7317830896621113`*^9}, {3.731783209200379*^9, 3.731783254790324*^9}, {
   3.731783698870543*^9, 3.7317837239231787`*^9}, {3.731784193086774*^9, 
   3.731784245629405*^9}, {3.731784735423513*^9, 3.731784736438078*^9}, {
   3.731791957209268*^9, 3.7317921329591303`*^9}, {3.731872852098283*^9, 
   3.731872856628716*^9}},ExpressionUUID->"6c0b1d1a-eef8-4382-aea1-\
d35fe2e03deb"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultOperatorMatrix\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.731784687520719*^9, 
  3.731791503246063*^9},ExpressionUUID->"335cc5ba-099b-4e88-bb3e-\
9f6243c89af3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultOperatorMatrix", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Options", "@", "ChemDVRDefaultExpectationValues"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultOperatorMatrix", "[", "\n", "\t", 
    RowBox[{
    "grid_", ",", "\n", "\t", "wfs_", ",", "\n", "\t", "evs_", ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"coreGridPoints", "=", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRDefaultGridPointList", "[", 
         RowBox[{"grid", ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", " ", 
            RowBox[{"Options", "[", "ChemDVRDefaultGridPointList", "]"}]}], 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"exfns", "=", "\n", "\t\t\t\t", 
        RowBox[{"Flatten", "@", 
         RowBox[{"List", "@", "evs"}]}]}], ",", "\n", "\t\t\t", "sels", ",", 
       "\n", "\t\t\t", "wfns", ",", "\n", "\t\t\t", 
       RowBox[{"retE", "=", "\n", "\t\t\t\t", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<ReturnEnergies\>\"", "]"}]}]}]}], 
      "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sels", ",", " ", "exfns"}], "}"}], "=", "\n", "\t\t\t", 
       RowBox[{"Transpose", "@", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"exfns", ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sel_", "\[Rule]", "fn_"}], ")"}], "\[RuleDelayed]", 
             "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"sel", ",", " ", "fn"}], "}"}]}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"fn_", ":>", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "OptionValue", "[", "\"\<WavefunctionSelection\>\"", "]"}], 
               ",", " ", "fn"}], "}"}]}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", 
          "\n", "\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t", "]"}]}]}], ";", "\n",
       "\t\t", 
      RowBox[{"wfns", "=", "\n", "\t\t\t", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ChemDVRDefaultWavefunctionSelection", "[", 
           RowBox[{"wfs", ",", " ", "#"}], "]"}], "&"}], ",", " ", "sels"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "sels"}], "\[Equal]", "1"}], ",", " ", 
         "First", ",", " ", "Identity"}], "]"}], "@", "\n", "\t\t\t", 
       RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Block", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mx", ",", " ", 
              RowBox[{"eSet", "=", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
              RowBox[{"wfSet", "=", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
              RowBox[{"exFs", "=", "#2"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"retE", ",", " ", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"Array", "[", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"eSet", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
                    RowBox[{"eSet", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}]}], "}"}], "&"}], ",", 
                   "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "@", "wfSet"}], ",", " ", 
                    RowBox[{"Length", "@", "wfSet"}]}], "}"}]}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}], "\[Rule]", "#"}], "&"}], ",", "\n",
                "\t\t\t\t\t\t", "Identity"}], "\n", "\t\t\t\t\t\t", "]"}], 
             "@", "\n", "\t\t\t\t\t", 
             RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"i", "=", "i"}], ",", " ", 
                   RowBox[{"j", "=", "j"}], ",", " ", 
                   RowBox[{"gr", "=", "coreGridPoints"}], ",", " ", 
                   RowBox[{"wfL", "=", 
                    RowBox[{"wfSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
                   RowBox[{"wfR", "=", 
                    RowBox[{"wfSet", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"Not", "@", 
                    RowBox[{"ListQ", "@", "exFs"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "chemDVRCalcExpectationValue", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "exFs", ",", " ", "\n", "\t\t\t\t\t\t\t\t\t", "gr", ",", 
                    " ", "\n", "\t\t\t\t\t\t\t\t\t", "wfL", ",", " ", "wfR"}],
                     "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "chemDVRCalcExpectationValue", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "#", ",", " ", "\n", "\t\t\t\t\t\t\t\t\t\t", "gr", ",", 
                    " ", "\n", "\t\t\t\t\t\t\t\t\t\t", "wfL", ",", " ", 
                    "wfR"}], "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", "exFs"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                  "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", 
                 RowBox[{"Length", "@", "wfSet"}]}], "}"}], ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", 
                 RowBox[{"Length", "@", "wfSet"}]}], "}"}]}], "\n", 
              "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}], "&"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{"wfns", ",", "\n", "\t\t\t\t\t", "exfns"}], "\n", 
          "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.731784255927072*^9, 3.7317843715402184`*^9}, {
   3.731784405350422*^9, 3.731784515569873*^9}, {3.7317847436488934`*^9, 
   3.731784744853985*^9}, {3.731785279243309*^9, 3.7317856013532257`*^9}, {
   3.7317873655100317`*^9, 3.731787371984212*^9}, {3.731787563094707*^9, 
   3.731787572634945*^9}, {3.731787616067062*^9, 3.7317876950301857`*^9}, {
   3.731787801916931*^9, 3.7317878524199047`*^9}, {3.731787917967128*^9, 
   3.731787924138693*^9}, {3.73178795814585*^9, 3.731787997677902*^9}, {
   3.7317880420182123`*^9, 3.731788078372403*^9}, {3.7317881149948606`*^9, 
   3.731788116432918*^9}, {3.731788157728228*^9, 3.731788224741891*^9}, {
   3.731790923270014*^9, 3.7317909370188437`*^9}, {3.731791281853166*^9, 
   3.731791283600025*^9}, {3.731791316252041*^9, 3.731791364569499*^9}, {
   3.7317914496582727`*^9, 3.731791449666258*^9}, 3.73179156363304*^9, {
   3.7317921582771463`*^9, 3.731792170856181*^9}, 3.731792595160637*^9, {
   3.731792706147279*^9, 3.731792724095911*^9}, {3.731792776570943*^9, 
   3.731792836793589*^9}, {3.731792943480287*^9, 
   3.7317929462707243`*^9}},ExpressionUUID->"84d84d4c-129e-4a3d-aaf0-\
674ec173c5c0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlot\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731972776573567*^9, 
  3.73197278676336*^9}},ExpressionUUID->"e33ee154-821b-4345-9835-\
41d1f372c741"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]$ChemDVRDefaultPlotOptions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, 
   3.731974990776958*^9},ExpressionUUID->"d17c39c5-cf9c-4eae-b5dd-\
7c2c57202849"],

Cell[BoxData[
 RowBox[{"$ChemDVRDefaultPlotOptions", "=", "\n", "\t", 
  RowBox[{
   RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
   RowBox[{"Join", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"\"\<ZeroAxis\>\"", "\[Rule]", "True"}], ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<ShowEnergy\>\"", "\[Rule]", "True"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "True"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<PotentialStyle\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<WavefunctionSelection\>\"", "\[Rule]", 
        RowBox[{"Scaled", "[", ".25", "]"}]}], ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<WavefunctionClipping\>\"", "\[Rule]", 
        RowBox[{"10", "^", 
         RowBox[{"-", "5"}]}]}], ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<WavefunctionScaling\>\"", "\[Rule]", "Automatic"}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<WavefunctionShifting\>\"", "\[Rule]", "Automatic"}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<WavefunctionRescaling\>\"", "\[Rule]", "None"}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<PotentialRescaling\>\"", "\[Rule]", "None"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<PlotProbabilityDensity\>\"", "\[Rule]", "False"}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<PlotDisplayMode\>\"", "->", "Manipulate"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<PlotFunction\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<CoordinateTransformation\>\"", "\[Rule]", "None"}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"\"\<PlotListStyle\>\"", "\[Rule]", "Automatic"}]}], "\n", 
      "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"Options", "[", "ChemDVRDefaultGridPointList", "]"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{"Options", "[", "ChemDVRDefaultWavefunctionSelection", "]"}]}], 
    "\n", "\t\t\t", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.731974669994624*^9, 3.7319747939564953`*^9}, {
   3.731974845390223*^9, 3.731974847154872*^9}, {3.731974909746955*^9, 
   3.73197491943198*^9}, {3.731974951435658*^9, 3.73197496443538*^9}, {
   3.7319770328509417`*^9, 3.731977035932681*^9}, {3.731978710515493*^9, 
   3.7319787236821833`*^9}, {3.731979255732642*^9, 3.73197926501219*^9}, {
   3.7319851705874453`*^9, 3.731985179944048*^9}, {3.732008992534459*^9, 
   3.732009007397603*^9}, {3.732067687073717*^9, 3.732067695171032*^9}, {
   3.732069174214336*^9, 3.732069177005423*^9}, 3.7320692070397863`*^9, {
   3.732069641645046*^9, 3.7320696576082363`*^9}, 3.7320705183780403`*^9, {
   3.732073163770446*^9, 3.732073165226499*^9}, {3.732074134991974*^9, 
   3.732074148253376*^9}, {3.732301642038023*^9, 3.732301661577847*^9}, {
   3.732425950650519*^9, 3.732425960587916*^9}, {3.7325130025989847`*^9, 
   3.732513011079768*^9}, {3.732513143405149*^9, 
   3.732513144202325*^9}},ExpressionUUID->"bde93d56-18d9-400b-8200-\
0dd72757672b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotOptionValue\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319805871724443`*^9, 
  3.731980592691134*^9}},ExpressionUUID->"561d1d8e-8b37-4839-ae29-\
b7fe0610ce37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotOptionValue", "[", 
   RowBox[{"opName_", ",", " ", "ops_", ",", " ", 
    RowBox[{"f_:", "None"}], ",", " ", 
    RowBox[{"default_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Lookup", "[", 
   RowBox[{
    RowBox[{"Flatten", "@", 
     RowBox[{"{", "ops", "}"}]}], ",", " ", "opName", ",", "\n", "\t\t", 
    RowBox[{"Lookup", "[", 
     RowBox[{
      RowBox[{"Options", "[", "f", "]"}], ",", " ", "opName", ",", " ", "\n", 
      "\t\t\t", 
      RowBox[{"Lookup", "[", 
       RowBox[{
       "$ChemDVRDefaultPlotOptions", ",", " ", "opName", ",", " ", 
        "default"}], "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.731980601340897*^9, 
  3.731980648228436*^9}},ExpressionUUID->"e4f7783b-6b94-4db5-be07-\
5f347434a283"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotGetShiftedScaledWavefunctions\
\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
  3.731974990776958*^9, 3.731975036013287*^9}, {3.731975161853141*^9, 
  3.73197516216982*^9}, {3.7319753068550377`*^9, 3.731975309741583*^9}, {
  3.732067706388941*^9, 3.732067715234645*^9}, {3.732069226658903*^9, 
  3.732069227520052*^9}},ExpressionUUID->"0d276a28-4d71-4512-9283-\
663629453970"],

Cell[BoxData[
 RowBox[{"ChemDVRDefaultPlotGetShiftedScaledWavefunctions", "//", 
  "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.732072735812634*^9, 
  3.732072736593836*^9}},ExpressionUUID->"9fb4e0ea-c588-49f3-b47a-\
54ee1187b2b5"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]chemDVRDefaultPlotWavefunctionRescalingFunction\
\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7320731973956213`*^9, 
  3.732073208174921*^9}},ExpressionUUID->"ae0b4dae-2cfd-406b-885b-\
90e433c0c744"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chemDVRDefaultPlotWavefunctionRescalingFunction", "//", "Clear"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionRescalingFunction", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"min_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"max_", "?", "NumericQ"}]}], "}"}], ",", "\n", "\t", "_"}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"Rescale", "[", 
      RowBox[{"#", ",", " ", 
       RowBox[{"MinMax", "[", "#", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"min", ",", " ", "max"}], "}"}]}], "]"}], "&"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionRescalingFunction", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"mm", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", " ", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ",", "\n", "\t", 
     "pot_"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pmm", "=", 
       RowBox[{"mm", "*", 
        RowBox[{"MinMax", "[", "pot", "]"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{"Rescale", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"MinMax", "[", "#", "]"}], ",", " ", "pmm"}], "]"}], "&"}], 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionRescalingFunction", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"n_", "?", "NumericQ"}], "]"}], ",", "\n", "\t", "pot_"}], "\n",
     "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{
   "chemDVRDefaultPlotWavefunctionRescalingFunction", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "n"}], "}"}], "]"}], ",", "\n", "\t\t", "pot"}],
     "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "chemDVRDefaultPlotWavefunctionRescalingFunction", "[", "___", "]"}], ":=", 
  "\n", "\t", "Identity"}]}], "CodeInput",
 CellChangeTimes->{{3.7320732155470247`*^9, 3.732073418020398*^9}, {
  3.732074275096808*^9, 3.732074276392169*^9}, {3.7320757465397882`*^9, 
  3.732075758953006*^9}},ExpressionUUID->"ee95d9cc-bcee-4d95-b24a-\
af51617e01a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]chemDVRDefaultPlotWavefunctionShift\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7320731973956213`*^9, 3.732073208174921*^9}, {
  3.7325133848448887`*^9, 
  3.732513391507206*^9}},ExpressionUUID->"31dda4b0-1d5a-44ec-8ce5-\
c93ae29a1c14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", 
    RowBox[{
     RowBox[{"n_", "?", "NumericQ"}], ",", " ", "pot_"}], "]"}], ":=", "\n", 
   "\t", "n"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", 
    RowBox[{
     RowBox[{"Scaled", "[", 
      RowBox[{"s_", "?", "NumericQ"}], "]"}], ",", " ", "pot_"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"s", "*", 
    RowBox[{"Max", "@", 
     RowBox[{"Abs", "[", 
      RowBox[{"pot", "-", 
       RowBox[{"Min", "[", "pot", "]"}]}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Offset", "[", 
      RowBox[{
       RowBox[{"base_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"shift_", "?", "NumericQ"}]}], "]"}], ",", " ", "pot_"}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"base", "+", "shift"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Offset", "[", 
      RowBox[{
       RowBox[{"base_", "?", "NumericQ"}], ",", " ", 
       RowBox[{"Scaled", "[", 
        RowBox[{"shift_", "?", "NumericQ"}], "]"}]}], "]"}], ",", " ", 
     "pot_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Offset", "[", 
      RowBox[{"base", ",", " ", 
       RowBox[{"shift", "*", 
        RowBox[{"Max", "@", 
         RowBox[{"Abs", "[", 
          RowBox[{"pot", "-", 
           RowBox[{"Min", "[", "pot", "]"}]}], "]"}]}]}]}], "]"}], ",", "\n", 
     "\t\t", "pot"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Offset", "[", 
      RowBox[{
       RowBox[{"Scaled", "[", 
        RowBox[{"base_", "?", "NumericQ"}], "]"}], ",", " ", "e_"}], "]"}], 
     ",", " ", "pot_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Offset", "[", 
      RowBox[{
       RowBox[{"Rescale", "[", 
        RowBox[{"base", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"MinMax", "[", "pot", "]"}]}], "]"}], ",", " ", "e"}], "]"}],
      ",", "\n", "\t\t", "pot"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", 
    RowBox[{"e_", ",", " ", "pot_"}], "]"}], ":=", "\n", "\t", "e"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.732513396578218*^9, 3.732513521870913*^9}, {
  3.732513576587142*^9, 3.7325136446141787`*^9}, {3.7325136791534843`*^9, 
  3.732513725279379*^9}},ExpressionUUID->"8e80de30-5a72-4e74-8b83-\
afab2332aee9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotGetShiftedScaledWavefunctions\
\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7320732134244843`*^9},ExpressionUUID->"6685cf81-fbd5-4f44-b0b3-\
e52181576640"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotGetShiftedScaledWavefunctions", "[", "\n", "\t", 
    RowBox[{
    "psi_", ",", "\n", "\t", "pot_", ",", "\n", "\t", "shift_", ",", "\n", 
     "\t", "scale_", ",", "\n", "\t", "rescale_"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"rescalePsi", "=", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"chemDVRDefaultPlotWavefunctionRescalingFunction", "[", 
          RowBox[{"rescale", ",", " ", "pot"}], "]"}], "[", "psi", "]"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"shiftFactor", "=", "\n", "\t\t\t\t", 
        RowBox[{"chemDVRDefaultPlotWavefunctionShift", "[", 
         RowBox[{"shift", ",", " ", "pot"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"scaleFactor", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"scale", ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"s_", "?", "NumericQ"}], "]"}], ":>", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"s", "*", 
            RowBox[{"Max", "@", 
             RowBox[{"Abs", "[", 
              RowBox[{"pot", "-", 
               RowBox[{"Min", "[", "pot", "]"}]}], "]"}]}]}]}]}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumericQ", "@", "shiftFactor"}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericQ", "@", "scaleFactor"}], "&&", 
             RowBox[{"NumericQ", "@", "shift"}]}], ",", " ", "\n", "\t\t\t\t", 
            RowBox[{"scaleFactor", "*", "shiftFactor"}], ",", " ", "\n", 
            "\t\t\t\t", "shiftFactor"}], "\n", "\t\t\t\t", "]"}], "+", "#"}], 
         ",", "\n", "\t\t\t", "#"}], "\n", "\t\t\t", "]"}], "&"}], "@", "\n", 
      "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "@", "scaleFactor"}], ",", " ", "\n", "\t\t\t\t", 
        
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"maxPsi", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "psi", "]"}], "]"}]}], "}"}], ",", "\n", 
          "\t", "\t\t\t\t", 
          RowBox[{"MapThread", "[", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"minPsi", "=", 
                 RowBox[{"First", "@", 
                  RowBox[{"MinimalBy", "[", 
                   RowBox[{"#", ",", " ", "Abs"}], "]"}]}]}], "}"}], ",", 
               "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"#2", "-", 
                RowBox[{"scaleFactor", "*", 
                 RowBox[{"minPsi", "/", "maxPsi"}]}]}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"rescalePsi", ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"scaleFactor", "*", 
               RowBox[{"rescalePsi", "/", "maxPsi"}]}]}], "\n", 
             "\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "rescalePsi"}], "\n", 
       "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7319753158991213`*^9, 3.731975381668454*^9}, {
   3.7319754275661907`*^9, 3.731975525446801*^9}, {3.731975599364622*^9, 
   3.731975614194309*^9}, {3.7319756580329247`*^9, 3.731975670876319*^9}, {
   3.7319757490862617`*^9, 3.731975806627816*^9}, {3.731975972295629*^9, 
   3.731976002090044*^9}, {3.7320078773652067`*^9, 3.73200787870739*^9}, {
   3.732067721547896*^9, 3.732067750759117*^9}, {3.732068917728118*^9, 
   3.73206894285503*^9}, {3.732069014599963*^9, 3.7320690178661413`*^9}, {
   3.732069243645565*^9, 3.732069274015998*^9}, {3.732069361761937*^9, 
   3.732069467133586*^9}, {3.7320695003366747`*^9, 3.732069508246449*^9}, {
   3.732069555256875*^9, 3.732069555775448*^9}, {3.732072422302246*^9, 
   3.732072422939434*^9}, {3.7320726688094273`*^9, 3.7320727226707277`*^9}, {
   3.73207283919807*^9, 3.732072936639964*^9}, {3.732073154452011*^9, 
   3.732073157032423*^9}, 3.732073189560671*^9, {3.732073506697407*^9, 
   3.732073534130484*^9}, {3.732073930113454*^9, 3.732074071329692*^9}, {
   3.7320742403303957`*^9, 3.7320742578851557`*^9}, {3.732074591757354*^9, 
   3.732074628139017*^9}, {3.7320746891771*^9, 3.732074801284964*^9}, {
   3.732074838570671*^9, 3.7320748580000687`*^9}, {3.732074912060575*^9, 
   3.7320751897783422`*^9}, {3.732075235056118*^9, 3.7320752405149527`*^9}, {
   3.7320757185770807`*^9, 3.732075720106614*^9}, 3.732075772394341*^9, {
   3.732513227231529*^9, 3.732513274434421*^9}, {3.732513306160062*^9, 
   3.73251331584391*^9}, {3.732513360259551*^9, 3.732513369655795*^9}, {
   3.732513552872191*^9, 
   3.7325135625066032`*^9}},ExpressionUUID->"c38a5e21-d2fc-4b4e-a667-\
4a78411989ed"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotGetClippedWavefunctionSpec\[RightFloor]\
", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
  3.731974990776958*^9, 3.731975036013287*^9}, {3.731975161853141*^9, 
  3.73197516216982*^9}, {3.7319753068550377`*^9, 3.731975309741583*^9}, {
  3.732067706388941*^9, 3.732067709080542*^9}, {3.732067819851852*^9, 
  3.732067832678422*^9}, {3.732067870542392*^9, 
  3.73206787139764*^9}},ExpressionUUID->"c3f94854-c12c-4830-aa66-\
5eec089ae83d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRDefaultPlotGetClippedWavefunctionSpec", "[", "\n", "\t", 
     RowBox[{"psi_", ",", "\n", "\t", 
      RowBox[{"clip_", "?", "NumericQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", ">=", "clip"}], "&"}], ",", " ", 
      RowBox[{"Abs", "[", "psi", "]"}]}], "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotGetClippedWavefunctionSpec", "[", "\n", "\t", 
    RowBox[{"psi_", ",", "\n", "\t", 
     RowBox[{"Scaled", "[", 
      RowBox[{"clip_", "?", "NumericQ"}], "]"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{
   "ChemDVRDefaultPlotGetClippedWavefunctionSpec", "[", "\n", "\t\t", 
    RowBox[{"psi", ",", "\n", "\t\t", 
     RowBox[{"Rescale", "[", 
      RowBox[{"clip", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"MinMax", "[", 
        RowBox[{"Abs", "@", "psi"}], "]"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotGetClippedWavefunctionSpec", "[", "\n", "\t", 
    RowBox[{"psi_", ",", "\n", "\t", "_"}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"True", ",", " ", 
     RowBox[{"Length", "@", "psi"}]}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7319753158991213`*^9, 3.731975381668454*^9}, {
  3.7319754275661907`*^9, 3.731975525446801*^9}, {3.731975599364622*^9, 
  3.731975614194309*^9}, {3.7319756580329247`*^9, 3.731975670876319*^9}, {
  3.7319757490862617`*^9, 3.731975806627816*^9}, {3.731975972295629*^9, 
  3.731976002090044*^9}, {3.7320078773652067`*^9, 3.73200787870739*^9}, {
  3.73206783934133*^9, 
  3.732068038084807*^9}},ExpressionUUID->"c1406ee7-8200-42a2-ade8-\
4eda6ba7ee4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotGetPlotPoints\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
  3.731974990776958*^9, 3.731975036013287*^9}, {3.731975161853141*^9, 
  3.73197516216982*^9}, {3.731975297974719*^9, 
  3.7319752993734283`*^9}},ExpressionUUID->"0666a1bb-eb01-4664-ad49-\
fd84e78f0e17"],

Cell["\[LeftCeiling]Handle zero axes appropriately\[RightFloor]", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.732301728510193*^9, 
  3.7323017347564917`*^9}},ExpressionUUID->"f2b58cde-c620-4a43-94a1-\
50e6649e57fa"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Imp\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731976534007821*^9, 
  3.731976537189883*^9}},ExpressionUUID->"180b6a6b-f4a5-4e32-beb1-\
66a0bd285c6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultPlotGetPlotPoints", "[", "\n", "\t", 
    RowBox[{
    "sel_", ",", "\n", "\t", "pot_", ",", "\n", "\t", "grid_", ",", "\n", 
     "\t", "scaling_", ",", "\n", "\t", "shifting_", ",", "\n", "\t", 
     "rescaling_", ",", "\n", "\t", 
     RowBox[{"clip", ":", 
      RowBox[{"_Scaled", "|", 
       RowBox[{"_", "?", "NumericQ"}]}]}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"scaledPsi", "=", "\n", "\t\t\t\t", 
       RowBox[{
       "ChemDVRDefaultPlotGetShiftedScaledWavefunctions", "[", "\n", 
        "\t\t\t\t\t", 
        RowBox[{
        "sel", ",", " ", "pot", ",", " ", "\n", "\t\t\t\t\t", "shifting", ",",
          " ", "scaling", ",", " ", "rescaling"}], "\n", "\t\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"MapThread", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{"pspec", "=", 
            RowBox[{"ChemDVRDefaultPlotGetClippedWavefunctionSpec", "[", 
             RowBox[{"#", ",", " ", "clip"}], "]"}]}], "\n", "\t\t\t\t\t", 
           "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Flatten", "@*", "List"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Pick", "[", 
               RowBox[{"grid", ",", " ", "pspec"}], "]"}], ",", " ", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Pick", "[", 
               RowBox[{"#2", ",", " ", "pspec"}], "]"}]}], "\n", "\t", "\t", 
             "\t", "\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"sel", ",", "\n", "\t\t\t\t", "scaledPsi"}], "\n", "\t\t\t\t",
         "}"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"iChemDVRDefaultPlotGetPlotPoints", "[", "\n", "\t", 
   RowBox[{
   "sel_", ",", "\n", "\t", "pot_", ",", "\n", "\t", "grid_", ",", "\n", "\t",
     "scaling_", ",", "\n", "\t", "shifting_", ",", "\n", "\t", "rescaling_", 
    ",", "\n", "\t", 
    RowBox[{"clip", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "NumericQ"}], "]"}]}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"scaledPsi", "=", "\n", "\t\t\t\t", 
      RowBox[{
      "ChemDVRDefaultPlotGetShiftedScaledWavefunctions", "[", "\n", 
       "\t\t\t\t\t", 
       RowBox[{
       "sel", ",", " ", "pot", ",", " ", "\n", "\t\t\t\t\t", "shifting", ",", 
        " ", "scaling", ",", " ", "rescaling"}], "\n", "\t\t\t\t\t", "]"}]}], 
     "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"Map", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{"Flatten", "@*", "List"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"grid", ",", " ", "#"}], "}"}]}], "]"}], "&"}], ",", "\n", 
      "\t\t\t", "scaledPsi"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.731975043712563*^9, 3.731975164713146*^9}, {
  3.731975290698099*^9, 3.731975303885252*^9}, {3.731975888360268*^9, 
  3.731975894163847*^9}, {3.731975929173182*^9, 3.731975965011765*^9}, {
  3.731976012624704*^9, 3.731976201022738*^9}, {3.7319763472017727`*^9, 
  3.731976386109108*^9}, {3.731976483291893*^9, 3.731976493169201*^9}, {
  3.731976762354782*^9, 3.731976774867663*^9}, {3.731987028719762*^9, 
  3.7319870481716957`*^9}, {3.732005531892686*^9, 3.732005543975174*^9}, {
  3.732068054481349*^9, 3.73206818317844*^9}, {3.7320695262208633`*^9, 
  3.732069542761732*^9}, {3.7320725167063837`*^9, 3.732072526651388*^9}, {
  3.732074159763014*^9, 
  3.732074177544674*^9}},ExpressionUUID->"bb6e9ed4-4055-4ccc-b079-\
26316cdff1ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]potResc\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732070260312495*^9},ExpressionUUID->"9e836724-c7be-4809-9039-\
163b9ff22670"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "chemDVRDefaultPlotPotentialRescalingFunction", "[", "potResc_", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{"potResc", ",", " ", "\n", "\t\t", 
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", " ", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"Function", "@", 
        RowBox[{"Rescale", "[", 
         RowBox[{"#", ",", " ", 
          RowBox[{"MinMax", "[", "#", "]"}], ",", " ", "potResc"}], "]"}]}]}],
       ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Scaled", "[", 
        RowBox[{"s", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", " ", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ":>", "\n", 
       "\t\t\t\t", 
       RowBox[{"Function", "@", "\n", "\t\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mm", "=", 
            RowBox[{"MinMax", "[", "#", "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t\t", 
          RowBox[{"Rescale", "[", 
           RowBox[{"#", ",", " ", "mm", ",", " ", 
            RowBox[{"s", "*", "mm"}]}], "]"}]}], "\n", "\t\t\t\t\t\t", 
         "]"}]}]}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Offset", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"off", ":", 
          RowBox[{"_", "?", "NumericQ"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"scl", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", " ", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "\n", "\t\t\t\t", 
        "]"}], "\[RuleDelayed]", "\n", "\t\t\t\t", 
       RowBox[{"Function", "[", "\n", "\t\t\t\t\t", 
        RowBox[{"off", "+", 
         RowBox[{"Rescale", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"MinMax", "[", "#", "]"}], ",", " ", "scl"}], "]"}]}], 
        "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Offset", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"off", ":", 
          RowBox[{"_", "?", "NumericQ"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Scaled", "[", 
          RowBox[{"scl", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", " ", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], "\n", 
        "\t\t\t\t", "]"}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"Function", "@", "\n", "\t\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mm", "=", 
            RowBox[{"MinMax", "[", "#", "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t\t", 
          RowBox[{"off", "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"scl", "\[Equal]", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "1"}], "}"}]}], ",", " ", "#", ",", " ", 
             RowBox[{"Rescale", "[", 
              RowBox[{"#", ",", " ", "mm", ",", " ", 
               RowBox[{"scl", "*", "mm"}]}], "]"}]}], "]"}]}]}], "\n", 
         "\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Offset", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Scaled", "[", 
          RowBox[{"off", ":", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"scl", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", " ", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "\n", "\t\t\t\t", 
        "]"}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"Function", "@", "\n", "\t\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mm", "=", 
            RowBox[{"MinMax", "[", "#", "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"off", "*", 
             RowBox[{"First", "[", "mm", "]"}]}], ")"}], "+", 
           RowBox[{"Rescale", "[", 
            RowBox[{"#", ",", " ", "mm", ",", " ", 
             RowBox[{"scl", "*", "mm"}]}], "]"}]}]}], "\n", "\t\t\t\t\t\t", 
         "]"}]}]}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Offset", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Scaled", "[", 
          RowBox[{"off", ":", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Scaled", "[", 
          RowBox[{"scl", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", " ", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], "\n", 
        "\t\t\t\t", "]"}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"Function", "@", "\n", "\t\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mm", "=", 
            RowBox[{"MinMax", "[", "#", "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"off", "*", 
             RowBox[{"First", "[", "mm", "]"}]}], ")"}], "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"scl", "\[Equal]", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "1"}], "}"}]}], ",", " ", "#", ",", " ", 
             RowBox[{"Rescale", "[", 
              RowBox[{"#", ",", " ", "mm", ",", " ", 
               RowBox[{"scl", "*", "mm"}]}], "]"}]}], "]"}]}]}], "\n", 
         "\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t", 
      RowBox[{"_", "->", "Identity"}]}], "\n", "\t\t\t", "}"}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.732070262149901*^9, 3.732070284372353*^9}, {
   3.7320705248527308`*^9, 3.732070611366336*^9}, {3.732070661724907*^9, 
   3.732070707757444*^9}, {3.732070748601069*^9, 3.732070785101755*^9}, 
   3.732070854602179*^9},ExpressionUUID->"e6e35b0a-6fd8-47eb-bb21-\
6f9f97fc5b0b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Main\[RightFloor]", "CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731976530053987*^9, 
  3.731976530469944*^9}},ExpressionUUID->"6e272033-118c-4e73-9582-\
a48bab604a4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotGetPlotPoints", "]"}], "=", 
   "\n", "\t", "$ChemDVRDefaultPlotOptions"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotGetPlotPoints", "[", "\n", "\t", 
   RowBox[{
   "gridpoints_", ",", "\n", "\t", "psi_", ",", "\n", "\t", "pot_", ",", "\n",
     "\t", "showPot_", ",", "\n", "\t", "showEng_", ",", "\n", "\t", 
    "transf_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"scaling", "=", "\n", "\t\t\t\t", 
       RowBox[{"OptionValue", "[", "\"\<WavefunctionScaling\>\"", "]"}]}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"rescaling", "=", "\n", "\t\t\t\t", 
       RowBox[{"OptionValue", "[", "\"\<WavefunctionRescaling\>\"", "]"}]}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"clipping", "=", "\n", "\t\t\t\t", 
       RowBox[{"OptionValue", "[", "\"\<WavefunctionClipping\>\"", "]"}]}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"shift", "=", "\n", "\t\t\t\t", 
       RowBox[{"OptionValue", "[", "\"\<WavefunctionShifting\>\"", "]"}]}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"potResc", "=", "\n", "\t\t\t\t", 
       RowBox[{"OptionValue", "[", "\"\<PotentialRescaling\>\"", "]"}]}], ",",
       "\n", "\t\t\t", 
      RowBox[{"wfnsel", "=", "\n", "\t\t\t\t", 
       RowBox[{"ChemDVRDefaultWavefunctionSelection", "[", "\n", "\t\t\t\t\t", 
        RowBox[{"psi", ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", " ", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Options", "@", "ChemDVRDefaultWavefunctionSelection"}]}], 
          "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"sqr", "=", "\n", "\t\t\t\t", 
       RowBox[{"TrueQ", "[", "\"\<PlotProbabilityDensity\>\"", "]"}]}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"gps", "=", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"transf", "===", "None"}], ",", " ", "\n", "\t\t\t\t\t", 
         "gridpoints", ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"transf", ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"chart_Rule", ":>", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Function", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"Evaluate", "@", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                RowBox[{"CoordinateTransform", "[", 
                 RowBox[{"chart", ",", " ", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"Slot", "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"gridpoints", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
               "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}],
            ",", "\n", "\t\t\t\t\t\t", "gridpoints"}], "\n", "\t\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
      RowBox[{"za", "=", "\n", "\t\t\t\t\t", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ZeroAxis\>\"", "]"}]}]}]}], "\n", 
     "\t\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "@", "showEng"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"wfnsel", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t\t", "None"}], 
       "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"iChemDVRDefaultPlotGetPlotPoints", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"sqr", ",", " ", 
          RowBox[{
           RowBox[{"wfnsel", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], ",", " ", 
          RowBox[{"wfnsel", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"showPot", ",", " ", "pot", ",", " ", 
          RowBox[{"{", "1", "}"}]}], "]"}], ",", "\n", "\t\t\t\t", "gps", ",",
         "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"scaling", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Automatic", "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rescaling", "=!=", "None"}], ",", " ", "None", ",", " ", 
             RowBox[{"Scaled", "[", ".5", "]"}]}], "]"}]}]}], "\n", 
         "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"shift", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Automatic", "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rescaling", "=!=", "None"}], ",", " ", "None", ",", " ", 
             RowBox[{"Offset", "[", 
              RowBox[{
               RowBox[{"Scaled", "[", "0", "]"}], ",", " ", "0"}], "]"}]}], 
            "]"}]}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
        "rescaling", ",", "\n", "\t\t\t\t", "clipping"}], "\n", "\t\t\t\t", 
       "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "@", "showPot"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Flatten", "@*", "List"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{"gps", ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
             "chemDVRDefaultPlotPotentialRescalingFunction", "[", "potResc", 
              "]"}], "@", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Normal", "@", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pot", "//", "MatrixQ"}], ",", "\n", "\t", "\t", "\t",
                 "\t\t\t\t\t\t", 
                RowBox[{"Diagonal", "@", "pot"}], ",", "\n", "\t", "\t", "\t",
                 "\t\t\t\t\t\t", "pot"}], "\n", "\t", "\t", "\t", 
               "\t\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], 
         "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "None"}], "\n", 
       "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.731975043712563*^9, 3.731975164713146*^9}, {
   3.731975290698099*^9, 3.731975303885252*^9}, {3.731975888360268*^9, 
   3.731975894163847*^9}, {3.731975929173182*^9, 3.731975965011765*^9}, {
   3.731976012624704*^9, 3.731976201022738*^9}, {3.7319763472017727`*^9, 
   3.7319763917279167`*^9}, {3.7319764312271423`*^9, 3.731976509142563*^9}, {
   3.731976553849824*^9, 3.731976592374621*^9}, {3.731976698401648*^9, 
   3.731976735286376*^9}, {3.731976789088656*^9, 3.731976840512615*^9}, {
   3.731976873048338*^9, 3.731976886388308*^9}, {3.731976921453442*^9, 
   3.731976962503902*^9}, {3.731977077697682*^9, 3.7319771076191053`*^9}, {
   3.7319771816640587`*^9, 3.731977202039607*^9}, {3.731985087916271*^9, 
   3.731985156225062*^9}, {3.731986518832107*^9, 3.731986521612543*^9}, {
   3.731986574236658*^9, 3.731986577624832*^9}, {3.7319866263084927`*^9, 
   3.731986769623126*^9}, {3.7319869621490507`*^9, 3.731987008464435*^9}, {
   3.731987278601145*^9, 3.731987311904161*^9}, {3.732005563119495*^9, 
   3.732005572046534*^9}, {3.732006240527577*^9, 3.732006243905435*^9}, {
   3.7320063641120443`*^9, 3.732006365928886*^9}, {3.732006411105062*^9, 
   3.7320064348533916`*^9}, 3.7320064807072906`*^9, {3.7320677732095327`*^9, 
   3.7320677917223177`*^9}, {3.7320682004252234`*^9, 
   3.7320682030286703`*^9}, {3.7320696800216427`*^9, 3.732069689795082*^9}, {
   3.73206974114045*^9, 3.7320698596618557`*^9}, {3.73206990227015*^9, 
   3.732069906632983*^9}, {3.732069996906901*^9, 3.732070249788521*^9}, {
   3.732070838080887*^9, 3.7320708429230013`*^9}, {3.732071030772806*^9, 
   3.732071031548468*^9}, 3.73207259853039*^9, {3.732072786518133*^9, 
   3.732072824883953*^9}, {3.7320741909637613`*^9, 3.732074217232868*^9}, {
   3.732301677784473*^9, 3.732301689299107*^9}, {3.7325130631205673`*^9, 
   3.732513078316722*^9}, {3.732513157682069*^9, 3.732513165257862*^9}, {
   3.73251384942909*^9, 
   3.7325138580255203`*^9}},ExpressionUUID->"fec8a5d3-9873-4484-8975-\
7c17d737ba87"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotPotential\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
  3.731977253210536*^9, 3.731977257928163*^9}, {3.7319772908739033`*^9, 
  3.731977292760194*^9}},ExpressionUUID->"e6c77380-cec7-4aea-bb30-\
f1bd97df988d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotPotential", "[", "\n", "\t", 
    RowBox[{"func_Symbol", ",", " ", "pot_", ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"potStyle", "=", "\n", "\t\t\t\t", 
       RowBox[{"ChemDVRDefaultPlotOptionValue", "[", "\n", "\t\t\t\t\t", 
        RowBox[{"\"\<PotentialStyle\>\"", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", "func", ",", 
         "\n", "\t\t\t\t\t", "Automatic"}], "\n", "\t\t\t\t\t", "]"}]}], "\n",
       "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"func", "[", "\n", "\t\t\t", 
      RowBox[{"pot", ",", "\n", "\t\t\t", 
       RowBox[{"Evaluate", "@", "\n", "\t\t\t\t", 
        RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"PlotStyle", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{"potStyle", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Automatic", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"pot", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "===", "2"}], ",", "\n",
                     "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"Dashed", ",", " ", "Gray"}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"Opacity", "[", ".5", "]"}], ",", " ", "Gray"}], 
                    "]"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", "\t",
                  "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
               "\t\t\t\t\t\t", "ops"}], "\n", "\t", "\t\t\t\t\t\t", "}"}]}], 
            ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"Options", "@", "func"}]}], "\n", "\t\t\t\t\t\t", "]"}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"Except", "[", "PolarAxes", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "due", " ", "to", " ", "poor", " ", "implementation", " ", 
              "this", " ", "will", " ", "layer"}], "..."}], " ", "*)"}], 
           "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7319772944998407`*^9, 3.7319773460763407`*^9}, {
   3.73197740271532*^9, 3.731977499019153*^9}, {3.7320056516347218`*^9, 
   3.7320056860223217`*^9}, {3.732006012162664*^9, 3.7320062070857563`*^9}, {
   3.732006261483379*^9, 3.732006265453184*^9}, {3.732007124700583*^9, 
   3.7320071918834476`*^9}, {3.732425488557456*^9, 3.73242548870755*^9}, {
   3.732425572419064*^9, 3.732425613290864*^9}, 3.732425653266344*^9, {
   3.732425711073029*^9, 3.73242571238422*^9}, {3.732425760654337*^9, 
   3.732425793828751*^9}},ExpressionUUID->"163083ff-8b69-4ff5-a783-\
5b8ee6e01cdb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotResolvePlotStyle\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.732008439525531*^9, 
  3.732008452513975*^9}},ExpressionUUID->"e7db39d5-a4bb-4d02-92de-\
7612b3f7423e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotResolvePlotStyle", "[", "\n", "\t", 
   RowBox[{"func_", ",", " ", "solNum_", ",", " ", "ops_"}], "\n", "\t", 
   "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"cf", "=", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"s", ":", 
            RowBox[{"_String", "|", 
             RowBox[{"{", 
              RowBox[{"_String", ",", " ", "__"}], "}"}]}]}], 
           "\[RuleDelayed]", 
           RowBox[{"ColorData", "[", "s", "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
          
          RowBox[{"Automatic", ":>", 
           RowBox[{"ColorData", "[", "97", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
         "}"}], "\n", "\t\t\t\t\t", "]"}], "@", "\n", "\t\t\t\t\t", 
       RowBox[{"ChemDVRDefaultPlotOptionValue", "[", "\n", "\t\t\t\t\t\t", 
        RowBox[{"\"\<PlotListStyle\>\"", ",", " ", "\n", "\t\t\t\t\t\t", 
         RowBox[{"{", "ops", "}"}], ",", " ", "\n", "\t\t\t\t\t\t", "func", 
         ",", " ", "\n", "\t\t\t\t\t\t", 
         RowBox[{"Lookup", "[", "\n", "\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Charting`ResolvePlotTheme", "[", 
            RowBox[{"Automatic", ",", " ", "func"}], "]"}], ",", "\n", 
           "\t\t\t\t\t\t\t", "\"\<DefaultColorFunction\>\"", ",", "\n", 
           "\t\t\t\t\t\t\t", 
           RowBox[{"Lookup", "[", "\n", "\t\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Lookup", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Charting`ResolvePlotTheme", "[", 
                RowBox[{"Automatic", ",", " ", "func"}], "]"}], ",", " ", 
               "\n", "\t\t\t\t\t\t\t\t\t", "Method", ",", "\n", 
               "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"\"\<DefaultPlotStyle\>\"", "\[Rule]", "Automatic"}], 
                "}"}]}], "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
              "\t\t", "]"}], ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t", 
             "\t", "\t", "\"\<DefaultPlotStyle\>\"", ",", "\n", 
             "\t\t\t\t\t\t\t\t", "Automatic"}], "\n", "\t\t\t\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", 
        "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
    RowBox[{"With", "[", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t\t", 
       RowBox[{"ci", "=", "\n", "\t\t\t\t\t\t", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"cf", ",", " ", 
          RowBox[{"HoldPattern", "[", 
           RowBox[{"ColorDataFunction", "[", 
            RowBox[{"_", ",", " ", "\"\<Indexed\>\"", ",", " ", "__"}], "]"}],
            "]"}]}], "]"}]}], "\n", "\t", "\t\t\t\t", "}"}], ",", "\n", 
      "\t\t\t\t", 
      RowBox[{"Function", "[", "\n", "\t\t\t\t\t", 
       RowBox[{"Which", "[", "\n", "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"ListQ", "@", "cf"}], ",", "\n", "\t\t\t\t\t\t\t", 
         RowBox[{"cf", "[", 
          RowBox[{"[", 
           RowBox[{"Mod", "[", 
            RowBox[{"#", ",", " ", 
             RowBox[{"Length", "[", "cf", "]"}], ",", " ", "1"}], "]"}], 
           "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t", "ci", ",", "\n", 
         "\t\t\t\t\t\t\t", 
         RowBox[{"cf", "@", "#"}], ",", "\n", "\t\t\t\t\t\t", "True", ",", 
         "\n", "\t\t\t\t\t\t\t", 
         RowBox[{"cf", "@", 
          RowBox[{"Rescale", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "solNum"}], "}"}]}], "]"}]}]}], "\n", 
        "\t", "\t\t\t\t\t", "]"}], "\n", "\t", "\t\t\t\t", "]"}]}], "\n", 
     "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7320084361376333`*^9, 3.732008722278521*^9}, 
   3.732008904620514*^9, {3.732008939755988*^9, 3.732008939904943*^9}, {
   3.7320090119780684`*^9, 
   3.732009012621892*^9}},ExpressionUUID->"d4480b43-e76b-4286-b277-\
87ae79bb0611"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotManipulateSolutions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
  3.731977253210536*^9, 
  3.731977257928163*^9}},ExpressionUUID->"ee7ded1a-bcf0-49fb-ba25-\
b16a589ba77f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotManipulateSolutions", "[", "\n", "\t", 
   RowBox[{
   "func_Symbol", ",", " ", "energies_", ",", " ", "solns_", ",", " ", "pot_",
     ",", "\n", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", " ", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"potPlot", "=", "\n", "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pot", "=!=", "None"}], ",", " ", 
         RowBox[{"ChemDVRDefaultPlotPotential", "[", 
          RowBox[{"func", ",", " ", "pot", ",", " ", "ops"}], "]"}], ",", " ",
          "None"}], "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"ps", "=", "\n", "\t\t\t\t", 
       RowBox[{"ChemDVRDefaultPlotResolvePlotStyle", "[", 
        RowBox[{"func", ",", " ", 
         RowBox[{"Length", "@", "solns"}], ",", " ", 
         RowBox[{"{", "ops", "}"}]}], "]"}]}]}], "\n", "\t\t\t", "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"func", "[", 
         RowBox[{
          RowBox[{"solns", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Evaluate", "@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"ops", ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"PlotStyle", "->", "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"ps", "[", "i", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Options", "@", "func"}]}], "\n", "\t\t\t\t\t\t\t", 
            "]"}]}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_Graphics", "|", "_Graphics3D"}], "]"}], ":>", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"Failure", "[", 
            RowBox[{"\"\<DVR Viewer\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Evaluate", "[", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
              "\"\<Couldn't view solutions for plotting function ``\>\"", 
               "\n", "\t\t\t\t\t\t\t\t\t", "~~", "TemplateApply", "~~", "\n", 
               "\t\t\t\t\t\t\t\t", "func"}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"g", ":", 
            RowBox[{"_Graphics", "|", "_Graphics3D"}]}], ":>", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Function", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"energies", "=!=", "None"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"Legended", "[", 
                RowBox[{"#", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Placed", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<E\>\"", ",", " ", "i"}], "]"}], ",", 
                    "\"\<: \>\"", ",", " ", 
                    RowBox[{"energies", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "}"}]}], ",", "\n",
                    "\t\t\t\t\t\t\t\t\t\t", "After"}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t",
                 "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", "#"}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t\t\t\t", "]"}], "@", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"pot", "=!=", "None"}], ",", " ", 
              RowBox[{"Show", "[", 
               RowBox[{"g", ",", " ", "potPlot"}], "]"}], ",", " ", "g"}], 
             "]"}]}]}]}], "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", 
       "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "\"\<\[Psi]\>\""}], "}"}], ",",
         " ", "1", ",", " ", 
        RowBox[{"Length", "@", "solns"}], ",", " ", "1"}], "}"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.731977259458197*^9, 3.731977283368187*^9}, {
   3.731977528963332*^9, 3.7319778265004883`*^9}, {3.7319778713559437`*^9, 
   3.731977918483832*^9}, {3.732005727634452*^9, 3.732005815300078*^9}, {
   3.73200585498775*^9, 3.732005866481737*^9}, 3.732005959778843*^9, 
   3.732006268226769*^9, {3.7320080530154877`*^9, 3.7320081094864683`*^9}, {
   3.73200879735749*^9, 3.732008809020873*^9}, {3.732396759538148*^9, 
   3.732396769171781*^9}},ExpressionUUID->"17ba6b62-f30e-48a7-b74b-\
48cd13a9880a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotListSolutions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
  3.731977253210536*^9, 3.731977257928163*^9}, {3.73197793559619*^9, 
  3.731977936114458*^9}},ExpressionUUID->"5b94c5d4-8d0a-4185-a81a-\
c071c56b8532"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotListSolutions", "[", "\n", "\t", 
    RowBox[{
    "func_Symbol", ",", " ", "energies_", ",", " ", "solns_", ",", " ", 
     "pot_", ",", "\n", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", " ", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"potPlot", "=", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pot", "=!=", "None"}], ",", " ", 
          RowBox[{"ChemDVRDefaultPlotPotential", "[", 
           RowBox[{"func", ",", " ", "pot", ",", " ", "ops"}], "]"}], ",", 
          " ", "None"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"ps", "=", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRDefaultPlotResolvePlotStyle", "[", 
         RowBox[{"func", ",", " ", 
          RowBox[{"Length", "@", "solns"}], ",", " ", 
          RowBox[{"{", "ops", "}"}]}], "]"}]}]}], "\n", "\t\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"Table", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"func", "[", 
          RowBox[{
           RowBox[{"solns", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Evaluate", "@", "\n", "\t\t\t\t\t\t", 
            RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"ops", ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"PlotStyle", "->", 
                 RowBox[{"ps", "[", "i", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
               "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Options", "@", "func"}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Except", "[", 
             RowBox[{"_Graphics", "|", "_Graphics3D"}], "]"}], ":>", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"Failure", "[", 
             RowBox[{"\"\<DVR Viewer\>\"", ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
              "\"\<Couldn't view solutions for plotting function ``\>\"", "~~",
                "TemplateApply", "~~", "func"}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"g", ":", 
             RowBox[{"_Graphics", "|", "_Graphics3D"}]}], ":>", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Function", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"energies", "=!=", "None"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"Legended", "[", 
                 RowBox[{"#", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"Placed", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<E\>\"", ",", " ", "i"}], "]"}], ",", 
                    "\"\<: \>\"", ",", " ", 
                    RowBox[{"energies", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "}"}]}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t\t", "After"}], "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                "#"}], "\n", "\t\t\t\t\t\t\t\t", "]"}], "\n", 
              "\t\t\t\t\t\t\t", "]"}], "@", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pot", "=!=", "None"}], ",", " ", 
               RowBox[{"Show", "[", 
                RowBox[{"g", ",", " ", "potPlot"}], "]"}], ",", " ", "g"}], 
              "]"}]}]}]}], "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "@", "solns"}]}], "}"}]}], "\n", "\t\t\t", "]"}]}],
     "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731977259458197*^9, 3.731977283368187*^9}, {
   3.731977528963332*^9, 3.7319778265004883`*^9}, {3.7319778713559437`*^9, 
   3.7319779589794188`*^9}, {3.731978545796968*^9, 3.731978546472197*^9}, 
   3.732005826381093*^9, {3.7320058800867243`*^9, 3.732005887977277*^9}, 
   3.7320059527411013`*^9, 3.732006270284498*^9, 3.732006753159711*^9, {
   3.7320081493910713`*^9, 3.7320081859762297`*^9}, 3.7320084654526253`*^9, 
   3.732008511429366*^9, {3.732008743579713*^9, 
   3.732008785836897*^9}},ExpressionUUID->"cfe0763f-100e-489c-801e-\
b6105e3d2ba4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotShowSolutions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
  3.731977253210536*^9, 3.731977257928163*^9}, {3.73197793559619*^9, 
  3.731977936114458*^9}, {3.73197797453905*^9, 
  3.731977975209434*^9}},ExpressionUUID->"4649491e-3e50-4bb7-a281-\
63b4b7166f0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotShowSolutions", "[", "\n", "\t", 
   RowBox[{
   "func_Symbol", ",", " ", "energies_", ",", " ", "solns_", ",", " ", "pot_",
     ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"ps", "=", "\n", "\t\t\t\t", 
      RowBox[{"ChemDVRDefaultPlotResolvePlotStyle", "[", 
       RowBox[{"func", ",", " ", 
        RowBox[{"Length", "@", "solns"}], ",", " ", 
        RowBox[{"{", "ops", "}"}]}], "]"}]}], "\n", "\t\t\t", "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{"Show", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pot", "=!=", "None"}], ",", " ", "\n", "\t", "\t\t\t", 
        RowBox[{"ChemDVRDefaultPlotPotential", "[", 
         RowBox[{"func", ",", " ", "pot", ",", " ", "ops"}], "]"}], ",", " ", 
        "\n", "\t", "\t\t\t", 
        RowBox[{"{", "}"}]}], "\n", "\t", "\t\t\t", "]"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"MapIndexed", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"func", "[", 
            RowBox[{"#", ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"Evaluate", "@", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"ops", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"PlotStyle", "->", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"ps", "@", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\n", 
                 "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Options", "@", "func"}]}], "\n", "\t", 
               "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t\t\t", "]"}], 
           ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Except", "[", 
              RowBox[{"_Graphics", "|", "_Graphics3D"}], "]"}], ":>", "\n", 
             "\t", "\t\t\t\t\t\t", "Nothing"}], "\n", "\t", "\t\t\t\t\t", 
            "}"}]}], "\n", "\t", "\t\t\t\t", "]"}], "&"}], ",", "\n", "\t", 
        "\t\t\t", "solns"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.731977259458197*^9, 3.731977283368187*^9}, {
   3.731977528963332*^9, 3.7319778265004883`*^9}, {3.7319778713559437`*^9, 
   3.7319779994654217`*^9}, {3.731978524045891*^9, 3.73197860655107*^9}, 
   3.732006271731144*^9, {3.732007063999234*^9, 3.732007112147256*^9}, {
   3.7320072488138027`*^9, 3.732007423445397*^9}, {3.7320075495823708`*^9, 
   3.7320076982121763`*^9}, {3.732008825499819*^9, 
   3.7320088380192213`*^9}},ExpressionUUID->"66d05291-d6fe-4f91-b367-\
fe507c9bf85d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotSolutions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972837675275*^9}, {
   3.731977253210536*^9, 3.731977257928163*^9}, {3.73197793559619*^9, 
   3.731977936114458*^9}, {3.73197797453905*^9, 3.731977975209434*^9}, 
   3.731978676952999*^9},ExpressionUUID->"bc185738-6acb-40d4-9fd7-\
6078940f5d2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotSolutions", "[", "\n", "\t", 
    RowBox[{
    "func_Symbol", ",", " ", "energies_", ",", " ", "solns_", ",", " ", 
     "pot_", ",", "\n", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", " ", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Switch", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ChemDVRDefaultPlotOptionValue", "[", "\n", "\t\t\t", 
      RowBox[{"\"\<PlotDisplayMode\>\"", ",", "\n", "\t\t\t", 
       RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t", "func"}], "\n", 
      "\t\t\t", "]"}], ",", "\n", "\t\t", 
     RowBox[{"Manipulate", "|", "\"\<Manipulate\>\""}], ",", "\n", "\t\t\t", 
     RowBox[{"ChemDVRDefaultPlotManipulateSolutions", "[", "\n", "\t\t\t\t", 
      RowBox[{
      "func", ",", " ", "energies", ",", " ", "solns", ",", " ", "pot", ",", 
       " ", "\n", "\t\t\t\t", "ops"}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Show", "|", "\"\<Show\>\""}], ",", "\n", "\t\t\t", 
     RowBox[{"ChemDVRDefaultPlotShowSolutions", "[", "\n", "\t\t\t\t", 
      RowBox[{
      "func", ",", " ", "energies", ",", " ", "solns", ",", " ", "pot", ",", 
       " ", "\n", "\t\t\t\t", "ops"}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
     "\t\t", "_", ",", "\n", "\t\t\t", 
     RowBox[{"ChemDVRDefaultPlotListSolutions", "[", "\n", "\t\t\t\t", 
      RowBox[{
      "func", ",", " ", "energies", ",", " ", "solns", ",", " ", "pot", ",", 
       " ", "\n", "\t\t\t\t", "ops"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotSolutions", "[", "\n", "\t", 
   RowBox[{
   "func_", ",", " ", "energies_", ",", " ", "solns_", ",", " ", "pot_", ",", 
    "\n", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", " ", "]"}], ":=", "\n", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "plotFun", "}"}], ",", "\n", " \t", 
    RowBox[{
     RowBox[{
      RowBox[{"plotFun", "[", "e___", "]"}], ":=", 
      RowBox[{"func", "[", "e", "]"}]}], ";", "\n", " \t", 
     RowBox[{"ChemDVRDefaultPlotSolutions", "[", 
      RowBox[{
      "func", ",", " ", "energies", ",", " ", "solns", ",", " ", "pot", ",", 
       " ", "ops"}], "]"}]}]}], "\n", " \t", "]"}], " "}]}], "CodeInput",
 CellChangeTimes->{{3.731977259458197*^9, 3.731977283368187*^9}, {
   3.731977528963332*^9, 3.7319778265004883`*^9}, {3.7319778713559437`*^9, 
   3.7319779994654217`*^9}, {3.731978524045891*^9, 3.73197860655107*^9}, {
   3.731978683752214*^9, 3.731978758502657*^9}, {3.7319787920032473`*^9, 
   3.731978834865797*^9}, {3.731979340834741*^9, 3.731979393330659*^9}, {
   3.7319807234728928`*^9, 3.731980756395734*^9}, 
   3.732006725215293*^9},ExpressionUUID->"c354b9b3-b735-442f-af14-\
cfa291a9a240"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotBasic\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731980818104446*^9, 
  3.73198082607099*^9}},ExpressionUUID->"51c67646-69ed-460e-8819-\
395af15b57db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t", 
    RowBox[{
    "solutions_", ",", " ", "grid_", ",", " ", "potentialMatrix_", ",", " ", 
     "\n", "\t", "headFunc_Symbol", ",", " ", 
     RowBox[{"defaultFunc", ":", 
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"params", "=", "\n", "\t\t\t\t", 
       RowBox[{"ChemDVRDefaultPlotGetPlotPoints", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
        "grid", ",", "\n", "\t\t\t\t\t", "solutions", ",", " ", "\n", 
         "\t\t\t\t\t", "potentialMatrix", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"TrueQ", "@", "\n", "\t\t\t\t\t\t", 
          RowBox[{"ChemDVRDefaultPlotOptionValue", "[", 
           RowBox[{"\"\<ShowPotential\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
            "headFunc", ",", "\n", "\t\t\t\t\t\t\t", "False"}], "\n", 
           "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"TrueQ", "@", "\n", "\t\t\t\t\t\t", 
          RowBox[{"ChemDVRDefaultPlotOptionValue", "[", 
           RowBox[{"\"\<ShowEnergy\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"{", "ops", "}"}], ",", " ", "\n", "\t\t\t\t\t\t\t", 
            "headFunc", ",", "\n", "\t\t\t\t\t\t\t", "False"}], "\n", 
           "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"ChemDVRDefaultPlotOptionValue", "[", 
          RowBox[{
          "\"\<CoordinateTransformation\>\"", ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"{", "ops", "}"}], ",", " ", "\n", "\t\t\t\t\t\t", 
           "headFunc", ",", "\n", "\t\t\t\t\t\t", "None"}], "\n", 
          "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Options", "@", "ChemDVRDefaultPlotGetPlotPoints"}]}], 
          "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"ChemDVRDefaultPlotSolutions", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ChemDVRDefaultPlotOptionValue", "[", 
          RowBox[{"\"\<PlotFunction\>\"", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", "ops", "}"}], ",", " ", "\n", "\t\t\t\t\t", 
           "headFunc", ",", "\n", "\t\t\t\t\t", "False"}], "\n", "\t\t\t\t\t",
           "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Automatic", "\[Rule]", "defaultFunc"}]}], "\n", "\t\t\t\t", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"Sequence", "@@", "params"}], ",", "\n", "\t\t\t", "ops", ",", 
       "\n", "\t\t\t", 
       RowBox[{"PlotRange", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"Append", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{"Automatic", ",", " ", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"params", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", " ", "1", ",", " ", "1"}], "]"}], "]"}], 
              "]"}], "-", "1"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"MinMax", "@", 
           RowBox[{"params", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", " ", "All", ",", " ", "All", ",", " ", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "\n", "\t\t\t\t\t", 
         "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"PlotRangePadding", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"Append", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"ConstantArray", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Scaled", "[", ".05", "]"}], ",", 
              RowBox[{"Scaled", "[", ".05", "]"}]}], "}"}], ",", " ", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"params", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", " ", "1", ",", " ", "1"}], "]"}], "]"}], 
              "]"}], "-", "1"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", ".15", "]"}], ",", " ", 
            RowBox[{"Scaled", "[", ".15", "]"}]}], "}"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731980830208971*^9, 3.7319808954713717`*^9}, {
   3.731985706427507*^9, 3.731985736917324*^9}, {3.7319858648367033`*^9, 
   3.7319858653748093`*^9}, {3.732005340251356*^9, 3.732005380259553*^9}, {
   3.73200541656668*^9, 3.732005422132058*^9}, {3.732005596270982*^9, 
   3.732005600640148*^9}, 3.732006273697995*^9, {3.732006503521723*^9, 
   3.7320065328498583`*^9}, {3.732006834657583*^9, 3.732007019348566*^9}, {
   3.732007722370947*^9, 3.732007733744183*^9}, {3.7320079144477787`*^9, 
   3.732007944982697*^9}, {3.732007975861072*^9, 3.7320079957069674`*^9}, {
   3.732072136072945*^9, 
   3.732072223617484*^9}},ExpressionUUID->"5e012684-e279-4d44-b911-\
b4e8881a0376"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotCartesian1D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 
  3.731972837675275*^9}},ExpressionUUID->"d4f8d177-f7f2-4da6-bf19-\
b105eaa5708d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotCartesian1D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"AxesOrigin", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"PlotRange", "->", "Automatic"}]}], "\n", "\t\t\t", "}"}], ",",
      "\n", "\t\t", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"Options", "[", "ListLinePlot", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"Except", "[", 
        RowBox[{"AxesOrigin", "|", "PlotRange"}], "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotCartesian1D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotCartesian1D", ",", " ", "ListLinePlot", ",", 
    "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.707079133599949*^9, 3.707079165555623*^9}, {
   3.707079245500482*^9, 3.707079264996385*^9}, {3.707079435368559*^9, 
   3.707079461465197*^9}, {3.707079497021113*^9, 3.7070795551391993`*^9}, {
   3.707079614281602*^9, 3.70707962113295*^9}, {3.707079651941841*^9, 
   3.707079660821377*^9}, {3.70707973649951*^9, 3.707079741983705*^9}, {
   3.707079831675027*^9, 3.707079841565547*^9}, 3.707080175293795*^9, 
   3.707081124397023*^9, {3.70708116183797*^9, 3.707081180900281*^9}, {
   3.7070812352564774`*^9, 3.707081301439883*^9}, {3.7070813431527653`*^9, 
   3.707081378769888*^9}, {3.7070814646478252`*^9, 3.707081485289687*^9}, {
   3.7070815430080643`*^9, 3.707081606751402*^9}, {3.707081645885*^9, 
   3.707081668002983*^9}, {3.707081887309559*^9, 3.7070819335900087`*^9}, {
   3.7070821550594063`*^9, 3.707082203727014*^9}, {3.707082233986767*^9, 
   3.707082297709743*^9}, 3.7070823692314796`*^9, {3.707082524335957*^9, 
   3.707082535634412*^9}, 3.7070826022741337`*^9, {3.707249849136451*^9, 
   3.7072499231820707`*^9}, {3.707249995688854*^9, 3.707250024695369*^9}, {
   3.707505670928403*^9, 3.7075057007597637`*^9}, {3.7319745711763983`*^9, 
   3.731974589963378*^9}, {3.7319748160833473`*^9, 3.731974897912671*^9}, {
   3.7319749352135267`*^9, 3.731974967828711*^9}, {3.731975242688467*^9, 
   3.7319752728183413`*^9}, {3.731976221500863*^9, 3.731976223624001*^9}, {
   3.731976892778713*^9, 3.7319769088289423`*^9}, {3.731976975095969*^9, 
   3.731977072851667*^9}, {3.731977136337783*^9, 3.731977176884296*^9}, {
   3.731978657730508*^9, 3.731978658087182*^9}, {3.7319792217233562`*^9, 
   3.731979227923696*^9}, {3.731979511197679*^9, 3.731979528661531*^9}, {
   3.7319795827927847`*^9, 3.731979693400072*^9}, {3.73198065789436*^9, 
   3.731980711993986*^9}, {3.731980801284092*^9, 3.73198081419991*^9}, {
   3.731980904336831*^9, 3.7319809408394213`*^9}, {3.73200702978957*^9, 
   3.7320070344846992`*^9}},ExpressionUUID->"038f08e3-72d7-46ee-aea3-\
461dae64eeb5"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotCartesian2D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 
  3.7319728628107367`*^9}},ExpressionUUID->"61507ac3-6811-47f4-a1db-\
db17153544cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotCartesian2D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ListPlot3D", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotCartesian2D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotCartesian2D", ",", " ", "ListPlot3D", ",", 
    "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.707079133599949*^9, 3.707079165555623*^9}, {
   3.707079245500482*^9, 3.707079264996385*^9}, {3.707079435368559*^9, 
   3.707079461465197*^9}, {3.707079497021113*^9, 3.7070795551391993`*^9}, {
   3.707079614281602*^9, 3.70707962113295*^9}, {3.707079651941841*^9, 
   3.707079660821377*^9}, {3.70707973649951*^9, 3.707079741983705*^9}, {
   3.707079831675027*^9, 3.707079841565547*^9}, 3.707080175293795*^9, 
   3.707081124397023*^9, {3.70708116183797*^9, 3.707081180900281*^9}, {
   3.7070812352564774`*^9, 3.707081301439883*^9}, {3.7070813431527653`*^9, 
   3.707081378769888*^9}, {3.7070814646478252`*^9, 3.707081485289687*^9}, {
   3.7070815430080643`*^9, 3.707081606751402*^9}, {3.707081645885*^9, 
   3.707081668002983*^9}, {3.707081887309559*^9, 3.7070819335900087`*^9}, {
   3.7070821550594063`*^9, 3.707082203727014*^9}, {3.707082233986767*^9, 
   3.707082297709743*^9}, 3.7070823692314796`*^9, {3.707082524335957*^9, 
   3.707082535634412*^9}, 3.7070826022741337`*^9, {3.707249849136451*^9, 
   3.7072499231820707`*^9}, {3.707249995688854*^9, 3.707250024695369*^9}, {
   3.707505670928403*^9, 3.7075057007597637`*^9}, {3.7319745711763983`*^9, 
   3.731974589963378*^9}, {3.7319748160833473`*^9, 3.731974897912671*^9}, {
   3.7319749352135267`*^9, 3.731974967828711*^9}, {3.731975242688467*^9, 
   3.7319752728183413`*^9}, {3.731976221500863*^9, 3.731976223624001*^9}, {
   3.731976892778713*^9, 3.7319769088289423`*^9}, {3.731976975095969*^9, 
   3.731977072851667*^9}, {3.731977136337783*^9, 3.731977176884296*^9}, {
   3.731978657730508*^9, 3.731978658087182*^9}, {3.7319792217233562`*^9, 
   3.731979227923696*^9}, {3.731979511197679*^9, 3.731979528661531*^9}, {
   3.7319795827927847`*^9, 3.731979693400072*^9}, {3.73198065789436*^9, 
   3.731980711993986*^9}, {3.731980801284092*^9, 3.73198081419991*^9}, {
   3.731980904336831*^9, 3.7319809408394213`*^9}, {3.731985986480398*^9, 
   3.731986004579912*^9}},ExpressionUUID->"1edf79f7-dd9e-47da-a666-\
6d00b608a031"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotCartesian3D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.7319728628107367`*^9}, 
   3.731972922449617*^9},ExpressionUUID->"18b53df7-a45c-47d8-8261-\
ee441a3c023c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotCartesian3D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ContourPlot3D", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotCartesian3D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotCartesian3D", ",", " ", "ContourPlot3D", ",", 
    "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319860321049337`*^9, 
  3.731986046046645*^9}},ExpressionUUID->"42cf30e9-56a4-47cb-88f4-\
d3fdaae7ac4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotRing\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.732424422221841*^9, 
   3.7324244258912086`*^9}},ExpressionUUID->"1254e472-d24d-4f87-bcb5-\
9573743bdbc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotRing", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<WavefunctionShifting\>\"", "\[Rule]", "1"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"\"\<PotentialRescaling\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
         RowBox[{"Offset", "[", 
          RowBox[{
           RowBox[{"Scaled", "[", 
            RowBox[{"-", "1.5"}], "]"}], ",", " ", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1"}], "}"}], "]"}]}], "]"}]}], ",", "\n",
         "\t\t\t\t", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "\n", "\t\t\t\t", "}"}], ",",
       "\n", "\t\t\t", "$ChemDVRDefaultPlotOptions", ",", "\n", "\t", "\t\t", 
      
      RowBox[{"Options", "[", "ListPolarPlot", "]"}]}], "\n", "\t", "\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotRing", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotRing", ",", " ", "ListPolarPlot", ",", "\n", 
    "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<WavefunctionShifting\>\"", "\[Rule]", "1"}], ",", "\n", 
    "\t\t", 
    RowBox[{"\"\<PotentialRescaling\>\"", "\[Rule]", 
     RowBox[{"Offset", "[", 
      RowBox[{
       RowBox[{"Scaled", "[", 
        RowBox[{"-", "1.5"}], "]"}], ",", " ", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1"}], "}"}], "]"}]}], "]"}]}], ",", "\n", 
    "\t\t", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", "\n", "\t\t", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\n", "\t\t", 
    RowBox[{"PolarAxes", "\[Rule]", "True"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319860321049337`*^9, 3.731986046046645*^9}, {
   3.731986376875256*^9, 3.73198639505483*^9}, {3.732068235503559*^9, 
   3.732068294559266*^9}, {3.732068779661989*^9, 3.7320687889939337`*^9}, {
   3.732068877927959*^9, 3.732068878477798*^9}, {3.73207030038395*^9, 
   3.732070338449501*^9}, {3.732070419677133*^9, 3.7320704794198313`*^9}, {
   3.732070797676426*^9, 3.732070813087555*^9}, {3.732071002298841*^9, 
   3.7320710229536467`*^9}, {3.732071090662547*^9, 3.7320710935805197`*^9}, 
   3.732071241060174*^9, {3.7320712771530857`*^9, 3.7320712823700247`*^9}, {
   3.732424435449319*^9, 3.7324244366237803`*^9}, {3.732425414211877*^9, 
   3.732425417341784*^9}},ExpressionUUID->"4bba0af6-5ffe-4265-a964-\
edf672d40a46"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotRing3D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.73207134533421*^9, 3.732071345877569*^9}, {
   3.73207153700486*^9, 3.7320715384894943`*^9}, 
   3.73242443829062*^9},ExpressionUUID->"482963f4-dfec-4ba2-aa45-\
013274675f77"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRDefaultPlotRing3D\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.73240004580024*^9, 
  3.7324244396938763`*^9},ExpressionUUID->"98565325-86f9-48b2-8f1d-\
4d29a015446d"],

Cell[BoxData[{
 RowBox[{"iChemDVRDefaultPlotRing3D", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "iChemDVRDefaultPlotRing3D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Options", "[", "ListPointPlot3D", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultPlotRing3D", "[", 
    RowBox[{"pts_", ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ReplaceAll", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ListPointPlot3D", "[", 
      RowBox[{"pts", ",", "\n", "\t\t\t", 
       RowBox[{"Evaluate", "@", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", " ", 
          RowBox[{"Options", "[", "ListPointPlot3D", "]"}]}], "]"}]}]}], "\n",
       "\t\t\t", "]"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a___", ",", " ", "p_Point", ",", " ", "b___"}], "}"}], 
      "\[RuleDelayed]", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", " ", "a", ",", " ", 
        RowBox[{"Line", "@@", 
         RowBox[{"Insert", "[", 
          RowBox[{"p", ",", " ", 
           RowBox[{"p", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ",", " ", "b"}], 
       "}"}]}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.732071972639267*^9, 3.732072051978161*^9}, {
   3.732072107145105*^9, 3.732072107971518*^9}, 3.732072233629624*^9, {
   3.732074362072588*^9, 3.732074463773034*^9}, {3.732424440682488*^9, 
   3.732424441982951*^9}},ExpressionUUID->"b99eca6f-1725-4c1a-b540-\
31ab4ee8284a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotRing3D\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.732400051031472*^9, 
  3.732424442695181*^9},ExpressionUUID->"491f9885-b755-4bb4-968f-\
11fdea81b2a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotRing3D", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t\t", 
      RowBox[{"Options", "[", "ListPointPlot3D", "]"}]}], "\n", "\t\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotRing3D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotRing3D", ",", " ", "iChemDVRDefaultPlotRing3D",
     ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<CoordinateTransformation\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "#", "]"}], ",", " ", 
         RowBox[{"Sin", "[", "#", "]"}]}], "}"}], "&"}], ")"}]}]}], "\n", 
   "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319860321049337`*^9, 3.731986046046645*^9}, {
   3.731986376875256*^9, 3.73198639505483*^9}, {3.732068235503559*^9, 
   3.732068294559266*^9}, {3.732068779661989*^9, 3.7320687889939337`*^9}, {
   3.732068877927959*^9, 3.732068878477798*^9}, {3.73207030038395*^9, 
   3.732070338449501*^9}, {3.732070419677133*^9, 3.7320704794198313`*^9}, {
   3.732070797676426*^9, 3.732070813087555*^9}, {3.732071002298841*^9, 
   3.7320710229536467`*^9}, {3.732071090662547*^9, 3.7320710935805197`*^9}, 
   3.732071241060174*^9, {3.7320712771530857`*^9, 3.7320712823700247`*^9}, 
   3.732071522120802*^9, {3.732071576708695*^9, 3.732071648806293*^9}, {
   3.732071694737545*^9, 3.732071698832242*^9}, {3.732071729625893*^9, 
   3.732071784021433*^9}, {3.7324244432993526`*^9, 
   3.732424445907914*^9}},ExpressionUUID->"cd43c6a4-88f1-4eb6-bbc3-\
7b6f630e86c6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotPolar\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.731973014928238*^9, 3.731973040628045*^9}, {
   3.73197329286683*^9, 
   3.731973293937059*^9}},ExpressionUUID->"5fcc91ab-8aed-4e36-9d69-\
b99ddb78e353"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotPolar", "]"}], "=", "\n", "\t", 
   
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ListPlot3D", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotPolar", "[", "\n", "\t", 
    RowBox[{
    "solutions_", ",", "\n", "\t", "gridpoints_", ",", "\n", "\t", 
     "potentialMatrix_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
    RowBox[{
    "solutions", ",", " ", "gridpoints", ",", " ", "potentialMatrix", ",", 
     "\n", "\t\t", "ChemDVRDefaultPlotPolar", ",", " ", "ListPlot3D", ",", 
     "\n", "\t\t", "ops", ",", "\n", "\t\t", 
     RowBox[{"\"\<CoordinateTransformation\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"(", 
       RowBox[{"\"\<Polar\>\"", " ", "\[Rule]", " ", "\"\<Cartesian\>\""}], 
       ")"}]}], ",", "\n", "\t\t", 
     RowBox[{"RegionMemberFunction", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"RegionMember", "[", "\n", "\t\t\t\t", 
       RowBox[{"Annulus", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"MinMax", "[", 
          RowBox[{"gridpoints", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "]"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"MinMax", "[", 
          RowBox[{"gridpoints", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7319737717516336`*^9, 3.731973793875864*^9}, {
  3.731973875323844*^9, 3.731974127047364*^9}, {3.731974163861602*^9, 
  3.7319742530502577`*^9}, {3.731974461987932*^9, 3.731974547647347*^9}, {
  3.7319859420866632`*^9, 3.731985973953587*^9}, {3.7319864753225946`*^9, 
  3.7319865084858923`*^9}, {3.731986827968244*^9, 3.7319868384347057`*^9}, {
  3.7319873670187693`*^9, 
  3.731987389225945*^9}},ExpressionUUID->"05b38677-7ad5-4f43-9fec-\
f5c7e9e9ffde"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotShell\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.731973014928238*^9, 
   3.731973040628045*^9}},ExpressionUUID->"c2922bc6-91f1-4504-ae18-\
e56fe1a29630"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotShell", "]"}], "=", "\n", "\t", 
   
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{"\"\<WavefunctionShifting\>\"", "\[Rule]", "1"}], "\n", "\t", 
       "\t\t\t", "}"}], ",", "\n", "\t", "\t\t", "$ChemDVRDefaultPlotOptions",
       ",", "\n", "\t", "\t\t", 
      RowBox[{"Options", "[", "ListSurfacePlot3D", "]"}]}], "\n", "\t", 
     "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotShell", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "gridpoints_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "gridpoints", ",", " ", "potentialMatrix", ",", 
    "\n", "\t\t", "ChemDVRDefaultPlotShell", ",", " ", "ListSurfacePlot3D", 
    ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<CoordinateTransformation\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", " ", "\[Rule]", " ", "\"\<Cartesian\>\""}],
       ")"}]}], ",", "\n", "\t\t", 
    RowBox[{"\"\<WavefunctionShifting\>\"", "\[Rule]", "1"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319737717516336`*^9, 3.731973793875864*^9}, {
   3.731973875323844*^9, 3.731974127047364*^9}, {3.731974163861602*^9, 
   3.7319742530502577`*^9}, {3.731974461987932*^9, 3.731974547647347*^9}, {
   3.7319859420866632`*^9, 3.731985973953587*^9}, {3.7319864753225946`*^9, 
   3.7319865084858923`*^9}, {3.731986827968244*^9, 3.731986867439732*^9}, 
   3.7319869407175627`*^9, {3.731987242709889*^9, 3.731987252018392*^9}, {
   3.731987318286289*^9, 3.731987363281475*^9}, {3.731987416083716*^9, 
   3.731987418873311*^9}, {3.7320682994992123`*^9, 
   3.7320683388956423`*^9}},ExpressionUUID->"21fae153-d4af-4651-9c03-\
3d0b23ccd60c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotSpherical\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.731973014928238*^9, 3.731973040628045*^9}, 
   3.732067647810955*^9},ExpressionUUID->"5cabb60e-aa58-4c17-847a-\
4d84cfd245b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotSpherical", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ContourPlot3D", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotSpherical", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "gridpoints_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "gridpoints", ",", " ", "potentialMatrix", ",", 
    "\n", "\t\t", "ChemDVRDefaultPlotSpherical", ",", " ", "ContourPlot3D", 
    ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<CoordinateTransformation\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", " ", "\[Rule]", " ", "\"\<Cartesian\>\""}],
       ")"}]}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319737717516336`*^9, 3.731973793875864*^9}, {
   3.731973875323844*^9, 3.731974127047364*^9}, {3.731974163861602*^9, 
   3.7319742530502577`*^9}, {3.731974461987932*^9, 3.731974547647347*^9}, {
   3.7319859420866632`*^9, 3.731985973953587*^9}, {3.7319864753225946`*^9, 
   3.7319865084858923`*^9}, {3.731986827968244*^9, 3.731986867439732*^9}, 
   3.7319869407175627`*^9, {3.731987242709889*^9, 3.731987252018392*^9}, {
   3.731987318286289*^9, 3.731987363281475*^9}, {3.731987416083716*^9, 
   3.731987418873311*^9}, {3.73206834292705*^9, 
   3.732068357906218*^9}},ExpressionUUID->"8369eaa1-4bfa-4f3e-a470-\
f985f2522499"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotDensity1D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972886585318*^9}, 
   3.732399864479454*^9},ExpressionUUID->"dfc05781-17db-49dc-a7c7-\
3129cd3df1f7"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRDefaultPlotDensity1D\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.73240004580024*^9, 
  3.732400078299602*^9},ExpressionUUID->"0964a3b3-38fb-443f-a2fe-\
09c71aabeaaf"],

Cell[BoxData[{
 RowBox[{"iChemDVRDefaultPlotDensity1D", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "iChemDVRDefaultPlotDensity1D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Options", "[", "ListLinePlot", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultPlotDensity1D", "[", 
    RowBox[{"pts_", ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"gp", "=", "\n", "\t\t\t\t", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"wv", "=", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], "=!=", 
            "False"}], ",", "\n", "\t", "\t\t\t\t", "Rescale", ",", "\n", 
           "\t", "\t\t\t\t", "Identity"}], "\n", "\t", "\t\t\t\t", "]"}], "@", 
         RowBox[{"pts", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"cf", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"Quiet", "@", 
           RowBox[{"ColorData", "@", 
            RowBox[{"OptionValue", "[", "ColorFunction", "]"}]}]}], ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"HoldPattern", "[", 
              RowBox[{"ColorData", "[", "Automatic", "]"}], "]"}], ":>", "\n",
              "\t\t\t\t\t\t\t", 
             RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}]}], ",",
             "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"HoldPattern", "[", 
              RowBox[{"ColorData", "[", "f_", "]"}], "]"}], "\[RuleDelayed]", 
             "f"}]}], "\n", "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"ReplaceAll", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{"Thread", "@", 
          RowBox[{"{", 
           RowBox[{"gp", ",", " ", "1"}], "}"}]}], ",", "\n", "\t", "\t\t\t", 
         
         RowBox[{"Evaluate", "@", "\n", "\t", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ops", ",", " ", 
              RowBox[{"Axes", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"True", ",", " ", "False"}], "}"}]}]}], "}"}], ",", 
            " ", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Options", "[", "ListLinePlot", "]"}]}], "\n", 
           "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
       "\t", "\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a___", ",", " ", "l_Line", ",", " ", "b___"}], "}"}], 
        "\[RuleDelayed]", "\n", "\t", "\t\t\t", 
        RowBox[{"{", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", " ", "\n", "\t", 
          "\t\t\t\t", "a", ",", " ", "\n", "\t", "\t\t\t\t", 
          RowBox[{"Append", "[", 
           RowBox[{"l", ",", " ", "\n", "\t\t\t\t\t\t", 
            RowBox[{"VertexColors", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Map", "[", 
              RowBox[{"cf", ",", " ", "wv"}], "]"}]}]}], "\n", "\t\t\t\t\t\t",
            "]"}], ",", " ", "\n", "\t\t\t\t\t", "b"}], "\n", "\t\t\t\t\t", 
         "}"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.732071972639267*^9, 3.732072051978161*^9}, {
   3.732072107145105*^9, 3.732072107971518*^9}, 3.732072233629624*^9, {
   3.732074362072588*^9, 3.732074463773034*^9}, {3.732400084427476*^9, 
   3.73240038956573*^9}, {3.732424548626132*^9, 
   3.7324245540844727`*^9}},ExpressionUUID->"521dbda7-0b72-4d35-99ed-\
a228f72c2c3c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotDensity1D\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.732400051031472*^9, 
  3.7324004114637814`*^9},ExpressionUUID->"67f35118-cc78-4676-9fd1-\
fba5f79d932b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotDensity1D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t\t", 
      RowBox[{"Options", "[", "ListLinePlot", "]"}]}], "\n", "\t\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotDensity1D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotDensity1D", ",", " ", 
    "iChemDVRDefaultPlotDensity1D", ",", "\n", "\t\t", "ops", ",", "\n", 
    "\t\t", 
    RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319860321049337`*^9, 3.731986046046645*^9}, {
   3.731986376875256*^9, 3.73198639505483*^9}, {3.732068235503559*^9, 
   3.732068294559266*^9}, {3.732068779661989*^9, 3.7320687889939337`*^9}, {
   3.732068877927959*^9, 3.732068878477798*^9}, {3.73207030038395*^9, 
   3.732070338449501*^9}, {3.732070419677133*^9, 3.7320704794198313`*^9}, {
   3.732070797676426*^9, 3.732070813087555*^9}, {3.732071002298841*^9, 
   3.7320710229536467`*^9}, {3.732071090662547*^9, 3.7320710935805197`*^9}, 
   3.732071241060174*^9, {3.7320712771530857`*^9, 3.7320712823700247`*^9}, 
   3.732071522120802*^9, {3.732071576708695*^9, 3.732071648806293*^9}, {
   3.732071694737545*^9, 3.732071698832242*^9}, {3.732071729625893*^9, 
   3.732071784021433*^9}, {3.7324004125906343`*^9, 3.732400427842627*^9}, {
   3.732424667224853*^9, 
   3.732424669037363*^9}},ExpressionUUID->"ccfa27e8-f620-4f96-8ec9-\
6968d6bc5998"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotDensity2D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 
  3.731972886585318*^9}},ExpressionUUID->"4d052222-32f1-4ef7-9a47-\
f09db05fbbc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotDensity2D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ListDensityPlot", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotDensity2D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotDensity2D", ",", " ", "ListDensityPlot", ",", 
    "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.73198811151147*^9, 3.7319881253882017`*^9}, 
   3.732424676485958*^9},ExpressionUUID->"2ad7209f-9c52-4a5d-a470-\
d2ecf2ccce58"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotDensity3D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972886585318*^9}, 
   3.731988097560068*^9},ExpressionUUID->"0caf1c6e-64d0-48eb-997a-\
6559632be6dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotDensity3D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ListDensityPlot3D", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotDensity3D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotDensity3D", ",", " ", "ListDensityPlot3D", ",",
     "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.73198811151147*^9, 3.731988140203594*^9}, 
   3.732424681174699*^9},ExpressionUUID->"4068cf10-dac1-4c8a-8524-\
948b3f10944c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotDensityRing\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972886585318*^9}, 
   3.731988097560068*^9, {3.732400518623269*^9, 3.732400520109941*^9}, 
   3.7324244471335278`*^9},ExpressionUUID->"8c478ef3-0db7-43e3-a8f7-\
472dd30a8ed5"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRDefaultPlotDensityRing\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.73240004580024*^9, 3.732400078299602*^9, 
  3.73240052627839*^9, 
  3.732424448155167*^9},ExpressionUUID->"3967c5de-c9ce-4b43-b641-\
6e6cb95ef6ad"],

Cell[BoxData[{
 RowBox[{"iChemDVRDefaultPlotDensityRing", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "iChemDVRDefaultPlotDensityRing", "]"}], "=", "\n",
    "\t", 
   RowBox[{"Options", "[", "ListPolarPlot", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRDefaultPlotDensityRing", "[", 
    RowBox[{"pts_", ",", " ", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"gp", "=", "\n", "\t\t\t\t", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"wv", "=", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], "=!=", 
            "False"}], ",", "\n", "\t", "\t\t\t\t", "Rescale", ",", "\n", 
           "\t", "\t\t\t\t", "Identity"}], "\n", "\t", "\t\t\t\t", "]"}], "@", 
         RowBox[{"pts", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"cf", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"Quiet", "@", 
           RowBox[{"ColorData", "@", 
            RowBox[{"OptionValue", "[", "ColorFunction", "]"}]}]}], ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"HoldPattern", "[", 
              RowBox[{"ColorData", "[", "Automatic", "]"}], "]"}], ":>", "\n",
              "\t\t\t\t\t\t\t", 
             RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}]}], ",",
             "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"HoldPattern", "[", 
              RowBox[{"ColorData", "[", "f_", "]"}], "]"}], "\[RuleDelayed]", 
             "f"}]}], "\n", "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"ReplaceAll", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"ListPolarPlot", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Thread", "@", 
          RowBox[{"{", 
           RowBox[{"gp", ",", " ", ".5"}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Evaluate", "@", "\n", "\t", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Joined", "\[Rule]", "False"}], ",", "\n", 
              "\t\t\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", 
            " ", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Options", "[", "ListPolarPlot", "]"}]}], "\n", 
           "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
       "\t", "\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a___", ",", " ", "p_Point", ",", " ", "b___"}], "}"}], 
        "\[RuleDelayed]", "\n", "\t", "\t\t\t", 
        RowBox[{"{", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", " ", "\n", "\t", 
          "\t\t\t\t", "a", ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"TrueQ", "@", 
                RowBox[{"OptionValue", "[", "Joined", "]"}]}], ",", " ", 
               RowBox[{"Apply", "[", "Line", "]"}], ",", " ", "Identity"}], 
              "]"}], "@", "p"}], ",", " ", "\n", "\t\t\t\t\t\t", 
            RowBox[{"VertexColors", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Map", "[", 
              RowBox[{"cf", ",", " ", "wv"}], "]"}]}]}], "\n", "\t\t\t\t\t\t",
            "]"}], ",", " ", "\n", "\t\t\t\t\t", "b"}], "\n", "\t\t\t\t\t", 
         "}"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.732071972639267*^9, 3.732072051978161*^9}, {
   3.732072107145105*^9, 3.732072107971518*^9}, 3.732072233629624*^9, {
   3.732074362072588*^9, 3.732074463773034*^9}, {3.732400084427476*^9, 
   3.73240038956573*^9}, {3.732400561103118*^9, 3.7324005659755287`*^9}, {
   3.732400767618719*^9, 3.7324007957124*^9}, {3.732400833764308*^9, 
   3.7324008396850433`*^9}, {3.7324008752001667`*^9, 3.732400890421748*^9}, {
   3.732424449133161*^9, 3.732424450366061*^9}, {3.732424485320586*^9, 
   3.732424534300206*^9}, {3.7324249143676033`*^9, 3.732424993619357*^9}, {
   3.7324250476823378`*^9, 3.7324250624489737`*^9}, {3.732425102674398*^9, 
   3.732425103110619*^9}, {3.7324251751405983`*^9, 3.7324252064496727`*^9}, {
   3.732425280248184*^9, 
   3.732425355371295*^9}},ExpressionUUID->"f8c398a8-dc60-42ea-8b03-\
90397a7bf235"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotDensityRing\[RightFloor]", \
"CodeSubsubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.732400051031472*^9, 3.7324004114637814`*^9, 
  3.7324009874731903`*^9, 
  3.732424451061503*^9},ExpressionUUID->"c5faaaf5-2b6f-45df-8dee-\
3f8696b3779f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "iChemDVRDefaultPlotDensityRing", "]"}], "=", "\n",
    "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t\t", 
      RowBox[{"Options", "[", "ListPolarPlot", "]"}]}], "\n", "\t\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotDensityRing", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotDensityRing", ",", " ", 
    "iChemDVRDefaultPlotDensityRing", ",", "\n", "\t\t", "ops", ",", "\n", 
    "\t\t", 
    RowBox[{"PolarAxes", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", " ", "False"}], "}"}]}], ",", "\n", "\t\t", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", " ", "\n", "\t\t", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", "\n", "\t\t", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319860321049337`*^9, 3.731986046046645*^9}, {
   3.731986376875256*^9, 3.73198639505483*^9}, {3.732068235503559*^9, 
   3.732068294559266*^9}, {3.732068779661989*^9, 3.7320687889939337`*^9}, {
   3.732068877927959*^9, 3.732068878477798*^9}, {3.73207030038395*^9, 
   3.732070338449501*^9}, {3.732070419677133*^9, 3.7320704794198313`*^9}, {
   3.732070797676426*^9, 3.732070813087555*^9}, {3.732071002298841*^9, 
   3.7320710229536467`*^9}, {3.732071090662547*^9, 3.7320710935805197`*^9}, 
   3.732071241060174*^9, {3.7320712771530857`*^9, 3.7320712823700247`*^9}, 
   3.732071522120802*^9, {3.732071576708695*^9, 3.732071648806293*^9}, {
   3.732071694737545*^9, 3.732071698832242*^9}, {3.732071729625893*^9, 
   3.732071784021433*^9}, {3.7324004125906343`*^9, 3.732400427842627*^9}, {
   3.7324009674744053`*^9, 3.73240098102356*^9}, {3.732424451588825*^9, 
   3.7324244539528217`*^9}, 3.7324246846386833`*^9, {3.732425186100869*^9, 
   3.732425189871207*^9}, {3.732425227439473*^9, 3.732425229283627*^9}, {
   3.732425397221867*^9, 
   3.73242540139012*^9}},ExpressionUUID->"3b743fc0-fed3-4446-8a4c-\
301a1cb9587b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotPolarDensity\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.731973014928238*^9, 3.731973040628045*^9}, {
   3.73197329286683*^9, 3.731973293937059*^9}, 
   3.732068459514309*^9},ExpressionUUID->"75455310-aa23-4fba-a723-\
9ea2da787db1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotPolarDensity", "]"}], "=", "\n",
    "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "DensityPlot", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotPolarDensity", "[", "\n", "\t", 
    RowBox[{
    "solutions_", ",", "\n", "\t", "gridpoints_", ",", "\n", "\t", 
     "potentialMatrix_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
    RowBox[{
    "solutions", ",", " ", "gridpoints", ",", " ", "potentialMatrix", ",", 
     "\n", "\t\t", "ChemDVRDefaultPlotPolarDensity", ",", " ", "DensityPlot", 
     ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
     RowBox[{"\"\<CoordinateTransformation\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"(", 
       RowBox[{"\"\<Polar\>\"", " ", "\[Rule]", " ", "\"\<Cartesian\>\""}], 
       ")"}]}], ",", "\n", "\t\t", 
     RowBox[{"RegionMemberFunction", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"RegionMember", "[", "\n", "\t\t\t\t", 
       RowBox[{"Annulus", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"MinMax", "[", 
          RowBox[{"gridpoints", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "]"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"MinMax", "[", 
          RowBox[{"gridpoints", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7319737717516336`*^9, 3.731973793875864*^9}, {
   3.731973875323844*^9, 3.731974127047364*^9}, {3.731974163861602*^9, 
   3.7319742530502577`*^9}, {3.731974461987932*^9, 3.731974547647347*^9}, {
   3.7319859420866632`*^9, 3.731985973953587*^9}, {3.7319864753225946`*^9, 
   3.7319865084858923`*^9}, {3.731986827968244*^9, 3.7319868384347057`*^9}, {
   3.7319873670187693`*^9, 3.731987389225945*^9}, {3.73206846860432*^9, 
   3.7320684816565123`*^9}, 
   3.732424690500967*^9},ExpressionUUID->"1dbadead-81b6-49cd-a17e-\
4d11c29c48d8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotSphericalDensity\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.731973014928238*^9, 3.731973040628045*^9}, 
   3.732067647810955*^9, 
   3.7320683921983643`*^9},ExpressionUUID->"6f7dfd0c-9e04-48ea-9e34-\
14405a89c408"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotSphericalDensity", "]"}], "=", 
   "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "DensityPlot3D", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotSphericalDensity", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "gridpoints_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "gridpoints", ",", " ", "potentialMatrix", ",", 
    "\n", "\t\t", "ChemDVRDefaultPlotSphericalDensity", ",", " ", 
    "DensityPlot3D", ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<CoordinateTransformation\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"(", 
      RowBox[{"\"\<Spherical\>\"", " ", "\[Rule]", " ", "\"\<Cartesian\>\""}],
       ")"}]}], ",", "\n", "\t\t", 
    RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7319737717516336`*^9, 3.731973793875864*^9}, {
   3.731973875323844*^9, 3.731974127047364*^9}, {3.731974163861602*^9, 
   3.7319742530502577`*^9}, {3.731974461987932*^9, 3.731974547647347*^9}, {
   3.7319859420866632`*^9, 3.731985973953587*^9}, {3.7319864753225946`*^9, 
   3.7319865084858923`*^9}, {3.731986827968244*^9, 3.731986867439732*^9}, 
   3.7319869407175627`*^9, {3.731987242709889*^9, 3.731987252018392*^9}, {
   3.731987318286289*^9, 3.731987363281475*^9}, {3.731987416083716*^9, 
   3.731987418873311*^9}, {3.73206834292705*^9, 3.732068357906218*^9}, {
   3.732068397229287*^9, 3.7320684099573812`*^9}, 
   3.73242469645464*^9},ExpressionUUID->"65e2c7ee-e1aa-4ff4-ba03-df33a4e1d018"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotContour2D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972886585318*^9}, {
  3.73197306705895*^9, 
  3.731973068936736*^9}},ExpressionUUID->"034c6db1-ddcd-4c0a-8e0d-\
2870b984d0c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotContour2D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ListContourPlot", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotContour2D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotContour2D", ",", " ", "ListContourPlot", ",", 
    "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.73198811151147*^9, 3.73198816168373*^9}, 
   3.732424701214271*^9},ExpressionUUID->"03079e63-c457-423a-bd01-\
1aaf26a97849"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotContour3D\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.7319728956264753`*^9}, {
  3.731973008258246*^9, 3.7319730084322023`*^9}, {3.731973060947579*^9, 
  3.731973063257362*^9}},ExpressionUUID->"a1972f9a-3783-4b52-8f4c-\
392c1e3f2205"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotContour3D", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ListContourPlot3D", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlotContour3D", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
   RowBox[{
   "solutions", ",", " ", "grid", ",", " ", "potentialMatrix", ",", "\n", 
    "\t\t", "ChemDVRDefaultPlotContour3D", ",", " ", "ListContourPlot3D", ",",
     "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.73198811151147*^9, 3.731988174155347*^9}, 
   3.732424704566489*^9},ExpressionUUID->"f6446a99-28b1-4f1b-89ae-\
d985ec37fd50"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlotPolarContour\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7319728349664288`*^9, 3.731972846571466*^9}, 
   3.731972912987523*^9, {3.731973014928238*^9, 3.731973040628045*^9}, {
   3.73197329286683*^9, 3.731973293937059*^9}, 3.732068459514309*^9, {
   3.7320685557567253`*^9, 
   3.732068556939372*^9}},ExpressionUUID->"a399819d-b1a7-45f9-825e-\
a9683bb5cd27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlotPolarContour", "]"}], "=", "\n",
    "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{"$ChemDVRDefaultPlotOptions", ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "ContourPlot", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDefaultPlotPolarContour", "[", "\n", "\t", 
    RowBox[{
    "solutions_", ",", "\n", "\t", "gridpoints_", ",", "\n", "\t", 
     "potentialMatrix_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemDVRDefaultPlotBasic", "[", "\n", "\t\t", 
    RowBox[{
    "solutions", ",", " ", "gridpoints", ",", " ", "potentialMatrix", ",", 
     "\n", "\t\t", "ChemDVRDefaultPlotPolarContour", ",", " ", "ContourPlot", 
     ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
     RowBox[{"\"\<CoordinateTransformation\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"(", 
       RowBox[{"\"\<Polar\>\"", " ", "\[Rule]", " ", "\"\<Cartesian\>\""}], 
       ")"}]}], ",", "\n", "\t\t", 
     RowBox[{"RegionMemberFunction", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"RegionMember", "[", "\n", "\t\t\t\t", 
       RowBox[{"Annulus", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", "\n", "\t\t\t\t\t", 
         RowBox[{"MinMax", "[", 
          RowBox[{"gridpoints", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "]"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"MinMax", "[", 
          RowBox[{"gridpoints", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], "]"}]}], "\n", 
        "\t\t\t\t\t", "]"}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ShowPotential\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7319737717516336`*^9, 3.731973793875864*^9}, {
   3.731973875323844*^9, 3.731974127047364*^9}, {3.731974163861602*^9, 
   3.7319742530502577`*^9}, {3.731974461987932*^9, 3.731974547647347*^9}, {
   3.7319859420866632`*^9, 3.731985973953587*^9}, {3.7319864753225946`*^9, 
   3.7319865084858923`*^9}, {3.731986827968244*^9, 3.7319868384347057`*^9}, {
   3.7319873670187693`*^9, 3.731987389225945*^9}, {3.73206846860432*^9, 
   3.7320684816565123`*^9}, {3.7320685627322063`*^9, 3.732068571675168*^9}, 
   3.732424709428862*^9},ExpressionUUID->"e77365b2-ffbf-4596-8231-\
c9cb06011424"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRDefaultPlot\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7319870961406717`*^9},ExpressionUUID->"4b09e163-7f20-4d69-b474-\
cde384e01b12"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "nosup"}], "=", 
   "\"\<PlotMode `` is unsupported\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731987514093251*^9, 3.731987517010848*^9}, {
  3.731987967273376*^9, 
  3.7319879822787333`*^9}},ExpressionUUID->"3e0e01e8-850a-4a4d-8531-\
6f0f9d123ddd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRDefaultPlot", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<PlotMode\>\"", "\[Rule]", "Automatic"}], "\n", "\t\t\t", 
      "}"}], ",", "\n", "\t\t", "$ChemDVRDefaultPlotOptions"}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRDefaultPlot", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Catch", "@", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "gridpoints", ",", "\n", "\t\t\t", "func", ",", "\n", "\t\t\t", "pmode",
        ",", "\n", "\t\t\t", "gridranges"}], "\n", "\t\t\t", "}"}], ",", "\n",
      "\t\t", 
     RowBox[{
      RowBox[{"pmode", "=", "\n", "\t\t\t", 
       RowBox[{"ChemDVRDefaultPlotOptionValue", "[", "\n", "\t\t\t\t", 
        RowBox[{"\"\<PlotMode\>\"", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
         "ChemDVRDefaultPlot", ",", "\n", "\t\t\t\t", "Automatic"}], "\n", 
        "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"func", "=", "\n", "\t\t\t", 
       RowBox[{"Switch", "[", 
        RowBox[{"pmode", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Cartesian\>\"", ",", " ", "1"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotCartesian1D", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Cartesian\>\"", ",", " ", "2"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotCartesian2D", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Cartesian\>\"", ",", " ", "3"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotCartesian3D", ",", "\n", 
         "\t\t\t\t", "\"\<Cartesian\>\"", ",", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"gridpoints", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"ChemDVRDefaultGridPointList", "[", 
            RowBox[{"grid", ",", " ", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", " ", 
               RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], 
              "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"\"\<Cartesian\>\"", ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"gridpoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Density\>\"", ",", " ", "1"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotDensity1D", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Density\>\"", ",", " ", "2"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotDensity2D", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Density\>\"", ",", " ", "3"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotDensity3D", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Density\>\"", ",", " ", "\"\<Ring\>\""}], "}"}], ",", 
         "\n", "\t\t\t\t\t", "ChemDVRDefaultPlotDensityRing", ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Density\>\"", ",", " ", "\"\<Polar\>\""}], "}"}], ",", 
         "\n", "\t\t\t\t\t", "ChemDVRDefaultPlotPolarDensity", ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Density\>\"", ",", " ", "\"\<Spherical\>\""}], "}"}], 
         ",", "\n", "\t\t\t\t\t", "ChemDVRDefaultPlotSphericalDensity", ",", 
         "\n", "\t\t\t\t", "\"\<Density\>\"", ",", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"gridpoints", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"ChemDVRDefaultGridPointList", "[", 
            RowBox[{"grid", ",", " ", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", " ", 
               RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], 
              "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"\"\<Density\>\"", ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"gridpoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Contour\>\"", ",", " ", "2"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotContour2D", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Contour\>\"", ",", " ", "3"}], "}"}], ",", "\n", 
         "\t\t\t\t\t", "ChemDVRDefaultPlotContour3D", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Contour\>\"", ",", " ", "\"\<Polar\>\""}], "}"}], ",", 
         "\n", "\t\t\t\t\t", "ChemDVRDefaultPlotPolarContour", ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<Contour\>\"", ",", " ", "\"\<Spherical\>\""}], "}"}], 
         ",", "\n", "\t\t\t\t\t", "ChemDVRDefaultPlotSpherical", ",", "\n", 
         "\t\t\t\t", "\"\<Contour\>\"", ",", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"gridpoints", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"ChemDVRDefaultGridPointList", "[", 
            RowBox[{"grid", ",", " ", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", " ", 
               RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], 
              "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"\"\<Contour\>\"", ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"gridpoints", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ",", "\n", 
         "\t\t\t\t", "\"\<Ring\>\"", ",", "\n", "\t\t\t\t\t", 
         "ChemDVRDefaultPlotRing", ",", "\n", "\t\t\t\t", "\"\<Ring3D\>\"", 
         ",", "\n", "\t\t\t\t\t", "ChemDVRDefaultPlotRing3D", ",", "\n", 
         "\t\t\t\t", "\"\<Polar\>\"", ",", "\n", "\t\t\t\t\t", 
         "ChemDVRDefaultPlotPolar", ",", "\n", "\t\t\t\t", "\"\<Shell\>\"", 
         ",", "\n", "\t\t\t\t\t", "ChemDVRDefaultPlotShell", ",", "\n", 
         "\t\t\t\t", "\"\<Spherical\>\"", ",", "\n", "\t\t\t\t\t", 
         "ChemDVRDefaultPlotSpherical", ",", "\n", "\t\t\t\t", "Automatic", 
         ",", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"gridpoints", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"ChemDVRDefaultGridPointList", "[", 
            RowBox[{"grid", ",", " ", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", " ", 
               RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], 
              "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"gridranges", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"gridpoints", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
             "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"MinMax", "@", "gridpoints"}], "}"}], ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{"MinMax", "/@", 
              RowBox[{"Transpose", "[", "gridpoints", "]"}]}]}], "\n", 
            "\t\t\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{"Switch", "[", 
           RowBox[{"gridranges", ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", " ", "_"}], "}"}], "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "==", 
                 RowBox[{"2", "\[Pi]"}]}], "&"}], ")"}]}], "}"}], ",", "\n", 
            "\t\t\t\t\t\t\t", "\"\<Ring\>\"", ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", " ", "_"}], "}"}], "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "==", 
                  RowBox[{"2", "\[Pi]"}]}], "&"}], ")"}]}], ",", " ", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", " ", "_"}], "}"}], "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "==", "\[Pi]"}], "&"}], 
                ")"}]}]}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", 
            "\t\t\t\t\t\t\t", "\"\<Shell\>\"", ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", " ", "_"}], "}"}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", " ", "_"}], "}"}], "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "==", 
                  RowBox[{"2", "\[Pi]"}]}], "&"}], ")"}]}]}], "\n", 
             "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
            "\"\<Polar\>\"", ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", " ", "_"}], "}"}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", " ", "_"}], "}"}], "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "==", 
                  RowBox[{"2", "\[Pi]"}]}], "&"}], ")"}]}], ",", " ", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", " ", "_"}], "}"}], "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "==", "\[Pi]"}], "&"}], 
                ")"}]}]}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", 
            "\t\t\t\t\t\t\t", "\"\<Spherical\>\"", ",", "\n", "\t\t\t\t\t\t", 
            "_", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"\"\<Cartesian\>\"", ",", " ", 
              RowBox[{"Length", "@", "gridranges"}]}], "}"}]}], "\n", 
           "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", "_", ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Message", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"ChemDVRRun", "::", "nosup"}], ",", "\n", "\t\t\t\t\t\t", 
            "pmode"}], "\n", "\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\n", "\t\t\t\t", 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringQ", "@", "func"}], "||", 
         RowBox[{"ListQ", "@", "func"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRDefaultPlot", "[", "\n", "\t\t\t\t", 
         RowBox[{
         "solutions", ",", "\n", "\t\t\t\t", "grid", ",", "\n", "\t\t\t\t", 
          "potentialMatrix", ",", "\n", "\t\t\t\t", 
          RowBox[{"\"\<PlotMode\>\"", "\[Rule]", "func"}], ",", "\n", 
          "\t\t\t\t", "ops"}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"ListQ", "@", "gridpoints"}]}], ",", " ", "\n", 
           "\t\t\t\t", 
           RowBox[{"gridpoints", "=", "\n", "\t\t\t\t\t", 
            RowBox[{"ChemDVRDefaultGridPointList", "[", 
             RowBox[{"grid", ",", " ", "\n", "\t\t\t\t\t\t", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", "ops", "}"}], ",", " ", 
                RowBox[{"Options", "@", "ChemDVRDefaultGridPointList"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", 
          "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"func", "[", "\n", "\t\t\t\t", 
          RowBox[{
          "solutions", ",", "\n", "\t\t\t\t", "gridpoints", ",", "\n", 
           "\t\t\t\t", "potentialMatrix", ",", "\n", "\t\t\t\t", "ops"}], 
          "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}]}], "\n", 
    "\t\t", "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.731972781629786*^9, 3.731972818164227*^9}, {
   3.731987071262067*^9, 3.7319870838012133`*^9}, {3.731987255259973*^9, 
   3.731987266055849*^9}, 3.731987348083055*^9, {3.731987423942429*^9, 
   3.7319875976697073`*^9}, {3.7319876278024197`*^9, 3.73198764486766*^9}, {
   3.7319877459201593`*^9, 3.73198806686756*^9}, {3.7319881885681963`*^9, 
   3.731988240528117*^9}, {3.732006277550037*^9, 3.7320062821709213`*^9}, {
   3.732006562538224*^9, 3.732006606356135*^9}, 3.732067071123054*^9, {
   3.732067103377095*^9, 3.7320671666410723`*^9}, 3.732067205041801*^9, {
   3.73206726328913*^9, 3.732067288858499*^9}, {3.732067363843972*^9, 
   3.732067447279447*^9}, {3.732067486879389*^9, 3.7320676263738747`*^9}, {
   3.732068425061602*^9, 3.732068447328561*^9}, {3.732068507136335*^9, 
   3.732068528427224*^9}, {3.7320685960895367`*^9, 3.732068607001732*^9}, {
   3.7320686615507793`*^9, 3.7320687340317793`*^9}, {3.732071664191573*^9, 
   3.7320716683022223`*^9}, {3.73240099710205*^9, 3.732401028289798*^9}, {
   3.732424455710451*^9, 
   3.73242446377912*^9}},ExpressionUUID->"da63ee8d-cb1e-4a4d-8fa8-\
efcf1b48173e"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRObject\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6991966763172083`*^9, 3.699196677485319*^9}, {
   3.699201363329368*^9, 3.6992013650563927`*^9}, 
   3.700004724121943*^9},ExpressionUUID->"dcc42bd4-fc39-4313-b4d7-\
2920f9bc832c"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Helpers\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7323141268114243`*^9, 
  3.7323141279783087`*^9}},ExpressionUUID->"8866e15a-efeb-4100-a898-\
2992c6a05fe3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRValidQ", "[", "uuid_String", "]"}], ":=", "\n", "\t", 
   RowBox[{"KeyMemberQ", "[", 
    RowBox[{
     RowBox[{"$ChemDVRManager", "[", "\"\<Objects\>\"", "]"}], ",", "uuid"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRValidQ", "[", 
    RowBox[{"ChemDVRObject", "[", "uuid_", "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"chemDVRValidQ", "[", "uuid", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRValidQ", "[", "___", "]"}], ":=", "False"}], ";"}], "\n", 
 RowBox[{"dvrObjPattern", "=", 
  RowBox[{"ChemDVRObject", "[", 
   RowBox[{"uuid_", "?", "chemDVRValidQ"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6991970873879623`*^9, 3.699197114951487*^9}, {
   3.700004724149478*^9, 3.700004724152691*^9}, {3.707069854270802*^9, 
   3.707069855196086*^9}, {3.7094828545167627`*^9, 3.709482943502315*^9}, 
   3.7095084930456743`*^9},ExpressionUUID->"5a342f9f-abfb-4115-95b5-\
48c2f2d363b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dvrOpsLookup", "[", 
   RowBox[{"ops___", ",", "key_", ",", "default_"}], "]"}], ":=", "\n", "\t", 
  
  RowBox[{"Lookup", "[", 
   RowBox[{
    RowBox[{"Flatten", "@", 
     RowBox[{"Normal", "@", 
      RowBox[{"{", "ops", "}"}]}]}], ",", "key", ",", "default"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"dvrOpsLookup", "~", "SetAttributes", "~", "HoldAll"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699204419926141*^9, 3.699204483651804*^9}, {
  3.709508471785342*^9, 
  3.7095084779424257`*^9}},ExpressionUUID->"5836edc7-b8f8-4a36-8f2f-\
d4ab75b4bf4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Reloading\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699215853546481*^9, 3.699215865496324*^9}, {
  3.732303110910838*^9, 
  3.732303111139042*^9}},ExpressionUUID->"a32dac60-8496-498f-8b7c-\
afc75639578b"],

Cell[BoxData[
 RowBox[{"ChemDVRObject", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.732314122564632*^9, 
  3.732314123447558*^9}},ExpressionUUID->"93ae5292-f035-4cb6-b71e-\
0fa2e4cb2d52"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRObject", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRCreate", "[", "a", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRObject", "[", 
    RowBox[{"uuid_String", "?", 
     RowBox[{"(", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{
           RowBox[{"$ChemDVRManager", "[", "\"\<Objects\>\"", "]"}], ",", 
           "#"}], "]"}]}], "&&", "\n", "\t\t", 
        RowBox[{"FileExistsQ", "@", 
         RowBox[{"ChemDVRFile", "[", 
          RowBox[{"$dvrinst", ",", " ", 
           RowBox[{"#", "<>", "\"\<.m\>\""}]}], "]"}]}]}], "\n", "\t", "&"}], 
      ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRCreate", "[", "uuid", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRObject", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"s_String", "?", 
      RowBox[{"(", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"ChemDVRClass", "[", "#", "]"}], ",", " ", 
           RowBox[{"ChemDVRClass", "[", 
            RowBox[{"_Association", "?", "AssociationQ"}], "]"}]}], "]"}]}], 
        "&"}], "\n", "\t\t", ")"}]}], ",", " ", "\n", "\t", 
     RowBox[{"o___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "s", "]"}], "[", "o", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699215914328568*^9, 3.6992159234698963`*^9}, {
   3.700004724161327*^9, 3.700004724164465*^9}, 3.7094870167073936`*^9, {
   3.732302504111462*^9, 3.732302529972989*^9}, 3.732314119409726*^9, {
   3.732314161027429*^9, 
   3.732314166914674*^9}},ExpressionUUID->"2af9b5b3-af09-44e4-b89c-\
0e68a1dd7b06"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Association\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699211545202107*^9, 
  3.699211546617084*^9}},ExpressionUUID->"3c9f7060-15df-407a-9e7a-\
70819eaf8d07"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRAssociation", "[", 
    RowBox[{"obj", ":", "dvrObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"$ChemDVRManager", "[", 
    RowBox[{"\"\<Objects\>\"", ",", 
     RowBox[{"First", "@", "obj"}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69921154776952*^9, 3.6992115632579403`*^9}, {
   3.700004724191477*^9, 3.7000047241942883`*^9}, 
   3.7095084930563383`*^9},ExpressionUUID->"ab6934f5-2e78-49d8-a4f6-\
2b13b5db67af"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Get\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69919687184629*^9, 3.699196873004815*^9}, {
  3.699201166272868*^9, 
  3.69920116655901*^9}},ExpressionUUID->"54c128bc-80ba-43db-b132-\
4866f23f8a03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", "attribute_"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"$ChemDVRManager", "[", 
      RowBox[{"\"\<Objects\>\"", ",", 
       RowBox[{"First", "@", "obj"}]}], "]"}], ",", "attribute"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", "attribute_", ",", 
     "default_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{
     RowBox[{"$ChemDVRManager", "[", 
      RowBox[{"\"\<Objects\>\"", ",", 
       RowBox[{"First", "@", "obj"}]}], "]"}], ",", "attribute", ",", 
     "default"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196874327071*^9, 3.6991969237260933`*^9}, {
  3.6991971263683977`*^9, 3.699197142208737*^9}, {3.699200987814231*^9, 
  3.699200987818199*^9}, {3.7000047242029953`*^9, 3.7000047242118196`*^9}, {
  3.709508493063735*^9, 
  3.7095084930679703`*^9}},ExpressionUUID->"cf66a048-82dd-4c1d-b33f-\
64a574cbf90f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", 
      RowBox[{"ChemDVRClass", "[", "a_Association", "]"}]}], ",", 
     "attribute_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"a", ",", "attribute"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{
     RowBox[{"obj", ":", 
      RowBox[{"ChemDVRClass", "[", "a_Association", "]"}]}], ",", 
     "attribute_", ",", "default_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"a", ",", "attribute", ",", "default"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699196874327071*^9, 3.6991969237260933`*^9}, {
  3.6991971263683977`*^9, 3.699197142208737*^9}, {3.699200987814231*^9, 
  3.699200987818199*^9}, {3.7000047242029953`*^9, 3.7000047242118196`*^9}, {
  3.7075054931792793`*^9, 
  3.707505508082748*^9}},ExpressionUUID->"4a3bcd97-84b3-4dc4-b65f-\
b464c357c319"],

Cell[BoxData[
 RowBox[{"PackageAddAutocompletions", "[", "\n", "\t", 
  RowBox[{"ChemDVRGet", ",", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"None", ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "$dvrgr", ",", "\n", "\t\t\t", "$dvrke", ",", "$dvrpe", ",", "\n", 
       "\t\t\t", "$dvrwf", ",", "$dvrgrwf", ",", "\n", "\t\t\t", "$dvrintwf", 
       ",", "$dvrexv", ",", "\n", "\t\t\t", "$dvrexm", ",", "$dvrvw"}], "\n", 
      "\t\t\t", "}"}]}], "\n", "\t\t", "}"}]}], "\n", "\t", 
  "]"}]], "CodeInput",
 CellChangeTimes->{{3.731944192197379*^9, 
  3.7319443124634647`*^9}},ExpressionUUID->"f66145b7-0bb0-44ba-aee3-\
bf3e3ece7052"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Mutate\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699201167782341*^9, 3.699201168118986*^9}, {
  3.727732445412798*^9, 
  3.7277324477491903`*^9}},ExpressionUUID->"f3de83bd-f616-474e-88ba-\
1d14b8447e21"],

Cell[BoxData[{
 RowBox[{"ChemDVRMutate", "//", "ClearAll"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRMutate", "~", "SetAttributes", "~", "HoldAll"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"obPat", "=", "dvrObjPattern"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"ChemDVRMutate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", "obPat"}], ")"}], "[", "at___", "]"}], ",", " ",
         "fn_", ",", " ", "args___"}], "]"}], ":=", "\n", "\t", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k", "=", 
          RowBox[{"First", "@", "obj"}]}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"fn", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", 
           RowBox[{"\"\<Objects\>\"", ",", " ", "k", ",", " ", "at"}], "]"}], 
          ",", "\n", "\t", "\t\t\t", "args"}], "\n", "\t", "\t\t\t", "]"}]}], 
       "\n", "\t", "\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRMutate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", "obPat"}], ")"}], "[", 
         RowBox[{"[", "at___", "]"}], "]"}], ",", " ", "fn_", ",", " ", 
        "args___"}], "]"}], ":=", "\n", "\t", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k", "=", 
          RowBox[{"First", "@", "obj"}]}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"fn", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"$ChemDVRManager", "[", 
           RowBox[{"[", 
            RowBox[{"\"\<Objects\>\"", ",", " ", "k", ",", " ", "at"}], "]"}],
            "]"}], ",", "\n", "\t", "\t\t\t", "args"}], "\n", "\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "]"}]}]}]}], "\n", "\t\t", "]"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699201181200038*^9, 3.6992011975899887`*^9}, {
   3.699212494340621*^9, 3.699212508082419*^9}, {3.699298683785789*^9, 
   3.699298685727716*^9}, {3.700004724221751*^9, 3.700004724224667*^9}, 
   3.709508493074862*^9, {3.727732417297453*^9, 3.727732459733604*^9}, {
   3.727732530628047*^9, 3.727732562885551*^9}, {3.7277326380771437`*^9, 
   3.7277326511953506`*^9}, {3.727732784722123*^9, 3.727732827882661*^9}, {
   3.7277329250089407`*^9, 3.727732928540719*^9}, {3.727732985542776*^9, 
   3.727732993803175*^9}, 3.727746177964987*^9, {3.7277464606995373`*^9, 
   3.7277465850180597`*^9}},ExpressionUUID->"60a67af8-e986-4af9-8991-\
228fce2adc64"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Set\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699201167782341*^9, 
  3.699201168118986*^9}},ExpressionUUID->"f76e80e9-cadc-46e7-8988-\
04f1ae9db263"],

Cell[BoxData[
 RowBox[{"ChemDVRSet", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.727732847778788*^9, 
  3.727732848577655*^9}},ExpressionUUID->"cbadf7c6-7ec8-41d8-9130-\
742bef98ab87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRSet", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "attribute__", ",", " ", 
    "value_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemDVRMutate", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"obj", "[", "attribute", "]"}], ",", "\n", "\t\t", "Set", ",", 
    "\n", "\t\t", "value"}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699201181200038*^9, 3.6992011975899887`*^9}, {
   3.699212494340621*^9, 3.699212508082419*^9}, {3.699298683785789*^9, 
   3.699298685727716*^9}, {3.700004724221751*^9, 3.700004724224667*^9}, 
   3.709508493074862*^9, {3.727732417297453*^9, 3.727732420017602*^9}, {
   3.7277325798158283`*^9, 3.727732580579913*^9}, {3.72773261154007*^9, 
   3.727732630162447*^9}, {3.7277326687336473`*^9, 3.727732681480076*^9}, {
   3.727732835276078*^9, 
   3.727732838817815*^9}},ExpressionUUID->"933df858-4c59-4994-8cff-\
5078cd63fb21"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Options\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718052275537813*^9, 
  3.71805227628936*^9}},ExpressionUUID->"76e675a6-136b-4638-94cf-\
4aa1e540a1e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROptions", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "method_String"}], 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"Options", "@", 
    RowBox[{"ChemDVRGet", "[", 
     RowBox[{"obj", ",", " ", "method"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVROptions", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", 
     RowBox[{"methods", ":", 
      RowBox[{"{", "__String", "}"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AssociationMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ChemDVROptions", "[", 
       RowBox[{"obj", ",", "#"}], "]"}], "&"}], ",", " ", "methods"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVROptions", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", 
    RowBox[{"Optional", "[", 
     RowBox[{"All", ",", " ", "All"}], "]"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemDVROptions", "[", 
   RowBox[{"obj", ",", " ", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{
     "$dvrgr", ",", " ", "$dvrke", ",", " ", "\"\<PotentialEnergy\>\"", ",", 
      " ", "$dvrwf", ",", " ", "\"\<View\>\""}], "}"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.718052277162889*^9, 3.7180524333381844`*^9}, {
  3.7317861690846977`*^9, 
  3.731786186099976*^9}},ExpressionUUID->"23e267c4-57eb-4e3a-a6fd-\
d7b732a6d292"],

Cell[BoxData[
 RowBox[{"PackageAddAutocompletions", "[", "\n", "\t", 
  RowBox[{"ChemDVROptions", ",", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"None", ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "$dvrgr", ",", "\n", "\t\t\t", "$dvrke", ",", " ", "$dvrpe", ",", " ", 
       "$dvrwf", ",", "\n", "\t\t\t", "$dvrvw"}], "\n", "\t\t\t", "}"}]}], 
    "\n", "\t\t", "}"}]}], "\n", "\t", "]"}]], "CodeInput",
 CellChangeTimes->{{3.7292526878326817`*^9, 3.7292527370822287`*^9}, {
  3.729252772212078*^9, 
  3.729252781481769*^9}},ExpressionUUID->"843d70d0-891b-459a-9ab0-\
272d1aca4944"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Dimension\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699196985185794*^9, 
  3.699196986312482*^9}},ExpressionUUID->"4515930b-a7a9-41dc-b2af-\
f94aa243e1a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRDimension", "[", 
    RowBox[{"obj", ":", "dvrObjPattern"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Length", "@", 
    RowBox[{"ChemDVRGet", "[", 
     RowBox[{"obj", ",", "\"\<Range\>\""}], "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699196987396916*^9, 3.699197012622686*^9}, {
   3.69919714646422*^9, 3.699197158092146*^9}, 3.699200987825506*^9, {
   3.700004724233077*^9, 3.700004724235886*^9}, 
   3.709508493087575*^9},ExpressionUUID->"99d8ed0b-a8f1-413c-a8d7-\
a4c9c805ac71"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Grid\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6991969270441923`*^9, 
  3.699196929003084*^9}},ExpressionUUID->"6d9c36b7-ecd7-478f-9310-\
a7967588dac8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "baddom"}], "=", 
   "\"\<\\\"Range\\\" `` isn't a valid DVR domain specification\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "::", "baddiv"}], "=", 
   "\"\<\\\"Points\\\" `` isn't valid DVR division specification \>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.732421123413842*^9, 3.732421168764906*^9}, {
  3.7324212661117907`*^9, 
  3.732421287648746*^9}},ExpressionUUID->"734b35ba-7701-4a4a-b8b5-\
3787a0e034a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRGrid", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"RunRange", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunPoints", "=", "None"}]}], "\n", "\t\t", "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"RunRange", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"dvrOpsLookup", "[", 
          RowBox[{"ops", ",", "\"\<Range\>\"", ",", "None"}], "]"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"l", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "\[RuleDelayed]", 
          RowBox[{"{", "l", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"RunRange", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], ",", 
              RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], "]"}],
         ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRSet", "[", 
         RowBox[{"obj", ",", "\"\<Range\>\"", ",", "RunRange"}], "]"}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunRange", "=", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", " ", "\"\<Range\>\""}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"RunRange", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "NumericQ"}], ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], 
          "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ChemDVRRun", "::", "baddom"}], ",", " ", "RunRange"}], 
          "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}], ";"}]}], "\n", "\t\t\t", 
       "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunPoints", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"dvrOpsLookup", "[", 
          RowBox[{"ops", ",", "\"\<Points\>\"", ",", "None"}], "]"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"l", ":", 
           RowBox[{"_", "?", "IntegerQ"}]}], "\[RuleDelayed]", 
          RowBox[{"{", "l", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"RunPoints", ",", " ", 
          RowBox[{"{", 
           RowBox[{"__", "?", "IntegerQ"}], "}"}]}], "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"ChemDVRSet", "[", 
         RowBox[{"obj", ",", "\"\<Points\>\"", ",", "RunPoints"}], "]"}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunPoints", "=", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", " ", "\"\<Points\>\""}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"RunPoints", ",", " ", 
           RowBox[{"{", 
            RowBox[{"__", "?", "IntegerQ"}], "}"}]}], "]"}]}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ChemDVRRun", "::", "baddiv"}], ",", " ", "RunPoints"}], 
          "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}], ";"}]}], "\n", "\t\t\t", 
       "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", "\"\<FormatGrid\>\"", ",", 
         RowBox[{"(", 
          RowBox[{"#", "&"}], ")"}]}], "]"}], "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", "$dvrgr"}], "]"}], "[", "\n", "\t\t\t\t", 
         RowBox[{
         "RunPoints", ",", "\n", "\t\t\t\t", "RunRange", ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", 
             RowBox[{"Options", "@", 
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", "$dvrgr"}], "]"}]}]}], "]"}]}]}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "RunPoints"}], "\n", 
       "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6991969299578247`*^9, 3.6991969620576553`*^9}, {
   3.699197166287361*^9, 3.699197170063559*^9}, {3.699200858953191*^9, 
   3.699200869415214*^9}, {3.6992009878361473`*^9, 3.6992009878432417`*^9}, {
   3.6992026966594877`*^9, 3.699202723881104*^9}, {3.699203818943363*^9, 
   3.699203860422764*^9}, {3.69921228205164*^9, 3.699212325977086*^9}, {
   3.700004724247127*^9, 3.700004724276058*^9}, {3.707242507509078*^9, 
   3.7072425160989923`*^9}, 3.707249518019245*^9, {3.7072495638980227`*^9, 
   3.70724956509202*^9}, {3.709487835819138*^9, 3.7094878476729927`*^9}, {
   3.709508471798473*^9, 3.709508493096951*^9}, {3.731786179525681*^9, 
   3.731786179531638*^9}, {3.732421049943583*^9, 3.732421069470243*^9}, {
   3.7324211086286716`*^9, 3.732421122216268*^9}, {3.7324211764633913`*^9, 
   3.732421261857923*^9}, {3.732421296672555*^9, 3.732421312154579*^9}, {
   3.732421850867326*^9, 
   3.732421927665245*^9}},ExpressionUUID->"16129866-6626-4a55-bed5-\
aaffae5731ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]KineticEnergy\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699197066071319*^9, 
  3.699197067831275*^9}},ExpressionUUID->"fda1b7b2-ce25-4311-92a5-\
0f815343198c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrCalcKE", "[", 
   RowBox[{"obj_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", "=", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"ChemDVRGet", "[", 
      RowBox[{"obj", ",", "$dvrke"}], "]"}], "[", 
     RowBox[{"g", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "@", 
          RowBox[{"ChemDVRGet", "[", 
           RowBox[{"obj", ",", "$dvrke"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
   "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992026475303993`*^9, 3.6992026585309057`*^9}, 
   3.699204470799953*^9, {3.699212671352203*^9, 3.6992126771743193`*^9}, {
   3.7000047242849703`*^9, 3.7000047242909184`*^9}, {3.709508471814032*^9, 
   3.709508477969434*^9}, 
   3.731786179537806*^9},ExpressionUUID->"cfbc0fb1-1d54-4056-a1aa-\
3ead97507f59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRKineticEnergy", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dvrke", "=", 
       RowBox[{"ChemDVRGet", "[", 
        RowBox[{"obj", ",", "$dvrke"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "dvrke"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", "dvrke"}], ",", 
         RowBox[{"Import", "@", "dvrke"}], ",", 
         RowBox[{"Import", "@", 
          RowBox[{"ChemDVRFile", "[", 
           RowBox[{"$dvrke", ",", "dvrke"}], "]"}]}]}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tryLoad", "=", "\n", "\t\t\t\t", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"dvrOpsLookup", "[", 
             RowBox[{"ops", ",", 
              RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"dvrOpsLookup", "[", 
               RowBox[{
               "ops", ",", "\"\<Load\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"$ChemDVRManager", "[", 
                 RowBox[{"\"\<Settings\>\"", ",", 
                  RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}]}], "]"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{"tryLoad", ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FileExistsQ", "@", 
              RowBox[{"ChemDVRFile", "[", 
               RowBox[{"$dvrke", ",", "obj"}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"Import", "@", 
              RowBox[{"ChemDVRFile", "[", 
               RowBox[{"$dvrke", ",", "obj"}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"ChemDVRKineticEnergy", "[", 
              RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"\"\<Load\>\"", "<>", "$dvrke"}], "\[Rule]", 
                "False"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"\"\<Load\>\"", "\[Rule]", "False"}], ",", "\n", 
               "\t\t\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
            "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ke", "=", 
               RowBox[{"dvrCalcKE", "[", 
                RowBox[{"obj", ",", "ops"}], "]"}]}], "}"}], ",", "\n", "\t", 
             "\t", "\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatrixQ", "[", "ke", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"TrueQ", "@", 
                   RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{"ops", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrke"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{
                    "ops", ",", "\"\<Save\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"$ChemDVRManager", "[", 
                    RowBox[{"\"\<Settings\>\"", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrke"}]}], "]"}]}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"ChemDVRSave", "[", 
                   RowBox[{"$dvrke", ",", "obj", ",", "ke"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
              ";", "\n", "\t\t\t\t\t\t", "ke"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69919706340727*^9, 3.699197075407057*^9}, {
   3.699197180230233*^9, 3.699197282432089*^9}, {3.699197412117258*^9, 
   3.699197459880109*^9}, {3.699197687145479*^9, 3.699197738333351*^9}, {
   3.699197771332769*^9, 3.699197922739546*^9}, 3.699200987854453*^9, {
   3.699202664735258*^9, 3.699202668883069*^9}, {3.699207754395616*^9, 
   3.699207773783395*^9}, {3.699212680579134*^9, 3.6992126892319117`*^9}, {
   3.699213161213209*^9, 3.699213165739191*^9}, 3.6992145834281387`*^9, {
   3.6992149560950127`*^9, 3.699215028554652*^9}, {3.69929874328679*^9, 
   3.699298744484782*^9}, {3.699301697569229*^9, 3.6993017088779707`*^9}, {
   3.69932447487288*^9, 3.6993244750316553`*^9}, {3.7000047243029947`*^9, 
   3.700004724333516*^9}, {3.709508471828471*^9, 3.7095084931055117`*^9}, {
   3.719694586244753*^9, 3.719694594118734*^9}, {3.731785984270596*^9, 
   3.731786006235691*^9}},ExpressionUUID->"8eae755e-4aba-40b9-8c69-\
ecff37fa97f8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PotentialEnergy\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699197066071319*^9, 3.699197067831275*^9}, {
  3.699197929539864*^9, 
  3.6991979307301702`*^9}},ExpressionUUID->"8f6b21e1-2dae-433a-88ed-\
f28406f52387"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrCalcPE", "[", 
   RowBox[{"obj_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", "=", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{
     RowBox[{"ChemDVRGet", "[", 
      RowBox[{"obj", ",", "$dvrpe"}], "]"}], "[", 
     RowBox[{"g", ",", "\n", "\t\t\t", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "@", 
          RowBox[{"ChemDVRGet", "[", 
           RowBox[{"obj", ",", "$dvrpe"}], "]"}]}]}], "]"}]}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699202502378221*^9, 3.699202503064679*^9}, {
  3.6992025466963654`*^9, 3.699202585401987*^9}, {3.699202621390476*^9, 
  3.699202650490757*^9}, {3.699212691009399*^9, 3.6992126943009033`*^9}, {
  3.7000047243426037`*^9, 3.700004724348812*^9}, {3.709508471854788*^9, 
  3.709508477775098*^9}, {3.71106137079778*^9, 3.711061373545039*^9}, {
  3.7317859318661613`*^9, 
  3.731785938025778*^9}},ExpressionUUID->"9ad6a124-cd89-474b-bb85-\
e3188f6782e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrLoadPotential", "[", 
   RowBox[{"obj_", ",", "file_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"DiagonalMatrix", "@", "\n", "\t\t", 
   RowBox[{"Flatten", "[", "\n", "\t\t\t", 
    RowBox[{"dvrImportAlignPotential", "[", "\n", "\t\t\t\t", 
     RowBox[{"obj", ",", "\n", "\t\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"gBase", "=", 
           RowBox[{"dvrOpsLookup", "[", 
            RowBox[{"ops", ",", " ", "$dvrgr", ",", 
             RowBox[{"ChemDVRGrid", "[", 
              RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"dim", "=", 
           RowBox[{"ChemDVRDimension", "[", "obj", "]"}]}]}], "\n", 
         "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"gBase", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "dim", "]"}], "]"}], "=!=", "dim"}], ",", "\n", 
          "\t\t\t\t\t\t", 
          RowBox[{"SelectFirst", "[", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{"gBase", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"d2", "=", 
                 RowBox[{"Dimensions", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "d2", "]"}], ">=", "dim"}], "&&", 
                RowBox[{
                 RowBox[{"d2", "[", 
                  RowBox[{"[", "dim", "]"}], "]"}], "===", "dim"}]}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Throw", "[", "$Failed", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
           "]"}], ",", "\n", "\t\t\t\t\t\t", "gBase"}], "\n", "\t\t\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "file", 
      ",", "\n", "\t\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", 
        RowBox[{"Options", "@", "dvrImportAlignPotential"}]}], "]"}]}], "\n", 
     "\t\t\t\t", "]"}], "\n", "\t\t\t", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.715987439539275*^9, 3.71598748541973*^9}, {
  3.7159881524202757`*^9, 3.715988382478784*^9}, {3.7159884235465384`*^9, 
  3.715988514154049*^9}, {3.716001430877695*^9, 3.716001531775898*^9}, {
  3.716001591212276*^9, 3.716001608251238*^9}, {3.7160016444189568`*^9, 
  3.7160016490811*^9}, {3.716053017735896*^9, 3.716053048807095*^9}, {
  3.73178594087087*^9, 
  3.7317859412190742`*^9}},ExpressionUUID->"e31401a1-e986-4ae0-af21-\
80664d266b78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRPotentialEnergy", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dvrpe", "=", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"ops", ",", "$dvrpe", ",", 
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", "$dvrpe"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringQ", "@", "dvrpe"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", "dvrpe"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"dvrLoadPotential", "[", 
          RowBox[{"obj", ",", "dvrpe", ",", "ops"}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"dvrLoadPotential", "[", 
          RowBox[{"obj", ",", 
           RowBox[{"ChemDVRFile", "[", 
            RowBox[{"$dvrpe", ",", " ", "dvrpe"}], "]"}], ",", "ops"}], 
          "]"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tryLoad", "=", "\n", "\t\t\t\t", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"dvrOpsLookup", "[", 
             RowBox[{"ops", ",", 
              RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"dvrOpsLookup", "[", 
               RowBox[{
               "ops", ",", "\"\<Load\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"$ChemDVRManager", "[", 
                 RowBox[{"\"\<Settings\>\"", ",", 
                  RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}]}], "]"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{"tryLoad", ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FileExistsQ", "@", 
              RowBox[{"ChemDVRFile", "[", 
               RowBox[{"$dvrpe", ",", "obj"}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"dvrLoadPotential", "[", 
              RowBox[{"obj", ",", 
               RowBox[{"ChemDVRFile", "[", 
                RowBox[{"$dvrpe", ",", "obj"}], "]"}], ",", "ops"}], "]"}], 
             ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"ChemDVRPotentialEnergy", "[", 
              RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"\"\<Load\>\"", "<>", "$dvrpe"}], "\[Rule]", 
                "False"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"\"\<Load\>\"", "\[Rule]", "False"}], ",", "\n", 
               "\t\t\t\t\t\t\t", "ops"}], "]"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}], ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pe", "=", 
               RowBox[{"dvrCalcPE", "[", 
                RowBox[{"obj", ",", "ops"}], "]"}]}], "}"}], ",", "\n", "\t", 
             "\t", "\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatrixQ", "[", "pe", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"TrueQ", "@", 
                   RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{"ops", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrpe"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"dvrOpsLookup", "[", 
                    RowBox[{
                    "ops", ",", "\"\<Save\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"$ChemDVRManager", "[", 
                    RowBox[{"\"\<Settings\>\"", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrpe"}]}], "]"}]}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"ChemDVRSave", "[", 
                   RowBox[{"$dvrpe", ",", "obj", ",", "pe"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
              ";", "\n", "\t\t\t\t\t\t", "pe"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69919706340727*^9, 3.699197075407057*^9}, {
   3.699197180230233*^9, 3.699197282432089*^9}, {3.699197412117258*^9, 
   3.699197459880109*^9}, {3.699197687145479*^9, 3.699197738333351*^9}, {
   3.699197771332769*^9, 3.699197968117004*^9}, 3.699200987864172*^9, {
   3.699202682518722*^9, 3.699202685243787*^9}, {3.699207679861404*^9, 
   3.699207748536065*^9}, {3.6992126960403976`*^9, 3.699212704830653*^9}, {
   3.6992131365682163`*^9, 3.699213148861494*^9}, 3.699214579414061*^9, {
   3.6992150742077227`*^9, 3.6992151005586433`*^9}, {3.699298733613081*^9, 
   3.699298737142411*^9}, {3.69930167926392*^9, 3.699301692373331*^9}, {
   3.699324468280842*^9, 3.699324468456209*^9}, {3.700004724360675*^9, 
   3.700004724391506*^9}, {3.709508471621833*^9, 3.7095084929525843`*^9}, {
   3.715987076337344*^9, 3.7159871011873207`*^9}, {3.7159871838610487`*^9, 
   3.7159872158080263`*^9}, {3.715987256780138*^9, 3.715987300695809*^9}, {
   3.715987378821685*^9, 3.715987382684194*^9}, {3.715987492908499*^9, 
   3.715987524173087*^9}, {3.715987990647231*^9, 3.7159880241951857`*^9}, {
   3.719694602139135*^9, 3.71969462123132*^9}, {3.731785946405696*^9, 
   3.731785972027854*^9}},ExpressionUUID->"c85108af-993b-429f-9b75-\
8f70823bc7e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GridPotential\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.711061095682518*^9, 
  3.711061097785287*^9}},ExpressionUUID->"0d591dd9-97a1-4fd1-b288-\
90186ef4adba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dvrImportPotential", "[", 
    RowBox[{"obj_", ",", 
     RowBox[{"grid", ":", 
      RowBox[{"{", 
       RowBox[{"_List", ",", "___"}], "}"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"g", "=", "\n", "\t\t\t", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"grid", ",", 
           RowBox[{
            RowBox[{"Depth", "[", "grid", "]"}], "-", "3"}]}], "]"}], ",", 
         RowBox[{"AllTrue", "[", "NumericQ", "]"}]}], "]"}]}], "\n", "\t\t\t",
       "}"}], ",", "\n", "\t\t", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}]}], "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "]"}]}], "\n", "\t", 
    "\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dvrImportPotential", "[", 
   RowBox[{"obj_", ",", 
    RowBox[{"vals", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", "___"}], "}"}]}]}], "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"grid", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], "&&", 
           RowBox[{"MatrixQ", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "@", 
       RowBox[{"ChemDVRGrid", "[", "obj", "]"}]}]}], "\n", "\t\t", "}"}], ",",
     "\n", "\t\t", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"grid", ",", 
         RowBox[{
          RowBox[{"Depth", "[", "grid", "]"}], "-", "3"}]}], "]"}], ",", 
       "vals"}], "}"}], "]"}]}], "\n", "\t", "\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.711059681406206*^9, 3.711059729643276*^9}, {
  3.711059782908168*^9, 3.711059796587542*^9}, {3.7110601820479383`*^9, 
  3.711060301856887*^9}, {3.711060436297085*^9, 3.711060488738284*^9}, {
  3.711060541945222*^9, 3.7110606192770576`*^9}, {3.7110608211668577`*^9, 
  3.711060826318776*^9}, {3.711060858188053*^9, 3.711060860996961*^9}, {
  3.7110609545591917`*^9, 3.711061064311831*^9}, {3.7110611098690567`*^9, 
  3.711061124893055*^9}, {3.7159862390232267`*^9, 3.7159862400239*^9}, {
  3.71598787548462*^9, 
  3.715987902883874*^9}},ExpressionUUID->"66e9af72-7793-43fc-ae6a-\
563dd9b256fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvrImportPotential", "[", 
   RowBox[{"obj_", ",", 
    RowBox[{"file_String", "?", "FileExistsQ"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"res", "=", "\n", "\t\t\t", 
      RowBox[{"dvrImportPotential", "[", "\n", "\t\t\t\t", 
       RowBox[{"obj", ",", "\n", "\t\t\t\t", 
        RowBox[{"Import", "[", "file", "]"}]}], "\n", "\t", "\t\t\t", "]"}]}],
      "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"res", "/;", 
     RowBox[{"AllTrue", "[", 
      RowBox[{"res", ",", "ListQ"}], "]"}]}]}], "\n", "\t", "\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.711060271297646*^9, 3.711060287311977*^9}, {
  3.7110603998614388`*^9, 3.7110604257078953`*^9}, {3.711060627683467*^9, 
  3.7110606407151613`*^9}, {3.711061563098775*^9, 3.711061564601282*^9}, {
  3.715986233787491*^9, 3.715986237151125*^9}, {3.715987910374197*^9, 
  3.715987927927762*^9}},ExpressionUUID->"8006dec8-de8f-4885-ad1b-\
2b632c951d90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "dvrAlignPotential", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Tolerance", "\[Rule]", ".01"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<GridPotentialPrepFunction\>\"", "\[Rule]", "Identity"}]}], 
    "\n", "\t\t", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dvrAlignPotential", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"grid", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", "\n", "\t", 
    RowBox[{"peInput", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"peGrid", "=", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "OptionValue", "[", "\"\<GridPotentialPrepFunction\>\"", "]"}], "@", 
         "peInput"}], ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Except", "[", "_List", "]"}], ":>", "peInput"}]}], "\n", 
       "\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Dimensions", "[", "grid", "]"}], ";", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"d1", "=", 
          RowBox[{"Depth", "[", "grid", "]"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"d2", "=", 
          RowBox[{"Depth", "[", "peGrid", "]"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"tol", "=", 
          RowBox[{"OptionValue", "[", "Tolerance", "]"}]}]}], "\n", "\t\t\t", 
        "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d1", "<", "d2"}], ",", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}], "]"}], ";", "\n", "\t", 
        "\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"points1", "=", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"grid", "[", 
                  RowBox[{"[", 
                   RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "\[Rule]", 
                 "#"}], "&"}], ",", " ", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Position", "[", 
                RowBox[{"grid", ",", 
                 RowBox[{"{", 
                  RowBox[{"__", "?", "NumericQ"}], "}"}]}], "]"}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"points2", "=", "\n", "\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"Dimensions", "[", "peGrid", "]"}]}], "===", "2"}], 
               ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"peGrid", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"Most", "/@", "peGrid"}]}], "\n", "\t\t\t\t\t\t\t", 
              "]"}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "points1", "]"}], "=!=", 
             RowBox[{"Length", "[", "points2", "]"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"interpf", "=", 
                RowBox[{"Interpolation", "[", "peGrid", "]"}]}], "}"}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"ReplacePart", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"grid", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Thread", "@", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"Rule", "[", 
                  RowBox[{
                   RowBox[{"Last", "/@", "points1"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Quiet", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"interpf", "@@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{"First", ",", "points1"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"InterpolatingFunction", "::", "dmval"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
               "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
            
            RowBox[{"(*", "\n", "\t\t\t\t\t", 
             RowBox[{
             "Find", " ", "the", " ", "nearest", " ", "point", " ", "to", " ",
               "the", " ", "points", "\n", "\t\t\t\t\t\t", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "issues", " ", "with", " ", "duplicates", " ", "may", " ", 
                 "arise"}], ",", " ", 
                RowBox[{
                 RowBox[{"but", " ", "only", " ", "for", " ", "ill"}], "-", 
                 RowBox[{"aligned", " ", "data"}]}]}], " ", ")"}], "\n", 
              "\t\t\t\t\t", "Replace", " ", "the", " ", "grid", " ", "points",
               " ", "with", " ", "the", " ", "potential", " ", "values"}], 
             "\n", "\t\t\t\t\t", "\n", "\t\t\t\t\t", "*)"}], "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"nearestChoices", "=", "points1"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"nearestValues", "=", "points2"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"nearestFound", "=", 
                 RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"While", "[", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"nearestFound", "=", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"nearestFound", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "DeleteDuplicates", "@", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "AssociationThread", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "nearestValues", "->", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Map", "[", 
                    RowBox[{"First", ",", " ", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{"nearestChoices", ",", " ", "nearestValues"}], 
                    "]"}]}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", "}"}]}], ";", "\n",
                  "\t\t\t\t\t\t\t", 
                 RowBox[{"nearestChoices", "=", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                   "nearestChoices", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"Values", "@", 
                    RowBox[{"Last", "[", "nearestFound", "]"}]}]}], ")"}]}]}],
                    "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"nearestValues", "=", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"nearestValues", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"Keys", "@", 
                    RowBox[{"Last", "[", "nearestFound", "]"}]}]}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Length", "[", "nearestValues", "]"}], ">", "0"}]}],
                 "\n", "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t", 
               RowBox[{"nearestFound", "=", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Join", ",", " ", 
                  RowBox[{"Map", "[", 
                   RowBox[{"Values", ",", " ", 
                    RowBox[{"Flatten", "[", "nearestFound", "]"}]}], "]"}]}], 
                 "]"}]}], ";", "\n", "\t\t\t\t\t\t", 
               RowBox[{"ReplacePart", "[", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"grid", ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"nearestFound", "->", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"peGrid", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
           "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}]}], 
   "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.71106115983678*^9, 3.711061291106675*^9}, {
   3.7110613260501213`*^9, 3.711061347534607*^9}, {3.7110614656910973`*^9, 
   3.711061520285655*^9}, {3.711061661325329*^9, 3.711061673506959*^9}, {
   3.7110617100698547`*^9, 3.711061772317848*^9}, {3.711062209700679*^9, 
   3.711062221899032*^9}, {3.711062346909327*^9, 3.7110624055650673`*^9}, {
   3.7110624613885813`*^9, 3.711062487556774*^9}, {3.711062579599313*^9, 
   3.71106264441905*^9}, {3.711062696623996*^9, 3.711062737638442*^9}, {
   3.711838225556767*^9, 3.711838330269305*^9}, {3.7118383699853163`*^9, 
   3.711838371363419*^9}, {3.711838574548581*^9, 3.711838647228166*^9}, {
   3.711839289681869*^9, 3.711839290297269*^9}, {3.71598622550419*^9, 
   3.715986230864448*^9}, {3.715986298669754*^9, 3.71598637700975*^9}, {
   3.715986560116501*^9, 3.715986561368948*^9}, {3.7159867286902122`*^9, 
   3.7159867375252743`*^9}, {3.7159867788667507`*^9, 3.715987002514758*^9}, {
   3.715987050347571*^9, 3.715987050826755*^9}, {3.715987775490653*^9, 
   3.7159877795751343`*^9}, {3.715988057279538*^9, 3.715988062221723*^9}, {
   3.715988528732129*^9, 3.715988785361414*^9}, {3.715988821098933*^9, 
   3.7159888307772083`*^9}, {3.715988864252236*^9, 3.7159888932814913`*^9}, 
   3.715988980198165*^9, {3.715989062873452*^9, 3.7159891265257263`*^9}, {
   3.715989340372538*^9, 3.715989449793867*^9}, {3.715989487219141*^9, 
   3.715989531427794*^9}, {3.7159897207599363`*^9, 3.715989789130486*^9}, {
   3.715995824497034*^9, 3.7159958474403343`*^9}, {3.71599591939919*^9, 
   3.7159959527038794`*^9}, {3.715995985073577*^9, 3.7159960248377542`*^9}, {
   3.715997129994727*^9, 3.715997134361384*^9}, 3.7159978969513187`*^9, {
   3.715997979050208*^9, 3.715998118588015*^9}, {3.715998152732917*^9, 
   3.715998204313005*^9}, {3.715998305523741*^9, 3.715998352198983*^9}, {
   3.715998397696088*^9, 3.715998826399201*^9}, {3.715998887027473*^9, 
   3.7159988905745697`*^9}, {3.7159989237770023`*^9, 3.715998943862809*^9}, {
   3.715999019447576*^9, 3.715999038190391*^9}, {3.715999105868196*^9, 
   3.715999127799575*^9}, {3.7159992196062927`*^9, 3.7159992302545*^9}, {
   3.7159992829263*^9, 3.715999284465829*^9}, {3.7159993787501593`*^9, 
   3.715999424942309*^9}, 3.716001267986636*^9, {3.716001305443116*^9, 
   3.7160014052146387`*^9}},ExpressionUUID->"875c2f35-8ac8-4c85-a188-\
af4bbac009da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "dvrImportAlignPotential", "]"}], "=", 
   RowBox[{"Options", "[", "dvrAlignPotential", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dvrImportAlignPotential", "[", 
   RowBox[{"obj_", ",", "grid_", ",", 
    RowBox[{"pot", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", "=", 
      RowBox[{"dvrImportPotential", "[", 
       RowBox[{"obj", ",", "pot"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"dvrAlignPotential", "[", 
     RowBox[{"grid", ",", "p", ",", "ops"}], "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7159864060853577`*^9, 3.715986421993225*^9}, {
   3.715986577436757*^9, 3.7159866660607986`*^9}, {3.715986714199174*^9, 
   3.715986714598933*^9}, {3.71598733256569*^9, 3.715987337447113*^9}, {
   3.715987931751667*^9, 3.715987936170681*^9}, 
   3.715988051428129*^9},ExpressionUUID->"d0fedf88-150b-4d68-9de7-\
ac99ed1a3aa6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Wavefunctions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 
  3.699201641474523*^9}},ExpressionUUID->"5a53e8b3-32a8-4855-a3a7-\
79924f81f362"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dvrCalcWFs", "[", 
    RowBox[{"obj_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ke", "=", "\n", "\t\t\t", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{"ops", ",", "$dvrke", ",", 
          RowBox[{"ChemDVRKineticEnergy", "[", 
           RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"pe", "=", "\n", "\t\t\t", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{"ops", ",", "\"\<PotentialEnergy\>\"", ",", 
          RowBox[{"ChemDVRPotentialEnergy", "[", 
           RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"wf", "=", 
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "$dvrwf"}], "]"}]}]}], "\n", "\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"wf", "[", 
      RowBox[{"ke", ",", "pe", ",", "\n", "\t\t\t", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t", 
          RowBox[{"Options", "@", "wf"}]}], "]"}]}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992024004022408`*^9, 3.69920248733768*^9}, {
   3.699212624872706*^9, 3.699212625998097*^9}, {3.699212707000072*^9, 
   3.699212713582858*^9}, {3.699212911221856*^9, 3.699212916269256*^9}, {
   3.6992130160607023`*^9, 3.6992130169464006`*^9}, {3.699213084216807*^9, 
   3.69921309275019*^9}, {3.699213202635684*^9, 3.6992132029697523`*^9}, {
   3.700004724401084*^9, 3.700004724410631*^9}, {3.70950847165125*^9, 
   3.709508477812776*^9}, {3.72443521591695*^9, 3.7244352380073233`*^9}, 
   3.724437605757646*^9, 
   3.731786186106991*^9},ExpressionUUID->"1047b326-eff4-44fe-b97a-\
dab553f970bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRWavefunctions", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tryLoad", "=", "\n", "\t\t", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{"ops", ",", 
          RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}], ",", "\n", "\t\t\t", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{"ops", ",", "\"\<Load\>\"", ",", "\n", "\t\t\t\t", 
            RowBox[{"$ChemDVRManager", "[", 
             RowBox[{"\"\<Settings\>\"", ",", 
              RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}]}], "]"}]}], "]"}]}], 
         "\n", "\t\t\t", "]"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"tryLoad", ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", 
          RowBox[{"ChemDVRFile", "[", 
           RowBox[{"$dvrwf", ",", "obj"}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Import", "@", 
          RowBox[{"ChemDVRFile", "[", 
           RowBox[{"$dvrwf", ",", "obj"}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"ChemDVRWavefunctions", "[", 
          RowBox[{"obj", ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<Load\>\"", "<>", "$dvrwf"}], "\[Rule]", "False"}], 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{"\"\<Load\>\"", "\[Rule]", "False"}], ",", "\n", 
           "\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"wf", "=", 
           RowBox[{"dvrCalcWFs", "[", 
            RowBox[{"obj", ",", "ops"}], "]"}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "wf"}], "\[Equal]", "2"}], "&&", 
             RowBox[{"MatrixQ", "[", 
              RowBox[{
               RowBox[{"Last", "@", "wf"}], ",", "NumericQ"}], "]"}]}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "@", 
               RowBox[{"dvrOpsLookup", "[", 
                RowBox[{"ops", ",", 
                 RowBox[{"\"\<Save\>\"", "<>", "$dvrwf"}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"dvrOpsLookup", "[", 
                  RowBox[{
                  "ops", ",", "\"\<Save\>\"", ",", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"$ChemDVRManager", "[", 
                    RowBox[{"\"\<Settings\>\"", ",", 
                    RowBox[{"\"\<Save\>\"", "<>", "$dvrwf"}]}], "]"}]}], 
                  "]"}]}], "\n", "\t", "\t", "\t", "\t", "\t\t\t", "]"}]}], 
              ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"ChemDVRSave", "[", 
               RowBox[{"$dvrwf", ",", "obj", ",", "wf"}], "]"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ";", "\n", 
          "\t\t\t\t", "wf"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.719694641000502*^9, 3.7196946484795513`*^9}, {3.7244352424343224`*^9, 
   3.72443524269345*^9}, {3.72443586733749*^9, 3.724435868890486*^9}, 
   3.72443590889896*^9, {3.7317862799776487`*^9, 
   3.7317862878036222`*^9}},ExpressionUUID->"57a776b8-2551-470f-b838-\
ee4d541c9402"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GridWavefunctions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
   3.716044651921208*^9, 3.716044652615678*^9}, 
   3.718049011651156*^9},ExpressionUUID->"aea49a8f-aa11-4fde-b7c1-\
5dba5ec136e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRGridWavefunctions", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gridwf", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", "$dvrgrwf"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"gridwf", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t", "\t\t\t", "]"}], 
      ",", "\n", "\t", "\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t", 
        RowBox[{"Options", "@", "gridwf"}]}], "\n", "\t", "\t\t\t", "]"}]}], 
     "\n", "\t", "\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718049011670295*^9, 3.718049011675613*^9}, {3.718052731356646*^9, 
   3.7180527546232*^9}, {3.7317861583598413`*^9, 
   3.7317861795461903`*^9}},ExpressionUUID->"4e815964-e0f2-4a23-82bc-\
db588bc73ddc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]InterpolatingWavefunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
  3.716044651921208*^9, 3.716044652615678*^9}, {3.718049011698127*^9, 
  3.7180490349269447`*^9}},ExpressionUUID->"47099584-f7cd-4e62-b9ac-\
a412ed83617e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRInterpolatingWavefunctions", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"interpf", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrintwf"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"interpf", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t", "\t\t\t", "]"}], 
      ",", "\n", "\t", "\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "interpf"}]}], "\n", "\t\t\t\t", "]"}]}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718048971834189*^9, 3.718048980566161*^9}, {3.718052700316998*^9, 
   3.7180527280336647`*^9}, {3.731702588533813*^9, 3.731702598349668*^9}, 
   3.731785908164795*^9, 3.731786090569401*^9, {3.7317861691064053`*^9, 
   3.731786179555431*^9}},ExpressionUUID->"a31c0ade-159d-4ebe-9fe3-\
1a1e82112f84"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ExpectationValues\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
  3.716044651921208*^9, 3.716044652615678*^9}, {3.718049011698127*^9, 
  3.7180490349269447`*^9}, {3.7314333747697363`*^9, 
  3.7314333785914497`*^9}},ExpressionUUID->"4d53a8d5-a156-4483-8b9d-\
b69cc418159f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRExpectationValues", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrexv"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718048971834189*^9, 3.718048980566161*^9}, {3.718052700316998*^9, 
   3.7180527280336647`*^9}, {3.731433382329239*^9, 3.731433478656146*^9}, {
   3.731702515443252*^9, 3.731702572399046*^9}, {3.731702621760159*^9, 
   3.731702630681596*^9}, {3.731782974758243*^9, 3.731782980919476*^9}, {
   3.7317860293571043`*^9, 
   3.731786044328086*^9}},ExpressionUUID->"8fff59da-f124-431c-8055-\
7f0aaac83398"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OperatorMatrix\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992016390438643`*^9, 3.699201641474523*^9}, {
   3.716044651921208*^9, 3.716044652615678*^9}, {3.718049011698127*^9, 
   3.7180490349269447`*^9}, {3.7314333747697363`*^9, 
   3.7314333785914497`*^9}, {3.731787197805335*^9, 3.731787198860034*^9}, 
   3.731791449699368*^9},ExpressionUUID->"3460bcba-b1df-4e89-b1b6-\
40f4f4db6402"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVROperatorMatrix", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", " ", "\n", "\t", 
    RowBox[{"efuns", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exFun", "=", 
      RowBox[{"ChemDVRGet", "[", 
       RowBox[{"obj", ",", " ", "$dvrexm"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"exFun", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", " ", "$dvrgr", ",", " ", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{
       "ops", ",", "\n", "\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRWavefunctions", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t\t", "]"}], ",", 
      "\n", "\t\t\t", "efuns", ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Options", "@", "exFun"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6992016425558777`*^9, 3.699201644570715*^9}, {
   3.6992016783069277`*^9, 3.699201679600355*^9}, {3.6992018688339987`*^9, 
   3.699201913954846*^9}, {3.699202239679612*^9, 3.699202346223328*^9}, {
   3.6992023824239264`*^9, 3.699202397348524*^9}, {3.699202517979288*^9, 
   3.699202527369062*^9}, {3.699212715680834*^9, 3.699212726081011*^9}, {
   3.699212878567347*^9, 3.6992129075868673`*^9}, {3.699213117596525*^9, 
   3.69921314602836*^9}, 3.699214572571432*^9, {3.6992146792146807`*^9, 
   3.699214686415449*^9}, {3.699215121079707*^9, 3.699215149573737*^9}, {
   3.699301661091034*^9, 3.699301669933214*^9}, {3.7000047244214973`*^9, 
   3.700004724443285*^9}, {3.709508471667099*^9, 3.7095084929644012`*^9}, {
   3.71604468765968*^9, 3.7160446982425623`*^9}, {3.716044745052003*^9, 
   3.716044833176176*^9}, {3.716045574207285*^9, 3.716045588259344*^9}, {
   3.71604564960534*^9, 3.71604571667426*^9}, 3.7160459774466867`*^9, {
   3.718048971834189*^9, 3.718048980566161*^9}, {3.718052700316998*^9, 
   3.7180527280336647`*^9}, {3.731433382329239*^9, 3.731433478656146*^9}, {
   3.731702515443252*^9, 3.731702572399046*^9}, {3.731702621760159*^9, 
   3.731702630681596*^9}, {3.731782974758243*^9, 3.731782980919476*^9}, {
   3.7317860293571043`*^9, 3.731786044328086*^9}, {3.7317872017689457`*^9, 
   3.7317872151804657`*^9}, 
   3.7317914497142477`*^9},ExpressionUUID->"2572244a-ae7d-412e-9907-\
36aebd21cb01"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]View\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69920235802768*^9, 
  3.699202359426248*^9}},ExpressionUUID->"fb4001c0-f4b0-4bd4-8088-\
b30ef2d8ac45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRView", "[", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", "=", "\n", "\t\t", 
      RowBox[{"dvrOpsLookup", "[", 
       RowBox[{"ops", ",", "$dvrgr", ",", 
        RowBox[{"ChemDVRGrid", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pe", "=", "\n", "\t\t\t", 
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{"ops", ",", "\"\<PotentialEnergy\>\"", ",", "\n", "\t\t\t\t", 
          RowBox[{"ChemDVRPotentialEnergy", "[", 
           RowBox[{"obj", ",", 
            RowBox[{"$dvrgr", "\[Rule]", "g"}], ",", "ops"}], "]"}]}], 
         "]"}]}], "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"wfs", "=", "\n", "\t\t\t\t", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{
           "ops", ",", "\n", "\t\t\t\t\t", "$dvrwf", ",", "\n", "\t\t\t\t\t", 
            
            RowBox[{"ChemDVRWavefunctions", "[", 
             RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"$dvrgr", "\[Rule]", "g"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"\"\<PotentialEnergy\>\"", "\[Rule]", "pe"}], ",", "\n",
               "\t\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
           "\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"ChemDVRGet", "[", 
          RowBox[{"obj", ",", "\"\<View\>\""}], "]"}], "[", 
         RowBox[{"wfs", ",", "g", ",", "pe", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"{", "ops", "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699202363319469*^9, 3.6992023675458393`*^9}, {
   3.6992028250013866`*^9, 3.6992028317721567`*^9}, {3.699202872013734*^9, 
   3.699203011208631*^9}, 3.699203234542742*^9, {3.699212727904619*^9, 
   3.699212731496891*^9}, {3.700004724454616*^9, 3.700004724471876*^9}, {
   3.709508471689867*^9, 3.709508492976128*^9}, {3.7247981022662697`*^9, 
   3.7247981134808407`*^9}, {3.731786169113029*^9, 3.731786179575794*^9}, 
   3.732006640936161*^9},ExpressionUUID->"fa0e20f2-79bb-4dec-b848-\
ba00d5a1be3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Run\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699203074921628*^9, 
  3.699203075680646*^9}},ExpressionUUID->"48ec542e-c8b7-45cd-bc13-\
b2f10b3fe710"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRRun", "::", "badops"}], "=", 
  "\"\<Options `` aren't valid for ChemDVRRun (OptionQ failed)\>\""}]], \
"CodeInput",
 CellChangeTimes->{{3.731972157115737*^9, 
  3.7319721719939737`*^9}},ExpressionUUID->"9272731b-3c95-4e34-b82f-\
41e10cf26459"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRGetRuntimeOptions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420860018095*^9},ExpressionUUID->"da8213d9-1207-4c95-84f1-\
db674f087fab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRGetRuntimeOptions", "[", "key_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Sequence", "@@", "\n", "\t\t", 
   RowBox[{"dvrOpsLookup", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"{", "RunRuntimeOptions", "}"}], ",", " ", "\n", "\t\t\t", 
     RowBox[{"key", "<>", "\"\<Options\>\""}], ",", "\n", "\t\t\t", 
     RowBox[{"{", "RunRuntimeOptions", "}"}]}], "\n", "\t\t\t", 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.731971721095667*^9, 3.731971741997733*^9}, {
  3.731972459943149*^9, 3.731972469122239*^9}, {3.73197252901712*^9, 
  3.731972530061943*^9}},ExpressionUUID->"2a7fc280-6e69-4015-bf64-\
f3bad471dd16"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunGridWavefunctions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208626033487`*^9},ExpressionUUID->"f16a0d28-84dc-4cce-bf57-\
0bdd38d02b21"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunGridWavefunctions", "[", "obj_", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ChemDVRGridWavefunctions", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"$dvrwf", "\[Rule]", "RunWavefunctions"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrgrwf", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731865263376029*^9, 3.731865305508288*^9}, {
   3.7318653530758657`*^9, 3.731865421341365*^9}, 3.731944156681129*^9, {
   3.731971898118725*^9, 3.73197195331919*^9}, 
   3.7324208667276163`*^9},ExpressionUUID->"b7176fab-afcd-4649-b2af-\
1c1adffa5d71"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunInterpolatingWavefunctions\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7324208692026443`*^9},ExpressionUUID->"e5df2a6e-9676-4f01-97df-\
7b9506d8383a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunInterpolatingWavefunctions", "[", "obj_", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"ChemDVRInterpolatingWavefunctions", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"$dvrwf", "\[Rule]", "RunWavefunctions"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrintwf", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731865263376029*^9, 3.731865305508288*^9}, {
   3.7318653530758657`*^9, 3.731865421341365*^9}, 3.731944156681129*^9, {
   3.731971898118725*^9, 3.73197195331919*^9}, {3.7324208667276163`*^9, 
   3.732420874665475*^9}},ExpressionUUID->"bab9416a-6279-4fa2-9ac0-\
a6135924d514"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunExpectationValues\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420876842416*^9},ExpressionUUID->"caaab80e-53f5-408e-89ca-\
5b4283bd2812"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRunExpectationValues", "[", "obj_", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ChemDVRExpectationValues", "[", 
    RowBox[{"obj", ",", "\n", "\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Rest", "@", "RunEndPoint"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", ":", 
            RowBox[{"Except", "[", "_List", "]"}]}], "}"}], "\[RuleDelayed]", 
          "f"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"e_", "\[RuleDelayed]", 
          RowBox[{"Flatten", "[", "e", "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], 
      "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrwf", "\[Rule]", "RunWavefunctions"}], ",", "\n", "\t\t", 
     RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
     RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrexv", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.731865263376029*^9, 3.731865305508288*^9}, {
   3.7318653530758657`*^9, 3.731865421341365*^9}, 3.731944156681129*^9, {
   3.731971898118725*^9, 3.73197195331919*^9}, {3.7324208667276163`*^9, 
   3.732420881713443*^9}},ExpressionUUID->"b2caac88-0e22-4d9e-903a-\
a7a39082e7de"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRunOperatorMatrix\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420883642754*^9},ExpressionUUID->"1a7bd58b-6ec1-4bea-a16f-\
8055a7c1ef80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iChemDVRRunOperatorMatrix", "[", "obj_", "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemDVROperatorMatrix", "[", 
   RowBox[{"obj", ",", "\n", "\t\t", 
    RowBox[{"Replace", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Rest", "@", "RunEndPoint"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ":", 
           RowBox[{"Except", "[", "_List", "]"}]}], "}"}], "\[RuleDelayed]", 
         "f"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"e_", "\[RuleDelayed]", 
         RowBox[{"Flatten", "[", "e", "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], 
     "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
    RowBox[{"$dvrwf", "\[Rule]", "RunWavefunctions"}], ",", "\n", "\t\t", 
    RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t", 
    RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrexm", "]"}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.731865263376029*^9, 3.731865305508288*^9}, {
   3.7318653530758657`*^9, 3.731865421341365*^9}, 3.731944156681129*^9, {
   3.731971898118725*^9, 3.73197195331919*^9}, {3.7324208667276163`*^9, 
   3.732420881713443*^9}},ExpressionUUID->"7fdf74ea-54fb-4e0a-abd2-\
a50b7621f9a0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]iChemDVRRun\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.732420888067032*^9},ExpressionUUID->"71364a2d-f264-4063-8d15-\
0137d8f4ca23"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iChemDVRRun", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"RunObject", "=", "obj"}], ",", "\n", "\t\t", 
       RowBox[{"RunRuntimeOptions", "=", "\n", "\t\t\t", 
        RowBox[{"Sequence", "@@", "\n", "\t\t\t\t", 
         RowBox[{"Normal", "@", "\n", "\t\t\t\t\t", 
          RowBox[{"Merge", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"ops", ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<RuntimeOptions\>\"", ",", " ", 
                RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              
              RowBox[{"ChemDVRGet", "[", 
               RowBox[{"obj", ",", " ", "\"\<Defaults\>\"", ",", " ", 
                RowBox[{"{", "}"}]}], "]"}]}], "\n", "\t", "\t\t\t\t\t\t", 
             "}"}], ",", "\n", "\t", "\t\t\t\t\t", "First"}], "\n", "\t", 
           "\t\t\t\t\t", "]"}]}]}]}], ",", "\n", "\t\t", 
       RowBox[{"RunCheckPoint", "=", "None"}], ",", "\n", "\t\t", 
       "RunEndPoint", ",", "\n", "\t\t", 
       RowBox[{"RunRange", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunPoints", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunGrid", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunTransformation", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunKineticEnergy", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunPotentialEnergy", "=", "None"}], ",", "\n", "\t\t", 
       RowBox[{"RunWavefunctions", "=", "None"}]}], "\n", "\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"OptionQ", "[", 
          RowBox[{"{", "RunRuntimeOptions", "}"}], "]"}]}], ",", " ", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ChemDVRRun", "::", "badops"}], ",", " ", 
           "RunRuntimeOptions"}], "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\n", "\t\t\t", "]"}], 
      ";", "\n", "\t\t", 
      RowBox[{"RunEndPoint", "=", "\n", "\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{
        "RunRuntimeOptions", ",", " ", "Return", ",", " ", "\"\<View\>\""}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dvrOpsLookup", "[", 
         RowBox[{
         "RunRuntimeOptions", ",", " ", "\"\<Save\>\"", ",", " ", "False"}], 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRSave", "@", "obj"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Grid", " ", "--"}], "--"}], "--"}], "--"}]}]}]}]}]}],
         "-"}], "*)"}], "\n", "\t\t", 
      RowBox[{"RunGrid", "=", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"RunRuntimeOptions", ",", " ", "$dvrgr", ",", " ", "None"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunGrid", "===", "None"}], ",", "\n", "\t\t\t", 
        RowBox[{"RunGrid", "=", "\n", "\t\t\t\t", 
         RowBox[{"ChemDVRGrid", "[", 
          RowBox[{"obj", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrgr", "]"}]}], "\n", 
          "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "@", 
          RowBox[{"RunGrid", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
         RowBox[{"SquareMatrixQ", "@", 
          RowBox[{"RunGrid", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"SquareMatrixQ", "[", 
           RowBox[{"RunGrid", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"RunGrid", ",", " ", "RunTransformation"}], "}"}], "=", 
         "RunGrid"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrgr"}], ",", " ", 
        RowBox[{"Return", "@", "RunGrid"}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"RunCheckPoint", "=", "$dvrgr"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", " ", "Kinetic"}]}]}]}]}], " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Energy", " ", "--"}], "--"}], "--"}], "--"}]}], "-"}], 
       "*)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RunEndPoint", "=!=", "$dvrpe"}], "&&", "\n", "\t\t\t", 
         RowBox[{"!", 
          RowBox[{"ListQ", "@", 
           RowBox[{"dvrOpsLookup", "[", 
            RowBox[{
            "RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", "None"}], 
            "]"}]}]}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"RunKineticEnergy", "=", "\n", "\t\t\t\t", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{
           "RunRuntimeOptions", ",", " ", "$dvrke", ",", " ", "None"}], 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"RunKineticEnergy", "===", "None"}], ",", "\n", "\t", 
           "\t\t\t", 
           RowBox[{"RunKineticEnergy", "=", "\n", "\t", "\t\t\t\t", 
            RowBox[{"ChemDVRKineticEnergy", "[", 
             RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{
              "\"\<TransformationMatrix\>\"", "->", "RunTransformation"}], 
              ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrke", "]"}]}], 
             "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], 
         ";"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrke"}], ",", " ", 
        RowBox[{"Return", "@", "RunKineticEnergy"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"RunCheckPoint", "=", "$dvrke"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", " ", "Potential"}]}]}]}]}], " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Energy", " ", "--"}], "--"}], "--"}], "--"}]}], "-"}], 
       "*)"}], "\n", "\t\t", 
      RowBox[{"RunPotentialEnergy", "=", "\n", "\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"RunRuntimeOptions", ",", " ", "$dvrpe", ",", " ", "None"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunPotentialEnergy", "===", "None"}], ",", "\n", "\t\t\t", 
        RowBox[{"RunPotentialEnergy", "=", "\n", "\t\t\t\t", 
         RowBox[{"ChemDVRPotentialEnergy", "[", 
          RowBox[{"obj", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t\t\t\t", 
           
           RowBox[{
           "\"\<TransformationMatrix\>\"", "->", "RunTransformation"}], ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrpe", "]"}]}], "\n", 
          "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrpe"}], ",", 
        RowBox[{"Return", "@", "RunPotentialEnergy"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"RunCheckPoint", "=", "$dvrpe"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Hamiltonian", " ", "--"}], "--"}], "--"}], 
              "--"}]}]}]}]}]}], "-", "--"}], "*)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "\"\<Hamiltonian\>\""}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"RunPotentialEnergy", "+", "RunKineticEnergy"}], "]"}]}], 
       "]"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Wavefunctions", " ", "--"}], "--"}], "--"}], 
              "--"}]}]}]}]}]}], "-"}], "*)"}], "\n", "\t\t", 
      RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t", 
       RowBox[{"dvrOpsLookup", "[", 
        RowBox[{"RunRuntimeOptions", ",", " ", "$dvrwf", ",", " ", "None"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunWavefunctions", "===", "None"}], ",", "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ke", "=", "RunKineticEnergy"}], ",", " ", 
            RowBox[{"pe", "=", "RunPotentialEnergy"}]}], "}"}], ",", "\n", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"RunWavefunctions", "=", "\n", "\t\t\t\t", 
            RowBox[{"ChemDVRWavefunctions", "[", 
             RowBox[{"obj", ",", "\n", "\t\t\t\t\t", 
              RowBox[{"$dvrke", "\[Rule]", "ke"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"$dvrpe", "\[Rule]", "pe"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrwf", "]"}]}], 
             "\n", "\t\t\t\t\t", "]"}]}], ";"}]}], "\n", "\t\t\t\t", "]"}]}], 
       "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "$dvrwf"}], ",", "\n", "\t\t\t", 
        RowBox[{"Return", "@", "RunWavefunctions"}]}], "\n", "\t\t\t", "]"}], 
      ";", "\n", "\t\t", 
      RowBox[{"RunCheckPoint", "=", "$dvrwf"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Energies", " ", "--"}], "--"}], "--"}], 
              "--"}]}]}]}]}]}], "-", "--"}], "*)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"RunEndPoint", "===", "\"\<Energies\>\""}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"RunWavefunctions", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", "\n", "\t\t", 
      "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Rest", " ", "--"}], "--"}], "--"}], "--"}]}]}]}]}]}],
         "-", "--"}], "*)"}], "\n", "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{"RunEndPoint", ",", "\n", "\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"(", "\n", "\t\t\t\t\t", 
           RowBox[{
           "$dvrgr", "|", "$dvrke", "|", "$dvrpe", "|", "$dvrwf", "|", 
            "\"\<Hamiltonian\>\"", "|", "\"\<Energies\>\"", "|", "\n", 
            "\t\t\t\t\t\t", "$dvrgrwf", "|", "$dvrintwf", "|", 
            RowBox[{"{", 
             RowBox[{"$dvrexv", ",", " ", "__"}], "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"$dvrexm", ",", " ", "__"}], "}"}]}], ")"}], ".."}], 
         "\n", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "@", "RunEndPoint"}], ",", "\n", "\t",
             "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"$dvrgr", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"$dvrgr", "->", "RunGrid"}], ")"}]}], ",", "\n", "\t",
               "\t\t\t\t\t\t", 
              RowBox[{"$dvrke", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"$dvrke", "->", "RunKineticEnergy"}], ")"}]}], ",", 
              "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"$dvrpe", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"$dvrpe", "->", "RunPotentialEnergy"}], ")"}]}], ",", 
              "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"$dvrwf", "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"$dvrwf", "->", "RunWavefunctions"}], ")"}]}], ",", 
              "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"\"\<Hamiltonian\>\"", ":>", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{"\"\<Hamiltonian\>\"", "->", 
                 RowBox[{"RunPotentialEnergy", "+", "RunKineticEnergy"}]}], 
                ")"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"\"\<Energies\>\"", ":>", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{"\"\<Energies\>\"", "->", 
                 RowBox[{"RunWavefunctions", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
              "$dvrgrwf", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{"$dvrgrwf", "->", 
                 RowBox[{"iChemDVRRunGridWavefunctions", "[", "obj", "]"}]}], 
                ")"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"$dvrintwf", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{"$dvrintwf", "->", 
                 RowBox[{
                 "iChemDVRRunInterpolatingWavefunctions", "[", "obj", "]"}]}],
                 ")"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"$dvrexv", ",", " ", "__"}], "}"}], ":>", "\n", "\t", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{"$dvrexv", "->", 
                 RowBox[{"iChemDVRRunExpectationValues", "[", "obj", "]"}]}], 
                ")"}]}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"$dvrexm", ",", " ", "__"}], "}"}], ":>", "\n", "\t", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{"$dvrexm", "->", 
                 RowBox[{"iChemDVRRunOperatorMatrix", "[", "obj", "]"}]}], 
                ")"}]}]}], "\n", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t",
             "\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"o", ":", 
            RowBox[{"{", "__Rule", "}"}]}], "\[RuleDelayed]", 
           RowBox[{"Association", "[", "o", "]"}]}]}], "\n", "\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", "$dvrgrwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "  ", "Wavefunction"}]}]}]}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Grid", " ", "--"}], "--"}], "--"}], "--"}]}], "-"}], 
         "*)"}], "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunGridWavefunctions", "[", "obj", "]"}], ",", "\n", 
        "\t\t\t", "$dvrintwf", ",", "\n", "\t\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "  ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"InterpolatingWavefunctions", " ", "--"}], "--"}], 
                 "--"}], "--"}]}]}]}]}]}], "-"}], "*)"}], "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunInterpolatingWavefunctions", "[", "obj", "]"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"$dvrexv", ",", " ", "__"}], "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "  ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ExpectationValues", " ", "--"}], "--"}], "--"}], 
                "--"}]}]}]}]}]}], "-"}], "*)"}], "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunExpectationValues", "[", "obj", "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"$dvrexm", ",", " ", "__"}], "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "  ", "Operator"}]}]}]}]}], " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Matrix", " ", "--"}], "--"}], "--"}], "--"}]}], "-"}], 
         "*)"}], "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRunOperatorMatrix", "[", "obj", "]"}], ",", "\n", 
        "\t\t\t", "\"\<FullResults\>\"", ",", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ListQ", "@", "RunWavefunctions"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"<|", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<Grid\>\"", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunGrid"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", "RunGrid"}], "]"}], ",", 
               "\n", "\t\t\t\t\t\t\t\t", "RunGrid"}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"\"\<PotentialEnergy\>\"", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunPotentialEnergy"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", "RunPotentialEnergy"}], 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", "RunPotentialEnergy"}], 
              "\n", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"\"\<KineticEnergy\>\"", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunKineticEnergy"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", "RunKineticEnergy"}], 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", "RunKineticEnergy"}], 
              "\n", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"\"\<Energies\>\"", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunWavefunctions"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", 
                 RowBox[{"RunWavefunctions", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RunWavefunctions", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"\"\<Wavefunctions\>\"", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "@", "RunWavefunctions"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RawArray", "[", 
                RowBox[{"\"\<Real64\>\"", ",", " ", 
                 RowBox[{"RunWavefunctions", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"RunWavefunctions", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}]}]}], "\n", "\t\t\t\t\t\t", "|>"}]}], "\n", "\t\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", "_", ",", "\n", "\t\t\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"View", " ", "--"}], "--"}], "--"}], 
                "--"}]}]}]}]}]}], "-"}], "*)"}], "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRView", "[", 
         RowBox[{"obj", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"$dvrwf", "\[Rule]", "RunWavefunctions"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"$dvrpe", "\[Rule]", "RunPotentialEnergy"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"$dvrgr", "\[Rule]", "RunGrid"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"\"\<TransformationMatrix\>\"", "->", "RunTransformation"}],
           ",", "\n", "\t\t\t\t\t", 
          RowBox[{"iChemDVRGetRuntimeOptions", "[", "$dvrvw", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992032177917747`*^9, 3.699203262015998*^9}, {
   3.699203295626753*^9, 3.699203397745308*^9}, {3.699203461023991*^9, 
   3.699203523461934*^9}, {3.6992035903327017`*^9, 3.699203659090412*^9}, {
   3.699203791449403*^9, 3.699203793552492*^9}, {3.6992039303582087`*^9, 
   3.699203932684717*^9}, {3.69920401503767*^9, 3.699204023924644*^9}, 
   3.699204061513153*^9, {3.699204233624629*^9, 3.6992042411682053`*^9}, {
   3.699204303423398*^9, 3.699204414136359*^9}, {3.6992044867542353`*^9, 
   3.69920459188787*^9}, {3.6992046737943087`*^9, 3.699204768053973*^9}, {
   3.6992048210911427`*^9, 3.6992049227404137`*^9}, {3.699205124321416*^9, 
   3.6992051555138493`*^9}, {3.699205299842502*^9, 3.6992054266336203`*^9}, 
   3.699212277775734*^9, {3.6992123343164253`*^9, 3.699212346691283*^9}, {
   3.6992125897313337`*^9, 3.699212590425357*^9}, 3.6992127713596573`*^9, 
   3.699212824677453*^9, {3.6992134093141317`*^9, 3.6992134255029182`*^9}, 
   3.6992140327992697`*^9, {3.6993207024534187`*^9, 3.699320719384933*^9}, 
   3.699320762521163*^9, {3.6993208192120943`*^9, 3.69932086375082*^9}, {
   3.699321700834528*^9, 3.699321706975512*^9}, {3.6993218306069727`*^9, 
   3.699321848418612*^9}, 3.6993225532905607`*^9, {3.699322976604629*^9, 
   3.699322977426303*^9}, 3.6993259952890043`*^9, {3.700004724490913*^9, 
   3.70000472452376*^9}, {3.709508471717108*^9, 3.709508492993671*^9}, {
   3.7180486680685577`*^9, 3.7180489209889107`*^9}, {3.7180490146238737`*^9, 
   3.71804901463277*^9}, {3.724435931959387*^9, 3.7244359415976477`*^9}, {
   3.724436284089901*^9, 3.724436300153223*^9}, {3.7244363861249638`*^9, 
   3.724436475432324*^9}, {3.724438258323332*^9, 3.724438267716722*^9}, {
   3.724793443134077*^9, 3.724793607248292*^9}, {3.724794227959553*^9, 
   3.7247942302464123`*^9}, 3.7247943972667313`*^9, {3.724798077857821*^9, 
   3.7247980884787292`*^9}, {3.7311589126508503`*^9, 
   3.7311589244495907`*^9}, {3.731702099399558*^9, 3.731702144029365*^9}, {
   3.731703445746649*^9, 3.731703499609839*^9}, {3.731703660000887*^9, 
   3.731703662479446*^9}, {3.731703959883716*^9, 3.731704004238969*^9}, {
   3.7317041089650106`*^9, 3.731704120157454*^9}, {3.7317041527124453`*^9, 
   3.7317041531102047`*^9}, {3.731704802723484*^9, 3.73170481876898*^9}, {
   3.731704856224616*^9, 3.731704912947318*^9}, {3.7317051213523207`*^9, 
   3.7317051228221483`*^9}, {3.731705200165697*^9, 3.731705209291698*^9}, {
   3.731786090583889*^9, 3.731786110746657*^9}, {3.731786158374222*^9, 
   3.7317861861558237`*^9}, {3.731786395040366*^9, 3.7317864625189466`*^9}, {
   3.731787042373569*^9, 3.7317870682570953`*^9}, 3.731791449727706*^9, {
   3.731864578657239*^9, 3.7318646919702873`*^9}, {3.731864828000461*^9, 
   3.731864890187702*^9}, {3.731865079128347*^9, 3.731865156372787*^9}, 
   3.731865259442379*^9, {3.731865296999807*^9, 3.731865347253538*^9}, {
   3.731865380404001*^9, 3.731865387186659*^9}, {3.731865424885829*^9, 
   3.7318655753211813`*^9}, {3.7318699831465883`*^9, 
   3.7318700197091227`*^9}, {3.7318700575347557`*^9, 3.731870069499922*^9}, {
   3.731870154059067*^9, 3.731870185048505*^9}, {3.731971681401441*^9, 
   3.7319717063896847`*^9}, {3.731971738236652*^9, 3.731971854096079*^9}, {
   3.731971968841917*^9, 3.731971978951316*^9}, {3.731972023562505*^9, 
   3.73197207332652*^9}, {3.731972145278843*^9, 3.731972149544744*^9}, {
   3.731972191029357*^9, 3.731972226216835*^9}, {3.7319724167578506`*^9, 
   3.731972417754417*^9}, {3.7319724509286633`*^9, 3.73197248827509*^9}, {
   3.731972648606625*^9, 3.731972652221534*^9}, {3.732399285534478*^9, 
   3.7323993044591627`*^9}, {3.732399338399111*^9, 3.732399415485458*^9}, {
   3.732399690803557*^9, 3.732399699973838*^9}, {3.732399757535132*^9, 
   3.732399757660239*^9}, {3.732420927981739*^9, 3.732420946247279*^9}, {
   3.732516580933485*^9, 
   3.732516707808769*^9}},ExpressionUUID->"cf991749-e396-417e-94ae-\
f407430bfb5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRRun", "[", 
    RowBox[{
     RowBox[{"obj", ":", "dvrObjPattern"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Catch", "@", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", "=", 
        RowBox[{"If", "[", 
         RowBox[{"$Notebooks", ",", 
          RowBox[{"dvrOpsLookup", "[", 
           RowBox[{"ops", ",", "Monitor", ",", "False"}], "]"}], ",", 
          "False"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{"m", ",", "\n", "\t\t\t", 
        RowBox[{"Automatic", "|", "True"}], ",", "\t", "\n", "\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "Now"}], ",", 
            RowBox[{"clock", "=", 
             RowBox[{"Unique", "@", "\"\<clock$\>\""}]}]}], "}"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"iChemDVRRun", "[", 
             RowBox[{"obj", ",", "ops"}], "]"}], ",", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p", "=", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Position", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "$dvrgr", ",", "$dvrke", ",", "$dvrpe", ",", "$dvrwf"}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", "RunCheckPoint"}],
                    "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "i_", "}"}], "}"}], "\[RuleDelayed]", "i"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"_", "\[Rule]", 
                    RowBox[{"-", "1"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t", 
                   "}"}]}], "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"Panel", "@", 
               RowBox[{"Grid", "[", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Time Elapsed:\>\"", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "4"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"clock", ";", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"Now", "-", "start"}], ",", ".02"}], "]"}]}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Invisible", "@", 
                    RowBox[{"Pane", "[", 
                    RowBox[{
                    RowBox[{"Animator", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "@", "clock"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", ".1"}], "}"}], ",", "1"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "5"}], "}"}]}], "]"}]}]}], "}"}]}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Now", "-", "start"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Grid:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "1"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}], ",", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Kinetic Energy:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "2"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}], ",", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Potential Energy:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "3"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}], ",", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Wavefunctions:\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "<", "4"}], ",", "\"\<\[EmptySquare]\>\"", 
                    ",", "\"\<\[CheckmarkedBox]\>\""}], "]"}]}], "}"}]}], 
                  "\n", "\t", "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"Alignment", "\[Rule]", "Left"}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", "_Function", ",", "\n", "\t\t\t\t", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"iChemDVRRun", "[", 
           RowBox[{"obj", ",", "ops"}], "]"}], ",", 
          RowBox[{"m", "@", "RunCheckPoint"}]}], "]"}], ",", "\n", "\t\t\t", 
        "_", ",", "\n", "\t\t\t\t", 
        RowBox[{"iChemDVRRun", "[", 
         RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
     "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ChemDVRRun", "[", 
     RowBox[{
      RowBox[{"obj", ":", "dvrObjPattern"}], ",", "\n", "\t", 
      RowBox[{"ret", ":", "\n", "\t\t", 
       RowBox[{
       "$dvrke", "|", "$dvrpe", "|", "$dvrwf", "|", "\n", "\t\t\t", "$dvrgr", 
        "|", "$dvrgrwf", "|", "$dvrintwf"}]}], ",", "\n", "\t", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
    "\n", "\t", 
    RowBox[{"ChemDVRRun", "[", "\n", "\t\t", 
     RowBox[{"obj", ",", "\n", "\t\t", 
      RowBox[{"Return", "\[Rule]", "ret"}], ",", "\n", "\t\t", "ops"}], "\n", 
     "\t\t", "]"}]}], "*)"}]}]}], "CodeInput",
 CellChangeTimes->{{3.699205433951889*^9, 3.699205788251836*^9}, {
   3.699213848275215*^9, 3.699213911819869*^9}, {3.699213946388775*^9, 
   3.6992139627730427`*^9}, {3.699214040051881*^9, 3.699214040998678*^9}, {
   3.699232502311946*^9, 3.699232525652507*^9}, {3.6993239559787483`*^9, 
   3.699323971591793*^9}, {3.6993242697297897`*^9, 3.699324321844657*^9}, {
   3.699324685031756*^9, 3.6993246883576393`*^9}, {3.69932473545464*^9, 
   3.699324735995984*^9}, {3.700004724541155*^9, 3.7000047245552387`*^9}, 
   3.707076348563538*^9, {3.7095084717748203`*^9, 3.709508493012377*^9}, {
   3.719869513605652*^9, 3.719869514372237*^9}, {3.7292525476476297`*^9, 
   3.72925265535778*^9}, {3.731703668127626*^9, 3.7317036770989857`*^9}, {
   3.731786169209524*^9, 3.731786186166882*^9}, {3.731786378161098*^9, 
   3.7317863940986853`*^9}},ExpressionUUID->"4f751eef-826d-4ae2-b5de-\
783aa1910291"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PackageAddAutocompletions", "[", "\n", "\t", 
   RowBox[{"ChemDVRRun", ",", "\n", "\t", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"None", ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
       "$dvrke", ",", " ", "$dvrpe", ",", " ", "$dvrwf", ",", "\n", "\t\t\t", 
        "$dvrgr", ",", " ", "$dvrgrwf", ",", " ", "$dvrintwf"}], "\n", 
       "\t\t\t", "}"}]}], "\n", "\t\t", "}"}]}], "\n", "\t", "]"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.7292526878326817`*^9, 
  3.729252722959811*^9}},ExpressionUUID->"141af66c-0d04-430f-90aa-\
67026cba1e09"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Notebook\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992164115355043`*^9, 
  3.699216412743689*^9}},ExpressionUUID->"b6375e8d-b58e-400c-bc15-\
b7c008a5c38b"],

Cell[BoxData[
 RowBox[{"ChemDVRNotebook", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.725750804339913*^9, 
  3.725750805168111*^9}},ExpressionUUID->"1a697234-c53b-4e79-a536-\
c9952d7c89bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRNotebook", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<SaveObject\>\"", "\[Rule]", "True"}], "\n", "\t\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "Notebook"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRNotebook", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"obj", ":", "dvrObjPattern"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"so", "=", 
      RowBox[{"OptionValue", "[", "\"\<SaveObject\>\"", "]"}]}], "\n", 
     "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"so", ",", "\n", "\t\t\t", 
       RowBox[{"ChemDVRSave", "@", "obj"}]}], "\n", "\t\t\t", "]"}], ";", 
     "\n", "\t\t", 
     RowBox[{"CreateDocument", "@", "\n", "\t\t\t", 
      RowBox[{"Notebook", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"First", "@", "\n", "\t", "\t\t\t\t", 
         RowBox[{"Get", "[", 
          RowBox[{"PackageFilePath", "[", 
           RowBox[{
           "\"\<Resources\>\"", ",", " ", "\"\<Templates\>\"", ",", " ", 
            "\"\<DVRNotebook.nb\>\""}], "]"}], "]"}]}], ",", "\n", "\t", 
        "\t\t\t", 
        RowBox[{"FilterRules", "[", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"ops", ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"WindowTitle", "\[Rule]", 
             RowBox[{"ChemDVRGet", "[", 
              RowBox[{"obj", ",", "\"\<UUID\>\""}], "]"}]}]}], "\n", "\t", 
           "\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"Options", "@", "Notebook"}]}], "\n", "\t", "\t\t\t\t", 
         "]"}]}], "\n", "\t", "\t\t\t", "]"}]}]}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6992164140005836`*^9, 3.6992164502732773`*^9}, {
   3.699216543161448*^9, 3.6992165757947474`*^9}, {3.69921702949203*^9, 
   3.699217119965397*^9}, {3.6992171652019577`*^9, 3.6992177523990793`*^9}, {
   3.6992178364829493`*^9, 3.699217870403246*^9}, {3.6992179315570993`*^9, 
   3.699218068469788*^9}, {3.699313762968474*^9, 3.699313806540395*^9}, {
   3.6993139255650883`*^9, 3.69931392578755*^9}, {3.700004724573234*^9, 
   3.7000047246249228`*^9}, 3.709508493025963*^9, {3.725750774614238*^9, 
   3.7257508124228277`*^9}, {3.725751085594125*^9, 3.7257511565373287`*^9}, {
   3.725751550408649*^9, 3.725751610074643*^9}, {3.725751644339746*^9, 
   3.725751686621216*^9}},ExpressionUUID->"d8de4986-047f-42cc-839b-\
bfcfb9bcc0e3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OOP Interface\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.711059468448546*^9, 3.711059470712175*^9}, {
  3.727732155572032*^9, 
  3.727732158730432*^9}},ExpressionUUID->"a8d8cd6b-d076-4306-a4e0-\
3971cd9348be"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Call\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.73178728951991*^9, 
  3.731787289902672*^9}},ExpressionUUID->"6e5b44d8-ea0b-43b6-bc08-\
ea2bc254b869"],

Cell[BoxData[
 RowBox[{"$dvrBasicKeys", "=", "\n", "\t", 
  RowBox[{
  "$dvrgr", "|", "$dvrpe", "|", "$dvrke", "|", "\n", "\t\t", "$dvrwf", "|", 
   "$dvrgrwf", "|", "$dvrintwf", "|", "\"\<Hamiltonian\>\"", "|", 
   "\"\<Energies\>\"", "|", "\"\<FullResults\>\""}]}]], "CodeInput",
 CellChangeTimes->{{3.731702846767716*^9, 3.731702900711887*^9}, 
   3.7317860905900497`*^9, {3.731786158385253*^9, 3.7317861861743317`*^9}, 
   3.7317863941048098`*^9, {3.731864772362146*^9, 3.731864775829237*^9}, {
   3.7325167423863792`*^9, 
   3.732516749680912*^9}},ExpressionUUID->"4f13f9a1-6387-451c-abd2-\
2143208b843e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRObject", "[", 
     RowBox[{"uuid_", "?", "chemDVRValidQ"}], "]"}], "[", 
    RowBox[{"a___", "?", "OptionQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRRun", "[", 
    RowBox[{
     RowBox[{"ChemDVRObject", "[", "uuid", "]"}], ",", "a"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{
     RowBox[{"k", ":", "$dvrBasicKeys"}], ",", " ", 
     RowBox[{"args___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRRun", "[", 
    RowBox[{"obj", ",", " ", 
     RowBox[{"Return", "\[Rule]", "k"}], ",", " ", "args"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{
     RowBox[{"k", ":", 
      RowBox[{"$dvrexv", "|", "$dvrexm"}]}], ",", " ", "\n", "\t\t", 
     RowBox[{"efuns", ":", 
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}]}], ",", " ", 
     RowBox[{"args___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRRun", "[", 
    RowBox[{"obj", ",", " ", 
     RowBox[{"Return", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"k", ",", " ", "efuns"}], "}"}]}], ",", " ", "args"}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    "\"\<Properties\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Keys", "@", 
    RowBox[{"ChemDVRAssociation", "[", "obj", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    "\"\<Association\>\"", "]"}], ":=", "\n", "\t", 
   RowBox[{"Keys", "@", 
    RowBox[{"ChemDVRAssociation", "[", "obj", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{"k", ":", 
     RowBox[{
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{"obj", ",", " ", "k"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRObject", "/:", "\n", "\t", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"obj", ":", 
      RowBox[{"_ChemDVRObject", "?", "chemDVRValidQ"}]}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"k", ":", 
      RowBox[{
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "]"}], ":=", 
   "\n", "\t\t", 
   RowBox[{"ChemDVRGet", "[", 
    RowBox[{"obj", ",", " ", "k"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.711059471254497*^9, 3.711059593424692*^9}, {
   3.715976224947933*^9, 3.715976228536435*^9}, {3.715976743508663*^9, 
   3.715976769775591*^9}, {3.715976814311968*^9, 3.7159768193790913`*^9}, {
   3.715976869389058*^9, 3.7159768839972363`*^9}, {3.71604052823193*^9, 
   3.716040530566181*^9}, {3.716045598988353*^9, 3.716045616178789*^9}, {
   3.718049011712675*^9, 3.718049011717945*^9}, {3.727732059366169*^9, 
   3.727732152006884*^9}, {3.727732198002253*^9, 3.72773222851462*^9}, {
   3.7277323709033117`*^9, 3.7277323750307817`*^9}, {3.731433565166134*^9, 
   3.731433613998336*^9}, 3.7317022018307667`*^9, {3.73170282210918*^9, 
   3.731702845043398*^9}, {3.731702905661354*^9, 3.731702930432407*^9}, {
   3.731786110753549*^9, 3.731786110759338*^9}, {3.731787299597692*^9, 
   3.731787310217435*^9}},ExpressionUUID->"ce6292b3-9e8c-492e-a319-\
e7edc3dd1dd2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Mutate\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731787281343988*^9, 
  3.731787283718527*^9}},ExpressionUUID->"e0f0ad4a-4252-46ce-bc09-\
d941b1947e24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ChemDVRObjMutate", "//", "ClearAll"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRObjMutate", "~", "SetAttributes", "~", "HoldAllComplete"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$ChemDVROneArgMutators", "=", "\n", "\t", 
   RowBox[{
   "Set", "|", "SetDelayed", "|", "TimesBy", "|", "DivideBy", "|", "AddTo", 
    "|", "SubtractFrom", "|", "\n", "\t\t", "PrependTo", "|", "AppendTo", "|",
     "AssociateTo", "|", "KeyDropFrom"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$ChemDVRBaseNoArgMutators", "=", "\n", "\t", 
   RowBox[{"Increment", "|", "Decrement"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemDVRObject", "/:", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", ":", 
      RowBox[{"Set", "|", "SetDelayed"}]}], ")"}], "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"obj_ChemDVRObject", "?", "chemDVRValidQ"}], "[", 
      RowBox[{"k", ":", 
       RowBox[{
        RowBox[{"Except", "[", 
         RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], ",", "\n", 
     "\t", "v_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRMutate", "[", 
    RowBox[{
     RowBox[{"obj", "[", "k", "]"}], ",", " ", "m", ",", " ", "v"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"oneArgs", "=", "$ChemDVROneArgMutators"}], ",", " ", 
      RowBox[{"noArg", "=", "$ChemDVRNoArgMutators"}]}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "oneArgs"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"obj", ":", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
             "chemDVRValidQ"}]}], ")"}], "[", 
          RowBox[{"k", ":", 
           RowBox[{
            RowBox[{"Except", "[", 
             RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], ",", "\n",
          "\t", "\t\t", "a_"}], "\n", "\t", "\t\t", "]"}], "\n", "\t\t", 
       "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", "k", "]"}], ",", " ", "m", ",", " ", "a"}], 
         "]"}]}], "\n", "\t\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "oneArgs"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"obj", ":", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
             "chemDVRValidQ"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"k", ":", 
            RowBox[{
             RowBox[{"Except", "[", 
              RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "]"}], 
         ",", "\n", "\t", "\t\t", "a_"}], "\n", "\t", "\t\t", "]"}], "\n", 
       "\t\t", "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", " ", "m", ",", " ", "a"}], 
         "]"}]}], "\n", "\t\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "noArg"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
            "chemDVRValidQ"}]}], ")"}], "[", 
         RowBox[{"k", ":", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "\n", "\t",
         "\t\t", "]"}], "\n", "\t\t", "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", "k", "]"}], ",", " ", "m"}], "]"}]}], "\n", 
       "\t\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"ChemDVRObjMutate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", ":", "noArg"}], ")"}], "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"obj", ":", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"_Symbol", "|", "_ChemDVRObject"}], ")"}], "?", 
            "chemDVRValidQ"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"k", ":", 
           RowBox[{
            RowBox[{"Except", "[", 
             RowBox[{"_", "?", "OptionQ"}], "]"}], ".."}]}], "]"}], "]"}], 
        "\n", "\t", "\t\t", "]"}], "\n", "\t\t", "]"}], ":=", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"o", "=", "obj"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"ChemDVRMutate", "[", 
         RowBox[{
          RowBox[{"o", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", " ", "m"}], "]"}]}], "\n", 
       "\t\t\t", "]"}]}], ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.727732153253992*^9, 3.727732195962308*^9}, {
  3.727732236991886*^9, 3.727732328282538*^9}, {3.72773238782777*^9, 
  3.727732394239332*^9}, {3.727732696691856*^9, 3.7277327781747637`*^9}, {
  3.727732856958026*^9, 3.727732901948389*^9}, {3.727746201440668*^9, 
  3.727746271519067*^9}, {3.727746313224814*^9, 3.7277463417970667`*^9}, {
  3.727746678860036*^9, 3.7277466801765203`*^9}, {3.727748592051979*^9, 
  3.727748605406838*^9}, {3.7277489603112164`*^9, 
  3.727749062613564*^9}},ExpressionUUID->"9720f9bf-46ab-4aa3-b867-\
8db86a85c5dc"],

Cell[BoxData[
 RowBox[{"Language`SetMutationHandler", "[", 
  RowBox[{"ChemDVRObject", ",", " ", "ChemDVRObjMutate"}], "]"}]], "CodeInput",
 CellChangeTimes->{{3.727732352529777*^9, 
  3.727732360933573*^9}},ExpressionUUID->"d293b01f-3f5d-464d-a4b0-\
c22cb7adc485"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Formatting\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699197077686358*^9, 
  3.699197078654756*^9}},ExpressionUUID->"96625e5d-36f5-479b-a1de-\
695a383d52c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$dvrimg", "=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"First", "@", "#"}], ",", "\n", "\t\t", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"28", ",", "28"}], "}"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", "\n", "\t\t\t", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], "\n",
         "\t\t\t", "}"}]}], "\n", "\t\t", "]"}], "&"}], "@", 
    GraphicsBox[{{}, GraphicsComplexBox[CompressedData["
1:eJyNlX9U1FUaxkcG0URwgOGHlAZEQo2CRDJSxL3ZGmKKYGAJJ8QfC5qQiBUh
GiCT0KqkOFPEGgrrUVNEMcWxjn2vpSuBBexqWMjuRIMiooiASqAG973v3X/X
g4fz5Z577/u+93mej/eyNQv/aqNSqWqH/4/8zju9/O2kbg+mV46qftk9imz/
cuQvHqz+sG15eI8j2WXarUlpd2fpEdNX72z2JAf4Bne2d5zHUK2NH6lJaxn+
cWN+ppYvcj4MJmcXDzy2dpEbc7I0r1AtpKRxtvtb7za5soDyxlm6Ua+R1qAZ
RzPnubJZi7+3n6hdRLomva7OPq9llmL1H+U/LyV/DO/+cJaW9RjtrLEbUond
3aLhilxY4riOWkvW+8S5rXLIMNOFLXeyjM7fnEe8fqpbUPiVMyv/Ke1GgM0W
Evh1R8WWAGeWbLyeMLjdSML2jZzgxCIzCyZd6S0jc4p9I4t9ndjh9bmF+bb7
yfBlIy2yic9FfT2/8yhZMTyNEk8NW+Xvs7Roh5lYRq7TTWAzrg5+cKn8DBn5
It6OjM6urjDa/EA8hrub7e7Afrzw1KG4gibC23MYzzwOVv67K+Iymesw0qE9
61sxdfqGMgtZ2e43MiLWqX/MJiH7Ksnn8x/Lkha9s3vQ4ZaY9xhm3hlQ+MKv
veQEn68da/2c7lPdGBDzHM3O5rxWqDWr6C0+P1v2Q+/WdR3Ro+kYPi81uz7e
kpXQMo7CfGzYGHWCOcysoTCPUSxUa7ZuLtbSN3j/KnYn98FLZ9QTKfT7SImq
OZlw0XEy1fL+HiieM8+X7b3sTefwfgYVVcNbzc/2+NJcXv99pXVu9iFNpD89
yuu9qxzLflJXdVFHrby+PmXlDS+lzBAo6rmjhNdZAx5WBNFYfv9t5cql/2xL
ywumGn7fTSXoXKpuU8wM+gE/v0OxSZxc9J6dnlr4eVZlndORtuSdM+mbfL9F
mVcYcGXgRqio57Jypi9x2oDti5Ty9UYlxPecpucifjPl6X+o59fEhlGV+JfZ
sDykISeM5sI6SRbrSbCfNIj9e+B8cqofzod1C/n0Y7hfNZnXR/qdoT6op4N8
tgTq94L+iPJP6A/qv03im6F/f5gPOVQP87kN8yPWmzA/BvMlxzfCfMX8ybZ5
MP9oeB+S0QjvA/p8QKJD4f064H1JnBneF+5XUdMmeH8K+qDfuYI+fEE/1McW
9CP0RRc6gr66QX/Usx/0J/RJ7fJAn2bQL239O+hX6JsaTKBvA+if2i8G/Qt/
0NUzwR/Qjz1NTAb/CH/RpyvBXxPBf7StDvwn/EmNL4M/reBfur8d/Cv8TU95
g7+hfw0dCAT/z4V8oD5bIB/CIT9o2XuQH9MhX6i2FPIF5uNMQ8yQP1rIJ6pp
+S/Pp7GQX/RqwzWeXyLf6G+XRvN8A/9q6dsE8s8C+UgbJ0M+XoT8pC5l/+L5
KfKVakJbeL7CfN3oGmMbz9+DkM80K13H87kM8puW+KTw/Bb5TtfdieT5DvP3
oMcy7vH8Rx6cDPvojVGWWMmDHZccz7sULZU82HrymmndlDTJg+Om1JZSa6bk
QXeKOUYfly95cHlsVVtgW5HkQeXvhqvzF5dIHvxlzdyzpjsVkgc6h5i2I56H
JQ+6/Lwz9BNqJA8mxS5paMphkgeblzxz3xBfK3nQnt/yyolvmiQPTtU4pIev
/0XyYEOz/9IahzbJgwNJxhcWhF2XPFg1ffvBcyt6JA8ineP/tmbvPcmD/vrV
335S9Ujy4GyXfpuhy5YiD1K1xzSlYfYUebBsj1+1PtOJIg8K1K1ZMRo3ijxI
HzKETMh4nCIPNs55uDX3Ry+KPOg6tCorLtyXIg9Mae2urw75od/Y+rStGVdu
6SQPNqYpG0/1BkoeBL9Zr5vfHSR5EOWaXud7OljyoHRPnTl69gzJg86oV4w/
p4T8jwdTU3d12eolDyblLE/JeRQieTDL54vm+yRE8qA/Xr/W/uTzkgefPrl3
amjSc5IHjjU77LYXBEgeVIw3vXyie4rkwb3oae7n856QPCj2rHrRuFYtecA2
VWtKvdQMedBneKn24etPMOTBYLJPWeh3UxjywD6ix//IhACGPPg8vKpvU2MQ
Qx7UJzZWXysKZsiDkGUXdnZOeZ4hD26KdeTBb2I/8mBInI888F0J9yMPnAug
PuRB/GaoH3nQ5w79IQ+WiP6RB/vEfJAHU8X8kAcHxHyRB71i/siDKPE+yIMI
8X7Ig2zxvsgDjwXw/siD00IfyINkoR/kQYTQF/IgX+gPeRAn9Ik8iBX6RR4c
FPpGHlChf+TBzUHwB/LAU/gHeaAS/kIeNLqA/5AHlcKfyINdF8C/yIPfhb+R
B2eE/5EHnyyDfEAe5P8K+YE8aPoG8gV5sN8A+YM8cBH5hDwYtxDyC3lQ7wb5
hjzwG4rm+Yc8KImBfEQeRJdAfiIPEs2Heb4iD9pdIH+RB2vfX83zGXlQXWXl
+Y08ePX4eJ7vyIPCojye/9Ny7GPvPuxU0BdF8E3wG3mB37j//13/E/+FsGQ=

       "], {{{}, 
         {RGBColor[
          0.21020243862087418`, 0.47802869583858715`, 0.802198107305176], 
          Opacity[0.25], EdgeForm[None], 
          GraphicsGroupBox[
           PolygonBox[{{1, 199, 200, 97, 96, 95, 94, 93, 92, 91, 90, 89, 88, 
            87, 86, 85, 84, 83, 82, 81, 80, 79, 78, 77, 76, 75, 74, 73, 72, 
            71, 70, 69, 68, 67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 
            55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 
            39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 
            23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 
            6, 5, 4, 3, 2}}]]}, 
         {RGBColor[0., 0.5478609782372904, 0.4891696614045123], Opacity[0.25],
           EdgeForm[None], 
          GraphicsGroupBox[
           PolygonBox[{{196, 195, 140, 141, 142, 143, 144, 145, 146, 147, 148,
             149, 150, 151, 152}}]]}, 
         {RGBColor[0., 0.5478609782372904, 0.4891696614045123], Opacity[0.25],
           EdgeForm[None], 
          GraphicsGroupBox[
           PolygonBox[{{196, 198, 194, 193, 192, 191, 190, 189, 188, 187, 186,
             185, 184, 183, 182, 181, 180, 179, 178, 177, 176, 175, 174, 173, 
            172, 171, 170, 169, 168, 167, 166, 165, 164, 163, 162, 161, 160, 
            159, 158, 157, 156, 155, 154, 153}, {98, 197, 195, 139, 138, 137, 
            136, 135, 134, 133, 132, 131, 130, 129, 128, 127, 126, 125, 124, 
            123, 122, 121, 120, 119, 118, 117, 116, 115, 114, 113, 112, 111, 
            110, 109, 108, 107, 106, 105, 104, 103, 102, 101, 100, 
            99}}]]}, {}, {}, {}, {}, {}, {}}, {{}, {}, 
         {RGBColor[
          0.21020243862087418`, 0.47802869583858715`, 0.802198107305176], 
          PointSize[0.01388888888888889], Thickness[Tiny], 
          LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
           18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
            35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 
           51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
            68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 
           84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97}]}, 
         {RGBColor[0., 0.5478609782372904, 0.4891696614045123], PointSize[
          0.01388888888888889], Thickness[Tiny], 
          LineBox[{98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 
           110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 
           123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 
           136, 137, 138, 139, 195, 140, 141, 142, 143, 144, 145, 146, 147, 
           148, 149, 150, 151, 152, 196, 153, 154, 155, 156, 157, 158, 159, 
           160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 
           173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 
           186, 187, 188, 189, 190, 191, 192, 193, 
           194}]}}}], {}, {}, {{}, {}}, {{}, {}}},
     PlotStyle -> {
       Directive[
        RGBColor[
        0.21020243862087418`, 0.47802869583858715`, 0.802198107305176], 
        Thickness[Tiny]], 
       Directive[
        RGBColor[0., 0.5478609782372904, 0.4891696614045123], 
        Thickness[Tiny]]},
     Filling -> {1 -> {Axis, 
         Directive[
          RGBColor[
          0.21020243862087418`, 0.47802869583858715`, 0.802198107305176], 
          Opacity[0.25]]}, 2 -> {Axis, 
         Directive[
          RGBColor[0., 0.5478609782372904, 0.4891696614045123], 
          Opacity[0.25]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->None,
     AxesLabel->{None, None},
     AxesOrigin->{0, 0},
     DisplayFunction->Identity,
     Frame->{{False, False}, {False, False}},
     FrameLabel->{{None, None}, {None, None}},
     FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
     GridLines->{None, None},
     GridLinesStyle->Directive[
       GrayLevel[0.5, 0.4]],
     ImagePadding->All,
     Method->{"ShrinkWrap" -> True},
     PlotRange->Automatic,
     PlotRangeClipping->True,
     PlotRangePadding->{{
        Scaled[0.02], 
        Scaled[0.02]}, {0, 0}},
     Ticks->{Automatic, Automatic}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.707251191982739*^9, 3.707251196050308*^9}, {
   3.707496206337078*^9, 3.7074962100495*^9}, {3.707496273654303*^9, 
   3.7074963834917583`*^9}, {3.707496554894594*^9, 3.7074965564345922`*^9}, {
   3.707505123899651*^9, 3.707505173631956*^9}, 3.7075052752039948`*^9, 
   3.70750575182206*^9},ExpressionUUID->"ea9290b7-d9b3-4821-9183-\
435a9d1512c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"obj", ":", 
     RowBox[{"dvrObjPattern", "?", "chemDVRValidQ"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"RawBoxes", "@", "\n", "\t\t", 
    RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t\t", 
     RowBox[{
     "\"\<ChemDVRObject\>\"", ",", "\n", "\t\t\t", "obj", ",", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"ChemDVRGet", "[", 
         RowBox[{"obj", ",", "\"\<Icon\>\""}], "]"}], ",", 
        RowBox[{"_Missing", "\[Rule]", "$dvrimg"}]}], "]"}], ",", "\n", 
      "\t\t\t\t", 
      RowBox[{"{", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{"BoxForm`MakeSummaryItem", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Name: \>\"", ",", 
            RowBox[{"ChemDVRGet", "[", 
             RowBox[{"obj", ",", "\"\<Name\>\""}], "]"}]}], "}"}], ",", 
          "StandardForm"}], "]"}], ",", "\n", "\t", "\t", "\t\t\t", 
        RowBox[{"BoxForm`MakeSummaryItem", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<UUID: \>\"", ",", 
            RowBox[{"ChemDVRGet", "[", 
             RowBox[{"obj", ",", "\"\<UUID\>\""}], "]"}]}], "}"}], ",", 
          "StandardForm"}], "]"}]}], "\n", "\t", "\t\t\t\t", "}"}], ",", "\n",
       "\t\t\t", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$ContextPath", "=", 
          RowBox[{"{", "\"\<System`\>\"", "}"}]}], "}"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"Map", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"BoxForm`MakeSummaryItem", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{"#", ",", "\"\<: \>\""}], "}"}]}], ",", 
               RowBox[{"ChemDVRGet", "[", 
                RowBox[{"obj", ",", "#"}], "]"}]}], "}"}], ",", 
             "StandardForm"}], "]"}], "&"}], ",", 
          RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t", 
           RowBox[{
           "\"\<Range\>\"", ",", "\n", "\t", "\t\t\t\t\t", "\"\<Points\>\"", 
            ",", "\n", "\t\t\t\t\t\t", "$dvrgr", ",", "\n", "\t\t\t\t\t\t", 
            "$dvrke", ",", "\n", "\t\t\t\t\t\t", "$dvrpe", ",", "\n", 
            "\t\t\t\t\t\t", "$dvrwf"}], "\n", "\t\t\t\t\t", "}"}]}], "]"}]}], 
       "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "StandardForm"}], "\n", 
     "\t\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{"\t\t"}]}], "CodeInput",
 CellChangeTimes->{{3.699197080424842*^9, 3.69919708256737*^9}, {
   3.699198012647122*^9, 3.6991981721670637`*^9}, {3.699200987876966*^9, 
   3.699200987885203*^9}, {3.69921129977078*^9, 3.699211303876851*^9}, {
   3.699211360140952*^9, 3.699211366241783*^9}, {3.699211682838338*^9, 
   3.6992116832193327`*^9}, {3.6993079789800453`*^9, 3.699307994944398*^9}, {
   3.699308123375321*^9, 3.699308125764616*^9}, {3.7000047246360826`*^9, 
   3.700004724646934*^9}, {3.70725120833272*^9, 3.7072512136499023`*^9}, {
   3.707505374359499*^9, 3.70750538683698*^9}, {3.709482788399013*^9, 
   3.709482799812724*^9}, 3.709508493034738*^9, {3.715976278260483*^9, 
   3.715976294009515*^9}, {3.7317861692257767`*^9, 3.7317861861842327`*^9}, 
   3.7317863941114197`*^9},ExpressionUUID->"bbe07467-5b8a-4157-ba3a-\
7a5978392431"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRClass\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992013685372677`*^9, 3.699201369665763*^9}, 
   3.7000047246717587`*^9},ExpressionUUID->"cd405eee-c106-472e-9066-\
e5abf9b2f27f"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ChemDVRClass\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.731158896147128*^9, 
  3.73115889817822*^9}},ExpressionUUID->"a8fa74c8-80f2-4785-99ed-\
d7c637a11190"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClasses", "[", 
    RowBox[{"pat_:", "\"\<*\>\""}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Map", "[", "\n", "\t\t", 
    RowBox[{"FileBaseName", ",", "\n", "\t\t", 
     RowBox[{"Join", "@@", "\n", "\t\t\t", 
      RowBox[{"Map", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"FileNames", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"StringQ", "@", "pat"}], ",", 
              RowBox[{"StringTrim", "[", 
               RowBox[{"pat", ",", "\"\<.m\>\""}], "]"}], ",", "pat"}], "]"}],
             "~~", "\"\<.m\>\""}], ",", "\n", "\t\t\t\t\t", "#"}], "\n", 
          "\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemDVRDirectory", "[", 
         RowBox[{"\"\<Classes\>\"", ",", " ", "True"}], "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.709512818860159*^9, 3.709512904310858*^9}, {
   3.721165283898944*^9, 3.7211652909758873`*^9}, {3.721165499283287*^9, 
   3.721165528224895*^9}, 
   3.721165652969666*^9},ExpressionUUID->"4a2efc6d-a9a0-4a64-99eb-\
e1bf97addddd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"PackageAddAutocompletions", "[", "\n", "\t", 
    RowBox[{"\"\<ChemDVRClass\>\"", ",", "\n", "\t", 
     RowBox[{"List", "@", 
      RowBox[{"ChemDVRClasses", "[", "]"}]}]}], "\n", "\t", "]"}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.7095129727847424`*^9, 3.709513006801633*^9}, 
   3.7180486389708643`*^9, {3.7244347585318604`*^9, 3.724434772006802*^9}, {
   3.724434833670721*^9, 
   3.7244348432885036`*^9}},ExpressionUUID->"e913c1ad-8942-4f52-bcab-\
30e94d221336"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Loading\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699206374321762*^9, 
  3.6992063786640043`*^9}},ExpressionUUID->"f0fdc303-979b-463f-9708-\
548b0bba5f07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClass", "::", "noclass"}], "=", 
   "\"\<No class template found at ``\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClass", "[", 
    RowBox[{"f_String", "?", 
     RowBox[{"(", "FileExistsQ", ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", "=", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ExpandFileName", "[", "f", "]"}], "==", "\n", "\t\t\t\t", 
          RowBox[{"ExpandFileName", "@", 
           RowBox[{"ChemDVRFile", "[", 
            RowBox[{"\"\<Classes\>\"", ",", 
             RowBox[{"FileNameTake", "@", "f"}]}], "]"}]}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"ChemDVRNeeds", "@", 
          RowBox[{"FileBaseName", "@", "f"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"ChemDVRNeeds", "@", "f"}]}], "\n", "\t\t\t", "]"}]}], "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AssociationQ", "@", "a"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ExpandFileName", "[", "f", "]"}], "==", "\n", "\t\t\t\t\t", 
          RowBox[{"ExpandFileName", "@", 
           RowBox[{"ChemDVRFile", "[", 
            RowBox[{"\"\<Classes\>\"", ",", 
             RowBox[{"FileNameTake", "@", "f"}]}], "]"}]}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"ChemDVRClass", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"a", ",", 
            RowBox[{"\"\<Class\>\"", "->", 
             RowBox[{"FileBaseName", "@", "f"}]}]}], "]"}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"ChemDVRClass", "[", "a", "]"}]}], "\n", "\t\t\t\t", "]"}], 
       ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ChemDVRClass", "::", "noclass"}], ",", "f"}], "]"}], ";", 
        "$Failed"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClass", "[", 
    RowBox[{"f_String", "?", 
     RowBox[{"(", 
      RowBox[{"Not", "@*", "FileExistsQ"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "@", "#"}], ",", "\n", "\t\t\t", 
        RowBox[{"ChemDVRClass", "@", "#"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"ChemDVRClass", "::", "noclass"}], ",", "#"}], "]"}], ";", 
         "$Failed"}]}], "]"}], ")"}], "&"}], "@", "\n", "\t\t", 
    RowBox[{"ChemDVRFile", "[", 
     RowBox[{"\"\<Classes\>\"", ",", 
      RowBox[{
       RowBox[{"StringTrim", "[", 
        RowBox[{"f", ",", "\"\<.m\>\""}], "]"}], "<>", "\"\<.m\>\""}]}], 
     "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699211140490896*^9, 3.6992111505307627`*^9}, {
   3.6992112113360863`*^9, 3.699211241841501*^9}, 3.699211325626377*^9, {
   3.6992163082539988`*^9, 3.699216310187002*^9}, 3.699240188059278*^9, {
   3.699307401370687*^9, 3.699307505366496*^9}, {3.699307540479054*^9, 
   3.69930759996637*^9}, {3.699307804462592*^9, 3.6993078095787783`*^9}, {
   3.700004724694887*^9, 
   3.7000047247380533`*^9}},ExpressionUUID->"152253d0-81ab-4b07-9050-\
ae6ce36e7367"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Instantiation\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992063801513577`*^9, 
  3.69920638455215*^9}},ExpressionUUID->"1a8ac439-c302-4a08-b4c1-\
3cc7acc3e69d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "a_Association", "]"}], "[", "ops___Rule", 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemDVRCreate", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"a", ",", 
      RowBox[{"<|", "ops", "|>"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "a_Association", "]"}], "[", 
    RowBox[{"range", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "a", "]"}], "[", 
    RowBox[{"\"\<Range\>\"", "\[Rule]", "range"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "a_Association", "]"}], "[", 
    RowBox[{"points", ":", 
     RowBox[{"{", 
      RowBox[{"__Integer", "?", "Positive"}], "}"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "a", "]"}], "[", 
    RowBox[{"\"\<Points\>\"", "\[Rule]", "points"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "a_Association", "]"}], "[", "\n", "\t", 
    RowBox[{
     RowBox[{"points", ":", 
      RowBox[{"{", 
       RowBox[{"__Integer", "?", "Positive"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"range", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"ChemDVRClass", "[", "a", "]"}], "[", 
    RowBox[{
     RowBox[{"\"\<Points\>\"", "\[Rule]", "points"}], ",", 
     RowBox[{"\"\<Range\>\"", "\[Rule]", "range"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRClass", "[", "a_Association", "]"}], "[", "\n", "\t", 
   RowBox[{
    RowBox[{"range", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", "\n", 
    "\t", 
    RowBox[{"points", ":", 
     RowBox[{"{", 
      RowBox[{"__Integer", "?", "Positive"}], "}"}]}]}], "\n", "\t", "]"}], ":=",
   "\n", "\t", 
  RowBox[{
   RowBox[{"ChemDVRClass", "[", "a", "]"}], "[", 
   RowBox[{"points", ",", "range"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6992013701368303`*^9, 3.69920138374583*^9}, {
   3.6992014998478727`*^9, 3.6992015258687572`*^9}, {3.699206083838956*^9, 
   3.699206266116604*^9}, {3.699211576828723*^9, 3.699211632266419*^9}, {
   3.6993073136960287`*^9, 3.6993073284695272`*^9}, {3.700004724748094*^9, 
   3.700004724770212*^9}, {3.709485101197421*^9, 3.709485108322763*^9}, {
   3.709486415367545*^9, 3.709486417017065*^9}, 3.709487016474667*^9, {
   3.711061911711885*^9, 
   3.7110619277818193`*^9}},ExpressionUUID->"00ee3b2f-1f3b-41b7-ac1b-\
b08179b5899a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Template\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699206388792797*^9, 3.699206390871063*^9}, {
  3.699207239394168*^9, 3.699207241015896*^9}, {3.699216404012043*^9, 
  3.699216404680265*^9}},ExpressionUUID->"b53104b3-873d-48f5-9d28-\
8cf2e5157597"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ChemDVRClassTemplate", "=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sn", "=", 
       RowBox[{"ToBoxes", "@", 
        RowBox[{"Placeholder", "[", "\"\<Name\>\"", "]"}]}]}], "}"}], ",", 
     "\n", "\t", 
     RowBox[{"Notebook", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"TextData", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cell", "[", 
               RowBox[{"BoxData", "@", 
                RowBox[{"ToBoxes", "@", 
                 RowBox[{"Placeholder", "[", "\"\<LongName\>\"", "]"}]}]}], 
               "]"}], ",", "\"\< \>\"", ",", "\"\<DVR\>\""}], "}"}]}], ",", 
           " ", "\n", "\t\t\t", "\"\<CodeSection\>\""}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"TextData", "@", 
            RowBox[{"{", 
             RowBox[{"Cell", "[", 
              RowBox[{"BoxData", "@", 
               RowBox[{"ToBoxes", "@", 
                RowBox[{"Placeholder", "[", "\"\<Description\>\"", "]"}]}]}], 
              "]"}], "}"}]}], ",", "\"\<Text\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Cell", "[", 
           RowBox[{
            RowBox[{"BoxData", "@", "\"\<ChemDVRBegin[];\>\""}], ",", 
            "\"\<InputSection\>\""}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"Cell", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"BoxData", "@", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "\"\<FormatGrid\>\""}], "}"}], "]"}], 
                    ",", "\"\<::\>\"", ",", "\"\<usage\>\""}], "}"}], "]"}], 
                  ",", "\"\<=\>\"", ",", "\"\<\\\"\\\"\>\""}], "}"}], "]"}], 
               ",", "\"\<\\n\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrgr"}], "}"}], "]"}], ",", 
                    "\"\<::\>\"", ",", "\"\<usage\>\""}], "}"}], "]"}], ",", 
                  "\"\<=\>\"", ",", "\"\<\\\"\\\"\>\""}], "}"}], "]"}], ",", 
               "\"\<\\n\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrke"}], "}"}], "]"}], ",", 
                    "\"\<::\>\"", ",", "\"\<usage\>\""}], "}"}], "]"}], ",", 
                  "\"\<=\>\"", ",", "\"\<\\\"\\\"\>\""}], "}"}], "]"}], ",", 
               "\"\<\\n\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "\"\<PotentialEnegy\>\""}], "}"}], 
                    "]"}], ",", "\"\<::\>\"", ",", "\"\<usage\>\""}], "}"}], 
                   "]"}], ",", "\"\<=\>\"", ",", "\"\<\\\"\\\"\>\""}], "}"}], 
                "]"}], ",", "\"\<\\n\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrwf"}], "}"}], "]"}], ",", 
                    "\"\<::\>\"", ",", "\"\<usage\>\""}], "}"}], "]"}], ",", 
                  "\"\<=\>\"", ",", "\"\<\\\"\\\"\>\""}], "}"}], "]"}], ",", 
               "\"\<\\n\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "\"\<View\>\""}], "}"}], "]"}], ",", 
                    "\"\<::\>\"", ",", "\"\<usage\>\""}], "}"}], "]"}], ",", 
                  "\"\<=\>\"", ",", "\"\<\\\"\\\"\>\""}], "}"}], "]"}]}], 
              "\n", "\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t", 
            "\"\<CodeInput\>\""}], "]"}]}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Begin\>\"", ",", "\"\<[\>\"", ",", 
                  "\"\<\\\"`Private`\\\"\>\"", ",", "\"\<]\>\""}], "}"}], 
                "]"}], ",", "\"\<;\>\""}], "}"}], "]"}]}], ",", "\n", 
           "\t\t\t", "\"\<InputSection\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
          "\"\<Grid Formatting Function\>\"", ",", " ", 
           "\"\<CodeSubsubsection\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
          "\"\<This function should take a grid and the grid points used to \
generate the grid.\>\"", ",", "\n", "\t\t\t ", "\"\<Text\>\""}], "]"}], ",", 
         "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", "\n", "\t\t\t", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"sn", ",", "\"\<FormatGrid\>\""}], "}"}], "]"}], 
                  ",", "\"\<[\>\"", ",", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<grid_\>\"", ",", "\"\<,\>\"", ",", 
                    "\"\<points_\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], 
                 "}"}], "]"}], ",", "\n", "\t\t\t\t", "\"\<:=\>\"", ",", 
               "\"\<\\n\\t\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"ToBoxes", "@", 
                RowBox[{
                "Placeholder", "[", "\"\<FormatGrid Function\>\"", "]"}]}]}], 
              "}"}], "]"}]}], ",", "\n", "\t\t\t", "\"\<CodeInput\>\""}], 
          "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
          "\"\<Grid Function\>\"", ",", " ", "\"\<CodeSubsubsection\>\""}], 
          "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
          "\"\<This function should take the number of grid points for each \
coordinate\>\"", ",", "\n", "\t\t\t ", "\"\<Text\>\""}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", "\n", "\t\t\t", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrgr"}], "}"}], "]"}], ",", 
                  "\"\<[\>\"", ",", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<points_\>\"", ",", "\"\<,\>\"", ",", 
                    "\"\<range_\>\""}], "}"}], "]"}], ",", "\"\<]\>\""}], 
                 "}"}], "]"}], ",", "\n", "\t\t\t\t", "\"\<:=\>\"", ",", 
               "\"\<\\n\\t\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"ToBoxes", "@", 
                RowBox[{
                "Placeholder", "[", "\"\<Grid Function\>\"", "]"}]}]}], "}"}],
              "]"}]}], ",", "\n", "\t\t\t", "\"\<CodeInput\>\""}], "\n", 
          "\t\t\t", "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
          "\"\<Kinetic Energy Function\>\"", ",", " ", 
           "\"\<CodeSubsubsection\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
          "\"\<This should take the grid generated previously\>\"", ",", "\n",
            "\t\t\t ", "\"\<Text\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", "\n", "\t\t\t", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrke"}], "}"}], "]"}], ",", 
                  "\"\<[\>\"", ",", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", "\"\<grid_\>\"", "}"}], "]"}], ",", 
                  "\"\<]\>\""}], "}"}], "]"}], ",", "\n", "\t\t\t\t", 
               "\"\<:=\>\"", ",", "\"\<\\n\\t\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"ToBoxes", "@", 
                RowBox[{
                "Placeholder", "[", "\"\<KineticEnergy Function\>\"", 
                 "]"}]}]}], "}"}], "]"}]}], ",", "\n", "\t\t\t", 
           "\"\<CodeInput\>\""}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
          "\"\<Potential Energy Function\>\"", ",", " ", 
           "\"\<CodeSubsubsection\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
          "\"\<This should take the grid generated previously\>\"", ",", "\n",
            "\t\t\t ", "\"\<Text\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", "\n", "\t\t\t", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrpe"}], "}"}], "]"}], ",", 
                  "\"\<[\>\"", ",", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", "\"\<grid_\>\"", "}"}], "]"}], ",", 
                  "\"\<]\>\""}], "}"}], "]"}], ",", "\n", "\t\t\t\t", 
               "\"\<:=\>\"", ",", "\"\<\\n\\t\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"ToBoxes", "@", 
                RowBox[{
                "Placeholder", "[", "\"\<PotentialEnergy Function\>\"", 
                 "]"}]}]}], "}"}], "]"}]}], ",", "\n", "\t\t\t", 
           "\"\<CodeInput\>\""}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
          "\"\<Wavefunctions Function\>\"", ",", " ", 
           "\"\<CodeSubsubsection\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
          "\"\<This should take the kinetic and potential energies generated \
previously\>\"", ",", "\n", "\t\t\t ", "\"\<Text\>\""}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", "\n", "\t\t\t", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrwf"}], "}"}], "]"}], ",", 
                  "\"\<[\>\"", ",", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<T_\>\"", ",", "\"\<V_\>\""}], "}"}], "]"}], 
                  ",", "\"\<]\>\""}], "}"}], "]"}], ",", "\n", "\t\t\t\t", 
               "\"\<:=\>\"", ",", "\"\<\\n\\t\>\"", ",", "\n", "\t\t\t\t", 
               RowBox[{"ToBoxes", "@", 
                RowBox[{
                "Placeholder", "[", "\"\<Wavefunctions Function\>\"", 
                 "]"}]}]}], "}"}], "]"}]}], ",", "\n", "\t\t\t", 
           "\"\<CodeInput\>\""}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
          "\"\<View Function\>\"", ",", " ", "\"\<CodeSubsubsection\>\""}], 
          "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
          "\"\<This should take the wavefunctions, grid and potential \
energies\>\"", ",", "\n", "\t\t\t ", "\"\<Text\>\""}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", "\n", "\t\t\t", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"sn", ",", "\"\<View\>\""}], "}"}], "]"}], ",", 
                  "\"\<[\>\"", ",", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<wfs_\>\"", ",", "\"\<grid_\>\"", ",", "\"\<V_\>\""}],
                     "}"}], "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
               "\n", "\t\t\t\t", "\"\<:=\>\"", ",", "\"\<\\n\\t\>\"", ",", 
               "\n", "\t\t\t\t", 
               RowBox[{"ToBoxes", "@", 
                RowBox[{
                "Placeholder", "[", "\"\<View Function\>\"", "]"}]}]}], "}"}],
              "]"}]}], ",", "\n", "\t\t\t", "\"\<CodeInput\>\""}], "\n", 
          "\t\t\t", "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<End\>\"", ",", "\"\<[\>\"", ",", "\"\<]\>\""}], 
                 "}"}], "]"}], ",", "\"\<;\>\""}], "}"}], "]"}]}], ",", "\n", 
           "\t\t\t", "\"\<InputSection\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"BoxData", "@", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<<|\>\"", ",", "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\n",
                "\t\t\t\t", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"Name\\\"\>\"", ",", "\"\<\[Rule]\>\"", ",", 
                    RowBox[{"RowBox", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\\\"\>\"", ",", 
                    RowBox[{"ToBoxes", "@", 
                    RowBox[{"Placeholder", "[", "\"\<Name\>\"", "]"}]}], ",", 
                    "\"\<\\\"\>\""}], "}"}]}]}], "}"}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t", "\"\<,\>\"", ",", "\"\<\\n\>\"", ",", 
                  "\"\<\\t\>\"", ",", "\n", "\t\t\t\t\t", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"Dimension\\\"\>\"", ",", "\"\<\[Rule]\>\"", ",", 
                    
                    RowBox[{"ToBoxes", "@", 
                    RowBox[{
                    "Placeholder", "[", "\"\<Dimension\>\"", "]"}]}]}], "}"}],
                    "]"}], ",", "\n", "\t\t\t\t\t\t", "\"\<,\>\"", ",", 
                  "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\n", "\t\t\t\t\t", 
                  
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"FormatGrid\\\"\>\"", ",", "\"\<->\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "\"\<FormatGrid\>\""}], "}"}], "]"}]}],
                     "}"}], "]"}], ",", "\n", "\t\t\t\t\t\t", "\"\<,\>\"", 
                  ",", "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\\\"Grid\\\"\>\"", ",", "\"\<->\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrgr"}], "}"}], "]"}]}], "}"}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t", "\"\<,\>\"", ",", 
                  "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\n", "\t\t\t\t\t", 
                  
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"KineticEnergy\\\"\>\"", ",", "\"\<->\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrke"}], "}"}], "]"}]}], "}"}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t", "\"\<,\>\"", ",", 
                  "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\n", "\t\t\t\t\t", 
                  
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"PotentialEnergy\\\"\>\"", ",", "\"\<->\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrpe"}], "}"}], "]"}]}], "}"}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t", "\"\<,\>\"", ",", 
                  "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\n", "\t\t\t\t\t", 
                  
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\\\"Wavefunctions\\\"\>\"", ",", "\"\<->\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "$dvrwf"}], "}"}], "]"}]}], "}"}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t", "\"\<,\>\"", ",", 
                  "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\n", "\t\t\t\t\t", 
                  
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\\\"View\\\"\>\"", ",", "\"\<->\>\"", ",", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"sn", ",", "\"\<View\>\""}], "}"}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], "]"}], ",", "\n", "\t\t\t\t\t", 
               "\"\<\\n\>\"", ",", "\"\<\\t\>\"", ",", "\"\<|>\>\""}], "}"}], 
             "]"}]}], ",", "\n", "\t\t\t", "\"\<CodeInput\>\""}], "\n", 
          "\t\t\t", "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"BoxData", "@", "\"\<ChemDVREnd[];\>\""}], ",", 
           "\"\<InputSection\>\""}], "]"}], ",", "\n", "\t\t", 
         RowBox[{"Cell", "[", 
          RowBox[{"\"\<\>\"", ",", "\"\<SectionSeparator\>\""}], "]"}]}], 
        "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
       RowBox[{"StyleDefinitions", "\[Rule]", "\n", "\t\t\t", 
        RowBox[{"FrontEnd`FileName", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<ChemTools\>\"", ",", "\"\<Private\>\""}], "}"}], ",", 
          "\"\<NewDVRClass.nb\>\""}], "]"}]}]}], "\n", "\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699206392545425*^9, 3.699206394993764*^9}, {
   3.6992065000224648`*^9, 3.699206603200674*^9}, {3.699206643388485*^9, 
   3.699206841432807*^9}, {3.6992068862491207`*^9, 3.699207209235361*^9}, {
   3.6992072474927397`*^9, 3.699207267302618*^9}, {3.69920729794243*^9, 
   3.6992074309703283`*^9}, {3.6992074838846197`*^9, 3.699207486672621*^9}, {
   3.699207518066824*^9, 3.69920761242247*^9}, {3.6992078069434233`*^9, 
   3.699207849779862*^9}, {3.699207949027286*^9, 3.699208100324769*^9}, {
   3.699208172715893*^9, 3.6992083292977667`*^9}, {3.6992083605016193`*^9, 
   3.69920858568887*^9}, {3.69920867459321*^9, 3.6992086870846033`*^9}, {
   3.699208764100472*^9, 3.699208867532579*^9}, {3.699208981827486*^9, 
   3.699208987337901*^9}, {3.699209057809873*^9, 3.6992090583379707`*^9}, {
   3.699210072485448*^9, 3.699210076548121*^9}, {3.699210496174555*^9, 
   3.699210521587697*^9}, {3.699240078870713*^9, 3.6992401062408733`*^9}, {
   3.699241803292095*^9, 3.699241836698929*^9}, {3.700004724806899*^9, 
   3.700004724837203*^9}, {3.7070655845141172`*^9, 3.707065585072249*^9}, 
   3.709489208498086*^9, {3.7094893108144712`*^9, 3.709489322275023*^9}, {
   3.7094898445007467`*^9, 3.709489852967412*^9}, {3.731786169246167*^9, 
   3.731786186248274*^9}, {3.731786394131937*^9, 
   3.731786394151423*^9}},ExpressionUUID->"3a2f5004-b0b7-4d58-ab9c-\
656af09b7878"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]New\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6992090372707357`*^9, 
  3.699209037694421*^9}},ExpressionUUID->"68e07f1f-4455-4165-b54a-\
30c5315d1862"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemDVRNewClass", "]"}], "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<LongName\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Description\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Name\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Dimension\>\"", "\[Rule]", "None"}]}], "\n", "\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRNewClass", "[", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"name", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Name\>\"", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"s_String", "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"StringTrim", "[", 
             RowBox[{
              RowBox[{"StringReplace", "[", 
               RowBox[{"s", ",", 
                RowBox[{
                 RowBox[{"Except", "[", "WordCharacter", "]"}], "\[Rule]", 
                 "\"\<\>\""}]}], "]"}], ",", "\"\<DVR\>\""}], "]"}], "<>", 
            "\n", "\t\t\t\t\t", "\"\<DVR\>\""}]}]}], "\n", "\t\t\t\t", 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"ln", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<LongName\>\"", "]"}], ",", 
          RowBox[{"None", "->", 
           RowBox[{"OptionValue", "[", "\"\<Name\>\"", "]"}]}]}], "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"desc", "=", 
        RowBox[{"OptionValue", "[", "\"\<Description\>\"", "]"}]}], ",", "\n",
        "\t\t", 
       RowBox[{"dim", "=", 
        RowBox[{"OptionValue", "[", "\"\<Dimension\>\"", "]"}]}]}], "\n", 
      "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reps", "=", "\n", "\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"name", "===", "None"}], ",", "\n", "\t\t\t\t\t", 
             "Nothing", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"RowBox", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ToBoxes", "@", 
                    RowBox[{"Placeholder", "[", "\"\<Name\>\"", "]"}]}], ",", 
                    "s_"}], "}"}]}], ":>", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"name", "<>", "s"}], ")"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"RowBox", "@", 
                  RowBox[{"{", 
                   RowBox[{"s1_", ",", 
                    RowBox[{"ToBoxes", "@", 
                    RowBox[{"Placeholder", "[", "\"\<Name\>\"", "]"}]}], ",", 
                    "s2_"}], "}"}]}], ":>", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"s1", "<>", "name", "<>", "s2"}]}]}], "\n", 
               "\t\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t\t", "]"}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ln", "===", "None"}], ",", "\n", "\t\t\t\t\t", 
             "Nothing", ",", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ToBoxes", "@", 
               RowBox[{"Placeholder", "[", "\"\<LongName\>\"", "]"}]}], 
              "\[Rule]", "ln"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"desc", "===", "None"}], ",", "\n", "\t\t\t\t\t", 
             "Nothing", ",", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ToBoxes", "@", 
               RowBox[{"Placeholder", "[", "\"\<Description\>\"", "]"}]}], 
              "\[Rule]", "desc"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"dim", "===", "None"}], ",", "\n", "\t\t\t\t\t", 
             "Nothing", ",", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ToBoxes", "@", 
               RowBox[{"Placeholder", "[", "\"\<Dimension\>\"", "]"}]}], 
              "\[Rule]", "dim"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
          "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"CreateDocument", "@", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "reps"}], "===", "0"}], ",", "\n", 
          "\t\t\t\t\t", "$ChemDVRClassTemplate", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"name", "===", "None"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"$ChemDVRClassTemplate", ",", "reps"}], "]"}], ",", "\n",
             "\t\t\t\t\t\t", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"$ChemDVRClassTemplate", ",", "reps"}], "]"}], ",", 
              "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"\"\<WindowTitle\>\"", "\[Rule]", "name"}]}], "\n", 
             "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699209038532157*^9, 3.6992092322169247`*^9}, {
   3.699209347662252*^9, 3.699209402748426*^9}, {3.699209434561887*^9, 
   3.6992095457426434`*^9}, {3.699209586991514*^9, 3.699209954277371*^9}, {
   3.699210012956421*^9, 3.699210042608933*^9}, 3.699210345954177*^9, {
   3.6992104289280357`*^9, 3.699210449007607*^9}, {3.700004724852063*^9, 
   3.7000047248778477`*^9}, 3.701030055255843*^9, {3.707065588898052*^9, 
   3.707065592790909*^9}},ExpressionUUID->"85b9745a-b980-4576-8a98-\
027c08c5b55e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Begin\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699239443394215*^9, 
  3.699239444041135*^9}},ExpressionUUID->"16730cc1-fc87-47b1-ac5c-\
5712ca13981a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRBegin", "[", 
    RowBox[{"context_:", "\"\<\>\""}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$Context", "=!=", 
      RowBox[{"Context", "[", "ChemDVRBegin", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"BeginPackage", "[", 
       RowBox[{"Context", "[", "ChemDVRBegin", "]"}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"$ContextPath", "=", "\n", "\t\t\t", 
       RowBox[{"Join", "[", 
        RowBox[{"$ContextPath", ",", " ", "$PackageContexts"}], "]"}]}]}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699239538371735*^9, 3.6992396393563147`*^9}, {
   3.699239688914824*^9, 3.699239697240741*^9}, {3.69924449459455*^9, 
   3.699244518120574*^9}, {3.700004724886218*^9, 3.700004724892145*^9}, {
   3.719788204068878*^9, 3.7197882130709753`*^9}, {3.719788250232246*^9, 
   3.71978825096038*^9}, {3.719788424792981*^9, 3.71978844283747*^9}, {
   3.719941793429718*^9, 3.7199418217157097`*^9}, 3.721165737967766*^9, {
   3.732397364316463*^9, 
   3.732397374218656*^9}},ExpressionUUID->"1d450381-ef79-4f8f-88a5-\
43f1e6ed0473"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]End\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699239444985227*^9, 
  3.6992394482501507`*^9}},ExpressionUUID->"b6a612ca-2099-494b-9edb-\
7393bdc719c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVREnd", "[", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$Context", "===", 
      RowBox[{"Context", "[", "ChemDVRBegin", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"EndPackage", "[", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.69923967563544*^9, 3.69923968615515*^9}, {
  3.699298567801799*^9, 3.699298568224752*^9}, {3.700004724900271*^9, 
  3.7000047249030313`*^9}},ExpressionUUID->"44b2f3f4-5022-458f-a38b-\
e751005e960a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Needs\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699239705582326*^9, 
  3.699239714674364*^9}},ExpressionUUID->"d14539b3-3f73-4abd-a18a-\
b976c625afea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"AssociationQ", "@", "$ChemDVRLoaded"}]}], ",", "\n", "\t", 
    RowBox[{"$ChemDVRLoaded", "=", 
     RowBox[{"<|", "\n", "\t\t", "\n", "\t\t", "|>"}]}]}], "\n", "\t", "]"}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.699239731552478*^9, 3.699239745804282*^9}, {
  3.699242166361083*^9, 3.699242177300673*^9}, {3.700004724911167*^9, 
  3.7000047249139977`*^9}, {3.7094870164855757`*^9, 3.709487016489607*^9}, {
  3.709488628834133*^9, 3.709488628839898*^9}, {3.7095020485153427`*^9, 
  3.709502049761731*^9}},ExpressionUUID->"1ac73f29-fa26-4387-b8da-\
49975a532239"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chemDVRGet", "[", 
    RowBox[{"f_String", "?", 
     RowBox[{"(", "FileExistsQ", ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$ContextPath", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{"$PackageContexts", ",", " ", "\"\<System`\>\""}], "]"}]}], 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"Get", "@", "f"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"{", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{"c_Association", ":>", "\n", "\t", "\t\t\t\t", 
          RowBox[{"Set", "[", 
           RowBox[{
            RowBox[{"$ChemDVRLoaded", "[", "f", "]"}], ",", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"Append", "[", 
             RowBox[{"c", ",", 
              RowBox[{"\"\<File\>\"", "\[Rule]", "f"}]}], "]"}]}], "\n", "\t",
            "\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"_", "\[Rule]", "$Failed"}]}], "\n", "\t\t\t\t", "}"}]}], 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.707067439474018*^9, 3.707067487097458*^9}, {
   3.707067530631317*^9, 3.707067551954217*^9}, {3.707068964897738*^9, 
   3.707069001748479*^9}, {3.7075055438660583`*^9, 3.707505552262985*^9}, 
   3.70948701650008*^9, 3.709488628852296*^9, {3.709502179283183*^9, 
   3.709502192199139*^9}, {3.732397283936453*^9, 3.732397314764802*^9}, {
   3.732397385591365*^9, 
   3.73239740268118*^9}},ExpressionUUID->"d03664c3-b658-42cb-a395-\
857c98b49b06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRNeeds", "[", 
    RowBox[{"f_String", "?", 
     RowBox[{"(", "FileExistsQ", ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Lookup", "[", 
    RowBox[{"$ChemDVRLoaded", ",", "f", ",", "\n", "\t\t", 
     RowBox[{"chemDVRGet", "[", "f", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRNeeds", "[", 
    RowBox[{"f_String", "?", 
     RowBox[{"(", 
      RowBox[{"Not", "@*", "FileExistsQ"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"Lookup", "[", 
    RowBox[{"$ChemDVRLoaded", ",", "f", ",", "\n", "\t\t", 
     RowBox[{"Lookup", "[", 
      RowBox[{"$ChemDVRLoaded", ",", 
       RowBox[{"ChemDVRFile", "[", 
        RowBox[{"\"\<Classes\>\"", ",", 
         RowBox[{
          RowBox[{"StringTrim", "[", 
           RowBox[{"f", ",", "\"\<.m\>\""}], "]"}], "<>", "\"\<.m\>\""}]}], 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"chemDVRGet", "@", 
        RowBox[{"ChemDVRFile", "[", 
         RowBox[{"\"\<Classes\>\"", ",", 
          RowBox[{
           RowBox[{"StringTrim", "[", 
            RowBox[{"f", ",", "\"\<.m\>\""}], "]"}], "<>", "\"\<.m\>\""}]}], 
         "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699239706776084*^9, 3.699239711837459*^9}, {
   3.699239748486086*^9, 3.6992398617663317`*^9}, {3.699239926702342*^9, 
   3.699239945333599*^9}, {3.6992401485704107`*^9, 3.699240151863483*^9}, {
   3.699240216439987*^9, 3.699240230445177*^9}, {3.699242134791975*^9, 
   3.699242163302767*^9}, {3.7000047249234953`*^9, 3.7000047249423847`*^9}, {
   3.7070657532981157`*^9, 3.707065815826592*^9}, {3.707067286490736*^9, 
   3.7070672893627768`*^9}, {3.7070673393609657`*^9, 3.7070673482078533`*^9}, 
   3.707067520056731*^9, {3.707067560317531*^9, 3.707067564204009*^9}, {
   3.7070690081670094`*^9, 3.707069021633272*^9}, {3.709487016510026*^9, 
   3.709487016514468*^9}, {3.709488628865324*^9, 3.709488628869603*^9}, {
   3.7095020767096024`*^9, 
   3.70950209844317*^9}},ExpressionUUID->"313adba5-4d3d-4089-9d0e-\
54bbc82178ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Reload\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699817537593745*^9, 
  3.699817539520577*^9}},ExpressionUUID->"120ed1cc-5f1e-4f69-845c-\
1c06dc2b8585"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemDVRReload", "[", "s_String", "]"}], ":=", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyMemberQ", "[", 
        RowBox[{"$ChemDVRLoaded", ",", "s"}], "]"}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"$ChemDVRLoaded", "[", "s", "]"}], "=."}], ",", "\n", "\t\t", 
       
       RowBox[{
        RowBox[{"$ChemDVRLoaded", "[", 
         RowBox[{"ChemDVRFile", "[", 
          RowBox[{"\"\<Classes\>\"", ",", 
           RowBox[{
            RowBox[{"StringTrim", "[", 
             RowBox[{"s", ",", "\"\<.m\>\""}], "]"}], "<>", "\"\<.m\>\""}]}], 
          "]"}], "]"}], "=."}]}], "\n", "\t\t", "]"}], ";", "\n", "\t", 
     RowBox[{"ChemDVRNeeds", "@", "s"}]}], "\n", "\t", ")"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.699817542637241*^9, 3.699817557968457*^9}, {
   3.70000472494786*^9, 3.700004724954092*^9}, 3.709487016525186*^9, 
   3.709488628878789*^9, {3.7095022557121563`*^9, 
   3.709502287669404*^9}},ExpressionUUID->"cdbf26ad-3d74-465b-9c71-\
f1ec02c0c56a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PackageAddAutocompletions", "[", "\n", "\t", 
   RowBox[{"\"\<ChemDVRReload\>\"", ",", "\n", "\t", 
    RowBox[{"List", "@", 
     RowBox[{"ChemDVRClasses", "[", "]"}]}]}], "\n", "\t", "]"}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{
  3.724434852768161*^9},ExpressionUUID->"860e996d-0325-4b98-9a78-e691e1a7fd74"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Formatting\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699206386279348*^9, 
  3.6992063872072077`*^9}},ExpressionUUID->"0c1ef708-1ad5-4bba-9615-\
5820711064ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$dvrclassimg", "=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Inset", "[", "\n", "\t\t\t\t", 
          RowBox[{"Graphics", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", "#"}], "/.", 
             RowBox[{"_Opacity", "\[Rule]", 
              RowBox[{"Opacity", "[", ".1", "]"}]}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"28", ",", "28"}], "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}], 
              ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0"}], ",", "20"}], "}"}]}], "}"}]}]}], "\n", 
             "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "]"}], "\n", 
          "\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t", 
         RowBox[{"Inset", "[", "\n", "\t\t\t\t", 
          RowBox[{"Graphics", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"GrayLevel", "[", ".2", "]"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"First", "@", "#2"}]}], "\n", "\t\t\t\t\t\t", "}"}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"28", ",", "28"}], "}"}]}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
             "\n", "\t", "\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t", "]"}],
           "\n", "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t\t", "}"}], ",", 
       "\n", "\t", "\t", 
       RowBox[{"Background", "\[Rule]", 
        RowBox[{"GrayLevel", "[", ".95", "]"}]}], ",", "\n", "\t", "\t", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"GrayLevel", "[", ".8", "]"}]}], ",", "\n", "\t", "\t", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", "\n", "\t", "\t", 
       RowBox[{"FrameTicks", "\[Rule]", "False"}], ",", "\n", "\t", "\t", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"32", ",", "32"}], "}"}]}]}], "\n", "\t", "\t", "]"}], "&"}],
     "[", 
    RowBox[{"$dvrimg", ",", 
     GraphicsBox[{FilledCurveBox[Line[CompressedData["
1:eJxN2HmUjlUYAPCPKESLZA2p7Eu2SNkqRFkiZUnJUimyRCkqS7utVWTLvu+M
GWPGNjPGjNlnrNG+bySihN73zM85/XG/3/ne8533ufd7nvfe994q/Yd1G1ow
Eom0Dz5Co4J2qEAksoXRjOFWxnIb4xjP7dzBndzF3UxgIpO4h8ncyxSmch/T
mM4MZjKL2cxhLvO4P/AgD3A/85jLHGYzi5nMYDrTuI+pTOFeJnNP4IHAJCYy
gbu5izu5g9sZzzhuYyy3MobR3MIobuYmbuQGruc6ruUaruYqrgw8GLiCy7mM
S7mEi7mIC7mA8/kp53Eu53A2Z/ETzuQMfszp/Igf8gO+z/f4buChwGmcyimc
zEl8h2/zLb7JN/g6X+NETuB4juOrfIUvcyzH8CW+yNF8gc9zVODhwJF8jiM4
nMM4lM9yCAfzGT7NQXyKT/IJDuQA9mc/Ps6+fIyPsg8fYW/2CjwS2JM9+DAf
Ync+yG7sygfYhZ3ZiR15P+9jB7bnvWzHtmzDe3g372JrtmLLwM8CW7A57+Qd
bMbb2ZRNeBsbsxEbsgHr81bWY13WYW3WYk3WYHVWY1Xewpt5U+DRwCq8kZVZ
iRV5AyuwPMuxLMuwNK9nKV7HkryW1/BqXsUSLM4rWYxFWYRXBB4LvJyFWYiX
sSALMMKLkXwv8Dz/5Tn+w795lmf4F0/zFP/kSf7BEzzO3/kbfw3a50H7hT/z
J/7IH/g9v+O3/IZf8yt+yS94qR3jUX7GIzzMQzzIA9zPPOaKkeN7thhZYmSJ
kS1Gthg5YuSIkStGrhh5/2uXruUw22+zmOkeGUx37zTuEzNVH1K4V9+SuUef
k5hoLAncbYy7uNPYd3C7/z2ecfKxjbHytFXeYhgtn1sYJc+buSmSn/+N3BDJ
r4v1XBfJr5e1XBPJr6PVXBXJr6+Vkfx6Cw3rb0Ukvx5Df3f9OE/wD57knzzF
0/yLZ3iWf/MfnuO/PM8LvMjw+Q0twIK8jIVYmJcznC/C8RZhURbjlSzOEryK
V/MaXsuSvI6leD1LswzLshzLswJvYEVWYmWG83eYvyq8iTfzFlZlNVZnDdZk
LdZmHdZlPd7K+mzAhmzExryNTdiUt7MZw/U1rMs72Zwt2JKt2Jp38W7ewzZs
y3a8l+3ZgffxfnZkJ3ZmFz7AruzG8H0nfM668yE+zB7syV7szUfYh4/yMfbl
4+zH/hzAgXyCT/IpDuLTfIaDOYTh+2g4fwzlMA7nCD7HkRzF5/kCR/NFvsQx
HMuX+Qpf5TiO5wRO5Gt8nW8w3B+E8+FbfJvvcBIncwqnchrf5Xt8nx/wQ37E
6fyYMziTn3AWZ3MO53Iew/1aOL/P5wIu5CIu5hIu5TIu5wqu5Cqu5hqu5Tqu
5wZu5CZuZhS3MJoxDPfT4boVy22MYzy3cwd3chd3M4GJTOIeJnMvU5jKfUxj
OjOYySxmMzzfCNfhXOZxP8PzkXC9Ds9LLp0b/QdyegDz
         "]]], 
       FilledCurveBox[Line[CompressedData["
1:eJxN12W3VVUUBuAFUhICUoL0Renu7hYR2PvQ3SghZdChNAapoDTSgv4Ru7u7
W1H3Gvth6Ic5ng933BNrve88YzeYsXj0ouIhhKvFQoi2yHw2m+bZPJNNs2yu
8DKf5iVe5AWe5zme5ZlsmmbzFE/zFE/yBI/zGI/yCJ/kEzzMQ3ycj/EgD3A/
93Ev9/DRbJpk8wgf5kPczV3cyR3czm3cyi18kA9wMzdxIzdwPddxLddk0zib
1VzF+3kf7+U9XMkVXM5lXMq7uYSLuYgLeRfv5ALO57xsbs1mLudwNmdxJmdw
OqdxKqdwMidxIidwPMdxLAtMmXAMR2dzSzajeAdH8naO4G0czmEcyiEczEEc
yAHsz37syz7szV7smU2jbHqwO7uxK7uwMzuxIzuwPduxLduwNVuxJVuwOZux
KZswZqHIGRf5DkX+VvS/acgGrM96rMs6rM2bWYs1eRNrsDqrsSqr8EafoTIr
sSJvYAWWZzmW5fUsw9IsxZIswetYnMUY+E/I/ZtX+VfIz+pP/sHf+Rt/5S/8
mT/xR/7A7/kdv+U3/Nr7f8UvQ35+X4T8Tj8P+R1/FvI7j8YMfBryTERjRj4J
eWaiMUMf+z2Kxox9FPLMRWMGPwx5JqMxox+EPLPRmOH3Q57paMz4eyHPfDR2
4N2Qd+KdkHckGjvzdsg7FI2deivkHYvGzr0Z8g5GYyffCHlHo7Gzr4e8w9HY
6ddC3vFo7PyrId8B0bgTXgn5jojGnfFyyHfISyHfKdG4Y14M+c6Jxh30Qsh3
UjTuqOdDvrOicYc9F/KdFk1Z8PeC/yt4vYL3KXj/gs9T8DkLPn/qe6W+b+oc
UueTOrfUeabOOXXuqftI3VPq/lL3mrrvVA5S+UjlJpWnVL5SeUvlL5XHVD4T
eU3kN5HnRL4TeU/kP9GHRD8SfUn0J9GnRL8SfUv0L9HHRD8TfU30N9HnaHHG
vsf7KsGSLMXSLMPrWZblWJ4VeAMrshIr80ZWYVVWY3XWYNyfMV81WYs3szbr
sC7rsT4bsCGL2KjYf7+50Wu/wY3ZhE3ZjM3Zgi0Zd0XsRWu2YVu2Y3t2YEd2
Ymd2YVd2Y3f2YE/2Ym/2YV/2Y9wVsccDOJCDOJhDOJTDOJy3cQRv50hem1Ec
zTFMmLLAsRzH8V5zAidyEidzCqdyGqdzBmdyFmdzDudyHudzAe/kXVzIRc5g
MZfwbi7lMi7nCq7kPbyX9/F+ruJqruFaruN6buBGbuJmd/cAH+QWbuU2bucO
7uQu7uZDfJiP8FHu4V7u434e4EHG56mYtcd5iIf5BJ/kER7lMR7nCZ7kKZ7m
UzzDszzH87zAi7zE+LwaO3KZVxifb2OH4vPuUA7hYA7iQA5gf/ZjX/Zhb/Zi
T/Zgd3ZjV3ZhZ3ZiR3Zge7ZjW7Zha7ZiS157vv8X4eR7WA==
         "]]], 
       FilledCurveBox[Line[CompressedData["
1:eJxV3HV8VVe2AODTTmemU5lO3acydXekAgR3J7i7JPhNCCE4F3d3h1JKKS3u
rnVXqLuN63us5ru/ee+P+/vITXLvOXuvtfbOWYd7Q9vcejlnJkly3jlJEl50
+vHT6ceFpx8/8gd+z+/4Lb/h1/yKX/ILfs7P+Ck/4cf8iKd4kh/yA77P9/gu
3+HbfItv8g2+ztf4Kl/hy3yJL/IFnuBxHuNRHuFhHuJBHuB+7uNe7uFu7uJO
7uB2buNWbuFmbuJGPs/nuIHPcj2f4To+zbV8imv4JFdzFVdyBZdzGZdyCRdz
ERdyAedzHudyDmdzFmdyBqdzGqdyCidzEidyAsdzHMdyDEczzVEcyREczmEc
yiEczCIOYiEHsoADmM88ptif/diXfdibvdiTucxhD3ZnN3ZlF3ZmJ3ZkB7Zn
O7ZlG7ZmK7ZkCzZnMzZlEzZmNhuxIRuwPuuxLuuwNmuxJmuwOquxKquwMiux
IiuwPLNYjmVZhk/wcT7GR1mapViSJfgIH+ZDfJAP8H7ex3t5D+/mXbwzKV4/
7jj9uPj04/bTj0tOP247/biUl/FyXsEreRWv5jW8lr/ndbyeN/BG/oE38Wbe
wluZedzOO3gn7+LdvIf38j7ezwf4IEuYz5IsxdJ8lI/xcT7BMizLcsw8yrMC
K7ISK7MKq7Iaq7MGa7IWa7MO67Ie67MBG7IRs9mYTdiUzdicLdiSrdiabdiW
7dieHdiRndiZXdiV3didPZjDXPZkL/ZmH/ZlP/ZninnM5wAWcCALOYhFHMwh
HMphHM4RHMlRTHM0x3Asx3E8J3AiJ3Eyp3Aqp3E6Z3AmZ3E253Au53E+F3Ah
F3Exl3Apl3E5VzD2HJEjqxh7kgqsyEqszCqsymqszhqsyVqszTqsy3qszwZs
yEbMZmM2YVM2Y3O2YEu2Ymu2YVu2Y3t2YEd2Ymd2YVd2Y3f2YA5z2ZO92Jt9
2Jf92J8p5jGfA1jAgSzkIBZxMIdwKIdxOEdwJCNXIk4iV1ZyBZdzGZdyCRdz
ERdyAedzHudyDmdzFmdyBqdzGqdyCidzEidyAsdzHMdyDEcz8xjFkRzB4RzG
oRzCwSziIBZyIAs4gPnMY4r92Y992Ye92Ys9mcsc9mB3dmNXdmFndmJHdmB7
tmNbtmFrtmJLtmBzNmNTNmFjZrMRG7IB67Me67IOa7MWa7IGq7Maq7IKK7MS
K7ICyyf/XVPCcizLMnyCj/MxPsrSLMWSLMFH+DBjrxqxGfurkRzB4RzGoRzC
wSziIBZyIAs4gPnMY4r92Y992Ye92Ys9mcsc9mB3dmNXdmFndmJHdmB7tmNb
tmFrtmJLtmBzNmNTNmFjZrMRG7IB67Me67IOa7MWa7IGq7Maq7IKK7MSIzYj
LiI2I04iNiNusjx/m+dv83xYgiVZiqX5KB/j43yCZViW5ZjF8qzAiqzEyqzC
qqzG6qzBmqzF2qzDuqzH+mzAhmzEbDZmEzZlMzZnC7ZkK7ZmG7ZlO7ZnB3Zk
J3ZmF3ZlN3ZnD+Ywlz3Zi73Zh33Zj/2ZYh7zOYAFHMhCDmIRB3MIh3IYh3ME
R3IU0xzNMRzLcRzPCZzISZzMKZzKaZzOGZzJWZzNOZzLeZzPBVzIRVzMJVzK
ZVzOFVzJVVzNJ7mGT3Etn+Y6PsP1fJYb+Byf50Zu4mZu4VZu43bu4E7u4m7u
4V7u434e4EEe4mEe4VEe43Ge4At8kS/xZb7CV/kaX+cbfJNv8W2+w3f5Ht/n
B/yQJ3mKH/FjfsJP+Rk/5xf8kl/xa37Db/kdv+cP/JE/8Y/8E//Mv/Cv/Bv/
zn/wn/wX/83/8H+YnFHsGTyTv+BZ/CV/xV/zbP6G5/Bcnsfz+VtewN/xQl7E
i3kJL+VlvJxX8Epexat5Da/l73kdr+cNvJF/4E28mbfwVt7G23kH7+RdvJv3
8F7ex/v5AB/kQ3yYj7AES7IUS/NRPsbH+QTLsCzLMYvlWYEVWYmVWYVVWY3V
WYM1WYu1WYd1WY/12YAN2YjZbMwmbMpmbM4WbMlWbM02bMt2bM8O7MhO7Mwu
7Mpu7M4ezGEue7IXe7MP+7If+zPFPOZzAAs4kIUcxCIO5hAO5TAO5wiO5Cim
OZpjOJbjOJ4TOJGTOJlTOJXTOJ0zOJOzOJtzOJfzOJ8LuJCLuJhLuJTLuJwr
uJKruJpPcg2f4lo+zXV8huv5LDfwOT7PjdzEzdzCrdzG7dzBndzF3dzDvdzH
/TzAgzzEwzzCozzG4zzBF/giX+LLfIWv8jW+zjf4Jt/i23yH7/I9vs8P+CFP
8hQ/4sf8hJ/yM37OL/glv+LX/IbfnlHco/mO359R3KsJ7+RdvJv38F7ex/v5
AB/kQ3yYj7AES7IUS/NRPsbH+QTLsCzLMYvlWYEVWYmVWYVVWY3VWYM1WYu1
WYd1WY/12YAN2YjZbMwmbMpmbM4WbMlWbM02bMt2bM8O7MhO7Mwu7Mpu7M4e
zGEue7KXfOrD3sw835O5zGEPdmc3dmUXdmYndmQHtmc7tmUbtmYrtmQLNmcz
NmUTNmY2G7EhG7A+67Eu67A2a7Ema7A6q7Eqq7AyK7EiI86Pi/tjPCofjvAw
D/EgD3A/93Ev93A3d3End3A7t3Ert3AzN3Ejn+dz3MBnuZ7PcB2f5lo+xTV8
kqu5iiu5gsu5jEu5hIu5iAu5gPM5j3M5h7M5izM5g9M5jVM5hZM5iRM5geM5
jmM5hqOZ5iiO5AgO5zAO5RAOZhEHsZADWcABzGceU+zPfuzLPuzNXuzJXOaw
B7uzG7uyCzuzEzuyA9uzHduyDVuzFVuyBZuzGZuyiXxsLE+z5W22PM6W19ny
PFveh9VYnTVYk7VYm3VYl/VYnw3YkI2YzcZswqZsxuZswZZsxdZsw7Zsx/bs
wI7sxM7swq7sxu7swRzmsid7sTf7sC/7sT9TzGM+B7CAA1nIQSziYA7hUA7j
cI7gSHExSpykxU1aHKXFVVqcpcVdWhymxWVanKbFbVocp8V1WpynxX1aHqTl
RVqepOVNWh6l5VVanqXlXVoepuVlWp6m5W1aHqfldVqeh/2ZYh7zOYAFHMhC
DmIRB3MIh3IYh3MER3IU0xzNMRzLcRzPCZzISZzMKZzKaZzOGZzJWZzNOZzL
eZzPBVzIRVzMJVzKZVzOFVzJVVzNJ7mGT3Etn+Y6PsP1fJYb+Byf50Zu4mZu
4VZu43bu4E7u4m7u4V7u434e4EEe4mEe4VEe43GekKcn5O0JeXxCXp+Q5yfk
fTiEg1nEQSzkQBZwAPOZxxT7sx+jrsU+vDf7MPN8P/ZninnM5wAWcCALOYhF
HMwhHMphHM4RHMlRTHM0x3Asx3E8J3AiJ3Eyp3Aqp3E6Z3AmZ3E253Au53E+
F3AhF3Exl3Apl3E5V3AlV3E1n+QaPsW1fJrr+AzX81lu4HOMXk38nR+9mm8Z
1wGiZ/M14zpB9G6+ZFxHiB7O54zrDNHL+ZRxHSJ6Oh8zrlNEb+cU4zpG9Hg+
ZFzniF7P+4zrINHzeZdxnWR3UnzdJIzrKHuS4usqYVxniV5QXHeJXtBrjOsy
0RN6hXHdJnpDL/HFM4p7RC8w8uWQvA4jzw8nxXkfRh2I3tFhRp2IHtJBRh2J
XtJ+Rp2JntJeRh2K3tJuRp2KHtNORh2LXlPUteg1bWPUveg5bWHUxeg9bWLU
zehBPc+oq9GL2sCou9GTWs+oy9GbWseo29GjWsuo69GrWsOo+9GzWs1YF6J3
tZKxbkQPazljXYle1lLGuhM9rViHoqe1iLFORW9rAWMdO5kUr2thrHOnkuJ1
L4x1MHpesxjrZPS+ZjDW0eiBTWOss9ELm8JYh6MnNomxTkdvbAJjHf8iKV7X
w1jno1c2hrEPiJ5Z7AuiZzaKsW+I3tkIxr4iemjDGPuO6KUNYexLoqdWxNi3
RG+tkLGviR5bAWPfE722fOYx5fspv5fyeinvk/L+KceVcrwp55FyXinnmzIO
KeOTMm4p45kyzinjnzIvKfOVMo8p85sy7ylxkBIfKXGTEk8pcZYSfylxmRKv
KXGcEt8pcZ+SDyl5kpI/KfmUkmcp+ZeSlyn5mpLHKfkdHuJBHuB+7uNe7uFu
7uJO7uB2buNWbjGfm30d9Tb2wVGH+7Gv5/uwt5/vxZ5eJ9fr5rCH9+vObo6j
K7s4vs7s5Lg7soPzac92zrMt2zj/1mxlXFqyhfFqzmbGsSmbGN/GzDbujdjQ
fDQwP/VZz7zVZR3zWZu1zHNN1jD/1VlNXFRlFfFSmZXEUUVWEF/lmSXuyrGs
eCzDJ8Tp43xM/D4qnkuzlDgvyRLi/xE+LC8e4oPy5QHeL4/u473y6x7eLe/u
4p3y8Q7eLk9v463y9xbeLK9vYvSZTyXFfefI/xsYfemoC9cx+tZRL65l9LWj
jlzN6HtHfbmS0RePunM5o28e9ehSRl896tTFjL77z//vkdGXj7p2AaNvH/Xu
fEZfP+rguYy+f9THuA8g6uXZjPsEoo7+inEfQdTXsxj3GUTdPZNnMPH9xO8l
Xi/xPon3TRxP4jgTx584r8T5JsYhMT6JcUuMZ2KcE+OfmJfEPCXmLzGviflO
xEEiPhJxk4inRJwl4i8Rl4l4TcRxIq4T8Z7Ig0R+JPImkU+JPEvkXyIvE/ma
yONEfoeHeJAHuJ/7uJd7uJu7uJM7uJ3buJVbzOdmX0edjftONjLt+bSfS4uD
8Bc8i7/kr/hrns3f8Byey/N4Pn/LC/g7XsiLeDEv4aW8jJfzCl7Jq3g1r+G1
/D2v4/W8gTfyD7yJN/MW3srbeDvv4J28i3fzHt7L+3g/H+CDfIgP8xGWYEmW
YmlGXR7FkRzB4RzGoRzCwSziIBZyIAs4gPnMY4r92Y992Ye92Ys9mcsc9mB3
dmNXdmFndmJHdmB7tmNbtmFrtmJLtmBzNmNTNmFjZrMRG7IB67Me67IOa7MW
a7IGq7Maq7IKK7MSK7KCOCkvbsqLoyxxlSXOssRdljjMEpdZ4jRL3GaJ4yxx
nSXOs8R9ljzIkhdZ8iRL3mTJoyx5lSXPsuRdljzMkpdZ8jRL3mbJ4yx5nSXP
w2t5Da/mVbySV/ByXsZLeQkv5kW8kL/jBfwtz+d5PJfn8Dc8m7/mr/hLnsVf
8EyewYRR18P/8N/8F//Jf/Dv/Bv/yr/wz/wT/8if+CN/4Pf8jt/yG37Nr/gl
v+Dn/Iyf8hN+zI94iif5IT/g+3yP7/Idvs23+Cbf4Ot8ja/yFb7Ml/giX+AJ
HucxHuURHmbsESIfY48QeRp7hIqsxMqswqqsxuqswZqsxdqsw7qsx/pswIZs
xGw2ZhM2ZTM2Zwu2ZCu2Zhu2ZTu2Zwd2ZCd2Zhd2ZTd2Zw/mMJc92Yu92Yd9
2Y/9mWIe8zmABRzIQg5iEQdzCIdyGIdzBGMdj7iIdT3i5Ofr+TzCozzG4zzB
F/giX+LLfIWv8jW+zjf4Jt/i23yH7/I9vs8P+CFP8hQ/4sf8hJ/yM37OL/gl
v+LX/Ibf8jt+zx/4I3/iH/kn/pl/4V/5N/6d/+A/+S/+m//5P270/CY/t8nv
bfY6m73uFu+zxftudRxbHdc2x7nNcW93Htud1w7nucN57zQOu4zLLuO027jt
No57jOse47zXuO81D/vMyz7ztN+87TePB8zrAfMcsfshIw4iht9nxEnE8ruM
OIqYfpsRZxHbbzLiMGI84jJi/DVG3Easv8KI64j5l/iiR+bfJ3zvOI/5naM8
4rUO85D3OMgD3ns/9zmmvdzjWHdzl3PYyR3Obbtz3catxmALNxubTdxozJ7n
c8ZyA581xuv5jLFfx6fNyVo+Za7W8ElzuJqrzO1KRm8n5nw5o/cTsbCUS5Li
GFmcFMfMIkYvKWJpAaPXFDE2j9GLitibw+hVRUzOYvSyIlZnMHpdEcPTGL2w
iO0p/LlXluidJcW9tMiFCYxeW+TIOEYvLnJnDEcn/60JmRqRqRmZGpKpKZka
k6k5mRqUqUmZGpWpWZkalqlpmRqXqXmZGpipiZkaeTL5/zU0U1MzNTZTczM1
OFOTMzU6U7MzNTxT0zM1PlPzM2tAZk3IrBGZNSOzhmTWlMwak1lzMmtQZk3K
rFGZNSuzhh3kAe7nPu7lHu7mLu7kDm7nNm7lFvO52deRS7GWRi6N9PUIDvdz
wzjU7w/hYK9bxEHer5ADHUcBBzi+fOY57hT7O59+7Os8+7C38+/FnsYl1zjl
sIfx687MXiizN+pivDuzk3noyA7mpz3bmbe2bGM+W7OVeW7J2OvF/Dfnz/eY
Ju4xTYr3ihEvjRl7yYijRoy9ZsRX7D0j3uoz9qYRh3UZe9eIz9qMvW3EbU3G
3jfiuTpjbxxxXpVVkuL4r8zYW0deVGTsvSNfyif//Rsh8qgcyybF+VWGca92
5N3jjHu5Ix/j3u7Iz9KMe78jb0sy7g0/mRTfKx7GveOR5w8x7i2P/H+Ace95
1IX7GPemR724h3HvetSRuxj3tkd9uYNx73vm/86F8TlGUY9u4c1JcZ26ifE5
SFG/bkyK69kNvD4prnPXMT5XKerftYzPXYq6eDXjc5miXl7J+NymqKOXMz7X
KerrpYzPfYq6ezEznyv4v0iNm28=
         "]]]},
      ImageSize->{52.1640625, Automatic}]}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7072512615749702`*^9, 3.707251265717265*^9}, {
  3.70725136468526*^9, 3.707251374886096*^9}, {3.707495877374937*^9, 
  3.707495889223103*^9}, {3.707496236310917*^9, 3.7074962565888767`*^9}, {
  3.7074965857694197`*^9, 3.7074966222799997`*^9}, {3.707505245346434*^9, 
  3.70750526513126*^9}, {3.7075053083878202`*^9, 3.707505314622056*^9}, {
  3.707505393828124*^9, 3.707505448767522*^9}, {3.707505756334353*^9, 
  3.7075058313798943`*^9}, {3.707505938342243*^9, 3.707505953622929*^9}, {
  3.7075059890090313`*^9, 
  3.7075060562365503`*^9}},ExpressionUUID->"487766c1-9d32-455c-b293-\
afab3c7bff62"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"ChemDVRClass", "[", "a_Association", "]"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"RawBoxes", "@", "\n", "\t\t", 
    RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\n", "\t\t\t", 
     RowBox[{"\"\<ChemDVRClass\>\"", ",", "\n", "\t\t\t", 
      RowBox[{"Lookup", "[", 
       RowBox[{"a", ",", "\"\<Icon\>\"", ",", 
        RowBox[{"ChemDVRClass", "@", "a"}]}], "]"}], ",", "\n", "\t\t\t", 
      "$dvrclassimg", ",", "\n", "\t\t\t\t", 
      RowBox[{"{", "\n", "\t\t\t\t\t", 
       RowBox[{"BoxForm`MakeSummaryItem", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Name: \>\"", ",", 
           RowBox[{"Lookup", "[", 
            RowBox[{"a", ",", "\"\<Name\>\""}], "]"}]}], "}"}], ",", 
         "StandardForm"}], "]"}], "\n", "\t", "\t\t\t\t", "}"}], ",", "\n", 
      "\t", "\t\t", 
      RowBox[{"KeyValueMap", "[", "\n", "\t", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"BoxForm`MakeSummaryItem", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Row", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", "\"\<: \>\""}], "}"}]}], ",", "#2"}], "}"}], 
           ",", "StandardForm"}], "]"}], "&"}], ",", "\n", "\t", "\t\t\t\t", 
        RowBox[{"KeySelect", "[", 
         RowBox[{"a", ",", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"Except", "[", "\"\<Name\>\"", "]"}], "]"}]}], "]"}]}], 
       "\n", "\t", "\t\t\t", "]"}], ",", "\n", "\t", "\t\t", "StandardForm"}],
      "\n", "\t", "\t\t", "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992014129906178`*^9, 3.699201457489113*^9}, {
  3.699201570816434*^9, 3.699201618622539*^9}, {3.699206072093081*^9, 
  3.6992060732582197`*^9}, {3.69921129284207*^9, 3.699211295523595*^9}, {
  3.700004724964623*^9, 3.700004724971187*^9}, {3.707251268393806*^9, 
  3.707251271412424*^9}, {3.707505352271861*^9, 
  3.70750535719699*^9}},ExpressionUUID->"f17b21a3-7cd3-4fd5-9298-8ad6193b84ef"]
}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"fdeebcf6-8c06-4eff-91a0-\
04c994bffda0"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"9009c70d-1aad-415c-9701-\
edff1eaf5262"]
},
WindowSize->{788, 764},
WindowMargins->{{Automatic, 320}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

