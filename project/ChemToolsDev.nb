Notebook[{

Cell[CellGroupData[{
Cell["Symmetry Utilities", "CodeSection",
 CellChangeTimes->{{3.699309904476507*^9, 3.699309925987681*^9}, {
  3.718853827922717*^9, 
  3.7188538323609943`*^9}},ExpressionUUID->"f0604fb3-f2a8-4b8c-923f-\
aab08f484d02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemComputeSymmetryElements", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Finds all the symmetry elements of a collection of atoms\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemComputeInertialSymmetry", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Finds symmetry elements relative to the ABC axes\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemComputePointGroup", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Guesses the point group of the collection of atoms\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"29a9548b-f5bc-4812-87c2-b958328d8ae4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"b87ebe19-b7be-4ef4-8898-\
f23222baca30"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Common Uses\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"8e457046-554d-4b8b-b444-061d567aef09"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]symmetricPointQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693931314644553*^9, 
  3.693931317260872*^9}},ExpressionUUID->"355eb34c-4e05-491a-a727-\
be29afa02c78"],

Cell["\[LeftCeiling]Might be worth having a symmetry tester for each group\
\[RightFloor]", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.7185642503103523`*^9, 
  3.7185642599343557`*^9}},ExpressionUUID->"36b23b11-6d18-44f4-9eaf-\
06dcea256219"],

Cell[BoxData[
 RowBox[{
  RowBox[{"symmetricPointQ", "=", "\n", "\t", 
   RowBox[{"Compile", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", "\n", 
       "\t", "\t\t", 
       RowBox[{"{", 
        RowBox[{"opos", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", "\n", 
       "\t", "\t\t", 
       RowBox[{"{", 
        RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "\n", "\t", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Block", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"flag", "=", "False"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"idx", "=", "1"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"len", "=", 
          RowBox[{"Length", "@", "positions"}]}]}], "\n", "\t\t\t\t", "}"}], 
       ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"While", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"idx", "<=", "len"}], "&&", "\n", "\t\t\t\t\t", 
           RowBox[{"Not", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{"flag", "=", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "tol"}], "\[LessEqual]", 
               RowBox[{"positions", "[", 
                RowBox[{"[", 
                 RowBox[{"idx", ",", " ", "1"}], "]"}], "]"}], "<=", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "+", "tol"}]}], "&&", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "tol"}], "<=", 
               RowBox[{"positions", "[", 
                RowBox[{"[", 
                 RowBox[{"idx", ",", " ", "2"}], "]"}], "]"}], "<=", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", "tol"}]}], "&&", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "-", "tol"}], "<=", 
               RowBox[{"positions", "[", 
                RowBox[{"[", 
                 RowBox[{"idx", ",", " ", "3"}], "]"}], "]"}], "<=", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "+", "tol"}]}]}]}], "\n", 
            "\t", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
          RowBox[{"idx", "++"}]}], "\n", "\t\t\t\t", "]"}], ";", "\n", 
        "\t\t\t", "flag"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.693868096584106*^9, 3.693868104428486*^9}, {
   3.6938681389355803`*^9, 3.693868157821383*^9}, 3.693868254143012*^9, {
   3.693868292688652*^9, 3.6938685289015007`*^9}, {3.6938685805445232`*^9, 
   3.69386858070562*^9}, {3.693868620845501*^9, 3.693868897703773*^9}, {
   3.693869033306057*^9, 3.6938690732612057`*^9}, {3.6938691567947283`*^9, 
   3.693869296805365*^9}, 3.693882114589674*^9, {3.718550885259305*^9, 
   3.718550919456504*^9}, {3.718563879112688*^9, 3.718563904450831*^9}, {
   3.718563948109585*^9, 3.718564243792357*^9}, {3.718570468731543*^9, 
   3.718570476858918*^9}, {3.718570534365793*^9, 3.7185706299088993`*^9}, {
   3.718639550077507*^9, 
   3.718639550915492*^9}},ExpressionUUID->"856793d0-3e2c-47fd-82a3-\
b1b675b59892"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]symmetryOperationQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693931314644553*^9, 
  3.693931322226218*^9}},ExpressionUUID->"0f53e485-88eb-4bed-93a7-\
9329a1f214b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"symmetryOperationQ", "[", 
    RowBox[{"transform_", ",", " ", "pts_List", ",", " ", "tol_"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"pts", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"With", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{"tp", "=", 
          RowBox[{"transform", "@", "#"}]}], "\n", "\t\t\t\t", "}"}], ",", 
        "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"ListQ", "@", "tp"}], "&&", 
         RowBox[{"(", 
          RowBox[{"symmetricPointQ", "[", 
           RowBox[{"tp", ",", " ", "#", ",", " ", "pts", ",", " ", "tol"}], 
           "]"}], ")"}]}]}], "\n", "\t\t\t", "]"}], "&"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"symmetryOperationQ", "[", 
   RowBox[{"transform_", ",", "grps_Association", ",", "tol_"}], "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"AllTrue", "[", 
   RowBox[{"grps", ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"symmetryOperationQ", "[", 
      RowBox[{"transform", ",", " ", "#", ",", " ", "tol"}], "]"}], "&"}]}], 
   "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.693869347949503*^9, 3.6938694185166903`*^9}, {
  3.693869465025756*^9, 3.693869515976171*^9}, {3.6938701685721827`*^9, 
  3.693870192954495*^9}, {3.6938707546033287`*^9, 3.6938707679954367`*^9}, {
  3.718563749639727*^9, 3.7185638723040733`*^9}, {3.7185642793272448`*^9, 
  3.718564296728104*^9}, {3.718569535497274*^9, 3.718569665194791*^9}, {
  3.718570243448963*^9, 3.718570369413782*^9}, {3.718571043046962*^9, 
  3.718571044100395*^9}, {3.718764209757475*^9, 3.718764210660788*^9}, {
  3.7187642912643414`*^9, 
  3.718764300316451*^9}},ExpressionUUID->"be20e7b1-7180-4adb-b586-\
02fcf5dc7c16"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]uniqueAxesQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.6939313847981863`*^9},ExpressionUUID->"a2abc5e9-e06d-4cde-8884-\
ab62bea0387f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uniqueAxesQComp", "=", "\n", "\t", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"p", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"q", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "/", 
              RowBox[{"Norm", "[", "#", "]"}]}], "&"}], "@", "p"}], "-", 
           "center"}]}], ",", 
         RowBox[{"n2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "/", 
              RowBox[{"Norm", "[", "#", "]"}]}], "&"}], "@", "q"}], "-", 
           "center"}]}]}], "}"}], ",", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"n1", "-", "n2"}], "]"}], ">", "tol"}], "&&", "\n", 
        "\t\t\t\t", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"n1", "+", "n2"}], "]"}], ">", "tol"}]}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uniqueAxesQ", "[", 
    RowBox[{"center_", ",", " ", "p_", ",", "q_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"uniqueAxesQComp", "[", 
    RowBox[{
    "center", ",", "p", ",", "q", ",", " ", 
     "$ChemSymmetryUniquenessThreshold"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uniqueAxesQ", "[", "center_", "]"}], "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"uniqueAxesQComp", "[", 
    RowBox[{"center", ",", "p", ",", "q"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693930570350498*^9, 3.6939305773505573`*^9}, {
   3.6939306208667*^9, 3.693930727711863*^9}, {3.693945427389694*^9, 
   3.693945437263027*^9}, {3.693945467916223*^9, 3.693945474035131*^9}, {
   3.693945797152905*^9, 3.69394579755023*^9}, {3.7185718759359083`*^9, 
   3.7185718876379538`*^9}, {3.718572007286759*^9, 3.718572010001068*^9}, {
   3.718572059064726*^9, 3.718572059933045*^9}, {3.7185909661469383`*^9, 
   3.718590967002771*^9}, {3.718591105690886*^9, 3.718591197519814*^9}, {
   3.718604269635437*^9, 3.718604286217331*^9}, 3.718642120071246*^9, {
   3.7186421735932903`*^9, 3.718642173612651*^9}, {3.718744924308242*^9, 
   3.718744947260483*^9}},ExpressionUUID->"b1138c35-fae7-4f54-bed3-\
990c4f4d2916"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]deleteDuplicateAxes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7187572003840322`*^9, 3.7187572035098877`*^9}, {
  3.718759228409775*^9, 
  3.718759229104574*^9}},ExpressionUUID->"f2568a0f-f56d-46a8-b2d5-\
86f18e3015d6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deleteDuplicateAxesInds", "[", "tol_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Compile", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\t", 
      RowBox[{"{", 
       RowBox[{"vecs", ",", " ", "_Real", ",", " ", "2"}], "}"}], " ", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{"pickedVecs", ",", "\n", "\t\t\t", 
         RowBox[{"tally", "=", "0."}], ",", "\n", "\t\t\t", "vecNorm", ",", 
         "\n", "\t\t\t", "angs", ",", "\n", "\t\t\t", "order", ",", "\n", 
         "\t\t\t", "reorder", ",", "\n", "\t\t\t", "angDiffs", ",", "\n", 
         "\t\t\t", "angSel", ",", "\n", "\t\t\t", 
         RowBox[{"flag", "=", "1"}], ",", "\n", "\t\t\t", 
         RowBox[{"tolTrue", "=", 
          RowBox[{"tol", "/", "100"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Times", "@@", "\n", "\t\t\t\t", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"vecNorm", "=", 
            RowBox[{"Norm", "@", 
             RowBox[{"vecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\n", "\t\t\t\t\t", 
           RowBox[{"angs", "=", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vecs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ".", 
                 RowBox[{"vecs", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"vecNorm", "*", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"vecs", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ")"}]}], ",", 
              "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"i", "+", "1"}], ",", " ", 
                RowBox[{"Length", "@", "vecs"}]}], "}"}]}], "\n", 
             "\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t\t\t", 
           RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"1", ",", " ", 
               RowBox[{"{", 
                RowBox[{"o", ",", " ", "i"}], "}"}]}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "-", "tol"}], "<", 
                  RowBox[{"Abs", "[", "#", "]"}]}], ",", " ", "0", ",", " ", 
                 "1"}], "]"}], "&"}], "/@", "angs"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}]}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "@", "vecs"}]}], "}"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"deleteDuplicateAxes", "[", 
   RowBox[{"axes_", ",", " ", "tol_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"real", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"axes", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", "#", "]"}], ">", "tol"}], "&"}]}], "]"}]}], 
     "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "real", "]"}], ">", "1"}], ",", "\n", "\t\t\t", 
      
      RowBox[{"Pick", "[", 
       RowBox[{"real", ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"deleteDuplicateAxesInds", "[", "tol", "]"}], "@", "real"}], 
        ",", "\n", "\t\t\t\t", "1"}], "]"}], ",", "\n", "\t\t\t", "real"}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.718757208624332*^9, 3.718757361791288*^9}, {
   3.718757392716515*^9, 3.718757429808181*^9}, {3.7187575066526423`*^9, 
   3.718757664173521*^9}, {3.7187577937204733`*^9, 3.718757846087491*^9}, {
   3.7187579099886627`*^9, 3.718758034724592*^9}, {3.718758107247653*^9, 
   3.718758144339818*^9}, {3.718758184603244*^9, 3.7187583113589067`*^9}, {
   3.718758348305464*^9, 3.718758348986658*^9}, {3.718758472490013*^9, 
   3.718758606137054*^9}, {3.718758835412499*^9, 3.718758951457016*^9}, {
   3.718759029728397*^9, 3.718759163996477*^9}, {3.718759232706996*^9, 
   3.718759254779829*^9}, {3.7187593839568033`*^9, 3.7187593988175793`*^9}, {
   3.718759621727358*^9, 3.718759630640173*^9}, {3.7187607153052588`*^9, 
   3.718760846358426*^9}, {3.718760883003327*^9, 3.7187610649118*^9}, {
   3.718761100098308*^9, 3.718761231862609*^9}, {3.71876152746276*^9, 
   3.7187615380631323`*^9}, {3.718761571184825*^9, 3.71876162190406*^9}, 
   3.718762085913456*^9, {3.7187629229034557`*^9, 3.7187629859850883`*^9}, {
   3.718763102510935*^9, 3.718763107306473*^9}, {3.718763264970899*^9, 
   3.718763277815106*^9}, {3.718764382967464*^9, 3.7187643847244797`*^9}, {
   3.718764507013486*^9, 3.71876450795269*^9}, 3.718764625484418*^9, {
   3.718765122965559*^9, 3.718765223172495*^9}, {3.7187652628017473`*^9, 
   3.7187653165354137`*^9}, {3.7187746948574343`*^9, 3.718774747082506*^9}, {
   3.718818015287705*^9, 3.718818029461454*^9}, {3.718818082565815*^9, 
   3.718818095968535*^9}, {3.718818129088944*^9, 3.7188181380107517`*^9}, {
   3.7188188452088747`*^9, 3.718818865957944*^9}, {3.718820572355321*^9, 
   3.718820625521644*^9}, {3.718820800917883*^9, 3.718820888115798*^9}, 
   3.718820922326833*^9, {3.7188358079348803`*^9, 3.718835858229866*^9}, 
   3.718836740602749*^9, 3.7188382081708317`*^9, {3.718838317346896*^9, 
   3.718838317763278*^9}, {3.71883878815565*^9, 3.7188387893776693`*^9}, {
   3.71883904722656*^9, 3.7188390540267887`*^9}, 3.718839268692605*^9, {
   3.718840003543359*^9, 3.7188400279431477`*^9}, {3.7188432939467382`*^9, 
   3.7188432991084747`*^9}, {3.718843331218725*^9, 
   3.718843343715939*^9}},ExpressionUUID->"e90174b5-bf8e-4ef9-ba70-\
c6d12b6968f8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumerateAxes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718762098080755*^9, 
  3.718762100429113*^9}},ExpressionUUID->"eeb8d5d5-539e-4dfd-9231-\
cf98e02e09c2"],

Cell[BoxData[
 RowBox[{"enumerateAxesNormals", "=", "\n", "\t", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"p", ",", "_Real", ",", "3"}], "}"}], "}"}], ",", "\n", "\t\t", 
    
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", " ", "p"}], 
     "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7186481365551033`*^9, 3.718648182846286*^9}, {
   3.718648396574869*^9, 3.718648399230462*^9}, 3.71864868376438*^9, {
   3.7186487306378317`*^9, 3.7186487424199944`*^9}, 3.718652534171379*^9, {
   3.7187548193805923`*^9, 
   3.718754825052496*^9}},ExpressionUUID->"8b89bbb2-c2da-457d-95e2-\
a242c605ff9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumerateAxes", "[", 
   RowBox[{"positions_", ",", " ", "tol_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"enumerateAxesCached", "[", 
     RowBox[{"{", 
      RowBox[{"positions", ",", " ", "tol"}], "}"}], "]"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Except", "[", "_List", "]"}], ":>", "\n", "\t\t\t", 
     RowBox[{"Set", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"enumerateAxesCached", "[", 
        RowBox[{"{", 
         RowBox[{"positions", ",", " ", "tol"}], "}"}], "]"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{"posReal", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"deleteDuplicateAxes", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"positions", ",", " ", "\n", "\t\t\t\t\t\t\t", "tol"}], 
            "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "}"}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"deleteDuplicateAxes", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"enumeratePositions", "[", "posReal", "]"}], ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", "=", 
                 RowBox[{"enumeratePlanesSimple", "[", 
                  RowBox[{"posReal", ",", " ", "tol"}], "]"}]}], "}"}], ",", 
               "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "r", "]"}], ">", "0"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"enumerateAxesNormals", "@", "r"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"{", "}"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], 
              "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
            "]"}], ",", "\n", "\t\t\t\t\t\t", "tol"}], "\n", "\t\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], 
   "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718647451617277*^9, 3.718647466984288*^9}, {
   3.718648070814536*^9, 3.718648096157378*^9}, {3.718648390559228*^9, 
   3.718648407204258*^9}, {3.718648501269185*^9, 3.718648505069202*^9}, {
   3.718648590596682*^9, 3.718648616882307*^9}, {3.7186486934774323`*^9, 
   3.718648697173171*^9}, {3.71864882131478*^9, 3.7186488218193913`*^9}, {
   3.718648854476654*^9, 3.718648874450768*^9}, 3.7186496980707808`*^9, {
   3.718649738998571*^9, 3.718649822062825*^9}, {3.7186499085322313`*^9, 
   3.718649917181172*^9}, {3.718650381229319*^9, 3.718650381897015*^9}, {
   3.718750811534178*^9, 3.718750825719798*^9}, {3.718750910130663*^9, 
   3.7187509125776243`*^9}, 3.718753764974206*^9, {3.718754814892263*^9, 
   3.718754836763751*^9}, {3.718755118983307*^9, 3.718755135339758*^9}, {
   3.718762077186002*^9, 3.718762078999322*^9}, {3.718763244641769*^9, 
   3.718763254619008*^9}, 3.718763950971726*^9, {3.7187643557269783`*^9, 
   3.718764363958625*^9}, {3.718765323953689*^9, 3.71876535995713*^9}, {
   3.718765760660337*^9, 3.718765809876622*^9}, {3.7187663148945932`*^9, 
   3.7187663639598513`*^9}, {3.718766501970708*^9, 3.718766527378215*^9}, {
   3.718766714211608*^9, 3.718766715019596*^9}, {3.718766849886457*^9, 
   3.718766857541012*^9}, 3.718766945308961*^9, 3.718767170649253*^9, {
   3.718767341462205*^9, 3.718767352849918*^9}, {3.718767407620315*^9, 
   3.718767448565651*^9}, {3.7187741855715218`*^9, 3.718774216384794*^9}, {
   3.718774645449349*^9, 3.718774682164936*^9}, {3.718818157703199*^9, 
   3.718818158947747*^9}, {3.718818892842499*^9, 3.718818927485592*^9}, {
   3.7188193400707397`*^9, 3.718819360636744*^9}, {3.718820185090434*^9, 
   3.7188202007622957`*^9}, {3.718820230936947*^9, 3.71882024301055*^9}, 
   3.718820326581253*^9, {3.718820407877521*^9, 3.718820417769326*^9}, {
   3.718820475333194*^9, 3.718820477336712*^9}, {3.71883587618124*^9, 
   3.71883593009207*^9}, {3.7188359971603537`*^9, 3.7188361012876587`*^9}, {
   3.718836146032971*^9, 3.718836153053254*^9}, {3.718836423149149*^9, 
   3.7188364276819277`*^9}, {3.71883798201582*^9, 3.718837991907094*^9}, {
   3.718839069946313*^9, 3.71883907801553*^9}, {3.718839108778051*^9, 
   3.718839135005396*^9}, {3.7188401583014708`*^9, 3.7188401797570066`*^9}, {
   3.718840227810975*^9, 
   3.718840243102936*^9}},ExpressionUUID->"9c6b9c92-549e-4f83-b77e-\
e785f631d885"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Compiled Attempt\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"9b0cd0fb-f1bf-4e64-a503-80bf29557486"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]uniquePointsQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.718609182415524*^9},ExpressionUUID->"90cfa913-88a1-47ef-b323-\
224163b6cf95"],

Cell[BoxData[{
 RowBox[{"uniquePointsQComp", "=", "\n", "\t", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pt1", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pt2", ",", "_Real", ",", "1"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"tol", ",", "_Real"}], "}"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{"pt1", "-", "pt2"}], "]"}], ">", "tol"}]}], "\n", "\t\t", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uniquePointsQ", "[", 
    RowBox[{"pt1_List", ",", " ", "pt2_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"uniquePointsQComp", "[", 
    RowBox[{
    "pt1", ",", " ", "pt2", ",", " ", "$ChemSymmetryUniquenessThreshold"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"uniquePointsQ", "[", "___", "]"}], ":=", "False"}]}], "CodeInput",
 CellChangeTimes->{{3.718591066889296*^9, 3.71859108657038*^9}, {
   3.7185912070161*^9, 3.71859127199855*^9}, {3.718591341398511*^9, 
   3.718591366429934*^9}, 3.7185915611954536`*^9, {3.718604316248123*^9, 
   3.718604334463694*^9}},ExpressionUUID->"1e7656e2-26f1-412a-a195-\
0be208b994a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumeratePlanesIter Basic\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718563121813686*^9, 3.718563125388068*^9}, {
  3.718567733287434*^9, 3.718567735731179*^9}, {3.718637305448616*^9, 
  3.718637310982647*^9}},ExpressionUUID->"7d822684-246c-465e-8d86-\
70256827fa2e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"enumeratePlanesIter1", ":=", 
    RowBox[{"enumeratePlanesIter1", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t", 
        RowBox[{
         RowBox[{"$chemSymmEscapeArray", "=", "$chemSymmEscapeArray"}], ",", 
         "\n", "\t", 
         RowBox[{"uniquePointsQComp", "=", "uniquePointsQComp"}], ",", "\n", 
         "\t", 
         RowBox[{
         "$ChemSymmetryUniquenessThreshold", "=", 
          "$ChemSymmetryUniquenessThreshold"}], ",", "\n", "\t", 
         RowBox[{"enumeratePositionsIter", "=", "enumeratePositionsIter"}]}], 
        "\n", "\t", "}"}], ",", "\n", "\t\t", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t", "\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
           ",", "\n", "\t", "\t\t", 
           RowBox[{"{", 
            RowBox[{"n", ",", " ", "_Integer"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"plen", ",", " ", "_Integer"}], "}"}]}], "\n", "\t\t\t", 
          "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"With", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"1", "+", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"plen", "^", "2"}], ")"}]}], "]"}]}]}], ",", "\n", 
             "\t", "\t", "\t\t\t", 
             RowBox[{"j", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"n", ",", " ", 
                RowBox[{"plen", "^", "2"}], ",", " ", "1"}], "]"}]}]}], "\n", 
            "\t", "\t", "\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">=", "j"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{
              "$chemSymmEscapeArray", ",", " ", "$chemSymmEscapeArray"}], 
              "}"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pt1", "=", 
                 RowBox[{"enumeratePositionsIter", "[", 
                  RowBox[{"positions", ",", " ", "i", ",", " ", "plen"}], 
                  "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"pt1", "!=", "$chemSymmEscapeArray"}], "&&", "\n",
                     "\t\t\t\t\t\t\t\t", 
                    RowBox[{"uniquePointsQComp", "[", 
                    RowBox[{
                    "pt1", ",", " ", "center", ",", 
                    "$ChemSymmetryUniquenessThreshold"}], "]"}]}], "\n", 
                   "\t\t\t\t\t\t\t\t", ")"}], "//", "TrueQ"}], ",", "\n", 
                 "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"pt2", "=", 
                    RowBox[{"enumeratePositionsIter", "[", 
                    RowBox[{"positions", ",", " ", "j", ",", " ", "plen"}], 
                    "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"pt2", "!=", "$chemSymmEscapeArray"}], "&&", "\n",
                     "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"uniquePointsQComp", "[", 
                    RowBox[{
                    "pt2", ",", " ", "center", ",", " ", 
                    "$ChemSymmetryUniquenessThreshold"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", ")"}], "//", "TrueQ"}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"pt1", ",", " ", "pt2"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    "$chemSymmEscapeArray", ",", " ", 
                    "$chemSymmEscapeArray"}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                  "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{
                  "$chemSymmEscapeArray", ",", " ", "$chemSymmEscapeArray"}], 
                  "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", 
              "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
          "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
      "]"}]}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.718563068734398*^9, 3.7185630952952557`*^9}, {
   3.718563131886092*^9, 3.718563143596406*^9}, {3.718563203519526*^9, 
   3.718563234154915*^9}, {3.718563436117363*^9, 3.7185634577317457`*^9}, {
   3.718563535732452*^9, 3.718563543626466*^9}, 3.718563651056275*^9, {
   3.7185650340606728`*^9, 3.718565042747954*^9}, {3.718565129827237*^9, 
   3.718565209588175*^9}, {3.718565444410516*^9, 3.71856547491201*^9}, {
   3.718566654232503*^9, 3.718566728514124*^9}, {3.718566813163412*^9, 
   3.718566824019371*^9}, {3.7185669328137617`*^9, 3.71856696687014*^9}, {
   3.71856700891262*^9, 3.71856700977518*^9}, 3.7185670561688013`*^9, {
   3.7185673168421793`*^9, 3.7185673315900097`*^9}, {3.7185674008766737`*^9, 
   3.71856742241988*^9}, {3.718567461201674*^9, 3.718567479351462*^9}, {
   3.718567518479474*^9, 3.7185675195975647`*^9}, 3.7185675665972347`*^9, {
   3.71856769012465*^9, 3.7185676903146963`*^9}, {3.718571191913656*^9, 
   3.718571274534093*^9}, {3.718571479774027*^9, 3.718571481907873*^9}, 
   3.7185716763199463`*^9, {3.718571713922353*^9, 3.718571716377289*^9}, {
   3.718573849931273*^9, 3.71857385142423*^9}, {3.718574171417934*^9, 
   3.718574180118444*^9}, {3.7185743535153923`*^9, 3.718574375830408*^9}, {
   3.718574441243883*^9, 3.7185744449162493`*^9}, {3.718574505871586*^9, 
   3.7185746560109863`*^9}, {3.718574737940432*^9, 3.718574741056756*^9}, {
   3.7185748172995577`*^9, 3.718574821314806*^9}, {3.718574879792918*^9, 
   3.7185748819939327`*^9}, {3.718574947404476*^9, 3.71857498422305*^9}, {
   3.718575622512013*^9, 3.718575655102788*^9}, {3.7185756875519333`*^9, 
   3.718575734058361*^9}, {3.7185757769046383`*^9, 3.71857587910115*^9}, {
   3.718575929169014*^9, 3.718575989312982*^9}, {3.718576095856179*^9, 
   3.718576107554681*^9}, 3.718576415756146*^9, {3.7185912760953293`*^9, 
   3.718591311246863*^9}, {3.718637021580352*^9, 3.718637301181385*^9}, {
   3.718637365405898*^9, 3.7186373697509737`*^9}, {3.7186399745742083`*^9, 
   3.718639977106324*^9}, {3.718640038321322*^9, 3.71864003852838*^9}, {
   3.718640109124281*^9, 3.718640114756816*^9}, {3.718640629989229*^9, 
   3.718640632932458*^9}, 3.718640681635343*^9, {3.718641062903867*^9, 
   3.71864106642949*^9}, {3.7186411057951508`*^9, 3.7186411071366053`*^9}, {
   3.718641941626911*^9, 3.718641945346774*^9}, {3.718642486283057*^9, 
   3.718642501462572*^9}, {3.718642589842084*^9, 
   3.718642592360545*^9}},ExpressionUUID->"bb1ac031-bc85-4ff2-a161-\
830ba62d2634"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]symmetryTestAxis\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"4396f2ea-952c-4979-b912-de56863740f5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"enumerateAxesIter", ":=", 
    RowBox[{"enumerateAxesIter", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t", 
        RowBox[{
         RowBox[{"$chemSymmEscapeArray", "=", "$chemSymmEscapeArray"}], ",", 
         "\n", "\t", 
         RowBox[{"uniquePointsQComp", "=", "uniquePointsQComp"}], ",", "\n", 
         "\t", 
         RowBox[{
         "$ChemSymmetryUniquenessThreshold", "=", 
          "$ChemSymmetryUniquenessThreshold"}], ",", "\n", "\t", 
         RowBox[{"enumeratePositionsIter", "=", "enumeratePositionsIter"}], 
         ",", "\n", "\t", 
         RowBox[{"enumeratePlanesIter", "=", "enumeratePlanesIter"}]}], "\n", 
        "\t", "}"}], ",", "\n", "\t", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
           ",", "\n", "\t\t", 
           RowBox[{"{", 
            RowBox[{"n", ",", " ", "_Integer"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"plen", ",", " ", "_Integer"}], "}"}]}], "\n", "\t\t", 
          "}"}], ",", "\n", "\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", "=", "\n", "\t", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"n", "<=", 
                RowBox[{"plen", "^", "2"}]}], ",", "\n", "\t\t\t\t", 
               RowBox[{"enumeratePositionsIter", "[", 
                RowBox[{"positions", ",", " ", "n", ",", " ", "plen"}], "]"}],
                ",", "\n", "\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"s", "=", 
                   RowBox[{"enumeratePlanesIter", "[", 
                    RowBox[{"center", ",", " ", "positions", ",", " ", 
                    RowBox[{"n", " ", "-", " ", "plen"}]}], "]"}]}], "}"}], 
                 ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"s", "=!=", "$chemSymmEscapeArray"}], ",", "\n", 
                   "\t\t\t\t\t\t", 
                   RowBox[{"center", "+", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "center"}], ",", " ", 
                    RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}], 
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
                   "$chemSymmEscapeArray"}], "\n", "\t\t\t\t\t\t", "]"}]}], 
                "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
            "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"uniquePointsQComp", "[", 
              RowBox[{
              "p", ",", "center", ",", "$ChemSymmetryUniquenessThreshold"}], 
              "]"}], ",", "\n", "\t\t\t\t", "p", ",", " ", "\n", "\t\t\t\t", 
             "$chemSymmEscapeArray"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
          "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}]}], 
   ";", "\n", 
   RowBox[{
    RowBox[{"symmetryTestAxis", "[", 
     RowBox[{"center_", ",", " ", "positions_", ",", " ", "n_"}], "]"}], ":=",
     "\n", "\t", 
    RowBox[{"enumerateAxesIter", "[", 
     RowBox[{"center", ",", " ", "positions", ",", " ", "n", ",", " ", 
      RowBox[{"Length", "@", "positions"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"symmetryTestAxisCount", "[", "positions_", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "positions"}], "^", "4"}], "+", 
     RowBox[{"Length", "@", "positions"}]}]}]}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.693947552091663*^9, 3.6939475617271757`*^9}, {
   3.693947850454286*^9, 3.693947854643901*^9}, {3.693947885324699*^9, 
   3.693947890189496*^9}, {3.693948091349102*^9, 3.6939480946272297`*^9}, {
   3.693953488430533*^9, 3.693953506597168*^9}, {3.693953736598844*^9, 
   3.693953739253339*^9}, 3.693953842134327*^9, {3.7185652392636137`*^9, 
   3.7185652473283*^9}, {3.7185658706543283`*^9, 3.718565873055396*^9}, {
   3.7185660507292233`*^9, 3.718566056848847*^9}, {3.7185661240230827`*^9, 
   3.718566227865456*^9}, {3.718566537446185*^9, 3.718566637709152*^9}, {
   3.7185667343442287`*^9, 3.718566804475574*^9}, {3.718566947358583*^9, 
   3.718566948317726*^9}, {3.718566989239575*^9, 3.718566994420229*^9}, {
   3.718567483807186*^9, 3.718567512781579*^9}, {3.718569034834062*^9, 
   3.7185690353836203`*^9}, {3.71856915280811*^9, 3.718569186806691*^9}, {
   3.718571784785494*^9, 3.7185718201248207`*^9}, {3.718574092314979*^9, 
   3.7185741069289503`*^9}, {3.718574157370283*^9, 3.71857425002078*^9}, {
   3.718575071012796*^9, 3.718575073761989*^9}, {3.718575281709482*^9, 
   3.718575281907475*^9}, {3.718591319129506*^9, 3.7185913325259*^9}, {
   3.718591376651112*^9, 3.71859138536445*^9}, {3.718637349696803*^9, 
   3.7186374477956533`*^9}, {3.7186376705200253`*^9, 3.718637686918185*^9}, {
   3.718639952532323*^9, 3.7186399829151154`*^9}, 3.7186410774554243`*^9, {
   3.718641931255705*^9, 
   3.718641935410735*^9}},ExpressionUUID->"30e94279-a897-49f2-b2e0-\
64b72da2681c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]symmetryTestPlane\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718637327967203*^9, 
  3.718637341061719*^9}},ExpressionUUID->"e9c6e96b-fab1-4836-a71f-\
e7b15c61ff3a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"enumeratePlanesIter2", ":=", "\n", "\t", 
    RowBox[{"enumeratePlanesIter2", "=", 
     RowBox[{"With", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"$chemSymmEscapeArray", "=", "$chemSymmEscapeArray"}], ",", 
         "\n", "\t", "\t", 
         RowBox[{"uniquePointsQComp", "=", "uniquePointsQComp"}], ",", "\n", 
         "\t", "\t", 
         RowBox[{
         "$ChemSymmetryUniquenessThreshold", "=", 
          "$ChemSymmetryUniquenessThreshold"}], ",", "\n", "\t\t", 
         RowBox[{"enumerateAxesIter", "=", "enumerateAxesIter"}]}], "\n", 
        "\t\t", "}"}], ",", "\n", "\t\t", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t", "\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
           ",", "\n", "\t", "\t\t", 
           RowBox[{"{", 
            RowBox[{"n", ",", " ", "_Integer"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"plen", ",", " ", "_Integer"}], "}"}]}], "\n", "\t\t\t", 
          "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"With", "[", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"1", "+", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"plen", "^", "2"}], ")"}]}], "]"}]}]}], ",", "\n", 
             "\t", "\t", "\t\t\t", 
             RowBox[{"j", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"n", ",", " ", 
                RowBox[{"(", 
                 RowBox[{"plen", "^", "2"}], ")"}], ",", " ", "1"}], 
               "]"}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
           
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pt1", "=", 
               RowBox[{"enumerateAxesIter", "[", 
                RowBox[{"center", ",", " ", "positions", ",", " ", 
                 RowBox[{"i", " ", "+", " ", 
                  RowBox[{"plen", "^", "2"}]}], ",", " ", "plen"}], "]"}]}], 
              "}"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"pt1", "!=", "$chemSymmEscapeArray"}], "&&", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"uniquePointsQComp", "[", 
                   RowBox[{
                   "pt1", ",", " ", "center", ",", " ", 
                    "$ChemSymmetryUniquenessThreshold"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", ")"}], "//", "TrueQ"}], ",", "\n", "\t", 
               "\t", "\t\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"pt2", "=", 
                   RowBox[{"enumerateAxesIter", "[", 
                    RowBox[{
                    "center", ",", " ", "positions", ",", " ", "j", ",", " ", 
                    "plen"}], "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"pt2", "!=", "$chemSymmEscapeArray"}], "&&", "\n",
                     "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"uniquePointsQComp", "[", 
                    RowBox[{
                    "pt2", ",", " ", "center", ",", " ", 
                    "$ChemSymmetryUniquenessThreshold"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", ")"}], "//", "TrueQ"}], ",", "\n",
                    "\t", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"pt1", ",", " ", "pt2"}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{
                    "$chemSymmEscapeArray", ",", " ", 
                    "$chemSymmEscapeArray"}], "}"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{
                "$chemSymmEscapeArray", ",", " ", "$chemSymmEscapeArray"}], 
                "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}], ";", "\n", 
   RowBox[{"enumeratePlanesIter", "=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"enumeratePlanesIter1", "=", "enumeratePlanesIter1"}], ",", 
        "\n", "\t\t", 
        RowBox[{"enumeratePlanesIter2", "=", "enumeratePlanesIter2"}]}], "\n",
        "\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"Compile", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
          ",", "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"n", ",", " ", "_Integer"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"plen", ",", " ", "_Integer"}], "}"}]}], "\n", "\t\t\t\t", 
         "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"n", " ", "<=", " ", 
           RowBox[{"plen", "^", "4"}]}], ",", "\n", "\t\t\t\t", 
          RowBox[{"enumeratePlanesIter1", "[", 
           RowBox[{
           "center", ",", " ", "positions", ",", " ", "n", ",", " ", "plen"}],
            "]"}], ",", "\n", "\t", "\t\t\t", 
          RowBox[{"enumeratePlanesIter2", "[", 
           RowBox[{
           "center", ",", " ", "positions", ",", " ", "n", ",", " ", "plen"}],
            "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n",
      "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"symmetryTestPlane", "[", 
     RowBox[{"center_", ",", " ", "positions_", ",", " ", "n_"}], "]"}], ":=",
     "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"len", "=", 
        RowBox[{"Length", "@", "positions"}]}], "}"}], ",", "\n", "\t\t", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"n", " ", "<=", " ", 
         RowBox[{"len", "^", "4"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"enumeratePlanesIter", "[", 
         RowBox[{
         "center", ",", " ", "positions", ",", " ", "n", ",", " ", "len"}], 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"enumeratePlanesIter2", "[", 
         RowBox[{
         "center", ",", " ", "positions", ",", " ", "n", ",", " ", "len"}], 
         "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"symmetryTestPlaneCount", "[", "positions_", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "positions"}], "^", "4"}], "+", 
     RowBox[{
      RowBox[{"Length", "@", "positions"}], "^", "4"}]}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.718563068734398*^9, 3.7185630952952557`*^9}, {
   3.718563131886092*^9, 3.718563143596406*^9}, {3.718563203519526*^9, 
   3.718563234154915*^9}, {3.718563436117363*^9, 3.7185634577317457`*^9}, {
   3.718563535732452*^9, 3.718563543626466*^9}, 3.718563651056275*^9, {
   3.7185650340606728`*^9, 3.718565042747954*^9}, {3.718565129827237*^9, 
   3.718565209588175*^9}, {3.718565444410516*^9, 3.71856547491201*^9}, {
   3.718566654232503*^9, 3.718566728514124*^9}, {3.718566813163412*^9, 
   3.718566824019371*^9}, {3.7185669328137617`*^9, 3.71856696687014*^9}, {
   3.71856700891262*^9, 3.71856700977518*^9}, 3.7185670561688013`*^9, {
   3.7185673168421793`*^9, 3.7185673315900097`*^9}, {3.7185674008766737`*^9, 
   3.71856742241988*^9}, {3.718567461201674*^9, 3.718567479351462*^9}, {
   3.718567518479474*^9, 3.7185675195975647`*^9}, 3.7185675665972347`*^9, {
   3.71856769012465*^9, 3.7185676903146963`*^9}, {3.718571191913656*^9, 
   3.718571274534093*^9}, {3.718571479774027*^9, 3.718571481907873*^9}, 
   3.7185716763199463`*^9, {3.718571713922353*^9, 3.718571716377289*^9}, {
   3.718573849931273*^9, 3.71857385142423*^9}, {3.718574171417934*^9, 
   3.718574180118444*^9}, {3.7185743535153923`*^9, 3.718574375830408*^9}, {
   3.718574441243883*^9, 3.7185744449162493`*^9}, {3.718574505871586*^9, 
   3.7185746560109863`*^9}, {3.718574737940432*^9, 3.718574741056756*^9}, {
   3.7185748172995577`*^9, 3.718574821314806*^9}, {3.718574879792918*^9, 
   3.7185748819939327`*^9}, {3.718574947404476*^9, 3.71857498422305*^9}, {
   3.718575622512013*^9, 3.718575655102788*^9}, {3.7185756875519333`*^9, 
   3.718575734058361*^9}, {3.7185757769046383`*^9, 3.71857587910115*^9}, {
   3.718575929169014*^9, 3.718575989312982*^9}, {3.718576095856179*^9, 
   3.718576107554681*^9}, 3.718576415756146*^9, {3.7185912760953293`*^9, 
   3.718591311246863*^9}, {3.718637021580352*^9, 3.718637301181385*^9}, {
   3.718637462185898*^9, 3.718637478635418*^9}, {3.718637522046753*^9, 
   3.7186376383321953`*^9}, {3.718637718419351*^9, 3.718637759921246*^9}, {
   3.7186397459001007`*^9, 3.718639781454236*^9}, {3.718639814285322*^9, 
   3.718639857092355*^9}, {3.718639986037489*^9, 3.718639994141904*^9}, {
   3.71864018532743*^9, 3.718640190738593*^9}, {3.718640262947891*^9, 
   3.718640269416593*^9}, {3.7186411746021233`*^9, 3.718641174785512*^9}, {
   3.7186419145269747`*^9, 3.718641924382708*^9}, {3.718642576990099*^9, 
   3.7186425840920753`*^9}},ExpressionUUID->"d4aa648c-f20c-4db5-812a-\
1418cdfb8dba"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumerateRotationAxesCompiled\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693947181508573*^9, 3.693947184571351*^9}, 
   3.693947550801857*^9, {3.718647416370874*^9, 
   3.718647418071662*^9}},ExpressionUUID->"5f3586b0-66ee-4640-a9cf-\
2408d46236db"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"enumerateRotationAxesCompiled", ":=", 
    RowBox[{"enumerateRotationAxesCompiled", "=", 
     RowBox[{"With", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"$chemSymmEscapeArray", "=", "$chemSymmEscapeArray"}], ",", 
         "\n", "\t", "\t", 
         RowBox[{"uniquePointsQComp", "=", "uniquePointsQComp"}], ",", "\n", 
         "\t\t", 
         RowBox[{"uniqueAxesQComp", "=", "uniqueAxesQComp"}], ",", "\n", 
         "\t\t", 
         RowBox[{
         "$ChemSymmetryUniquenessThreshold", "=", 
          "$ChemSymmetryUniquenessThreshold"}], ",", "\n", "\t\t", 
         RowBox[{"enumerateAxesIter", "=", "enumerateAxesIter"}], ",", "\n", 
         "\t\t", 
         RowBox[{"enumeratePlanesIter", "=", "enumeratePlanesIter"}], ",", 
         "\n", "\t\t", 
         RowBox[{
         "ChemUtilsRotationAxisOrderComp", "=", 
          "ChemUtilsRotationAxisOrderComp"}]}], "\n", "\t\t", "}"}], ",", 
       "\n", "\t\t", 
       RowBox[{"Compile", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
           "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"groups", ",", " ", "_Integer", ",", " ", "1"}], "}"}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"totalCount", ",", " ", "_Integer"}], "}"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"linearFlag", ",", " ", "_Integer"}], "}"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "\n", "\t\t\t\t", 
          "}"}], ",", "\n", "\t\t", 
         RowBox[{"Block", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"triedAxes", "=", "\n", "\t\t\t\t\t", 
              RowBox[{"Table", "[", 
               RowBox[{"$chemSymmEscapeArray", ",", "totalCount"}], "]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{"successOrders", "=", "\n", "\t\t\t\t\t", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "totalCount"}], "]"}]}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{"linearQ", "=", 
              RowBox[{"linearFlag", "===", "1"}]}], ",", "\n", "\t\t\t\t", 
             "j", ",", "\n", "\t\t\t\t", "allTrueFlag"}], "\n", "\t\t\t\t", 
            "}"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Do", "[", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"triedAxes", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "=", 
                RowBox[{"enumerateAxesIter", "[", 
                 RowBox[{"center", ",", " ", "positions", ",", " ", "n"}], 
                 "]"}]}], ";", "\n", "\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"triedAxes", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "=!=", 
                  "$chemSymmEscapeArray"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"allTrueFlag", "=", "True"}], ";", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "<", "n"}], "&&", "allTrueFlag"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"allTrueFlag", "=", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "===", 
                    "$chemSymmEscapeArray"}], "||", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "uniqueAxesQComp", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"center", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", " ", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    "$ChemSymmetryUniquenessThreshold"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", ")"}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"j", "++"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
                    "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", "allTrueFlag"}], 
                    ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"o", "=", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ChemUtilsRotationAxisOrderComp", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"center", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "positions", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "groups", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "linearFlag", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "tol"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"o", ">", "1"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    RowBox[{"successOrders", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "=", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "o"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", 
                "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"n", ",", " ", "totalCount"}], "}"}]}], "\n", 
             "\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"successOrders", ",", " ", 
                 RowBox[{
                  RowBox[{"#", ">", "1"}], "&"}]}], "]"}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{"Pick", "[", 
                RowBox[{"triedAxes", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", ">", "1"}], "&"}], "/@", "successOrders"}]}], 
                "]"}]}], "\n", "\t\t\t\t", "}"}], "]"}]}]}], "\n", "\t\t\t", 
          "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.693940377477281*^9, 3.69394052814716*^9}, {
   3.693940593728228*^9, 3.693940713590411*^9}, 3.693940746847447*^9, {
   3.693940924084697*^9, 3.693940924365841*^9}, {3.6939417936696587`*^9, 
   3.6939418024525013`*^9}, 3.693942349231358*^9, 3.693944773437996*^9, {
   3.693945868799461*^9, 3.693945876717812*^9}, 3.693947241122196*^9, {
   3.693947460706156*^9, 3.69394752632625*^9}, {3.693947664935966*^9, 
   3.6939476669261913`*^9}, {3.6939477438476887`*^9, 3.693947747893819*^9}, {
   3.693947779867737*^9, 3.693947861228487*^9}, {3.6939480473815603`*^9, 
   3.693948048611393*^9}, {3.718568216476289*^9, 3.7185685892363567`*^9}, 
   3.718568673546647*^9, {3.7185687625517273`*^9, 3.718568771230887*^9}, {
   3.71856882223976*^9, 3.7185689242356377`*^9}, {3.718569021101101*^9, 
   3.7185690225619707`*^9}, {3.718569067153179*^9, 3.718569097314311*^9}, {
   3.7185692599481287`*^9, 3.718569282820486*^9}, {3.71856999350898*^9, 
   3.718570047994775*^9}, {3.718570145662881*^9, 3.7185701530180187`*^9}, {
   3.718571313289997*^9, 3.7185713231990547`*^9}, {3.7185714252358437`*^9, 
   3.718571474527461*^9}, {3.718571558722842*^9, 3.718571560465746*^9}, {
   3.718571827511982*^9, 3.7185718297961884`*^9}, {3.7185721365564413`*^9, 
   3.718572150216629*^9}, {3.718572184308654*^9, 3.7185722979622707`*^9}, {
   3.7185738141772614`*^9, 3.7185738150240717`*^9}, {3.718573885885751*^9, 
   3.71857398611998*^9}, {3.718574045447982*^9, 3.7185740805453043`*^9}, {
   3.718574137673291*^9, 3.718574141306486*^9}, 3.718574263936262*^9, {
   3.718575094508707*^9, 3.718575095441876*^9}, {3.718575134447877*^9, 
   3.71857513543561*^9}, {3.7185752086597147`*^9, 3.7185752107044773`*^9}, 
   3.718575258349374*^9, 3.718607678699621*^9, {3.718642631530507*^9, 
   3.7186426331526213`*^9}, 3.7186426981455107`*^9, {3.718642952810667*^9, 
   3.718642982904601*^9}, {3.718643016659671*^9, 3.718643287571665*^9}, {
   3.718646113911776*^9, 3.718646251988564*^9}, {3.718647062144066*^9, 
   3.7186470623332644`*^9}, {3.718647420002487*^9, 
   3.718647423706317*^9}},ExpressionUUID->"73264814-e578-40ed-8b9a-\
2a7fb62bd3fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumerateSymmetryPlanesCompiled\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6939471907630367`*^9, 3.6939471948110867`*^9}, {
  3.718647446951436*^9, 
  3.718647448407104*^9}},ExpressionUUID->"907d79aa-32f9-4d3a-9d1c-\
336af0c6ad42"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"enumerateSymmetryPlanesCompiled", ":=", 
    RowBox[{"enumerateSymmetryPlanes", "=", 
     RowBox[{"With", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"$chemSymmEscapeArray", "=", "$chemSymmEscapeArray"}], ",", 
         "\n", "\t", "\t", 
         RowBox[{"uniquePointsQComp", "=", "uniquePointsQComp"}], ",", "\n", 
         "\t\t", 
         RowBox[{"uniqueAxesQComp", "=", "uniqueAxesQComp"}], ",", "\n", 
         "\t\t", 
         RowBox[{
         "$ChemSymmetryUniquenessThreshold", "=", 
          "$ChemSymmetryUniquenessThreshold"}], ",", "\n", "\t\t", 
         RowBox[{"enumerateAxesIter", "=", "enumerateAxesIter"}], ",", "\n", 
         "\t\t", 
         RowBox[{"enumeratePlanesIter", "=", "enumeratePlanesIter"}], ",", 
         "\n", "\t\t", 
         RowBox[{
         "ChemUtilsPlaneOfSymmetryQComp", "=", 
          "ChemUtilsPlaneOfSymmetryQComp"}]}], "\n", "\t\t", "}"}], ",", "\n",
        "\t\t", 
       RowBox[{"Compile", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
           "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"groups", ",", " ", "_Integer", ",", " ", "1"}], "}"}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"totalCount", ",", " ", "_Integer"}], "}"}], ",", "\n", 
           "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "\n", "\t", "\t\t\t",
           "}"}], ",", "\n", "\t", "\t\t", 
         RowBox[{"Block", "[", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"triedPlanes", "=", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "$chemSymmEscapeArray", ",", " ", "$chemSymmEscapeArray"}], 
                 "}"}], ",", " ", "totalCount"}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"triedNorms", "=", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Table", "[", 
               RowBox[{"$chemSymmEscapeArray", ",", " ", "totalCount"}], 
               "]"}]}], ",", "\n", "\t\t\t\t\t", "testPlane", ",", "\n", 
             "\t\t\t\t\t", "testNorm", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"plen", "=", 
              RowBox[{"Length", "@", "positions"}]}], ",", "\n", "\t\t\t\t\t",
              "allTrueFlag", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"j", "=", "1"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"testPlane", "=", 
                RowBox[{"enumeratePlanesIter", "[", 
                 RowBox[{
                 "center", ",", " ", "positions", ",", " ", "n", ",", " ", 
                  "plen"}], "]"}]}], ";", "\n", "\t", "\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"testPlane", "=!=", 
                  RowBox[{"{", 
                   RowBox[{
                   "$chemSymmEscapeArray", ",", "$chemSymmEscapeArray"}], 
                   "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"testNorm", "=", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"triedNorms", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "=", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"testPlane", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "center"}], ",", " ", 
                    RowBox[{
                    RowBox[{"testPlane", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}], 
                    "]"}]}]}], ";", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"allTrueFlag", "=", "True"}], ";", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"testPlane", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "!=", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], "&&", "\n",
                     "\t\t\t\t\t\t\t", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "<", "n"}], "&&", "allTrueFlag"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"allTrueFlag", "=", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"triedNorms", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "===", 
                    "$chemSymmEscapeArray"}], "||", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "uniqueAxesQComp", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"center", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"triedNorms", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", " ", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "testNorm", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    "$ChemSymmetryUniquenessThreshold"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", ")"}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"j", "++"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
                    "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", "allTrueFlag"}], 
                    "\n", "\t\t\t\t\t\t\t\t", ")"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "ChemUtilsPlaneOfSymmetryQComp", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "center", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"testPlane", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "positions", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "groups", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "tol"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"triedPlanes", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "=", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "testPlane"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                   "]"}], ";"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"n", ",", " ", "totalCount"}], "}"}]}], "\n", 
             "\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
            RowBox[{"Select", "[", 
             RowBox[{"triedPlanes", ",", " ", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"#", "=!=", 
                RowBox[{"{", 
                 RowBox[{
                 "$chemSymmEscapeArray", ",", "$chemSymmEscapeArray"}], 
                 "}"}]}], "&"}]}], "\n", "\t", "\t\t\t\t", "]"}]}]}], "\n", 
          "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t\t", "]"}]}], "\n", "\t", 
      "]"}]}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.7185723893599987`*^9, 3.718572420773004*^9}, {
   3.7185724557514267`*^9, 3.7185725238269672`*^9}, {3.718572707828961*^9, 
   3.718572929159148*^9}, {3.71857296503835*^9, 3.7185730438623753`*^9}, {
   3.718573103464254*^9, 3.718573153072262*^9}, {3.718573244232376*^9, 
   3.718573299073588*^9}, {3.718575585688801*^9, 3.718575586438181*^9}, 
   3.718575791551063*^9, 3.718576001189744*^9, {3.718576038801902*^9, 
   3.718576085894546*^9}, {3.7185761341035213`*^9, 3.7185761503811007`*^9}, {
   3.718637813192069*^9, 3.718637836339552*^9}, {3.718637898766473*^9, 
   3.718637903135974*^9}, {3.718637966206409*^9, 3.7186383618522577`*^9}, {
   3.7186398843261557`*^9, 3.718639888161067*^9}, {3.718640221915348*^9, 
   3.71864022931842*^9}, {3.718641197079936*^9, 3.718641211532651*^9}, {
   3.718641253311689*^9, 3.7186414107554817`*^9}, {3.7186415420571823`*^9, 
   3.718641589160975*^9}, {3.7186416350351887`*^9, 3.718641745654243*^9}, 
   3.718641784206017*^9, {3.718641831462028*^9, 3.718641833272571*^9}, {
   3.718642036141457*^9, 3.7186420743486767`*^9}, {3.718642370770913*^9, 
   3.718642382421689*^9}, {3.718642922286565*^9, 3.718642922571731*^9}, {
   3.718647006020256*^9, 3.718647009911912*^9}, {3.7186474287703953`*^9, 
   3.718647430106432*^9}},ExpressionUUID->"1f8a41dc-c872-4418-92fe-\
7ec9ed91ccb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumerateScrewAxesCompiled\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693947199578849*^9, 3.6939472035471973`*^9}, {
  3.7186474447754707`*^9, 
  3.7186474463353453`*^9}},ExpressionUUID->"222616bd-ef9e-455d-9475-\
b10819f7eb37"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"enumerateScrewAxes", ":=", 
    RowBox[{"enumerateScrewAxes", "=", 
     RowBox[{"With", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"$chemSymmEscapeArray", "=", "$chemSymmEscapeArray"}], ",", 
         "\n", "\t", "\t", 
         RowBox[{"uniquePointsQComp", "=", "uniquePointsQComp"}], ",", "\n", 
         "\t\t", 
         RowBox[{"uniqueAxesQComp", "=", "uniqueAxesQComp"}], ",", "\n", 
         "\t\t", 
         RowBox[{
         "$ChemSymmetryUniquenessThreshold", "=", 
          "$ChemSymmetryUniquenessThreshold"}], ",", "\n", "\t\t", 
         RowBox[{"enumerateAxesIter", "=", "enumerateAxesIter"}], ",", "\n", 
         "\t\t", 
         RowBox[{"enumeratePlanesIter", "=", "enumeratePlanesIter"}], ",", 
         "\n", "\t\t", 
         RowBox[{
         "ChemUtilsScrewAxisOrderComp", "=", 
          "ChemUtilsScrewAxisOrderComp"}]}], "\n", "\t\t", "}"}], ",", "\n", 
       "\t\t", 
       RowBox[{"Compile", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
           "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"groups", ",", " ", "_Integer", ",", " ", "1"}], "}"}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"totalCount", ",", " ", "_Integer"}], "}"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"linearFlag", ",", " ", "_Integer"}], "}"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "\n", "\t\t\t\t", 
          "}"}], ",", "\n", "\t\t", 
         RowBox[{"Block", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"triedAxes", "=", "\n", "\t\t\t\t\t", 
              RowBox[{"Table", "[", 
               RowBox[{"$chemSymmEscapeArray", ",", "totalCount"}], "]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{"successOrders", "=", "\n", "\t\t\t\t\t", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "totalCount"}], "]"}]}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{"linearQ", "=", 
              RowBox[{"linearFlag", "===", "1"}]}], ",", "\n", "\t\t\t\t", 
             "j", ",", "\n", "\t\t\t\t", "allTrueFlag"}], "\n", "\t\t\t\t", 
            "}"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Do", "[", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"triedAxes", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "=", 
                RowBox[{"enumerateAxesIter", "[", 
                 RowBox[{"center", ",", " ", "positions", ",", " ", "n"}], 
                 "]"}]}], ";", "\n", "\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"triedAxes", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "=!=", 
                  "$chemSymmEscapeArray"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"allTrueFlag", "=", "True"}], ";", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "<", "n"}], "&&", "allTrueFlag"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"allTrueFlag", "=", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "===", 
                    "$chemSymmEscapeArray"}], "||", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "uniqueAxesQComp", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"center", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", " ", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    "$ChemSymmetryUniquenessThreshold"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", ")"}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"j", "++"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
                    "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", "allTrueFlag"}], 
                    ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"o", "=", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ChemUtilsScrewAxisOrderComp", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"center", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"triedAxes", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "positions", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "groups", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "tol"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"o", ">", "1"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    RowBox[{"successOrders", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "=", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "o"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", 
                "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"n", ",", " ", "totalCount"}], "}"}]}], "\n", 
             "\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"successOrders", ",", " ", 
                 RowBox[{
                  RowBox[{"#", ">", "1"}], "&"}]}], "]"}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{"Pick", "[", 
                RowBox[{"triedAxes", ",", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", ">", "1"}], "&"}], "/@", "successOrders"}]}], 
                "]"}]}], "\n", "\t\t\t\t", "}"}], "]"}]}]}], "\n", "\t\t\t", 
          "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.693940377477281*^9, 3.69394052814716*^9}, {
   3.693940593728228*^9, 3.693940713590411*^9}, 3.693940746847447*^9, {
   3.693940924084697*^9, 3.693940924365841*^9}, {3.6939417936696587`*^9, 
   3.6939418024525013`*^9}, 3.693942349231358*^9, 3.693944773437996*^9, {
   3.693945868799461*^9, 3.693945876717812*^9}, 3.693947241122196*^9, {
   3.693947460706156*^9, 3.69394752632625*^9}, {3.693947664935966*^9, 
   3.6939476669261913`*^9}, {3.6939477438476887`*^9, 3.693947747893819*^9}, {
   3.693947779867737*^9, 3.693947861228487*^9}, {3.6939480473815603`*^9, 
   3.693948048611393*^9}, {3.718568216476289*^9, 3.7185685892363567`*^9}, 
   3.718568673546647*^9, {3.7185687625517273`*^9, 3.718568771230887*^9}, {
   3.71856882223976*^9, 3.7185689242356377`*^9}, {3.718569021101101*^9, 
   3.7185690225619707`*^9}, {3.718569067153179*^9, 3.718569097314311*^9}, {
   3.7185692599481287`*^9, 3.718569282820486*^9}, {3.71856999350898*^9, 
   3.718570047994775*^9}, {3.718570145662881*^9, 3.7185701530180187`*^9}, {
   3.718571313289997*^9, 3.7185713231990547`*^9}, {3.7185714252358437`*^9, 
   3.718571474527461*^9}, {3.718571558722842*^9, 3.718571560465746*^9}, {
   3.718571827511982*^9, 3.7185718297961884`*^9}, {3.7185721365564413`*^9, 
   3.718572150216629*^9}, {3.718572184308654*^9, 3.7185722979622707`*^9}, {
   3.7185738141772614`*^9, 3.7185738150240717`*^9}, {3.718573885885751*^9, 
   3.71857398611998*^9}, {3.718574045447982*^9, 3.7185740805453043`*^9}, {
   3.718574137673291*^9, 3.718574141306486*^9}, 3.718574263936262*^9, {
   3.718575094508707*^9, 3.718575095441876*^9}, {3.718575134447877*^9, 
   3.71857513543561*^9}, {3.7185752086597147`*^9, 3.7185752107044773`*^9}, 
   3.718575258349374*^9, 3.718607678699621*^9, {3.718642631530507*^9, 
   3.7186426331526213`*^9}, 3.7186426981455107`*^9, {3.718642952810667*^9, 
   3.718642982904601*^9}, {3.718643016659671*^9, 3.718643287571665*^9}, {
   3.718646113911776*^9, 3.718646251988564*^9}, {3.718646295866274*^9, 
   3.7186463190516644`*^9}, {3.718646998824663*^9, 
   3.718647000589184*^9}},ExpressionUUID->"baac66b9-af61-4c96-84fd-\
6ac0a8502c31"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]symmetryTestPosition\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69394757592273*^9, 3.693947581604889*^9}, 
   3.718567685758416*^9},ExpressionUUID->"6209b9c3-ab29-4f78-92d7-\
03e478e8ca00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$chemSymmEscapeArray", "=", "\n", "\t", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", ".5"}], ",", ".5"}], "}"}], ",", "3"}], "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.7186368624304743`*^9, 3.7186368730391493`*^9}, {
  3.718640696422208*^9, 
  3.7186407156839542`*^9}},ExpressionUUID->"ad6ad9ed-7088-4614-bb75-\
f98de0c2fa99"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"enumeratePositionsIter", ":=", "\n", "\t", 
    RowBox[{"enumeratePositionsIter", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$chemSymmEscapeArray", "=", "$chemSymmEscapeArray"}], "}"}], 
       ",", "\n", "\t", 
       RowBox[{"enumeratePositionsIter", "=", "\n", "\t\t", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", " ", "_Integer"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"plen", ",", " ", "_Integer"}], "}"}]}], "}"}], ",", 
          "\n", "\t\t\t", 
          RowBox[{"With", "[", "\n", "\t", "\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t", "\t\t\t\t", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"1", "+", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}], "/", "plen"}], "]"}]}]}], 
              ",", "\n", "\t", "\t", "\t\t\t", 
              RowBox[{"j", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{"n", ",", " ", "plen", ",", " ", "1"}], "]"}]}]}], 
             "\n", "\t", "\t", "\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", ">", "j"}], ",", "\n", "\t", "\t\t\t\t", 
              "$chemSymmEscapeArray", ",", "\n", "\t", "\t\t\t\t", 
              RowBox[{"Mean", "[", 
               RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"positions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t", "\t", "\t",
                  "\t\t\t", 
                 RowBox[{"positions", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "\n", "\t", "\t", 
                "\t\t\t\t", "}"}], "]"}]}], "\n", "\t", "\t\t\t\t", "]"}]}], 
           "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t", 
      "]"}]}]}], ";", "\n", 
   RowBox[{
    RowBox[{"symmetryTestPosition", "[", 
     RowBox[{"center_", ",", " ", "positions_", ",", " ", "n_"}], "]"}], ":=",
     "\n", "\t", 
    RowBox[{"enumeratePositionsIter", "[", 
     RowBox[{"positions", ",", " ", "n", ",", " ", 
      RowBox[{"Length", "@", "positions"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"symmetryTestPositionCount", "[", 
     RowBox[{"center_", ",", " ", "positions_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{
     RowBox[{"Length", "@", "positions"}], "^", "2"}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.693947705000966*^9, 3.693947712880226*^9}, {
   3.693953289578742*^9, 3.693953291188725*^9}, {3.718563725154331*^9, 
   3.718563730211965*^9}, {3.7185650107114153`*^9, 3.7185650677891207`*^9}, {
   3.718565262142007*^9, 3.7185654113596*^9}, {3.718565457485045*^9, 
   3.7185655450832987`*^9}, {3.718565628519477*^9, 3.71856563555929*^9}, {
   3.71856571143099*^9, 3.718565711926961*^9}, {3.718565742617807*^9, 
   3.7185657448559923`*^9}, {3.718565815191101*^9, 3.7185658445081*^9}, {
   3.718565878595024*^9, 3.7185660208434258`*^9}, {3.7185669417895412`*^9, 
   3.718566945422781*^9}, {3.718567254472674*^9, 3.71856725498073*^9}, {
   3.718567438327712*^9, 3.7185674486836643`*^9}, {3.718567498737935*^9, 
   3.718567509061741*^9}, 3.718567595659107*^9, 3.718567683098164*^9, {
   3.718604746051372*^9, 3.718604775950453*^9}, {3.718605120442362*^9, 
   3.718605122970436*^9}, {3.718636749135903*^9, 3.718636898017239*^9}, {
   3.718640810481942*^9, 3.718640822466022*^9}, {3.7186419578497667`*^9, 
   3.71864196216986*^9}},ExpressionUUID->"70b37da5-b074-449a-945a-\
ca1f85cddcd8"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]InversionCenter\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"207b257c-54d7-408d-85c1-94410fe96942"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]InversionCenterQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693868069539731*^9, 
  3.6938680815159693`*^9}},ExpressionUUID->"72983024-2d69-4887-bd20-\
b8035f1d3670"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inversionTransform", "[", "point_", "]"}], ":=", "\n", "\t", 
  RowBox[{"AffineTransform", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ScalingMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
     RowBox[{"2", "*", "point"}]}], "}"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.693934874697735*^9, 3.693934901455841*^9}, {
  3.693935033317388*^9, 3.693935050805283*^9}, {3.69393512085787*^9, 
  3.693935132073039*^9}, {3.693935213030444*^9, 
  3.6939352325697002`*^9}},ExpressionUUID->"329e0d60-14cc-464e-8ec2-\
235d023471d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsInversionCenterQ", "[", " ", "\n", "\t", 
    RowBox[{"groups_", ",", " ", 
     RowBox[{"tol", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ")"}], ":", 
      "Automatic"}]}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"symmetryOperationQ", "[", "\n", "\t\t\t", 
    RowBox[{"Minus", ",", "\n", "\t\t\t", "groups", ",", "\n", "\t\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{"tol", ",", " ", 
       RowBox[{"Automatic", ":>", "$ChemSymmetryTolerance"}]}], "]"}]}], "\n",
     "\t\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.693868096584106*^9, 3.693868104428486*^9}, {
   3.6938681389355803`*^9, 3.693868157821383*^9}, 3.693868254143012*^9, {
   3.693868292688652*^9, 3.6938685289015007`*^9}, {3.6938685805445232`*^9, 
   3.69386858070562*^9}, {3.693868620845501*^9, 3.693868897703773*^9}, {
   3.693869033306057*^9, 3.6938690732612057`*^9}, {3.6938691567947283`*^9, 
   3.693869187575509*^9}, 3.6938692568645477`*^9, {3.693869302948348*^9, 
   3.69386932874625*^9}, {3.6938694839042673`*^9, 3.6938695419019117`*^9}, 
   3.693876157575829*^9, {3.6939348671898003`*^9, 3.693934870437134*^9}, {
   3.71856435983005*^9, 3.7185644010756817`*^9}, {3.718564962360093*^9, 
   3.718564978188731*^9}, {3.718603999088127*^9, 3.71860402243226*^9}, {
   3.718763416165572*^9, 3.718763418413671*^9}, {3.7187634690715017`*^9, 
   3.71876349516285*^9}},ExpressionUUID->"2d8abdb9-fc87-4c64-a679-\
f807d6474c7a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]RotationAxis\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"abecb3c2-88a5-402e-ab9b-e421d85bee2c"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumerateRotationAxes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7186480539331903`*^9, 3.718648067576207*^9}, {
  3.7186489945222588`*^9, 
  3.718648995696993*^9}},ExpressionUUID->"68703078-7cf1-4fd8-af59-\
67b7a58927c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumerateRotationAxes", "[", 
   RowBox[{
   "axes_", ",", " ", "groups_", ",", "linearQ_", ",", " ", "tol_", ",", " ", 
    "tol2_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"ax", "=", "\n", "\t\t\t\t", 
      RowBox[{"Union", "@@", "\n", "\t", "\t\t\t\t", 
       RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Values", "@", "\n", "\t", "\t\t\t\t\t\t", 
          RowBox[{"Map", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{
            "Function", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"enumerateAxes", "[", 
              RowBox[{"#", ",", " ", "tol2"}], "]"}], "\n", "\t", "\t", "\t", 
             "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
            "groups"}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
         "\t\t\t\t\t\t", 
         RowBox[{"{", "axes", "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
     "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"Map", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{"o", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{"ChemUtilsRotationAxisOrder", "[", 
            RowBox[{
            "#", ",", " ", "groups", ",", " ", "linearQ", ",", " ", "tol"}], 
            "]"}]}], "\n", "\t", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"o", ">", "1"}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"o", ",", " ", "#"}], "}"}], ",", "\n", "\t", "\t\t\t\t", 
           "Nothing"}], "\n", "\t", "\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t",
         "]"}], "&"}], ",", "\n", "\t\t\t", 
      RowBox[{"deleteDuplicateAxes", "[", "\n", "\t\t\t\t", 
       RowBox[{"ax", ",", "\n", "\t\t\t\t", "tol2"}], "\n", "\t\t\t\t", 
       "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718647451617277*^9, 3.718647460295944*^9}, {
   3.7186484423770657`*^9, 3.7186484441018887`*^9}, {3.718648488090356*^9, 
   3.7186484966551437`*^9}, 3.718648655436562*^9, {3.718648885007064*^9, 
   3.718648948960219*^9}, {3.718649083327577*^9, 3.718649091223506*^9}, {
   3.718649842110413*^9, 3.7186498481169357`*^9}, {3.718649905892639*^9, 
   3.7186499067622766`*^9}, 3.718753767509234*^9, {3.718754841069167*^9, 
   3.7187548490288897`*^9}, {3.718763033974597*^9, 3.7187630468581676`*^9}, {
   3.718763137284553*^9, 3.718763148026169*^9}, {3.718763197388171*^9, 
   3.718763198857254*^9}, 3.7187632408352947`*^9, {3.7187636072879333`*^9, 
   3.7187636166188793`*^9}, {3.718764052060732*^9, 3.718764073754092*^9}, {
   3.718765410503738*^9, 3.718765418054111*^9}, {3.7187667335835533`*^9, 
   3.7187667540252237`*^9}, {3.718766804468136*^9, 3.71876680611242*^9}, 
   3.718766859527673*^9, {3.718774296589229*^9, 3.7187743136710167`*^9}, {
   3.7188172467094183`*^9, 3.718817272048126*^9}, {3.718817323199597*^9, 
   3.7188173483449717`*^9}, {3.7188173965141077`*^9, 3.71881741810505*^9}, {
   3.718817462448641*^9, 3.718817503070437*^9}, 3.718817538310213*^9, {
   3.718817590733141*^9, 3.718817594769536*^9}, {3.718817663896371*^9, 
   3.718817685774556*^9}, 3.718817841390195*^9, {3.718817941393075*^9, 
   3.718817943183339*^9}, {3.718818164134057*^9, 3.718818175180719*^9}, {
   3.71881881868605*^9, 3.7188188355932693`*^9}, {3.718819543167268*^9, 
   3.718819554799405*^9}, {3.718819785741414*^9, 3.718819787391406*^9}, {
   3.718819843097747*^9, 3.718819893575264*^9}, {3.718838763342224*^9, 
   3.7188387703100367`*^9}, {3.71883912253959*^9, 3.718839146553013*^9}, {
   3.718840106151527*^9, 3.7188401263440638`*^9}, {3.718840273320253*^9, 
   3.718840275226262*^9}, {3.71884173858632*^9, 3.718841751200511*^9}, {
   3.718933224873332*^9, 3.718933277085395*^9}, {3.719209234895093*^9, 
   3.719209301917387*^9}, {3.7192094532234077`*^9, 3.719209453395494*^9}, {
   3.719209503833878*^9, 3.719209505114726*^9}, 3.719209663364916*^9, {
   3.719209762193391*^9, 3.719209763401229*^9}, {3.719209801601286*^9, 
   3.7192098221884193`*^9}, {3.719209853094325*^9, 3.719209885423527*^9}, {
   3.72023210639168*^9, 3.720232107560471*^9}, {3.720232410026726*^9, 
   3.720232428073778*^9}, 3.720233029804302*^9, 
   3.7202330751469088`*^9},ExpressionUUID->"e318e5ac-08ee-44a9-8822-\
4e4fa354dad2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]deleteDuplicateRotationAxes\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.718772867097109*^9},ExpressionUUID->"63f6b734-daab-427c-a1ae-\
2f903c26b6a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deleteDuplicateRotationAxes", "[", 
   RowBox[{"axes_", ",", " ", "tol_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"a", "=", 
      RowBox[{"GroupBy", "[", 
       RowBox[{"axes", ",", " ", 
        RowBox[{"First", "\[Rule]", "Last"}], ",", " ", "DeleteDuplicates"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"Join", "@@", "\n", "\t\t\t", 
     RowBox[{"KeyValueMap", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"#", ",", " ", 
           RowBox[{"Pick", "[", 
            RowBox[{
             RowBox[{"a", "[", "#", "]"}], ",", " ", "#2", ",", " ", "1"}], 
            "]"}]}], "}"}], "]"}], "&"}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"deleteDuplicateAxesInds", "[", "tol", "]"}], "/@", "a"}]}], 
      "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7187728678673973`*^9, 3.718772951120267*^9}, {
   3.7187729879448433`*^9, 3.7187730272579327`*^9}, {3.718773122211994*^9, 
   3.718773133911868*^9}, 3.718773164018873*^9, 3.7188379598969793`*^9, {
   3.7188383246844597`*^9, 
   3.718838325192621*^9}},ExpressionUUID->"0fd5bf0e-c884-4e64-ab1a-\
c082db67d748"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]RotationAxisOrderComp\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718645375113543*^9, 
  3.7186453810670557`*^9}},ExpressionUUID->"c1f0de96-a53d-4b66-849b-\
819a9495b90c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ChemUtilsRotationAxisOrderComp", ":=", "\n", "\t", 
    RowBox[{"With", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"symmetricPointQ", "=", "symmetricPointQ"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"uniqueAxesQ", "=", "uniqueAxesQComp"}], ",", "\n", "\t\t\t", 
        
        RowBox[{
        "rawRotationTransformationFunction", "=", "\n", "\t\t\t\t", 
         "rawRotationTransformationFunction"}]}], "\n", "\t\t\t", "}"}], ",", 
      "\n", "\t\t", 
      RowBox[{"Compile", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"point1", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"point2", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
          ",", "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"grps", ",", " ", "_Integer", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"linFlag", ",", " ", "_Integer"}], "}"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "\n", "\t\t\t\t", 
         "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"linFlag", "===", "1"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"If", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"uniqueAxesQ", "[", 
              RowBox[{"point1", ",", " ", 
               RowBox[{"positions", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", "point2"}], "]"}], "||",
              "\n", "\t", "\t", "\t\t\t\t", 
             RowBox[{"uniqueAxesQ", "[", 
              RowBox[{"point1", ",", " ", 
               RowBox[{"positions", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", "point2"}], 
              "]"}]}], ",", "\n", "\t", "\t", "\t\t\t", "1", ",", "\n", "\t", 
            "\t", "\t\t\t", 
            RowBox[{"-", "1"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"groupOrdering", " ", "=", " ", 
               RowBox[{"Ordering", "[", "grps", "]"}]}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"returnOrder", "=", "1"}]}], "\n", "\t\t\t\t\t", "}"}], 
            ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Do", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Block", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"flag", "=", "True"}], ",", "\n", "\t", "\t", "\t",
                    "\t", "\t\t\t\t\t", 
                   RowBox[{"i", "=", "1"}], ",", 
                   RowBox[{"j", "=", "1"}], ",", "\n", "\t", "\t", "\t", "\t",
                    "\t\t\t\t\t", "newpts", ",", "\n", "\t", "\t", "\t", "\t",
                    "\t\t\t\t\t", "oldpts"}], "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  "}"}], ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"While", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[LessEqual]", 
                    RowBox[{"Length", "[", "grps", "]"}]}], "&&", "flag"}], 
                    ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"grp", "=", 
                    RowBox[{"Take", "[", 
                    RowBox[{"positions", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Total", "@", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", " ", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}],
                     ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ";", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "\[LessEqual]", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "&&", "flag"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"flag", "=", 
                    RowBox[{
                    "symmetricPointQ", "[", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "rawRotationTransformationFunction", "[", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"grp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"2.", 
                    RowBox[{"\[Pi]", "/", "o"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "point2", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", "point1"}], "\n", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"grp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "grp", ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "tol"}], "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"j", "++"}]}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"i", "++"}]}]}], "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{"flag", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"returnOrder", "=", "o"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Break", "[", "]"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"o", ",", " ", "grps"}], "}"}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t", 
             "returnOrder"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t",
          "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{
  3.718645357061805*^9, {3.7186454083037043`*^9, 3.718645484265023*^9}, {
   3.718645516641765*^9, 3.718645607035201*^9}, {3.718645665977577*^9, 
   3.71864577164003*^9}, {3.718645848758905*^9, 3.7186459329477*^9}, {
   3.718645966885105*^9, 
   3.7186460230578012`*^9}},ExpressionUUID->"54f435c1-582d-4aad-be46-\
099043513047"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]RotationAxisOrder\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6938679814233093`*^9, 3.693867997965562*^9}, {
  3.693868192925787*^9, 
  3.693868205180365*^9}},ExpressionUUID->"a45c323f-07b1-4e71-890f-\
ba45433a0ba3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rotationTransform", "[", 
    RowBox[{"order_", ",", "  ", "point_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"RotationTransform", "[", 
    RowBox[{
     RowBox[{"2.", 
      RowBox[{"\[Pi]", "/", "order"}]}], ",", " ", "point"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rotationTransform", "[", "point_", "]"}], "[", "order_", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"rotationTransform", "[", 
    RowBox[{"order", ",", "point"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6939345847353983`*^9, 3.6939346073156633`*^9}, {
   3.6939346381291018`*^9, 3.6939346744275417`*^9}, {3.693934800007565*^9, 
   3.693934807045795*^9}, {3.718568184341564*^9, 3.7185681978870277`*^9}, 
   3.718571409502973*^9, {3.718754632730702*^9, 
   3.718754652391181*^9}},ExpressionUUID->"5d5c1c86-35f9-4c71-9299-\
23ffec5718f6"],

Cell[BoxData[
 RowBox[{"ChemUtilsRotationAxisOrder", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.718604036428566*^9, 
  3.718604037892446*^9}},ExpressionUUID->"3791eb08-fa7f-4ec8-aecd-\
a8c999e0c453"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsRotationAxisOrder", "[", "\n", "\t", 
    RowBox[{"point_", ",", "\n", "\t", "groups_", ",", "\n", "\t", 
     RowBox[{"linearQ", ":", 
      RowBox[{"True", "|", "False"}], ":", "False"}], ",", "\n", "\t", 
     RowBox[{"tol", ":", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ":", 
      "Automatic"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{"linearQ", ",", "\n", "\t\t", 
     RowBox[{"If", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"uniqueAxesQComp", "[", 
         RowBox[{
          RowBox[{"groups", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", "point"}], "]"}],
         "||", "\n", "\t\t\t\t", 
        RowBox[{"uniqueAxesQComp", "[", 
         RowBox[{
          RowBox[{"groups", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", "point"}], "]"}]}],
        ",", "\n", "\t\t\t", "1", ",", "\n", "\t\t\t", "\[Infinity]"}], "\n", 
      "\t\t\t", "]"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"es", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{"groups", ",", " ", "Length"}], "]"}]}], "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{"ret", "=", "\n", "\t\t\t\t\t", 
           RowBox[{"Do", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"symmetryOperationQ", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"rotationTransform", "[", 
                  RowBox[{"o", ",", " ", "point"}], "]"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "groups", ",", "\n", "\t\t\t\t\t\t\t\t", 
                 
                 RowBox[{"Replace", "[", 
                  RowBox[{"tol", ",", " ", 
                   RowBox[{
                   "Automatic", "\[RuleDelayed]", 
                    "$ChemSymmetryTolerance"}]}], "]"}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Return", "[", "o", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
              "]"}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"o", ",", " ", 
               RowBox[{"Length", "@", 
                RowBox[{"es", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], ",", " ", "2", ",", " ", 
               RowBox[{"-", "1"}]}], "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
          "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ret", ">", "1"}], "//", "TrueQ"}], ",", "\n", 
           "\t\t\t\t\t", "ret", ",", "\n", "\t\t\t\t\t", "1"}], "\n", 
          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.693868000851001*^9, 3.69386800484634*^9}, {
   3.693868234456831*^9, 3.6938682510956*^9}, {3.6938690898271723`*^9, 
   3.693869097338025*^9}, 3.693869341364582*^9, {3.693869531360589*^9, 
   3.693869534998392*^9}, {3.693869639634843*^9, 3.693869666199477*^9}, {
   3.6938699265172997`*^9, 3.693869927395994*^9}, {3.69387013669753*^9, 
   3.693870157495741*^9}, {3.693870285940197*^9, 3.693870404313805*^9}, {
   3.693870678804714*^9, 3.6938707218014183`*^9}, {3.693870779291135*^9, 
   3.6938708323551483`*^9}, {3.693870986580296*^9, 3.693871018468548*^9}, {
   3.693871198865802*^9, 3.693871242055758*^9}, {3.693871318706398*^9, 
   3.693871329536429*^9}, {3.693871411174685*^9, 3.693871459612759*^9}, {
   3.693872052841435*^9, 3.693872096673881*^9}, {3.693872323484805*^9, 
   3.6938723512902327`*^9}, {3.693934582247509*^9, 3.693934678747718*^9}, {
   3.693934812742985*^9, 3.693934817511202*^9}, {3.69393907608079*^9, 
   3.693939080191771*^9}, {3.693939192520775*^9, 3.693939194512632*^9}, {
   3.69393986836665*^9, 3.693939873948476*^9}, {3.69395429413013*^9, 
   3.693954296985458*^9}, {3.6939561164384117`*^9, 3.6939561285797787`*^9}, {
   3.693956358115484*^9, 3.693956430545885*^9}, {3.693956471038178*^9, 
   3.693956479235177*^9}, {3.693956989397191*^9, 3.693957021868203*^9}, {
   3.7185678142696953`*^9, 3.718568172378374*^9}, {3.718569351347392*^9, 
   3.718569352428878*^9}, {3.718569390345027*^9, 3.718569406574437*^9}, {
   3.718569750964423*^9, 3.7185697515064898`*^9}, {3.71856982022528*^9, 
   3.7185698258843203`*^9}, {3.718570172281143*^9, 3.71857021089524*^9}, {
   3.718570683911496*^9, 3.7185706855167303`*^9}, {3.718570741168517*^9, 
   3.718570751312354*^9}, {3.718570966864238*^9, 3.718571032996451*^9}, 
   3.718571122247602*^9, {3.718604029249032*^9, 3.718604059354835*^9}, {
   3.718605887485969*^9, 3.7186059827969227`*^9}, {3.718652790464365*^9, 
   3.718652793349195*^9}, {3.718754654626747*^9, 3.718754688647253*^9}, {
   3.719209387575585*^9, 
   3.719209408673572*^9}},ExpressionUUID->"b1ca0c80-bf95-43c8-bfc9-\
4c136d1bb551"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ScrewAxes\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"eca8b667-000d-4f8b-bd94-f1e06a693ae0"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumerateScrewAxes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.718649099946069*^9},ExpressionUUID->"edc3bc3d-84b9-48f6-b5c7-\
005a4536e445"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumerateScrewAxes", "[", 
   RowBox[{"axes_", ",", " ", "groups_", ",", "tol_", ",", "tol2_"}], "]"}], ":=",
   "\n", "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"ax", "=", "\n", "\t\t\t\t", 
      RowBox[{"Union", "@@", "\n", "\t", "\t\t\t\t", 
       RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Values", "@", "\n", "\t", "\t\t\t\t\t\t", 
          RowBox[{"Map", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{
            "Function", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{"enumerateAxes", "[", 
              RowBox[{"#", ",", " ", "tol2"}], "]"}], "\n", "\t", "\t", "\t", 
             "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
            "groups"}], "\n", "\t", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
         "\t", "\t\t\t\t\t", 
         RowBox[{"{", "axes", "}"}]}], "\n", "\t", "\t\t\t\t\t", "]"}]}]}], 
     "\n", "\t\t\t", "}"}], ",", "\n", "\t", 
    RowBox[{"Map", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"o", "=", 
           RowBox[{"ChemUtilsScrewAxisOrder", "[", 
            RowBox[{"#", ",", " ", "groups", ",", "tol"}], "]"}]}], "}"}], 
         ",", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"o", ">", "0"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"o", ",", " ", "#"}], "}"}], ",", "\n", "\t\t\t\t", 
           "Nothing"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], 
       "&"}], ",", "\n", "\t\t", 
      RowBox[{"deleteDuplicateAxes", "[", "\n", "\t\t\t", 
       RowBox[{"ax", ",", "\n", "\t\t\t", "tol2"}], "\n", "\t\t\t", "]"}]}], 
     "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718647451617277*^9, 3.718647460295944*^9}, {
   3.7186484423770657`*^9, 3.7186484441018887`*^9}, {3.718648488090356*^9, 
   3.7186484966551437`*^9}, 3.718648655436562*^9, {3.718648885007064*^9, 
   3.718648948960219*^9}, {3.718649083327577*^9, 3.718649091223506*^9}, {
   3.718649148791575*^9, 3.718649153301096*^9}, {3.718649478823875*^9, 
   3.71864947969938*^9}, {3.718650425017949*^9, 3.718650425648443*^9}, {
   3.718744481166642*^9, 3.718744490939156*^9}, {3.718754872260499*^9, 
   3.718754880692445*^9}, {3.71877434172431*^9, 3.7187743465206327`*^9}, {
   3.718817289068297*^9, 3.718817312851366*^9}, {3.7188173654137297`*^9, 
   3.7188173712942963`*^9}, {3.7188175078292027`*^9, 3.718817530619738*^9}, {
   3.7188175763616047`*^9, 3.718817581425787*^9}, {3.7188178438525763`*^9, 
   3.7188178596795597`*^9}, {3.718818188358282*^9, 3.718818191857793*^9}, {
   3.718818800939452*^9, 3.718818808923624*^9}, {3.7188391619680433`*^9, 
   3.718839164789802*^9}, {3.7188392310635157`*^9, 3.7188392415642776`*^9}, 
   3.7188392902514753`*^9, {3.718841702938463*^9, 3.7188417164223146`*^9}, {
   3.718933295504589*^9, 
   3.7189333099551983`*^9}},ExpressionUUID->"164d5fbe-6716-4f56-a7e5-\
54f7ac3a34f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ScrewAxisOrderComp\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718645375113543*^9, 3.7186453810670557`*^9}, 
   3.7186463512304153`*^9},ExpressionUUID->"bc5bf0bf-b2a6-45aa-afa8-\
5487e91f106b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ChemUtilsScrewAxisOrderComp", ":=", "\n", "\t", 
    RowBox[{"With", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"symmetricPointQ", "=", "symmetricPointQ"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"uniqueAxesQ", "=", "uniqueAxesQComp"}], ",", "\n", "\t\t\t", 
        
        RowBox[{
        "rawRotationReflectionTransformationFunction", "=", "\n", "\t\t\t\t", 
         "rawRotationReflectionTransformationFunction"}]}], "\n", "\t\t\t", 
       "}"}], ",", "\n", "\t\t", 
      RowBox[{"Compile", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"point1", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"point2", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
          ",", "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"grps", ",", " ", "_Integer", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "\n", "\t\t\t\t", 
         "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"groupOrdering", " ", "=", " ", 
             RowBox[{"Ordering", "[", "grps", "]"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"returnOrder", "=", "1"}]}], "\n", "\t\t\t\t\t", "}"}], 
          ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Do", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Block", "[", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"flag", "=", "True"}], ",", "\n", "\t", "\t", "\t", 
                 "\t", "\t\t\t\t\t", 
                 RowBox[{"i", "=", "1"}], ",", 
                 RowBox[{"j", "=", "1"}], ",", "\n", "\t", "\t", "\t", "\t", 
                 "\t\t\t\t\t", "newpts", ",", "\n", "\t", "\t", "\t", "\t", 
                 "\t\t\t\t\t", "oldpts"}], "\n", "\t", "\t\t\t\t\t\t\t\t", 
                "}"}], ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i", "\[LessEqual]", 
                    RowBox[{"Length", "[", "grps", "]"}]}], "&&", "flag"}], 
                  ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"grp", "=", 
                    RowBox[{"Take", "[", 
                    RowBox[{"positions", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Total", "@", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", " ", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}],
                     ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ";", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"j", "\[LessEqual]", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "&&", "flag"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"flag", "=", 
                    RowBox[{
                    "symmetricPointQ", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    RowBox[{
                    "rawRotationReflectionTransformationFunction", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"grp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"2.", 
                    RowBox[{"\[Pi]", "/", "o"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "point2", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", "point1"}], "\n", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"grp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "grp", ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "tol"}], "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"j", "++"}]}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t\t", 
                   RowBox[{"i", "++"}]}]}], "\n", "\t", "\t", "\t", 
                 "\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{"flag", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"returnOrder", "=", "o"}], ";", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Break", "[", "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"o", ",", " ", "grps"}], "}"}]}], "\n", 
            "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t", 
           "returnOrder"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", 
       "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{
  3.718645357061805*^9, {3.7186454083037043`*^9, 3.718645484265023*^9}, {
   3.718645516641765*^9, 3.718645607035201*^9}, {3.718645665977577*^9, 
   3.71864577164003*^9}, {3.718645848758905*^9, 3.7186459329477*^9}, {
   3.718645966885105*^9, 3.7186460230578012`*^9}, {3.7186463550853*^9, 
   3.718646369340136*^9}, {3.7186465155947733`*^9, 
   3.718646520841198*^9}},ExpressionUUID->"46f9a256-eb74-451e-a677-\
c941215dda88"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ScrewAxisOrder\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693933179393201*^9, 
  3.6939331898983707`*^9}},ExpressionUUID->"6117173f-9317-4bf2-b3be-\
4739fb2124e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"screwTransform", "[", 
    RowBox[{"order_", ",", " ", "axisPoint_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"Composition", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"rotationTransform", "[", 
       RowBox[{"order", ",", " ", "axisPoint"}], "]"}], ",", "\n", "\t\t", 
      RowBox[{"ReflectionTransform", "[", "axisPoint", "]"}]}], "\n", "\t\t", 
     "]"}], "//", "Simplify"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"screwTransform", "[", "axisPoint_", "]"}], "[", "order_", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"screwTransform", "[", 
   RowBox[{"order", ",", "axisPoint"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.693933425747375*^9, 3.693933536467146*^9}, {
  3.693933798227947*^9, 3.69393381328333*^9}, {3.69393453667826*^9, 
  3.6939345743640223`*^9}, {3.6939346906681757`*^9, 3.693934783838641*^9}, {
  3.693935458277231*^9, 3.693935462047345*^9}, {3.6939356968494787`*^9, 
  3.6939357266076937`*^9}, {3.693936475067168*^9, 3.693936516578043*^9}, {
  3.693937553901361*^9, 3.693937558673801*^9}, {3.693937591764505*^9, 
  3.693937634168419*^9}, {3.718754598794482*^9, 
  3.718754619088176*^9}},ExpressionUUID->"6adb38d8-66f9-4163-8a53-\
7c8cf14fef66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsScrewAxisOrder", "[", "\n", "\t", 
    RowBox[{"point_", ",", "\n", "\t", "groups_", ",", "\n", "\t", 
     RowBox[{"tol", ":", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ":", 
      "Automatic"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"es", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"groups", ",", " ", "Length"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{"ret", "=", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"symmetryOperationQ", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"screwTransform", "[", 
                RowBox[{"o", ",", " ", "point"}], "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t", "groups", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{"tol", ",", " ", 
                 RowBox[{
                 "Automatic", "\[RuleDelayed]", "$ChemSymmetryTolerance"}]}], 
                "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"Return", "[", "o", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}],
            ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"o", ",", " ", 
             RowBox[{"Length", "@", 
              RowBox[{"groups", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], ",", " ", "3", ",", " ", 
             RowBox[{"-", "1"}]}], "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n",
         "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ret", ">", "0"}], "//", "TrueQ"}], ",", "\n", "\t\t\t\t", 
         "ret", ",", "\n", "\t\t\t\t", "0"}], "\n", "\t\t\t\t", "]"}]}], "\n",
       "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.693868000851001*^9, 3.69386800484634*^9}, {
   3.693868234456831*^9, 3.6938682510956*^9}, {3.6938690898271723`*^9, 
   3.693869097338025*^9}, 3.693869341364582*^9, {3.693869531360589*^9, 
   3.693869534998392*^9}, {3.693869639634843*^9, 3.693869666199477*^9}, {
   3.6938699265172997`*^9, 3.693869927395994*^9}, {3.69387013669753*^9, 
   3.693870157495741*^9}, {3.693870285940197*^9, 3.693870404313805*^9}, {
   3.693870678804714*^9, 3.6938707218014183`*^9}, {3.693870779291135*^9, 
   3.6938708323551483`*^9}, {3.693870986580296*^9, 3.693871018468548*^9}, {
   3.693871198865802*^9, 3.693871242055758*^9}, {3.693871318706398*^9, 
   3.693871329536429*^9}, {3.693871411174685*^9, 3.693871459612759*^9}, {
   3.693872052841435*^9, 3.693872096673881*^9}, {3.693872323484805*^9, 
   3.6938723512902327`*^9}, {3.693934582247509*^9, 3.693934678747718*^9}, {
   3.693934812742985*^9, 3.693934817511202*^9}, {3.69393907608079*^9, 
   3.693939080191771*^9}, {3.693939192520775*^9, 3.693939194512632*^9}, {
   3.69393986836665*^9, 3.693939873948476*^9}, {3.69395429413013*^9, 
   3.693954296985458*^9}, {3.6939561164384117`*^9, 3.6939561285797787`*^9}, {
   3.693956358115484*^9, 3.693956430545885*^9}, {3.693956471038178*^9, 
   3.693956479235177*^9}, {3.693956989397191*^9, 3.693957021868203*^9}, {
   3.7185678142696953`*^9, 3.718568172378374*^9}, {3.718569351347392*^9, 
   3.718569352428878*^9}, {3.718569390345027*^9, 3.718569406574437*^9}, {
   3.718569750964423*^9, 3.7185697515064898`*^9}, {3.71856982022528*^9, 
   3.7185698258843203`*^9}, {3.718570172281143*^9, 3.71857021089524*^9}, {
   3.718570683911496*^9, 3.7185706855167303`*^9}, {3.718570741168517*^9, 
   3.718570751312354*^9}, {3.718570966864238*^9, 3.718571032996451*^9}, 
   3.718571122247602*^9, {3.7185734285246353`*^9, 3.718573486460107*^9}, {
   3.718573555691966*^9, 3.7185735569121523`*^9}, {3.7186040761413507`*^9, 
   3.7186040877282553`*^9}, {3.7187545461019487`*^9, 
   3.718754556568479*^9}},ExpressionUUID->"1a8888af-b6f1-46a9-b8b6-\
a2d301ca40a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Symmetry Planes\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"509463ea-fc74-48ee-a9ab-a7fb9b19a8a5"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]perpendicularAxisQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.693931392199067*^9},ExpressionUUID->"718ce9d9-1233-4200-b722-\
2d5fe4942bdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"perpendicularAxisQ", "[", 
    RowBox[{"center_", ",", "p_", ",", 
     RowBox[{"{", 
      RowBox[{"q1_", ",", "q2_"}], "}"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Not", "@", 
    RowBox[{"uniqueAxesQ", "[", 
     RowBox[{"center", ",", "p", ",", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"q1", "-", "center"}], ",", 
        RowBox[{"q2", "-", "center"}]}], "]"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perpendicularAxisQ", "[", 
     RowBox[{"center_", ",", "p_"}], "]"}], "[", "q_", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"perpendicularAxisQ", "[", 
    RowBox[{"center", ",", "p", ",", "q"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693930915446406*^9, 3.6939309727906837`*^9}, {
  3.693932337479426*^9, 
  3.6939323385490923`*^9}},ExpressionUUID->"631a94d5-1951-419a-9731-\
44d8a2d91f8b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]anyPerpendicular\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693931774762272*^9, 
  3.6939317784833717`*^9}},ExpressionUUID->"85547eda-fa0c-47aa-8888-\
15174aca3cd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"anyPerpPlane", "[", 
    RowBox[{"center_", ",", "axes_", ",", "planes_"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"AnyTrue", "[", 
    RowBox[{"planes", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"plane", "=", "#"}], "}"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"AnyTrue", "[", 
         RowBox[{"axes", ",", 
          RowBox[{
           RowBox[{"perpendicularAxisQ", "[", 
            RowBox[{"center", ",", "#", ",", "plane"}], "]"}], "&"}]}], 
         "]"}]}], "\n", "\t", "\t\t", "]"}], "&"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"anyPerpPlane", "[", 
     RowBox[{"center_", ",", "axes_"}], "]"}], "[", "planes_", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"anyPerpPlane", "[", 
    RowBox[{"center", ",", "axes", ",", "planes"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.693931782212802*^9, 3.6939318357400227`*^9}, {
  3.693952171901952*^9, 
  3.693952174582109*^9}},ExpressionUUID->"1461e29a-fae3-48cb-8e26-\
172eb96b13aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]uniqueAxesQCompGen\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.718755085902479*^9},ExpressionUUID->"3b42a3d0-9ae4-437c-acad-\
51838210da67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uniqueAxesQCompGen", "[", "tolRough_", "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tol", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"10", "*", "tolRough", "*", "Degree"}], ",", " ", "\[Pi]"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"q", ",", " ", "_Real", ",", " ", "1"}], "}"}]}], "}"}], ",",
       "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"arg", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", ".", "q"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Norm", "[", "p", "]"}], "*", 
             RowBox[{"Norm", "[", "q", "]"}]}], ")"}]}]}], "}"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"Which", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"arg", "==", 
           RowBox[{"-", "1"}]}], ",", "\n", "\t\t\t\t\t\t", "True", ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"arg", "==", "1"}], ",", "\n", "\t\t\t\t\t\t", "True", ",", 
          "\n", "\t\t\t\t\t", "True", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ang", "=", 
              RowBox[{"ArcCos", "[", "arg", "]"}]}], "}"}], ",", "\n", 
            "\t\t\t\t\t\t\t", 
            RowBox[{"tol", "<", "ang", "<", 
             RowBox[{"\[Pi]", "-", "tol"}]}]}], "\n", "\t\t\t\t\t\t\t", 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718749955615802*^9, 3.718749986198922*^9}, {
   3.718752827443528*^9, 3.718752844042328*^9}, {3.718753339187297*^9, 
   3.718753342942747*^9}, 3.718754382470685*^9, {3.718756169604219*^9, 
   3.7187561875040617`*^9}, {3.718756399410474*^9, 3.7187564040514402`*^9}, {
   3.7187564376908817`*^9, 3.718756438040393*^9}, {3.718756719379814*^9, 
   3.718756728919447*^9}},ExpressionUUID->"0a222796-4e0c-4d0c-9b22-\
cdc5c66b979e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonUniqueAxesQCompGen", "[", "tolRough_", "]"}], ":=", "\n", "\t", 
  
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tol", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"10", "*", "tolRough", "*", "Degree"}], ",", " ", "\[Pi]"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"q", ",", " ", "_Real", ",", " ", "1"}], "}"}]}], "}"}], ",",
       "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"arg", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", ".", "q"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Norm", "[", "p", "]"}], "*", 
             RowBox[{"Norm", "[", "q", "]"}]}], ")"}]}]}], "}"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"Which", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"arg", "==", 
           RowBox[{"-", "1"}]}], ",", "\n", "\t\t\t\t\t\t", "True", ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"arg", "==", "1"}], ",", "\n", "\t\t\t\t\t\t", "True", ",", 
          "\n", "\t\t\t\t\t", "True", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ang", "=", 
              RowBox[{"ArcCos", "[", "arg", "]"}]}], "}"}], ",", "\n", "\t", 
            "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"tol", ">", "ang"}], "||", 
             RowBox[{"ang", ">", 
              RowBox[{"\[Pi]", "-", "tol"}]}]}]}], "\n", "\t\t\t\t\t\t\t", 
           "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
     "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718749955615802*^9, 3.718749986198922*^9}, {
   3.71875086834787*^9, 3.718750874098415*^9}, {3.718752851883286*^9, 
   3.7187528585740213`*^9}, {3.718753325373115*^9, 3.718753327813541*^9}, {
   3.7187542221991663`*^9, 3.718754245384997*^9}, 3.7187543845902157`*^9, {
   3.7187561923122177`*^9, 3.718756195421139*^9}, {3.718756391395968*^9, 
   3.718756396129951*^9}, {3.7187567065323753`*^9, 
   3.718756711280538*^9}},ExpressionUUID->"706d4e24-1c35-46f8-aa1a-\
ddc330769cc2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]uniquePlanesQCompGen\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.718750097929509*^9},ExpressionUUID->"3669de50-df39-4566-9f00-\
4c78235dee74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uniquePlanesQCompGen", "[", 
   RowBox[{"center_", ",", " ", "tolRough_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tol", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"10", "*", "tolRough", "*", "Degree"}], ",", " ", "\[Pi]"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"src1", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", " ", 
        
        RowBox[{"{", 
         RowBox[{"src2", ",", " ", "_Real", ",", " ", "2"}], "}"}]}], "}"}], 
      ",", "\n", "\t", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"src1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"src1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"q", "=", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"src2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"src2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "\n", "\t\t\t\t", 
         "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"arg", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", ".", "q"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Norm", "[", "p", "]"}], "*", 
               RowBox[{"Norm", "[", "q", "]"}]}], ")"}]}]}], "}"}], ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"Which", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"arg", "==", 
             RowBox[{"-", "1"}]}], ",", "\n", "\t\t\t\t\t\t\t", "True", ",", 
            "\n", "\t\t\t\t\t\t", 
            RowBox[{"arg", "==", "1"}], ",", "\n", "\t\t\t\t\t\t\t", "True", 
            ",", "\n", "\t\t\t\t\t\t", "True", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ang", "=", 
                RowBox[{"ArcCos", "[", "arg", "]"}]}], "}"}], ",", "\n", 
              "\t\t\t\t\t\t\t\t", 
              RowBox[{"tol", "<", "ang", "<", 
               RowBox[{"\[Pi]", "-", "tol"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718749955615802*^9, 3.718750090853002*^9}, 
   3.718751342735463*^9, {3.718751500807032*^9, 3.7187515107342243`*^9}, {
   3.718752602229184*^9, 3.718752764975596*^9}, {3.718752804683359*^9, 
   3.7187528071349373`*^9}, {3.71875305836613*^9, 3.718753062530221*^9}, {
   3.718753137497209*^9, 3.718753169384511*^9}, {3.718753217072139*^9, 
   3.718753291611825*^9}, {3.718754369394639*^9, 3.7187543744869556`*^9}, {
   3.7187558904762297`*^9, 3.718755893876459*^9}, {3.718756080963472*^9, 
   3.718756100006804*^9}, {3.7187561323355427`*^9, 3.718756153086437*^9}, {
   3.718756379323353*^9, 3.7187563841463737`*^9}, {3.718756687894676*^9, 
   3.718756698376737*^9}},ExpressionUUID->"f9a81139-e87e-4bd6-b326-\
d79b8b85d2fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonUniquePlanesQCompGen", "[", "tolRough_", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tol", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"10", "*", "tolRough", "*", "Degree"}], ",", " ", "\[Pi]"}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"src1", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", " ", 
        
        RowBox[{"{", 
         RowBox[{"src2", ",", " ", "_Real", ",", " ", "2"}], "}"}]}], "}"}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"src1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"src1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"q", "=", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"src2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"src2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "\n", "\t\t\t\t", 
         "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"arg", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", ".", "q"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Norm", "[", "p", "]"}], "*", 
               RowBox[{"Norm", "[", "q", "]"}]}], ")"}]}]}], "}"}], ",", "\n",
           "\t\t\t\t\t", 
          RowBox[{"Which", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"arg", "==", 
             RowBox[{"-", "1"}]}], ",", "\n", "\t\t\t\t\t\t\t", "True", ",", 
            "\n", "\t\t\t\t\t\t", 
            RowBox[{"arg", "==", "1"}], ",", "\n", "\t\t\t\t\t\t\t", "True", 
            ",", "\n", "\t\t\t\t\t\t", "True", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ang", "=", 
                RowBox[{"ArcCos", "[", "arg", "]"}]}], "}"}], ",", "\n", "\t",
               "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"tol", ">", "ang"}], "||", 
               RowBox[{"ang", ">", 
                RowBox[{"\[Pi]", "-", "tol"}]}]}]}], "\n", "\t\t\t\t\t\t\t\t",
              "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718749955615802*^9, 3.718750090853002*^9}, 
   3.718751342735463*^9, {3.718751500807032*^9, 3.7187515107342243`*^9}, {
   3.718752602229184*^9, 3.718752800991206*^9}, {3.718753017253559*^9, 
   3.718753083932144*^9}, {3.718753304277018*^9, 3.718753316489246*^9}, {
   3.718753387675064*^9, 3.7187534748150682`*^9}, {3.718753600606023*^9, 
   3.718753626398931*^9}, 3.718753875560659*^9, 3.718753914421506*^9, 
   3.718754378215859*^9, {3.7187549436942368`*^9, 3.718754964436092*^9}, {
   3.718755925893421*^9, 3.71875606715205*^9}, {3.718756111422584*^9, 
   3.718756113838024*^9}, {3.7187562204815702`*^9, 3.7187563069840727`*^9}, {
   3.7187563705801983`*^9, 3.718756387587121*^9}, {3.718756513747157*^9, 
   3.718756523384811*^9}, {3.7187565918777647`*^9, 
   3.718756701696278*^9}},ExpressionUUID->"2efae9b1-58fa-48ed-8502-\
82fd324a708e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumeratePositions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718647515171051*^9, 3.7186475178493977`*^9}, {
  3.718755246441378*^9, 
  3.7187552479029627`*^9}},ExpressionUUID->"ca546272-e72d-44a1-8ba0-\
f7a4d8548192"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$chemSymmIgnore", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", "3"}], "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.718647629644658*^9, 3.718647642423891*^9}, 
   3.7186524140663633`*^9},ExpressionUUID->"9f581d61-647e-4c8f-a5d5-\
7cff90ee3e92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"enumeratePositionsCore", "=", "\n", "\t", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Select", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Table", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"With", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"1", "+", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "/", 
                 RowBox[{"Length", "[", "positions", "]"}]}], "]"}]}]}], ",", 
             "\n", "\t\t\t\t\t\t", 
             RowBox[{"j", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"n", ",", " ", 
                RowBox[{"Length", "[", "positions", "]"}], ",", " ", "1"}], 
               "]"}]}]}], "\n", "\t", "\t", "\t", "\t\t\t", "}"}], ",", "\n", 
           "\t", "\t", "\t", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "j"}], ",", "\n", "\t\t\t\t\t\t", 
             "$chemSymmEscapeArray", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", "j"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"positions", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"positions", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "=!=", 
                  RowBox[{"positions", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"Mean", "[", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t", "\t", 
                    "\t", "\t", "\t", "\t", "\t\t\t", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "}"}], "]"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "$chemSymmEscapeArray"}], "\n", 
                "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
            "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"n", ",", " ", 
           RowBox[{
            RowBox[{"Length", "@", "positions"}], "^", "2"}]}], "}"}]}], "\n",
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"#", "=!=", "$chemSymmEscapeArray"}], "&"}]}], "\n", "\t\t\t",
       "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"enumeratePositions", "[", "pts_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"enumeratePositionsCached", "[", 
     RowBox[{"{", "pts", "}"}], "]"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Except", "[", "_List", "]"}], ":>", "\n", "\t\t\t", 
     RowBox[{"Set", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"enumeratePositionsCached", "[", "pts", "]"}], ",", " ", "\n", 
       "\t\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pts", "]"}], ">", "0"}], ",", " ", 
         RowBox[{"enumeratePositionsCore", "[", "pts", "]"}], ",", " ", 
         RowBox[{"{", "}"}]}], "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", 
   "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.718647529275552*^9, 3.718647647737062*^9}, {
  3.718647690983838*^9, 3.71864782793393*^9}, {3.718647982141473*^9, 
  3.718647987686523*^9}, {3.7187457974388647`*^9, 3.71874581196509*^9}, {
  3.718754060646106*^9, 3.718754079553894*^9}, {3.718755481304336*^9, 
  3.718755497822877*^9}, {3.7187658932955713`*^9, 3.7187659095404177`*^9}, {
  3.71876647445502*^9, 3.718766491288721*^9}, {3.718766638002924*^9, 
  3.718766640626989*^9}, {3.71882014276054*^9, 3.718820166384358*^9}, {
  3.718820284233089*^9, 3.718820303959303*^9}, {3.718820539145516*^9, 
  3.718820544940843*^9}, {3.718840249194581*^9, 
  3.7188402546941013`*^9}},ExpressionUUID->"03701004-71ec-43ca-9884-\
91639f91e909"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]deleteDuplicatePlanes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7187572003840322`*^9, 
  3.7187572035098877`*^9}},ExpressionUUID->"dab18675-95aa-47c4-b59a-\
f2878320d54e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deleteDuplicatePlanesPickSpec", "[", "tol_", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Compile", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\t", 
      RowBox[{"{", 
       RowBox[{"planes", ",", " ", "_Real", ",", " ", "3"}], "}"}], " ", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"vecs", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Cross", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
           "planes"}]}], ",", "\n", "\t\t\t", "vecNorm", ",", "\n", "\t\t\t", 
         "angs", ",", "\n", "\t\t\t", "order", ",", "\n", "\t\t\t", 
         "angDiffs", ",", "\n", "\t\t\t", "angSel", ",", "\n", "\t\t\t", 
         RowBox[{"tally", "=", "0."}], ",", "\n", "\t\t\t", "normDiffs", ",", 
         "\n", "\t\t\t", 
         RowBox[{"flag", "=", "1"}], ",", "\n", "\t\t\t", 
         RowBox[{"tolTrue", "=", 
          RowBox[{"tol", "/", "100"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Times", "@@", "\n", "\t\t\t\t", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"vecNorm", "=", 
            RowBox[{"Norm", "@", 
             RowBox[{"vecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\n", "\t\t\t\t\t", 
           RowBox[{"angs", "=", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vecs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ".", 
                 RowBox[{"vecs", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"vecNorm", "*", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"vecs", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ")"}]}], ",", 
              "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"i", "+", "1"}], ",", " ", 
                RowBox[{"Length", "@", "vecs"}]}], "}"}]}], "\n", 
             "\t\t\t\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t\t\t", 
           RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"1", ",", " ", 
               RowBox[{"{", 
                RowBox[{"doop", ",", "i"}], "}"}]}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "-", "tol"}], "<", "#"}], ",", " ", "0", ",", 
                 " ", "1"}], "]"}], "&"}], "/@", 
              RowBox[{"Abs", "[", "angs", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
            "]"}]}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "[", "vecs", "]"}]}], "}"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"deleteDuplicatePlanes", "[", 
   RowBox[{"planes_", ",", " ", "tol_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "planes", "]"}], ">", "1"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"spec", "=", 
        RowBox[{
         RowBox[{"deleteDuplicatePlanesPickSpec", "[", "tol", "]"}], "@", 
         "planes"}]}], "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "spec", "]"}], "===", 
         RowBox[{"Length", "[", "planes", "]"}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Pick", "[", 
         RowBox[{"planes", ",", " ", "spec", ",", " ", "1"}], "]"}], ",", 
        "\n", "\t\t\t\t", "planes"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
     "\t\t\t", "]"}], ",", "\n", "\t\t", "planes"}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.718757208624332*^9, 3.718757361791288*^9}, {
   3.718757392716515*^9, 3.718757429808181*^9}, {3.7187575066526423`*^9, 
   3.718757664173521*^9}, {3.7187577937204733`*^9, 3.718757846087491*^9}, {
   3.7187579099886627`*^9, 3.718758034724592*^9}, {3.718758107247653*^9, 
   3.718758144339818*^9}, {3.718758184603244*^9, 3.7187583113589067`*^9}, {
   3.718758348305464*^9, 3.718758348986658*^9}, {3.718758472490013*^9, 
   3.718758606137054*^9}, {3.718758835412499*^9, 3.718758951457016*^9}, {
   3.718759029728397*^9, 3.718759163996477*^9}, {3.718762114762761*^9, 
   3.718762211372198*^9}, {3.71876228102065*^9, 3.718762333361396*^9}, {
   3.718762376904347*^9, 3.718762392246583*^9}, {3.718762572608296*^9, 
   3.718762573420477*^9}, {3.718762669716254*^9, 3.7187627106072617`*^9}, {
   3.71876279916162*^9, 3.718762864529807*^9}, {3.71876316265239*^9, 
   3.7187631729934187`*^9}, {3.718763219252186*^9, 3.718763227965547*^9}, {
   3.718765534816997*^9, 3.718765553914094*^9}, {3.718818042052116*^9, 
   3.718818122323244*^9}, {3.7188192916817617`*^9, 3.71881930224959*^9}, 
   3.718836773273939*^9, {3.718838122269924*^9, 3.718838128837184*^9}, {
   3.718838303450877*^9, 3.718838304054434*^9}, {3.719119291604764*^9, 
   3.71911936410607*^9}, {3.719119401891625*^9, 
   3.71911943656901*^9}},ExpressionUUID->"f0c7ba85-8171-42b2-a641-\
1ebcdf62befc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumeratePlanesSimple\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718647515171051*^9, 
  3.718647522430646*^9}},ExpressionUUID->"3307392e-a04d-4f8e-84fb-\
0d66d79f9ea2"],

Cell[BoxData[
 RowBox[{"enumeratePlanesEnumerator", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.7188191848088007`*^9, 
  3.718819185819952*^9}},ExpressionUUID->"99f0e9d9-1541-4758-a99d-\
bf6bafc764df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumeratePlanesEnumeratorComp", "=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"$failed", "=", "$chemSymmEscapeArray"}], "\n", "\t\t\t", "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
        "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Select", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"With", "[", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"i", "=", 
                  RowBox[{"1", "+", 
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "/", 
                    RowBox[{"Length", "[", "positions", "]"}]}], "]"}]}]}], 
                 ",", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"j", "=", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"n", ",", " ", 
                    RowBox[{"Length", "[", "positions", "]"}], ",", " ", 
                    "1"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"i2", "=", 
                  RowBox[{"1", "+", 
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "-", "1"}], ")"}], "/", 
                    RowBox[{"Length", "[", "positions", "]"}]}], "]"}]}]}], 
                 ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"j2", "=", 
                  RowBox[{"1", "+", 
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "-", "1"}], ")"}], "/", 
                    RowBox[{"Length", "[", "positions", "]"}]}], "]"}]}]}]}], 
                "\n", "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
               
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"n", ">", "m"}], "||", 
                  RowBox[{"i", ">", "j"}], "||", 
                  RowBox[{"i2", ">", "j2"}]}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 
                 RowBox[{"{", 
                  RowBox[{"$failed", ",", " ", "$failed"}], "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"samp", "=", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "j"}], ",", "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=!=", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t", "\t", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], "]"}], ",", "\n", "\t",
                     "\t", "\t\t\t\t\t\t\t\t\t\t\t", "$failed"}], "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t",
                     "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i2", "\[Equal]", "j2"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", " ", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=!=", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", "\n", "\t", "\t", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j2", "]"}], "]"}]}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], "]"}], ",", "\n", "\t",
                     "\t", "\t\t\t\t\t\t\t\t\t\t\t", "$failed"}], "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"samp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=!=", 
                    RowBox[{"samp", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "\t", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "samp", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"$failed", ",", " ", "$failed"}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{"n", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", "positions"}], "^", "2"}]}], "}"}], 
             ",", "\n", "\t\t\t\t\t", "\t", 
             RowBox[{"{", 
              RowBox[{"m", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", "positions"}], "^", "2"}]}], "}"}]}], 
            "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", "1"}], "\n",
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=!=", "$failed"}], "&&", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "=!=", "$failed"}], "&"}]}], 
        "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.718749414415238*^9, 3.718749610266775*^9}, {
   3.718749666917412*^9, 3.718749856889844*^9}, {3.7187498934109163`*^9, 
   3.718749901442651*^9}, {3.7187499948250217`*^9, 3.718749997815176*^9}, {
   3.7187501071988497`*^9, 3.718750279832819*^9}, {3.7187503445134907`*^9, 
   3.718750417110889*^9}, {3.718750633016404*^9, 3.718750791244158*^9}, {
   3.718750889948017*^9, 3.718750891097601*^9}, {3.71875111918926*^9, 
   3.718751306523543*^9}, {3.7187514054418488`*^9, 3.7187514598173027`*^9}, {
   3.718751550923253*^9, 3.718751565900573*^9}, {3.718751636925235*^9, 
   3.7187516666477613`*^9}, {3.718752969477813*^9, 3.718753008339777*^9}, {
   3.718753499424659*^9, 3.718753513145954*^9}, 3.718753585434023*^9, {
   3.718753945681102*^9, 3.7187540238750687`*^9}, {3.718754800638871*^9, 
   3.718754802796564*^9}, 3.71875523955582*^9, {3.718755396973041*^9, 
   3.7187555228448343`*^9}, {3.71875558301341*^9, 3.718755635830377*^9}, {
   3.718755683538836*^9, 3.718755690896695*^9}, {3.7188191807409973`*^9, 
   3.718819181274105*^9}},ExpressionUUID->"60b0117b-8435-499a-9c83-\
21b3dbd75770"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumeratePlanesEnumerator", "[", "pts_", "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"real", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"pts", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", "#", "]"}], ">", "0"}], "&"}]}], "]"}]}], 
     "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "real"}], ">", "1"}], ",", "\n", "\t\t\t", 
      RowBox[{"enumeratePlanesEnumeratorComp", "[", "real", "]"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"{", "}"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718819192601316*^9, 
  3.718819246095063*^9}},ExpressionUUID->"ebe5fa75-f2c2-4dab-92f6-\
9108ba7d5674"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumeratePlanesSimple", "[", 
   RowBox[{"pts_", ",", " ", "tol_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"enumeratePlanesSimpleCached", "[", 
     RowBox[{"{", 
      RowBox[{"pts", ",", " ", "tol"}], "}"}], "]"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Except", "[", "_List", "]"}], ":>", "\n", "\t\t\t", 
     RowBox[{"Set", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"enumeratePlanesSimpleCached", "[", 
        RowBox[{"{", 
         RowBox[{"pts", ",", " ", "tol"}], "}"}], "]"}], ",", "\n", 
       "\t\t\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"base", "=", 
           RowBox[{"DeleteDuplicates", "@", 
            RowBox[{"enumeratePlanesEnumerator", "[", "pts", "]"}]}]}], "}"}],
          ",", "\n", "\t\t\t\t\t\t", 
         RowBox[{"deleteDuplicatePlanes", "[", "\n", "\t\t\t\t\t\t\t", 
          RowBox[{"base", ",", "\n", "\t\t\t\t\t\t\t", "tol"}], "\n", 
          "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
      "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718749414415238*^9, 3.718749610266775*^9}, {
   3.718749666917412*^9, 3.718749856889844*^9}, {3.7187498934109163`*^9, 
   3.718749901442651*^9}, {3.7187499948250217`*^9, 3.718749997815176*^9}, {
   3.7187501071988497`*^9, 3.718750279832819*^9}, {3.7187503445134907`*^9, 
   3.718750417110889*^9}, {3.718750633016404*^9, 3.718750791244158*^9}, {
   3.718750889948017*^9, 3.718750891097601*^9}, {3.71875111918926*^9, 
   3.718751306523543*^9}, {3.7187514054418488`*^9, 3.7187514598173027`*^9}, {
   3.718751550923253*^9, 3.718751565900573*^9}, {3.718751636925235*^9, 
   3.7187516666477613`*^9}, {3.718752969477813*^9, 3.718753008339777*^9}, {
   3.718753499424659*^9, 3.718753513145954*^9}, 3.718753585434023*^9, {
   3.718753945681102*^9, 3.7187540238750687`*^9}, {3.718754800638871*^9, 
   3.718754802796564*^9}, 3.71875523955582*^9, {3.718755697567419*^9, 
   3.718755699799535*^9}, {3.718755743140378*^9, 3.7187557499267178`*^9}, {
   3.718755797943288*^9, 3.7187557987017612`*^9}, {3.718756748400075*^9, 
   3.718756784046545*^9}, {3.7187568375537148`*^9, 3.7187568708309183`*^9}, {
   3.7187569030349417`*^9, 3.7187569042826033`*^9}, {3.718756970387039*^9, 
   3.718756981030986*^9}, {3.718758051795784*^9, 3.718758059644103*^9}, {
   3.718758225928536*^9, 3.718758227102919*^9}, {3.718758993717594*^9, 
   3.718759009078601*^9}, {3.718759168979892*^9, 3.718759171389509*^9}, {
   3.7187658363327293`*^9, 3.718765841962256*^9}, {3.7187663739690657`*^9, 
   3.718766377431467*^9}, {3.7187664199599447`*^9, 3.718766459971239*^9}, {
   3.718819078003666*^9, 3.718819169394014*^9}, {3.718819252027532*^9, 
   3.718819280610704*^9}, {3.718819311014703*^9, 
   3.718819318285184*^9}},ExpressionUUID->"ed3345ba-8df4-415c-86ac-\
66c7fd1db351"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumeratePlanes optimized, broken version\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718647515171051*^9, 3.718647522430646*^9}, {
  3.718750607624861*^9, 
  3.718750622198401*^9}},ExpressionUUID->"ade582e7-38e1-463a-9d33-\
d72fbe79c1a0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"enumeratePlanesSimple", "=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uniqueAxesQComp", "=", "uniqueAxesQComp"}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"center", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",",
          " ", 
         RowBox[{"{", 
          RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"coplanarPts", "=", "\n", "\t\t\t\t\t", 
            RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{"0", ",", " ", "\n", "\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"m", ",", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "positions", "]"}], "^", "2"}]}], 
               "}"}], ",", " ", "\n", "\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"n", ",", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "positions", "]"}], "^", "2"}]}], 
               "}"}], ",", " ", "\n", "\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"o", ",", " ", 
                RowBox[{
                 RowBox[{"Length", "[", "positions", "]"}], "^", "2"}]}], 
               "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
           
           RowBox[{"coplanarFlag", "=", "False"}], ",", "\n", "\t\t\t\t", "p",
            ",", "\n", "\t\t\t\t", 
           RowBox[{"ptsBag", "=", 
            RowBox[{"Internal`Bag", "[", 
             RowBox[{"Most", "@", 
              RowBox[{"{", "0", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t", "}"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{"(*", " ", 
                RowBox[{
                "This", " ", "just", " ", "computes", " ", "the", " ", 
                 "indices", " ", "for", " ", "each", " ", "planar", " ", 
                 "pt"}], " ", "*)"}], "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"i1", "=", 
                 RowBox[{"1", "+", 
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "/", 
                    RowBox[{"Length", "[", "positions", "]"}]}], "]"}]}]}], 
                ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"j1", "=", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"n", ",", " ", 
                   RowBox[{"Length", "[", "positions", "]"}], ",", " ", "1"}],
                   "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"i2", "=", 
                 RowBox[{"1", "+", 
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "-", "1"}], ")"}], "/", 
                    RowBox[{"Length", "[", "positions", "]"}]}], "]"}]}]}], 
                ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"j2", "=", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"m", ",", " ", 
                   RowBox[{"Length", "[", "positions", "]"}], ",", " ", "1"}],
                   "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"i3", "=", 
                 RowBox[{"1", "+", 
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "-", "1"}], ")"}], "/", 
                    RowBox[{"Length", "[", "positions", "]"}]}], "]"}]}]}], 
                ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"j3", "=", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"m", ",", " ", 
                   RowBox[{"Length", "[", "positions", "]"}], ",", " ", "1"}],
                   "]"}]}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Reduce", " ", "the", " ", "combinations", " ", "to", " ", 
                "check"}], " ", "*)"}], "\n", "\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"m", ">", "n"}], "||", 
                 RowBox[{"i1", ">", "j1"}], "||", 
                 RowBox[{"i2", ">", "j2"}], "||", 
                 RowBox[{"i3", ">", "j3"}], "||", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"coplanarFlag", " ", "=", " ", "False"}], ";", 
                   "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"p", "=", "1"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"!", "coplanarFlag"}], ")"}], "&&", 
                    RowBox[{"p", "<", "n"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Check", " ", "if", " ", 
                    RowBox[{"there", "'"}], "s", " ", "anything", " ", 
                    "point", " ", "such", " ", "that", " ", "these", " ", 
                    "are", " ", "all", " ", "coplanar"}], " ", "*)"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"coplanarFlag", "=", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coplanarPts", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", " ", "n", ",", " ", "o"}], "]"}], "]"}],
                     ">", "0"}], ")"}], "&&", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"coplanarPts", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", " ", "m", ",", " ", "o"}], "]"}], "]"}],
                     ">", "0"}], ")"}]}]}], ";", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"p", "++"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
                    "]"}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"!", "coplanarFlag"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                  ")"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"-", "1"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"p1", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i1", "\[Equal]", "j1"}], ",", " ", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", " ", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", " ", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "}"}], "]"}]}], 
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"p2", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i2", "\[Equal]", "j2"}], ",", " ", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", " ", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], ",", " ", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j2", "]"}], "]"}]}], "}"}], "]"}]}], 
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"p3", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i3", "\[Equal]", "j3"}], ",", " ", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", " ", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "i3", "]"}], "]"}], ",", " ", 
                    RowBox[{"positions", "[", 
                    RowBox[{"[", "j3", "]"}], "]"}]}], "}"}], "]"}]}], 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"coplanarPts", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", "n", ",", " ", "o"}], "]"}], "]"}],
                     "=", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "uniqueAxesQComp", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"center", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{"p1", "-", "center"}], ",", " ", 
                    RowBox[{"p2", "-", "center"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{"p3", "-", "center"}], ",", " ", 
                    RowBox[{"p2", "-", "center"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "tol"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "1", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "0"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Internal`StuffBag", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ptsBag", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Internal`Bag", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Internal`Bag", "[", "p1", "]"}], ",", 
                    RowBox[{"Internal`Bag", "[", "p2", "]"}]}], "}"}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Internal`StuffBag", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ptsBag", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Internal`Bag", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Internal`Bag", "[", "p1", "]"}], ",", 
                    RowBox[{"Internal`Bag", "[", "p2", "]"}]}], "}"}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Internal`StuffBag", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ptsBag", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Internal`Bag", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Internal`Bag", "[", "p1", "]"}], ",", 
                    RowBox[{"Internal`Bag", "[", "p3", "]"}]}], "}"}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Internal`StuffBag", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ptsBag", ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Internal`Bag", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Internal`Bag", "[", "p2", "]"}], ",", 
                    RowBox[{"Internal`Bag", "[", "p3", "]"}]}], "}"}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n",
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                 "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
             "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"n", ",", " ", 
              RowBox[{
               RowBox[{"Length", "@", "positions"}], "^", "2"}]}], "}"}], ",",
             "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"m", ",", " ", 
              RowBox[{
               RowBox[{"Length", "@", "positions"}], "^", "2"}]}], "}"}], ",",
             "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"o", ",", " ", 
              RowBox[{
               RowBox[{"Length", "@", "positions"}], "^", "2"}]}], "}"}]}], 
           "\n", "\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
          RowBox[{"Internal`BagPart", "[", 
           RowBox[{"ptsBag", ",", " ", "All"}], "]"}]}]}], "\n", "\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.718647451617277*^9, 3.718647475095675*^9}, {
   3.71864787634991*^9, 3.718647917540208*^9}, {3.718647954974243*^9, 
   3.718648031866638*^9}, {3.7186500449246902`*^9, 3.718650086070284*^9}, {
   3.718650131718294*^9, 3.718650234505035*^9}, {3.71865036532658*^9, 
   3.718650375426567*^9}, {3.718745113095235*^9, 3.718745147213881*^9}, {
   3.718745233265691*^9, 3.718745235472085*^9}, {3.718745331763749*^9, 
   3.7187453438158283`*^9}, {3.718745485767221*^9, 3.718745604723757*^9}, {
   3.718745650017531*^9, 3.718745750219667*^9}, {3.718745793950365*^9, 
   3.718745968853175*^9}, {3.718746166326112*^9, 3.7187462550041933`*^9}, {
   3.718746313480987*^9, 3.7187463778158913`*^9}, {3.718746431474654*^9, 
   3.718746507726137*^9}, {3.718746558212376*^9, 3.718746581569243*^9}, {
   3.718746660261889*^9, 3.718746660827703*^9}, {3.7187467992953463`*^9, 
   3.718746802152837*^9}, {3.7187468395611267`*^9, 3.718746946452772*^9}, {
   3.718747218423932*^9, 3.718747479446753*^9}, {3.71874751210067*^9, 
   3.718747614321197*^9}, {3.718747697548925*^9, 3.7187478376173363`*^9}, {
   3.71874790418995*^9, 3.718747915956193*^9}, 3.718748049733047*^9, {
   3.718748210545496*^9, 3.718748235836355*^9}, {3.718748481534397*^9, 
   3.718748502517757*^9}, {3.7187485571251707`*^9, 3.718748628627658*^9}, {
   3.718748688841131*^9, 3.718748787773363*^9}, {3.7187488362633047`*^9, 
   3.718748838012455*^9}, {3.718748884689732*^9, 3.7187488977443657`*^9}, 
   3.718749083768734*^9, {3.718749148160828*^9, 3.718749148893529*^9}, {
   3.71874922878226*^9, 3.718749268876945*^9}, {3.718749352978168*^9, 
   3.7187493531119223`*^9}},ExpressionUUID->"7be59cc7-0383-40eb-a5ec-\
04dc340038fa"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Symmetry Planes\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"2f6c336d-cc79-4963-be0e-c47ac8b8a266"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]enumerateSymmetryPlanes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7186480539331903`*^9, 3.718648067576207*^9}, {
  3.7186489945222588`*^9, 
  3.718649000862014*^9}},ExpressionUUID->"8fd3d5f1-e783-40f6-8d22-\
6612aadfb488"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumeratePlanes", "[", 
   RowBox[{"positions_", ",", " ", "tol_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"axBase", "=", 
      RowBox[{"enumerateAxes", "[", 
       RowBox[{"positions", ",", " ", "tol"}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "axBase"}], ">", "1"}], ",", "\n", "\t\t\t", 
      RowBox[{"enumeratePlanesSimple", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"enumerateAxes", "[", 
         RowBox[{"positions", ",", " ", "tol"}], "]"}], ",", " ", "\n", 
        "\t\t\t\t", "tol"}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", "}"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718647451617277*^9, 3.718647463879352*^9}, {
   3.7186503867637167`*^9, 3.7186504156275167`*^9}, {3.7186524880221357`*^9, 
   3.718652489465892*^9}, {3.718754853428527*^9, 3.71875486123628*^9}, {
   3.7187551935559607`*^9, 3.718755197729856*^9}, {3.7187655123096943`*^9, 
   3.718765516436812*^9}, {3.718818680448202*^9, 3.7188187086290913`*^9}, {
   3.718819564718635*^9, 3.718819601024817*^9}, {3.7188196858441467`*^9, 
   3.7188196934816647`*^9}, {3.718819728886372*^9, 3.718819735337469*^9}, {
   3.7188197738351603`*^9, 3.7188197772870092`*^9}, {3.718819933654499*^9, 
   3.718819954935276*^9}, {3.7188200577092113`*^9, 3.7188200585485*^9}, 
   3.718820247366481*^9},ExpressionUUID->"501e850b-523a-4c91-80c2-\
7795618c356d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"enumerateSymmetryPlanes", "[", 
   RowBox[{"axes_", ",", " ", "groups_", ",", "tol_", ",", "tol2_"}], "]"}], ":=",
   "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"u", "=", "\n", "\t\t\t", 
      RowBox[{"Union", "@@", "\n", "\t\t\t\t", 
       RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Values", "@", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Map", "[", "\n", "\t", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"enumeratePlanes", "[", 
              RowBox[{"#", ",", " ", "tol2"}], "]"}], "&"}], ",", "\n", 
            "\t\t\t\t\t\t\t", "groups"}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
         ",", "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"Subsets", "[", 
           RowBox[{"axes", ",", " ", 
            RowBox[{"{", "2", "}"}]}], "]"}], "}"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "u"}], ">", "0"}], ",", "\n", "\t\t\t", 
      RowBox[{"Select", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"deleteDuplicatePlanes", "[", 
         RowBox[{"u", ",", " ", "tol2"}], "]"}], ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ChemUtilsPlaneOfSymmetryQ", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
          "#", ",", "\n", "\t", "\t", "\t\t\t", "groups", ",", "\n", "\t", 
           "\t", "\t\t\t", "tol"}], "\n", "\t", "\t", "\t\t\t", "]"}], 
         "&"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", "}"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718647451617277*^9, 3.7186474560724077`*^9}, {
   3.7186490413206997`*^9, 3.718649043704217*^9}, {3.718649183947398*^9, 
   3.718649213092092*^9}, {3.718650394034029*^9, 3.718650394688983*^9}, {
   3.718653031408931*^9, 3.718653055288494*^9}, {3.718754863427163*^9, 
   3.718754869572752*^9}, 3.718763053131467*^9, {3.718765499430119*^9, 
   3.7187655081888647`*^9}, {3.718774327196765*^9, 3.718774333040345*^9}, {
   3.718774474354123*^9, 3.718774475295858*^9}, {3.7187746228333282`*^9, 
   3.718774631333046*^9}, {3.718817197934634*^9, 3.718817237025546*^9}, 
   3.718817320443041*^9, {3.718817353366047*^9, 3.71881735856597*^9}, {
   3.7188174262204657`*^9, 3.718817458534416*^9}, 3.718817534406365*^9, {
   3.718817568673882*^9, 3.718817572343302*^9}, {3.718817834498695*^9, 
   3.718817836258478*^9}, {3.718817954680485*^9, 3.7188179553824997`*^9}, {
   3.718818181449894*^9, 3.718818185145721*^9}, {3.718818670786336*^9, 
   3.718818678448923*^9}, {3.7188197035719233`*^9, 3.718819704588256*^9}, {
   3.71881974520603*^9, 3.718819745561005*^9}, {3.7188199561666327`*^9, 
   3.7188200287943573`*^9}, {3.718820250230915*^9, 3.718820277275082*^9}, {
   3.7188364872055264`*^9, 3.718836514291246*^9}, {3.718836905205558*^9, 
   3.7188370130217323`*^9}, {3.71883705598307*^9, 3.7188371026601458`*^9}, {
   3.718837532505766*^9, 3.7188375418391323`*^9}, {3.718837662157802*^9, 
   3.718837707176146*^9}, {3.718837788186577*^9, 3.7188377894157057`*^9}, 
   3.7188379364960747`*^9, 3.718838005213402*^9, {3.718839154321567*^9, 
   3.718839157477734*^9}, {3.718839235580954*^9, 3.718839236825499*^9}, {
   3.7188417228225613`*^9, 3.718841731229032*^9}, {3.718932220643057*^9, 
   3.71893231695138*^9}, {3.718932351896412*^9, 3.718932362530794*^9}, {
   3.718932403248485*^9, 3.71893241259906*^9}, 3.71893244877837*^9, {
   3.718932922724121*^9, 3.7189329656564827`*^9}, {3.7189330048720083`*^9, 
   3.718933023189746*^9}, {3.718933067181315*^9, 3.718933090555386*^9}, {
   3.719210566314908*^9, 3.719210569181569*^9}, {3.7192106336285677`*^9, 
   3.719210657444147*^9}, {3.719210774353244*^9, 
   3.7192107766965733`*^9}},ExpressionUUID->"5c55a8d7-7dfa-4378-a284-\
5a4d0ec6693e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PlaneOfSymmetryQComp\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718645391317306*^9, 
  3.718645392547001*^9}},ExpressionUUID->"7136eb13-b64a-49c2-bc2c-\
acfa9421eeac"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ChemUtilsPlaneOfSymmetryQComp", ":=", "\n", "\t", 
    RowBox[{"With", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"symmetricPointQ", "=", "symmetricPointQ"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{
        "rawReflectionTransformationFunction", "=", 
         "rawReflectionTransformationFunction"}]}], "\n", "\t\t\t", "}"}], 
      ",", "\n", "\t\t", 
      RowBox[{"Compile", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"point1", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"norm", ",", " ", "_Real", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"positions", ",", " ", "_Real", ",", " ", "2"}], "}"}], 
          ",", "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"grps", ",", " ", "_Integer", ",", " ", "1"}], "}"}], ",", 
          "\n", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"tol", ",", " ", "_Real"}], "}"}]}], "\n", "\t\t\t\t", 
         "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"flag", "=", "True"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"j", "=", "1"}], ",", "\n", "\t\t\t\t\t", "newpts", ",", 
            "\n", "\t\t\t\t\t", "oldpts"}], "\n", "\t\t\t\t\t", "}"}], ",", 
          "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "\[LessEqual]", 
               RowBox[{"Length", "[", "grps", "]"}]}], "&&", "flag"}], ",", 
             "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"grp", "=", 
                  RowBox[{"Take", "[", 
                   RowBox[{"positions", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Total", "@", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", " ", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}],
                 ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"j", "=", "1"}], ";", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"While", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"j", "\[LessEqual]", 
                    RowBox[{"grps", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "&&", "flag"}], ",", 
                   "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"flag", "=", 
                    RowBox[{
                    "symmetricPointQ", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "rawReflectionTransformationFunction", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"grp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "norm", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "point1"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"grp", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "grp", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "tol"}], "\n", "\t\t\t\t\t\t\t\t\t",
                     "]"}]}], ";", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"j", "++"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
                  "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ";", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"i", "++"}]}]}], "\n", "\t\t\t\t\t\t", "]"}], ";", "\n",
            "\t\t\t\t\t", "flag"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.693868169296589*^9, 3.6938681827092533`*^9}, {
   3.6938682573266163`*^9, 3.6938682639496527`*^9}, 3.6938723915345716`*^9, {
   3.6938724317587347`*^9, 3.693872433477153*^9}, {3.693872645470345*^9, 
   3.693872649611545*^9}, {3.693872848545307*^9, 3.693872878580401*^9}, 
   3.6939331456807833`*^9, {3.693934501615739*^9, 3.693934509372473*^9}, {
   3.718572531612941*^9, 3.71857257117008*^9}, {3.718572605288802*^9, 
   3.718572682811614*^9}, {3.718638405805664*^9, 3.71863864253608*^9}, {
   3.718638828853363*^9, 3.7186388799786453`*^9}, {3.718639004986923*^9, 
   3.718639009226161*^9}, {3.718639072346656*^9, 3.718639241607299*^9}, {
   3.718639351251363*^9, 3.718639450804535*^9}, {3.71863948231225*^9, 
   3.718639499569704*^9}, {3.718639577341775*^9, 
   3.718639722105715*^9}},ExpressionUUID->"93db74d9-68f1-4ea8-aa39-\
6eafba7e4ab8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PlaneOfSymmetryQ\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69386800917048*^9, 
  3.693868086355568*^9}},ExpressionUUID->"3b42d2dc-4b97-41da-81d1-\
e458a1d7392d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsPlaneOfSymmetryQ", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"norm_:", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "\n", "\t", "grps_", 
     ",", "\n", "\t", 
     RowBox[{"tol", ":", 
      RowBox[{"_", "?", "NumericQ"}], ":", "0.000001"}]}], "\n", "\t", "]"}], 
   ":=", "\n", "\t", 
   RowBox[{"symmetryOperationQ", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ReflectionTransform", "[", "norm", "]"}], ",", "\n", "\t\t", 
     "grps", ",", "\n", "\t\t", "tol"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemUtilsPlaneOfSymmetryQ", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"point1_", ",", "point2_"}], "}"}], ",", "\n", "\t", "grps_", 
    ",", "\n", "\t", 
    RowBox[{"tol", ":", 
     RowBox[{"_", "?", "NumericQ"}], ":", "0.000001"}]}], "\n", "\t", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"ChemUtilsPlaneOfSymmetryQ", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{"point1", ",", " ", "point2"}], "]"}], ",", "\n", "\t\t", "grps",
     ",", "\n", "\t\t", "tol"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.693868169296589*^9, 3.6938681827092533`*^9}, {
   3.6938682573266163`*^9, 3.6938682639496527`*^9}, 3.6938723915345716`*^9, {
   3.6938724317587347`*^9, 3.693872433477153*^9}, {3.693872645470345*^9, 
   3.693872649611545*^9}, {3.693872848545307*^9, 3.693872878580401*^9}, 
   3.6939331456807833`*^9, {3.693934501615739*^9, 3.693934509372473*^9}, {
   3.718572531612941*^9, 3.71857257117008*^9}, {3.718572605288802*^9, 
   3.718572682811614*^9}, {3.718754510364653*^9, 3.718754523561805*^9}, {
   3.718754704841549*^9, 3.7187547121500483`*^9}, {3.718763341456251*^9, 
   3.7187633557414417`*^9}},ExpressionUUID->"73f7b6a6-bad7-41a4-b407-\
45ee21b183e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]InertialSymmetry\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6938733897132874`*^9, 3.693873432826721*^9}, {
  3.693877299838339*^9, 
  3.693877302841642*^9}},ExpressionUUID->"4ff9dcf4-b759-4a5e-933e-\
235d9d4d91e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemComputeInertialSymmetry", "[", 
    RowBox[{"c_", ",", "axes_", ",", "atoms_", ",", 
     RowBox[{"toler", ":", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ":", 
      "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tol", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"toler", ",", " ", 
         RowBox[{"Automatic", "\[RuleDelayed]", "$ChemSymmetryTolerance"}]}], 
        "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<CenterSymmetric\>\"", "\[Rule]", 
        RowBox[{"ChemUtilsInversionCenterQ", "[", 
         RowBox[{"c", ",", "atoms", ",", "tol"}], "]"}]}], ",", "\n", "\t", 
       "\t\t", 
       RowBox[{"\"\<ARotationOrder\>\"", "->", 
        RowBox[{"ChemUtilsRotationAxisOrder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<BRotationOrder\>\"", "->", 
        RowBox[{"ChemUtilsRotationAxisOrder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<CRotationOrder\>\"", "->", 
        RowBox[{"ChemUtilsRotationAxisOrder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<ABSymmetric\>\"", "\[Rule]", 
        RowBox[{"ChemUtilsPlaneOfSymmetryQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<ACSymmetric\>\"", "\[Rule]", 
        RowBox[{"ChemUtilsPlaneOfSymmetryQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<BCSymmetric\>\"", "\[Rule]", 
        RowBox[{"ChemUtilsPlaneOfSymmetryQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<AScrewOrder\>\"", "\[Rule]", "\n", "\t", "\t\t\t", 
        RowBox[{"ChemUtilsScrewAxisOrder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<BScrewOrder\>\"", "\[Rule]", "\n", "\t", "\t\t\t", 
        RowBox[{"ChemUtilsScrewAxisOrder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<CScrewOrder\>\"", "\[Rule]", "\n", "\t", "\t\t\t", 
        RowBox[{"ChemUtilsScrewAxisOrder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"c", "+", 
             RowBox[{"axes", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "atoms", ",", 
          "tol"}], "]"}]}]}], "\n", "\t\t\t", "|>"}]}], "\n", "\t\t", "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemComputeInertialSymmetry", "[", 
    RowBox[{"atoms_", ",", 
     RowBox[{"tol", ":", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ":", 
      "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"ChemComputeCenterOfMass", "@", "atoms"}]}], ",", "\n", 
       "\t\t", 
       RowBox[{"axes", "=", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"ChemComputeInertialSystem", "@", "atoms"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<AAxis\>\"", ",", "\"\<BAxis\>\"", ",", "\"\<CAxis\>\""}], 
           "}"}]}], "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"ChemComputeInertialSymmetry", "[", 
      RowBox[{"c", ",", "axes", ",", "atoms", ",", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"tol", ",", " ", 
         RowBox[{"Automatic", "\[RuleDelayed]", "$ChemSymmetryTolerance"}]}], 
        "]"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"58f4d9ea-012d-405c-8506-d7ad3e110c2c"]\

}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Symmetry Elements\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"c58777b2-8f1d-4a34-99d8-16a1162666e8"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]RawSymmetryElements\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693944820864649*^9, 3.693944824079577*^9}, {
  3.693954865637924*^9, 3.693954866139224*^9}, {3.7186087922358027`*^9, 
  3.718608792508726*^9}},ExpressionUUID->"d1d5242d-6863-49e8-817b-\
a0f78f047e6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$ChemSymmetryTolerance", "=", ".01"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$ChemSymmetryUniquenessThreshold", "=", ".0001"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.718838647634275*^9, 3.718838657104906*^9}, {
  3.718839691312524*^9, 3.71883969145221*^9}, {3.718843238084674*^9, 
  3.718843254251734*^9}, {3.71884416508811*^9, 
  3.718844170692842*^9}},ExpressionUUID->"6971aab1-bd47-42b9-b59d-\
cc19872d63bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemUtilsRawSymmetryElements", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Tolerance", "\[Rule]", "Automatic"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<UniquenessThreshold\>\"", "\[Rule]", "Automatic"}], ",", 
     "\n", "\t\t", 
     RowBox[{"\"\<ReturnElements\>\"", "\[Rule]", "All"}]}], "\n", "\t\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsRawSymmetryElements", "[", "\n", "\t", 
    RowBox[{"atoms_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
      "enumeratePositionsCached", ",", "\n", "\t\t", 
       "enumeratePlanesSimpleCached", ",", "\n", "\t\t", 
       "enumerateAxesCached", ",", "\n", "\t\t", 
       RowBox[{"$ChemSymmetryTolerance", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Tolerance", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_", "?", "NumericQ"}], "]"}], "->", 
           "$ChemSymmetryTolerance"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"$ChemSymmetryUniquenessThreshold", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<UniquenessThreshold\>\"", "]"}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_", "?", "NumericQ"}], "]"}], "->", 
           "$ChemSymmetryUniquenessThreshold"}]}], "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"center", "=", "\n", "\t\t\t\t", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"ChemComputeCenter", "@", "atoms"}], ",", " ", 
            "$ChemSymmetryUniquenessThreshold"}], "]"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"tol", "=", "\n", "\t\t\t\t", "$ChemSymmetryTolerance"}], 
         ",", "\n", "\t\t\t", 
         RowBox[{
         "tol2", "=", "\n", "\t\t\t\t", "$ChemSymmetryUniquenessThreshold"}], 
         ",", "\n", "\t\t\t", 
         RowBox[{"ret", "=", "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ReturnElements\>\"", "]"}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"All", "\[Rule]", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                "\"\<Center\>\"", ",", " ", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 "\"\<CenterSymmetric\>\"", ",", " ", "\n", "\t", "\t", 
                 "\t\t\t\t\t\t", "\"\<RotationAxes\>\"", ",", " ", "\n", "\t",
                  "\t", "\t\t\t\t\t\t", "\"\<SymmetryPlanes\>\"", ",", " ", 
                 "\n", "\t", "\t", "\t\t\t\t\t\t", "\"\<ScrewAxes\>\""}], 
                "\n", "\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
              
              RowBox[{"s_String", "\[RuleDelayed]", 
               RowBox[{"{", "s", "}"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], 
           "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"axes", "=", "\n", "\t", "\t\t\t\t", 
            RowBox[{"Last", "@", 
             RowBox[{"ChemComputeInertialEigensystem", "@", "atoms"}]}]}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"groups", "=", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{"#", "-", "center"}], "&"}], "]"}], "/@", "\n", "\t", 
             "\t\t\t\t\t", 
             RowBox[{"Round", "[", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"GroupBy", "[", 
                RowBox[{"atoms", ",", 
                 RowBox[{"First", "\[Rule]", "Last"}]}], "]"}], ",", "\n", 
               "\t", "\t\t\t\t\t\t", ".0001"}], "\n", "\t", "\t\t\t\t\t\t", 
              "]"}]}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"linear", "=", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"ChemComputeRotorType", "[", "atoms", "]"}], "===", 
             "\"\<Linear\>\""}]}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"AssociationThread", "[", 
            RowBox[{"ret", "\[Rule]", 
             RowBox[{"Lookup", "[", 
              RowBox[{"#", ",", " ", "ret"}], "]"}]}], "]"}], "&"}], "@", 
          "\n", "\t\t\t\t", 
          RowBox[{"<|", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<Center\>\"", ":>", "\n", "\t\t\t\t\t\t", "center"}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"\"\<CenterSymmetric\>\"", ":>", "\n", "\t\t\t\t\t\t", 
             RowBox[{"ChemUtilsInversionCenterQ", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Select", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Join", "@@", 
                  RowBox[{"Values", "@", "groups"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Norm", "[", "#", "]"}], ">", "0"}], "&"}]}], "\n",
                 "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
               "tol"}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"\"\<RotationAxes\>\"", ":>", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"enumerateRotationAxes", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                "axes", ",", "\n", "\t\t\t\t\t\t\t\t", "groups", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                  "ChemComputeRotorType", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"MapThread", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Thread", "@*", "List"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Keys", "[", "groups", "]"}], ",", 
                    RowBox[{"Values", "[", "groups", "]"}]}], "}"}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "]"}], "\n", "\t", 
                   "\t\t\t\t\t\t\t\t", "]"}], "===", "\"\<Linear\>\""}], ",", 
                 "\n", "\t\t\t\t\t\t\t\t", "tol", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "tol2"}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"o_", ",", " ", "v_"}], "}"}], ":>", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{"o", ",", " ", 
                  RowBox[{
                   RowBox[{"Normalize", "[", "v", "]"}], " ", "+", " ", 
                   "center"}]}], "}"}]}], ",", "\n", "\t\t\t\t\t\t\t", "1"}], 
              "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"\"\<SymmetryPlanes\>\"", ":>", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
               "enumerateSymmetryPlanes", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                "axes", ",", "\n", "\t\t\t\t\t\t\t\t", "groups", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "tol", ",", "\n", "\t\t\t\t\t\t\t\t", 
                 "tol2"}], "\n", "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"v1_", ",", " ", "v2_"}], "}"}], ":>", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Normalize", "[", "v1", "]"}], "+", "center"}], 
                  ",", " ", 
                  RowBox[{
                   RowBox[{"Normalize", "[", "v2", "]"}], "+", "center"}]}], 
                 "}"}]}], ",", "\n", "\t\t\t\t\t\t\t", "1"}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"\"\<ScrewAxes\>\"", ":>", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"enumerateScrewAxes", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                "axes", ",", "\n", "\t\t\t\t\t\t\t\t", "groups", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "tol", ",", "\n", "\t\t\t\t\t\t\t\t", 
                 "tol2"}], "\n", "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"o_", ",", "v_"}], "}"}], ":>", "\n", "\t", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{"o", ",", " ", 
                  RowBox[{
                   RowBox[{"Normalize", "[", "v", "]"}], "+", "center"}]}], 
                 "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t", "1"}], "\n", "\t", 
              "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t\t", "|>"}]}]}], 
        "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], \
"CodeInput",ExpressionUUID->"8fabc1ca-2f77-445f-bcfb-c51d43a7e6f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SymmetryElementFunctions\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718608768237554*^9, 
  3.718608783067614*^9}},ExpressionUUID->"2c64e75b-eb26-42d9-a019-\
a2543e4fb748"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryElementFunction", "[", "\n", "\t", 
    RowBox[{"\"\<InversionCenter\>\"", ",", "\n", "\t", "center_"}], "\n", 
    "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"ScalingTransform", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], ",", " ", "center"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryElementFunction", "[", "\n", "\t", 
    RowBox[{
    "\"\<RotationAxes\>\"", ",", "\n", "\t", "center_", ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"order_", ",", " ", "v_"}], "}"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"RotationTransform", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "order"}]}], ",", " ", 
     RowBox[{"v", "-", "center"}], ",", " ", "center"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryElementFunction", "[", "\n", "\t", 
    RowBox[{
    "\"\<SymmetryPlanes\>\"", ",", "\n", "\t", "center_", ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"v1_", ",", " ", "v2_"}], "}"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"ReflectionTransform", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"v1", "-", "center"}], ",", " ", 
       RowBox[{"v2", "-", "center"}]}], "]"}], ",", "\n", "\t\t", "center"}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemUtilsSymmetryElementFunction", "[", "\n", "\t", 
   RowBox[{"\"\<ScrewAxes\>\"", ",", "\n", "\t", "center_", ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"order_", ",", " ", "v_"}], "}"}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{
   RowBox[{"Composition", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", "order"}]}], ",", " ", 
       RowBox[{"v", "-", "center"}], ",", " ", "center"}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"ReflectionTransform", "[", "\n", "\t\t\t", 
      RowBox[{"v", ",", "\n", "\t\t\t", "center"}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}], "//", "Simplify"}]}]}], "CodeInput",
 CellChangeTimes->{{3.718607266747693*^9, 3.718607325746462*^9}, {
   3.718607938873618*^9, 3.718607950456286*^9}, {3.718607986899135*^9, 
   3.718608103073311*^9}, {3.718608145559557*^9, 3.718608152559785*^9}, {
   3.718839656818797*^9, 3.718839664536559*^9}, {3.719086683496757*^9, 
   3.719086691053664*^9}, {3.7190868395790663`*^9, 3.719086864965722*^9}, {
   3.7190870166407537`*^9, 3.7190870222377787`*^9}, {3.719087056063506*^9, 
   3.719087059883206*^9}, 3.719087162023342*^9, {3.719119449060707*^9, 
   3.719119449920352*^9}},ExpressionUUID->"0f81b632-e2f4-435e-8e80-\
e90947f5205d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryElementFunctions", "[", "\n", "\t", 
    RowBox[{"rawEls_Association", "?", 
     RowBox[{"(", 
      RowBox[{"KeyMemberQ", "[", "\"\<Center\>\"", "]"}], ")"}]}], "\n", "\t",
     "]"}], ":=", "\n", "\t", 
   RowBox[{"Association", "@", "\n", "\t", 
    RowBox[{"KeyValueMap", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{
        "#", ",", "\n", "\t\t\t", "\"\<CenterSymmetric\>\"", ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{"#2", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"\"\<InversionCenter\>\"", "->", "\n", "\t\t\t\t\t\t", 
            RowBox[{"ChemUtilsSymmetryElementFunction", "[", 
             RowBox[{"\"\<InversionCenter\>\"", ",", " ", 
              RowBox[{"rawEls", "[", "\"\<Center\>\"", "]"}]}], "]"}]}], ",", 
           "\n", "\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t", "]"}], ",", 
         "\n", "\t\t\t", "\"\<RotationAxes\>\"", ",", "\n", "\t\t\t\t", 
         RowBox[{"#", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"AssociationMap", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"ChemUtilsSymmetryElementFunction", "[", 
              RowBox[{"\"\<RotationAxes\>\"", ",", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"rawEls", "[", "\"\<Center\>\"", "]"}], ",", "\n", 
               "\t", "\t\t\t\t\t\t", "#"}], "\n", "\t", "\t\t\t\t\t\t", "]"}],
              "&"}], ",", "\n", "\t\t\t\t\t\t", "#2"}], "\n", "\t\t\t\t\t\t", 
           "]"}]}], ",", "\n", "\t\t\t", "\"\<SymmetryPlanes\>\"", ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"#", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"AssociationMap", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"ChemUtilsSymmetryElementFunction", "[", 
              RowBox[{"\"\<SymmetryPlanes\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"rawEls", "[", "\"\<Center\>\"", "]"}], ",", "\n", 
               "\t", "\t\t\t\t\t\t", "#"}], "\n", "\t", "\t\t\t\t\t\t", "]"}],
              "&"}], ",", "\n", "\t\t\t\t\t\t", "#2"}], "\n", "\t\t\t\t\t\t", 
           "]"}]}], ",", "\n", "\t\t\t", "\"\<ScrewAxes\>\"", ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"#", "->", "\n", "\t\t\t\t\t", 
          RowBox[{"AssociationMap", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"ChemUtilsSymmetryElementFunction", "[", 
              RowBox[{"\"\<ScrewAxes\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"rawEls", "[", "\"\<Center\>\"", "]"}], ",", "\n", 
               "\t", "\t\t\t\t\t\t", "#"}], "\n", "\t", "\t\t\t\t\t\t", "]"}],
              "&"}], ",", "\n", "\t\t\t\t\t\t", "#2"}], "\n", "\t\t\t\t\t\t", 
           "]"}]}], ",", "\n", "\t\t\t", "_", ",", "\n", "\t\t\t\t", 
         "Nothing"}], "\n", "\t\t\t", "]"}], "&"}], ",", "\n", "\t\t", 
      "rawEls"}], "\n", "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemUtilsSymmetryElementFunctions", "[", "\n", "\t", 
   RowBox[{"atoms_", ",", 
    RowBox[{"tol", ":", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], "|", "Automatic"}], ":", 
     "Automatic"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemUtilsSymmetryElementFunctions", "@", "\n", "\t\t", 
   RowBox[{"ChemRawSymmetryElements", "[", 
    RowBox[{"atoms", ",", " ", "tol"}], "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.718607762098851*^9, 3.718607780383483*^9}, {
   3.718608124505167*^9, 3.718608325813242*^9}, {3.71860836557412*^9, 
   3.718608376563107*^9}, {3.718608433016831*^9, 3.7186084885619707`*^9}, 
   3.7186087281731358`*^9, {3.7186100276200542`*^9, 3.718610032413397*^9}, {
   3.718610265160623*^9, 3.718610270437936*^9}, {3.718610321525325*^9, 
   3.7186103334085903`*^9}, {3.7186103653109627`*^9, 
   3.718610395376891*^9}},ExpressionUUID->"437337f0-567d-4b01-a9c1-\
5f688dc406ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SymmetryElementGrouping\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718608804217329*^9, 3.7186088067566433`*^9}, {
  3.718608882420896*^9, 
  3.7186088856775293`*^9}},ExpressionUUID->"eff2955c-8b14-40dd-a2f5-\
4f3b1bab4955"],

Cell[BoxData[
 RowBox[{"ChemUtilsSymmetryTotalGroup", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.719172981902047*^9, 
  3.7191729826507473`*^9}},ExpressionUUID->"ac690fc3-c528-4342-a00f-\
2d9520f5da8d"],

Cell[BoxData[
 RowBox[{"ChemUtilsSymmetryElementGroup", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.719172986165983*^9, 3.719173003799594*^9}, 
   3.719174896071042*^9},ExpressionUUID->"1f4174c0-4080-4187-9a44-\
ff41504653c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryTotalGroup", "[", 
    RowBox[{
     RowBox[{"\"\<RotationAxes\>\"", "|", "\"\<ScrewAxes\>\""}], ",", "\n", 
     "\t", "axes_", ",", "\n", "\t", "center_", ",", "\n", "\t", "fns_"}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"FixedPoint", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Flatten", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"f", "[", "p", "]"}], ",", "\n", "\t\t\t\t\t ", 
            RowBox[{"{", 
             RowBox[{"p", ",", " ", "#"}], "}"}], ",", "\n", "\t\t\t\t ", 
            RowBox[{"{", 
             RowBox[{"f", ",", " ", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Values", "@", "fns"}]}]}], "}"}]}], "\n", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "1"}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"#", "-", "#2"}], "]"}], "<", ".1"}], "&"}]}], "\n", 
       "\t\t\t", "]"}], "&"}], ",", " ", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"axes", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], "}"}], ",", " ", "\n", 
     "\t\t", 
     RowBox[{"Length", "[", "axes", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.718608875602111*^9, 3.718608941689809*^9}, {
   3.718608994468669*^9, 3.718609110505514*^9}, {3.7186092655123*^9, 
   3.7186092680425158`*^9}, {3.718609299987774*^9, 3.718609701289206*^9}, {
   3.718609755679295*^9, 3.718609827590363*^9}, {3.71860985881996*^9, 
   3.7186098884385977`*^9}, {3.718610467755938*^9, 3.718610527353064*^9}, {
   3.718610880289501*^9, 3.718610881232419*^9}, {3.718610957205372*^9, 
   3.7186109746969633`*^9}, {3.718611005688189*^9, 3.718611029457148*^9}, {
   3.718611385342904*^9, 3.718611601984363*^9}, {3.718611646667366*^9, 
   3.718611714034892*^9}, 3.718611764999566*^9, {3.7186118837277203`*^9, 
   3.718611884790325*^9}, {3.718611967951426*^9, 3.718612031644788*^9}, {
   3.718612124068613*^9, 3.718612126990136*^9}, {3.718612177525206*^9, 
   3.718612194744158*^9}, {3.718612350254694*^9, 3.718612467137712*^9}, {
   3.718612524724018*^9, 3.718612566790963*^9}, {3.718612642995501*^9, 
   3.718612644491743*^9}, {3.718612674509638*^9, 3.718612675369544*^9}, {
   3.71861273057463*^9, 3.718612737276865*^9}, {3.7186127924569607`*^9, 
   3.718612880131341*^9}, {3.718817723600775*^9, 3.718817753409657*^9}, {
   3.7188177844001217`*^9, 3.718817784936118*^9}, {3.718839317933473*^9, 
   3.718839322841531*^9}, {3.719171133694008*^9, 3.7191713240483027`*^9}, {
   3.7191713642424593`*^9, 3.7191714833869667`*^9}, {3.7191716491898746`*^9, 
   3.719171872307685*^9}, {3.7191719156106157`*^9, 3.719172144880349*^9}, {
   3.719172185192309*^9, 3.719172301377968*^9}, {3.719172437500641*^9, 
   3.719172483249268*^9}, {3.7191725252110167`*^9, 3.719172527929448*^9}, {
   3.7191726142981167`*^9, 3.719172616679965*^9}, {3.719172905411273*^9, 
   3.719172907655375*^9}, {3.719173915716608*^9, 3.719173921072733*^9}, {
   3.7191739571512747`*^9, 3.719173968260438*^9}, {3.719174066703534*^9, 
   3.719174070255746*^9}, {3.719174132747774*^9, 3.719174136236307*^9}, {
   3.719174570711988*^9, 3.719174572456048*^9}, {3.71917464270646*^9, 
   3.719174682178385*^9}, 
   3.719174725734105*^9},ExpressionUUID->"98a6ae0f-6b2b-4b52-8310-\
0a0370d04595"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryElementGroup", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<RotationAxes\>\"", "|", "\"\<ScrewAxes\>\""}], ",", "\n", 
     "\t", "axes_", ",", "\n", "\t", "center_", ",", "\n", "\t", "fns_"}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"ConnectedComponents", "[", "\n", "\t\t", 
    RowBox[{"Graph", "@", "\n", "\t\t\t", 
     RowBox[{"Flatten", "@", 
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Map", " ", "things", " ", "to", " ", "themselves"}], " ", 
        "*)"}], "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[UndirectedEdge]", "#"}], "&"}], ",", " ", "axes"}],
          "]"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{"fpl", "=", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"FixedPoint", "[", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "DeleteDuplicates", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"Map", "[", 
                    RowBox[{"f", ",", " ", "#"}], "]"}]}], "]"}]}], ",", "\n",
                    "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"#", "-", "#2"}], "]"}], "<", ".1"}], "&"}], 
                    ")"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", 
                "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"Length", "[", "axes", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"SameTest", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"#", ",", ".01"}], "]"}], "\[Equal]", 
                    RowBox[{"Round", "[", 
                    RowBox[{"#2", ",", ".01"}], "]"}]}], "&"}], ")"}]}]}], 
               "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "}"}],
             ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"order", "=", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"newPt", "=", "#"}]}], "\n", "\t\t\t\t\t\t\t", 
                 "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "Find", " ", "the", " ", "element", " ", "corresponding", 
                   " ", "to", " ", "the", " ", "point"}], " ", "*)"}], "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"SelectFirst", "[", 
                   RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"axes", ",", "a"}], "]"}], ",", "\n", "\t", "\t", 
                    "\t", "\t", "\t", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"order", "\[Equal]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
                    RowBox[{"!", 
                    RowBox[{"uniqueAxesQ", "[", 
                    RowBox[{"center", ",", " ", "newPt", ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "&"}], ",", 
                    "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", "Nothing"}], 
                   "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", "]"}], ",", 
                  "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"l_List", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "An", " ", "element", " ", "was", " ", "found", " ", "so",
                     " ", "connect", " ", "it", " ", "to", " ", "a"}], " ", 
                    "*)"}], "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"a", "\[UndirectedEdge]", "l"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
              "&"}], "/@", "fpl"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "axes"}], "}"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"f", ",", " ", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Values", "@", "fns"}]}]}], "}"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.718608875602111*^9, 3.718608941689809*^9}, {
   3.718608994468669*^9, 3.718609110505514*^9}, {3.7186092655123*^9, 
   3.7186092680425158`*^9}, {3.718609299987774*^9, 3.718609701289206*^9}, {
   3.718609755679295*^9, 3.718609827590363*^9}, {3.71860985881996*^9, 
   3.7186098884385977`*^9}, {3.718610467755938*^9, 3.718610527353064*^9}, {
   3.718610880289501*^9, 3.718610881232419*^9}, {3.718610957205372*^9, 
   3.7186109746969633`*^9}, {3.718611005688189*^9, 3.718611029457148*^9}, {
   3.718611385342904*^9, 3.718611601984363*^9}, {3.718611646667366*^9, 
   3.718611714034892*^9}, 3.718611764999566*^9, {3.7186118837277203`*^9, 
   3.718611884790325*^9}, {3.718611967951426*^9, 3.718612031644788*^9}, {
   3.718612124068613*^9, 3.718612126990136*^9}, {3.718612177525206*^9, 
   3.718612194744158*^9}, {3.718612350254694*^9, 3.718612467137712*^9}, {
   3.718612524724018*^9, 3.718612566790963*^9}, {3.718612642995501*^9, 
   3.718612644491743*^9}, {3.718612674509638*^9, 3.718612675369544*^9}, {
   3.71861273057463*^9, 3.718612737276865*^9}, {3.7186127924569607`*^9, 
   3.718612880131341*^9}, {3.718817723600775*^9, 3.718817753409657*^9}, {
   3.7188177844001217`*^9, 3.718817784936118*^9}, {3.718839317933473*^9, 
   3.718839322841531*^9}, {3.719171133694008*^9, 3.7191713240483027`*^9}, {
   3.7191713642424593`*^9, 3.7191714833869667`*^9}, {3.7191716491898746`*^9, 
   3.719171872307685*^9}, {3.7191719156106157`*^9, 3.719172144880349*^9}, {
   3.719172185192309*^9, 3.719172301377968*^9}, {3.719172437500641*^9, 
   3.719172483249268*^9}, {3.7191725252110167`*^9, 3.719172527929448*^9}, {
   3.7191726142981167`*^9, 3.719172616679965*^9}, {3.719172905411273*^9, 
   3.719172907655375*^9}, {3.719173915716608*^9, 3.719173921072733*^9}, {
   3.7191739571512747`*^9, 3.719173968260438*^9}, {3.719174066703534*^9, 
   3.719174070255746*^9}, {3.719174132747774*^9, 3.719174136236307*^9}, {
   3.719174570711988*^9, 3.719174572456048*^9}, {3.71917464270646*^9, 
   3.719174682178385*^9}, 3.719174725734105*^9, 3.719174882594479*^9, {
   3.7191749215728292`*^9, 3.7191750237658052`*^9}, {3.7192469849893427`*^9, 
   3.719246986433495*^9}},ExpressionUUID->"3c9d0156-a5be-42df-81a1-\
502c0731090f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryTotalGroup", "[", 
    RowBox[{
    "\"\<SymmetryPlanes\>\"", ",", "\n", "\t", "planes_", ",", "\n", "\t", 
     "center_", ",", "\n", "\t", "fns_"}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"FixedPoint", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Flatten", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"f", ",", " ", "pl"}], "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"pl", ",", " ", "#"}], "}"}], ",", "\n", "\t\t\t\t ", 
            RowBox[{"{", 
             RowBox[{"f", ",", " ", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Values", "@", "fns"}]}]}], "}"}]}], "\n", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "1"}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"Normalize", "@", 
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "center"}], ",", " ", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}], "]"}]}], 
            "-", "\n", "\t\t\t\t\t", 
            RowBox[{"Normalize", "@", 
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "center"}], ",", " ", 
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}], "]"}]}]}],
            "\n", "\t\t\t\t", "]"}], "<", ".1"}], "&"}]}], "\n", "\t\t\t", 
       "]"}], "&"}], ",", " ", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"planes", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", "\n", "\t\t", 
     RowBox[{"Length", "[", "planes", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryElementGroup", "[", 
    RowBox[{
    "\"\<SymmetryPlanes\>\"", ",", "\n", "\t", "planes_", ",", "\n", "\t", 
     "center_", ",", "\n", "\t", "fns_"}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"ConnectedComponents", "[", "\n", "\t\t", 
    RowBox[{"Graph", "@", 
     RowBox[{"Flatten", "@", "\n", "\t\t\t", 
      RowBox[{"Join", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[UndirectedEdge]", "#"}], "&"}], ",", " ", 
          "planes"}], "]"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{"fpl", "=", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"FixedPoint", "[", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "DeleteDuplicates", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"DeleteDuplicates", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{
                    RowBox[{"Map", "[", "f", "]"}], "/@", "#"}]}], "]"}]}], 
                   ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"p1", "=", "#"}], ",", " ", 
                    RowBox[{"p2", "=", "#2"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Norm", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Normalize", "@", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "center"}], ",", " ", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}], 
                    "]"}]}], "-", "\n", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t", 
                    RowBox[{"Normalize", "@", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "center"}], ",", " ", 
                    RowBox[{
                    RowBox[{"p2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}], 
                    "]"}]}]}], "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t",
                     "\t", "\t\t\t", "]"}], "<", ".1"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"{", "a", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Length", "[", "planes", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"SameTest", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"#", ",", ".01"}], "]"}], "\[Equal]", 
                    RowBox[{"Round", "[", 
                    RowBox[{"#2", ",", ".01"}], "]"}]}], "&"}], ")"}]}]}], 
               "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "}"}],
             ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"normal", "=", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"center", "+", 
                   RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "center"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}], 
                    "]"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t", "}"}], ",", 
                "\n", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{
                "Replace", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"SelectFirst", "[", 
                   RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"planes", ",", "a"}], "]"}], ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{
                    "uniqueAxesQ", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "center", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "normal", 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"center", "+", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "center"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "center"}]}], 
                    "]"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", "]"}]}], 
                    "&"}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    "Nothing"}], "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                   "]"}], ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                  RowBox[{"l_List", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"a", "\[UndirectedEdge]", "l"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
              "&"}], "/@", "fpl"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "planes"}], "}"}], ",", "\n", "\t\t\t\t\t", 
          
          RowBox[{"{", 
           RowBox[{"f", ",", " ", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Values", "@", "fns"}]}]}], "}"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemUtilsSymmetryElementGroup", "[", 
    RowBox[{"k1_", ",", "k_", ",", "r__"}], "]"}], ":=", "\n", "\t", "k"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemUtilsSymmetryElementGrouping", "[", "\n", "\t", 
   RowBox[{"elems_", ",", "\n", "\t", "fns_", ",", "\n", "\t", 
    RowBox[{"tol_:", "Automatic"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"Association", "@", "\n", "\t\t", 
   RowBox[{"KeyValueMap", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "->", "\n", "\t", "\t\t\t", 
       RowBox[{"ChemUtilsSymmetryElementGroup", "[", 
        RowBox[{"#", ",", " ", "#2", ",", " ", 
         RowBox[{"elems", "[", "\"\<Center\>\"", "]"}], ",", " ", "\n", "\t", 
         "\t", "\t\t\t", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"KeyDrop", "[", 
            RowBox[{"fns", ",", " ", "\"\<InversionCenter\>\""}], "]"}]}]}]}],
         "\n", "\t\t\t\t\t", "]"}]}], "&"}], ",", "\n", "\t\t\t", 
     RowBox[{"KeyDrop", "[", 
      RowBox[{"elems", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<Center\>\"", ",", "\"\<CenterSymmetric\>\""}], "}"}]}], 
      "]"}]}], "\n", "\t\t\t", "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.718608875602111*^9, 3.718608941689809*^9}, {
   3.718608994468669*^9, 3.718609110505514*^9}, {3.7186092655123*^9, 
   3.7186092680425158`*^9}, {3.718609299987774*^9, 3.718609701289206*^9}, {
   3.718609755679295*^9, 3.718609827590363*^9}, {3.71860985881996*^9, 
   3.7186098884385977`*^9}, {3.718610467755938*^9, 3.718610527353064*^9}, {
   3.718610880289501*^9, 3.718610881232419*^9}, {3.718610957205372*^9, 
   3.7186109746969633`*^9}, {3.718611005688189*^9, 3.718611029457148*^9}, {
   3.718611385342904*^9, 3.718611601984363*^9}, {3.718611646667366*^9, 
   3.718611714034892*^9}, 3.718611764999566*^9, {3.7186118837277203`*^9, 
   3.718611884790325*^9}, {3.718611967951426*^9, 3.718612031644788*^9}, {
   3.718612124068613*^9, 3.718612126990136*^9}, {3.718612177525206*^9, 
   3.718612194744158*^9}, {3.718612350254694*^9, 3.718612467137712*^9}, {
   3.718612524724018*^9, 3.718612566790963*^9}, {3.718612642995501*^9, 
   3.718612644491743*^9}, {3.718612674509638*^9, 3.718612675369544*^9}, {
   3.71861273057463*^9, 3.718612737276865*^9}, {3.7186127924569607`*^9, 
   3.718612880131341*^9}, {3.718817723600775*^9, 3.718817753409657*^9}, {
   3.7188177844001217`*^9, 3.718817784936118*^9}, {3.718839317933473*^9, 
   3.718839322841531*^9}, {3.719171133694008*^9, 3.7191713240483027`*^9}, {
   3.7191713642424593`*^9, 3.7191714833869667`*^9}, {3.7191716491898746`*^9, 
   3.719171872307685*^9}, {3.7191719156106157`*^9, 3.719172144880349*^9}, {
   3.719172185192309*^9, 3.719172406068898*^9}, {3.7191725040460453`*^9, 
   3.7191725423720837`*^9}, {3.7191725855727453`*^9, 3.719172631595478*^9}, {
   3.71917266532732*^9, 3.719172710007065*^9}, {3.719172746721573*^9, 
   3.7191727665501738`*^9}, {3.719172832256715*^9, 3.7191728655235*^9}, 
   3.719172899468186*^9, {3.719173852551016*^9, 3.7191739085703983`*^9}, {
   3.719173981727901*^9, 3.719173996845007*^9}, {3.7191740451454067`*^9, 
   3.7191740611339684`*^9}, 3.719174143221822*^9, 3.71917420192095*^9, {
   3.71917426931234*^9, 3.7191743577481833`*^9}, {3.719174391427636*^9, 
   3.719174407175753*^9}, {3.719174468374762*^9, 3.719174515749337*^9}, {
   3.719174549237056*^9, 3.719174586650931*^9}, {3.719174695003063*^9, 
   3.719174715882625*^9}, {3.7191747503850594`*^9, 3.719174782577436*^9}, {
   3.719247000389703*^9, 
   3.7192470038665457`*^9}},ExpressionUUID->"8c94cb68-fb07-46cf-9a9f-\
001f6aa0ed8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SymmetryElementExpandClass\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.718767865218783*^9, 
  3.7187678665333347`*^9}},ExpressionUUID->"00f2a805-4759-454d-8061-\
390926c503ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"axisCloseEnough", "[", "center_", "]"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"_", ",", " ", "r1_"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"_", ",", " ", "r2_"}], "}"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"va", "=", 
      RowBox[{"VectorAngle", "[", 
       RowBox[{
        RowBox[{"r1", "-", "center"}], ",", " ", 
        RowBox[{"r2", "-", "center"}]}], "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"va", " ", ">", " ", 
      RowBox[{"\[Pi]", "-", 
       RowBox[{"(", 
        RowBox[{"10.", "*", "Degree"}], ")"}]}]}], " ", "||", " ", 
     RowBox[{
      RowBox[{"10.", "*", "Degree"}], " ", ">", " ", "va"}]}]}], "\n", "\t\t",
    "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7187691490600567`*^9, 3.718769257209037*^9}, {
  3.7187693075944977`*^9, 3.718769314610962*^9}, {3.7187699632108393`*^9, 
  3.718769965006838*^9}, {3.7187703510081253`*^9, 
  3.718770363210215*^9}},ExpressionUUID->"03f78512-5ca7-4f2e-99fa-\
8e9c98e1e36e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemUtilsSymmetryApplyGroupElement", "[", 
   RowBox[{"objAssoc_", ",", "\n", "\t", 
    RowBox[{"k", ":", 
     RowBox[{"\"\<RotationAxes\>\"", "|", "\"\<ScrewAxes\>\""}]}], ",", "\n", 
    "\t", 
    RowBox[{"data", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", " ", "_"}], "}"}], ",", " ", "___"}], "}"}]}], ",", 
    "\n", "\t", "fns_"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"Join", "@@", "\n", "\t\t", 
   RowBox[{"KeyValueMap", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Thread", "[", "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{"#", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"FixedPoint", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"deleteDuplicateAxes", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"#", ",", " ", 
                RowBox[{"Join", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Through", "[", 
                    RowBox[{"fns", "[", "#", "]"}], "]"}], "&"}], ",", " ", 
                   "#"}], "]"}]}]}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
              "$ChemSymmetryUniquenessThreshold"}], "\n", "\t\t\t\t\t\t\t", 
             "]"}], "&"}], ",", "\n", "\t\t\t\t\t\t", "#2", ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"Length", "@", 
            RowBox[{"objAssoc", "[", "k", "]"}]}]}], "\n", "\t", "\t", 
          "\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "}"}], "\n", "\t\t\t\t", 
       "]"}], "&"}], ",", "\n", "\t\t\t", 
     RowBox[{"GroupBy", "[", 
      RowBox[{"data", ",", " ", 
       RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}], "\n", "\t\t\t", 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQvU67cemfLa8d5wW7rwDRNZcC14DoP7/794HoTdZR
L0D0tMyHYNruYr3wXyBd5DdFDERza6QrgWjxNW/AtEnZXhMQXbJ8vSOIfj5z
mi+Illd8FQCmd2/LBdEWKqZ5YP3BFWtAdMJ+5Y0gel/8k60g+ge/7TYQnWH7
8DCIfrdR6giI7mNd9V9+K9C9fkfB9MaLD5gVgPQKnlY+EP2k47AQiH7z/QSY
TvnkLwOifSQE5UH0DPtIFRD9qsRXC0RvaLB0BNGhLz84g2jz2g/uIHpWrK8X
iGbiuugHonf8POEPoll23b0GFm9c9B5Ez0vw+Qaib/S0/ALRL+aHcyoC6TVf
9vKC6KuKS9RBtMGJYi0QPdX8sAOIXsRv5Ayis/Qnu4PosOsXwPSb06d8QLRk
kakfiAYAypDivQ==
  "],ExpressionUUID->"a830fa60-81d0-4740-8e78-6348cb1ce419"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemUtilsSymmetryApplyGroupElement", "[", 
   RowBox[{
   "objAssoc_", ",", "\n", "\t", "\"\<SymmetryPlanes\>\"", ",", "\n", "\t", 
    RowBox[{"data", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", " ", "_"}], "}"}], ",", "___"}], "}"}]}], ",", " ", 
    "\n", "\t", "fns_"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"FixedPoint", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"deleteDuplicatePlanes", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"#", ",", "\n", "\t\t\t\t", 
         RowBox[{"Join", "@@", "\n", "\t\t\t\t\t", 
          RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Through", "[", 
                 RowBox[{"fns", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"Through", "[", 
                 RowBox[{"fns", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "\n", 
               "\t\t\t\t\t\t\t", "}"}]}], "&"}], ",", "\n", "\t\t\t\t\t\t", 
            "#"}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}],
        ",", "\n", "\t\t\t", "$ChemSymmetryUniquenessThreshold"}], "\n", 
      "\t\t\t", "]"}], "&"}], ",", "\n", "\t\t", "data", ",", "\n", "\t\t", 
    RowBox[{"Length", "@", 
     RowBox[{"objAssoc", "[", "\"\<SymmetryPlanes\>\"", "]"}]}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718767916036582*^9, 3.718767938228957*^9}, {
   3.718767970556944*^9, 3.71876811649951*^9}, {3.718768450819787*^9, 
   3.718768455044139*^9}, {3.7187687959942923`*^9, 3.718768820634576*^9}, {
   3.718768915223638*^9, 3.718768919396007*^9}, {3.718769061920679*^9, 
   3.718769165489191*^9}, {3.718769260706287*^9, 3.718769287316543*^9}, {
   3.718769361598139*^9, 3.718769383497972*^9}, {3.718769500683105*^9, 
   3.718769510268653*^9}, {3.7187706625931883`*^9, 3.718770676883596*^9}, {
   3.7188404922611847`*^9, 3.7188405062158546`*^9}, {3.7188405579867268`*^9, 
   3.718840573669861*^9}, {3.718840665132517*^9, 3.71884067345892*^9}, {
   3.718840916225754*^9, 3.718840917561213*^9}, {3.7188421172080793`*^9, 
   3.718842127131218*^9}, {3.718842484719022*^9, 3.7188425685191307`*^9}, {
   3.718842614753109*^9, 3.718842679655479*^9}, 3.71884288120133*^9, {
   3.718842961296588*^9, 3.718842980255621*^9}, {3.7191191962258368`*^9, 
   3.71911923772678*^9}},ExpressionUUID->"efa7c7e6-0425-490e-acd0-\
d6e83ef6077b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemUtilsSymmetryApplyGroupElement", "[", 
   RowBox[{"_", ",", " ", "_", ",", " ", "d_", ",", " ", "fn_"}], "]"}], ":=",
   "\n", "\t", 
  RowBox[{"{", "d", "}"}]}]], "CodeInput",
 CellChangeTimes->{{3.718769408418909*^9, 
  3.718769425979266*^9}},ExpressionUUID->"0d8fdaf3-cd1d-4b9f-a9a2-\
87efe7b3d9eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemUtilsSymmetryApplyGroup", "[", 
   RowBox[{
   "objAssoc_", ",", " ", "key_", ",", " ", "data_", ",", " ", "fns_"}], 
   "]"}], ":=", "\n", "\t", 
  RowBox[{"ChemUtilsSymmetryApplyGroupElement", "[", 
   RowBox[{
   "objAssoc", ",", " ", "key", ",", " ", "data", ",", " ", "\n", "\t\t", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"Values", "@", "fns"}]}], ",", " ", 
       RowBox[{"a_Association", "\[RuleDelayed]", 
        RowBox[{"Values", "[", "a", "]"}]}], ",", "1"}], "]"}]}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.718768459559555*^9, 3.718768526115506*^9}, {
   3.718769459762416*^9, 3.718769465749848*^9}, {3.718770189755715*^9, 
   3.718770194059926*^9}, {3.718770268484499*^9, 3.718770269681835*^9}, {
   3.718770302277707*^9, 3.718770334779696*^9}, {3.718770681666729*^9, 
   3.7187708457187643`*^9}, {3.718841963585125*^9, 3.718841964781604*^9}, {
   3.718842015800479*^9, 3.7188420254210367`*^9}, 3.718842275274094*^9, {
   3.718842335621464*^9, 
   3.718842433417713*^9}},ExpressionUUID->"dd962853-4be7-4775-ad69-\
1bb926c656c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemUtilsSymmetryElementExpandClass", "[", 
   RowBox[{"objAssoc_", ",", " ", "fns_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Association", "@", "\n", "\t\t", 
   RowBox[{"KeyValueMap", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "->", "\n", "\t\t\t", 
       RowBox[{"Switch", "[", 
        RowBox[{"#", ",", "\n", "\t\t\t\t", 
         RowBox[{"\"\<RotationAxes\>\"", "|", "\"\<ScrewAxes\>\""}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#2", "]"}], ">", "0"}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"a", "=", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"GroupBy", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "ChemUtilsSymmetryApplyGroup", "[", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                  "objAssoc", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "#", ",", 
                   "\n", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "DeleteDuplicates", "@", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"SortBy", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Join", "@@", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Map", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", "#", "]"}], "@", "\n", "\t", "\t",
                     "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Table", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"o", ",", " ", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "\n", "\t", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    
                    RowBox[{"{", 
                    RowBox[{"o", ",", " ", 
                    RowBox[{"Power", "@@@", 
                    RowBox[{"FactorInteger", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}]}], "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", "]"}]}], "&"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "#2"}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "First"}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t", "fns"}], "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"First", "\[Rule]", "Last"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", "DeleteDuplicates"}], "\n", "\t", 
                "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t\t", "}"}], 
             ",", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"Join", "@@", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"df", "=", 
                  RowBox[{
                  "deleteDuplicateAxesInds", "[", 
                   "$ChemSymmetryUniquenessThreshold", "]"}]}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{
                "KeyValueMap", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"real", "=", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Select", "[", 
                    RowBox[{"#2", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", "#", "]"}], ">", 
                    "$ChemSymmetryUniquenessThreshold"}], "&"}]}], "]"}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "real", "]"}], ">", "1"}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"real", ",", " ", 
                    RowBox[{"df", "@", "real"}], ",", " ", "1"}], "]"}]}], 
                    "}"}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Length", "[", "real", "]"}], "===", "1"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", " ", "real"}], "}"}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Length", "[", "#2", "]"}], ">", "0"}], ",", "\n",
                     "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], "}"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "True", ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t\t", "a"}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
               "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
           ",", "\n", "\t\t\t\t\t", "#2"}], "\n", "\t\t\t\t\t", "]"}], ",", 
         "\n", "\t\t\t\t", "\"\<SymmetryPlanes\>\"", ",", "\n", "\t\t\t\t\t", 
         
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pl", "=", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Sort", "/@", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"ChemUtilsSymmetryApplyGroup", "[", 
               RowBox[{
               "objAssoc", ",", "\n", "\t", "\t\t\t\t\t\t\t", "#", ",", "\n", 
                "\t", "\t\t\t\t\t\t\t", "#2", ",", "\n", "\t\t\t\t\t\t\t\t", 
                "fns"}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
            "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "pl", "]"}], ">", "1"}], ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{"deleteDuplicatePlanes", "[", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
              "pl", ",", "\n", "\t\t\t\t\t\t\t\t", 
               "$ChemSymmetryUniquenessThreshold"}], "\n", "\t\t\t\t\t\t\t\t",
               "]"}], ",", "\n", "\t\t\t\t\t\t\t", "pl"}], "\n", 
            "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n",
          "\t\t\t\t", "_", ",", "\n", "\t\t\t\t\t", "#2"}], "\n", "\t\t\t\t", 
        "]"}]}], "&"}], ",", "\n", "\t", "\t\t", "objAssoc"}], "\n", "\t", 
    "\t\t", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.718767868324539*^9, 3.718767909313346*^9}, {
   3.718768183161662*^9, 3.718768249332198*^9}, {3.71876834038785*^9, 
   3.718768445056275*^9}, {3.71876854355435*^9, 3.718768760183784*^9}, {
   3.718769052983301*^9, 3.7187690566829653`*^9}, 3.718769470068631*^9, {
   3.71876955478915*^9, 3.7187696055905*^9}, {3.7187696420936947`*^9, 
   3.7187696728114567`*^9}, {3.718769708030835*^9, 3.7187698683935738`*^9}, {
   3.718769930516872*^9, 3.718770012357244*^9}, {3.718770144041327*^9, 
   3.718770181075659*^9}, {3.718770520737987*^9, 3.718770564150576*^9}, {
   3.718770631378312*^9, 3.718770638910369*^9}, {3.718770852851104*^9, 
   3.718770898350456*^9}, {3.718770948859827*^9, 3.7187709967504597`*^9}, {
   3.718771030141563*^9, 3.7187712066076*^9}, {3.7187712577114267`*^9, 
   3.718771395665804*^9}, {3.718771449844057*^9, 3.718771729330464*^9}, {
   3.718771765595727*^9, 3.71877183947974*^9}, {3.718771886000422*^9, 
   3.7187718943218117`*^9}, {3.718772255920905*^9, 3.7187723243550673`*^9}, {
   3.718772355307589*^9, 3.7187723717398*^9}, 3.718772405747471*^9, {
   3.718817990332284*^9, 3.718817994964319*^9}, {3.718818213726026*^9, 
   3.7188182497636623`*^9}, {3.718818306654903*^9, 3.718818498231524*^9}, {
   3.718818534129332*^9, 3.7188185781063023`*^9}, {3.7188380668034353`*^9, 
   3.718838075658474*^9}, {3.718840697032558*^9, 3.718840734580242*^9}, {
   3.718841893641276*^9, 3.718841908110736*^9}, 3.718841953866498*^9, {
   3.718842723417923*^9, 3.7188427517281733`*^9}, {3.7188431698980494`*^9, 
   3.7188432123897343`*^9}, {3.718843266277467*^9, 3.718843273530821*^9}, {
   3.71884336294806*^9, 3.7188434231193857`*^9}, {3.718843461227316*^9, 
   3.718843624711375*^9}, {3.7188436758765087`*^9, 3.718843730321117*^9}, {
   3.718843890711542*^9, 3.718843906009725*^9}, {3.7188440226899347`*^9, 
   3.7188440727986317`*^9}},ExpressionUUID->"d6c315e8-0d08-408d-b63b-\
fd54bf5a99fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SymmetryElements\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"e6d9a94e-15e0-459f-9a98-8f80116997fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemComputeSymmetryElements", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "ChemUtilsRawSymmetryElements", "]"}], ",", "\n",
      "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<ReturnFunctions\>\"", "\[Rule]", "True"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"\"\<DetermineClasses\>\"", "\[Rule]", "True"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"\"\<FullClasses\>\"", "\[Rule]", "True"}]}], "\n", "\t\t\t", 
      "}"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ChemComputeSymmetryElements", "[", 
   RowBox[{"atoms_", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"raw", "=", "\n", "\t\t\t\t", 
       RowBox[{"ChemUtilsRawSymmetryElements", "[", 
        RowBox[{"atoms", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", " ", 
           RowBox[{"Options", "@", "ChemUtilsRawSymmetryElements"}]}], 
          "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", "fns", 
      ",", "\n", "\t\t\t", "fullClass", ",", "\n", "\t\t\t", 
      RowBox[{"funcs", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ReturnFunctions\>\"", "]"}]}]}], ",",
       "\n", "\t\t\t", 
      RowBox[{"classes", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<DetermineClasses\>\"", "]"}]}]}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"fullClasses", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<FullClasses\>\"", "]"}]}]}]}], "\n", 
     "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"fns", "=", 
      RowBox[{"ChemUtilsSymmetryElementFunctions", "@", "raw"}]}], ";", "\n", 
     "\t\t", 
     RowBox[{"fullClass", "=", "\n", "\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{"fullClasses", ",", "\n", "\t\t\t\t", 
        RowBox[{"ChemUtilsSymmetryElementExpandClass", "[", 
         RowBox[{"raw", ",", " ", "fns"}], "]"}], ",", "\n", "\t\t\t\t", 
        "raw"}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"funcs", ",", "\n", "\t\t\t", 
       RowBox[{"fns", "=", 
        RowBox[{"ChemUtilsSymmetryElementFunctions", "@", "fullClass"}]}]}], 
      "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Elements\>\"", "->", "\n", "\t\t\t\t", "fullClass"}], ",",
        "\n", "\t\t\t", 
       RowBox[{"\"\<Classes\>\"", "->", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"classes", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Association", "@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"KeyValueMap", "[", "\n", "\t", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "->", "\n", "\t", "\t", "\t\t\t\t\t\t", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#2", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", " ", 
                   RowBox[{"fullClass", "[", "#", "]"}]}], "]"}]}], "\n", 
                "\t", "\t", "\t\t\t\t\t\t\t", "]"}]}], "&"}], ",", "\n", "\t",
              "\t", "\t\t\t\t\t", 
             RowBox[{
             "ChemUtilsSymmetryElementGrouping", "[", "\n", "\t", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{
              "fullClass", ",", " ", "\n", "\t", "\t", "\t\t\t\t\t\t", 
               "fns"}], "\n", "\t", "\t", "\t\t\t\t\t\t", "]"}]}], "\n", 
            "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Missing", "[", "\"\<NotComputed\>\"", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Functions\>\"", "->", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"funcs", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Association", "@", "\n", "\t\t\t\t\t", 
           RowBox[{"KeyValueMap", "[", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "->", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", "=!=", "\"\<InversionCenter\>\""}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"KeyMap", "[", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Replace", "[", 
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", " ", 
                    RowBox[{"fullClass", "[", "#", "]"}]}], "]"}], "]"}], ",",
                    "\n", "\t", "\t\t\t\t\t\t\t\t", "#2"}], "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", "#2"}], "\n", "\t", "\t\t\t\t\t\t\t", 
                "]"}]}], "&"}], ",", "\n", "\t\t\t\t\t\t", "fns"}], "\n", 
            "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Missing", "[", "\"\<NotComputed\>\"", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "|>"}]}]}], "\n", "\t\t", 
   "]"}]}]}], \
"CodeInput",ExpressionUUID->"98502c85-a001-4765-b30c-3500ad5eddaa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Computations\[RightFloor]", "CodeSubsection",
 Evaluatable->True,ExpressionUUID->"aa499dcf-7b5e-4f8a-95a8-ac95038a235e"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]orderCount\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.693931395662911*^9},ExpressionUUID->"0367319a-d24a-4727-9ded-\
4a4fa53f654e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rotOrderCount", "[", 
    RowBox[{"order_", ",", "axes_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Length", "@", 
    RowBox[{"Select", "[", 
     RowBox[{"axes", ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "@", "#"}], "\[Equal]", "order"}], "&"}]}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rotOrderCount", "[", "order_", "]"}], "[", "axes_", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"rotOrderCount", "[", 
    RowBox[{"order", ",", "axes"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6939309973839693`*^9, 3.693931066269239*^9}, {
  3.693952135127792*^9, 3.693952146149251*^9}, {3.718773397888669*^9, 
  3.71877341452645*^9}},ExpressionUUID->"adf914fb-6bf1-428d-bfdd-6708fd629cb6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]IdentifyPointGroup\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693877458060896*^9, 
  3.6938774640120296`*^9}},ExpressionUUID->"7a8a4adb-25dd-4452-8ce5-\
1a06da23b37b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemUtilsIdentifyPointGroup", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"center", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}], ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], ",", "\n", "\t", 
    RowBox[{"centerOfSymmetry", ":", 
     RowBox[{"True", "|", "False"}], ":", "False"}], ",", "\n", "\t", 
    RowBox[{"rotationAxesS", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_Integer", "|", "\[Infinity]"}], ",", "_List"}], "}"}], 
       "..."}], "}"}]}], ",", "\n", "\t", 
    RowBox[{"symmetryPlanesS", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_List", ",", "_List"}], "}"}], "..."}], "}"}], ":", 
     RowBox[{"{", "}"}]}], ",", "\n", "\t", 
    RowBox[{"screwAxesS", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_Integer", "|", "\[Infinity]"}], ",", "_List"}], "}"}], 
       "..."}], "}"}], ":", 
     RowBox[{"{", "}"}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"rotationAxes", "=", "\n", "\t\t\t", 
       RowBox[{"deleteDuplicateRotationAxes", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"2", "\[Rule]", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}]}], "]"}], 
            "&"}], ",", " ", "rotationAxesS"}], "]"}], ",", "\n", "\t\t\t\t", 
         "$ChemSymmetryUniquenessThreshold"}], "\n", "\t\t\t\t", "]"}]}], ",",
       "\n", "\t\t", 
      RowBox[{"symmetryPlanes", "=", "\n", "\t\t\t", 
       RowBox[{"deleteDuplicatePlanes", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "-", "center"}], "&"}], ",", " ", "#"}], "]"}], 
            "&"}], ",", " ", "symmetryPlanesS"}], "]"}], ",", "\n", 
         "\t\t\t\t", "$ChemSymmetryUniquenessThreshold"}], "\n", "\t\t\t\t", 
        "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"screwAxes", "=", "\n", "\t\t\t", 
       RowBox[{"deleteDuplicateRotationAxes", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"2", "\[Rule]", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "center"}]}]}], "]"}], 
            "&"}], ",", " ", "screwAxesS"}], "]"}], ",", " ", "\n", 
         "\t\t\t\t", "$ChemSymmetryUniquenessThreshold"}], "\n", "\t\t\t\t", 
        "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"AnyTrue", "[", 
       RowBox[{
        RowBox[{"First", "/@", "rotationAxes"}], ",", 
        RowBox[{
         RowBox[{"#", "==", "\[Infinity]"}], "&"}]}], "]"}], ",", "\n", 
      "\t\t", 
      RowBox[{"(*", "Linear", "*)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{"centerOfSymmetry", ",", "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{"Inversion", " ", "center"}], "*)"}], "\n", "\t\t\t", 
        "\"\<D\[Infinity]h\>\"", ",", "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{"No", " ", "inversion", " ", "center"}], "*)"}], "\n", 
        "\t\t\t", "\"\<C\[Infinity]v\>\""}], "\n", "\t\t\t", "]"}], ",", "\n",
       "\t\t", 
      RowBox[{"(*", 
       RowBox[{"Non", "-", "linear"}], "*)"}], "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rotOrderCount", "[", 
          RowBox[{"3", ",", " ", "rotationAxes"}], "]"}], ">", "1"}], ",", 
        "\n", "\t\t\t", 
        RowBox[{"(*", 
         RowBox[{"2", "+", " ", 
          RowBox[{"unique", " ", "C3", " ", "axes"}]}], "*)"}], "\n", 
        "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rotOrderCount", "[", 
            RowBox[{"5", ",", "rotationAxes"}], "]"}], ">", "1"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"(*", 
           RowBox[{"2", "+", " ", 
            RowBox[{"unique", " ", "C5", " ", "axes"}]}], "*)"}], "\n", 
          "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"centerOfSymmetry", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"(*", 
             RowBox[{"Inversion", " ", "center"}], "*)"}], "\n", 
            "\t\t\t\t\t", "\"\<Ih\>\"", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"(*", 
             RowBox[{"No", " ", "inversion", " ", "center"}], "*)"}], "\n", 
            "\t\t\t\t\t", "\"\<I\>\""}], "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"<", 
            RowBox[{"2", " ", "unique", " ", "C5", " ", "axes"}]}], "*)"}], 
          "\n", "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rotOrderCount", "[", 
              RowBox[{"4", ",", "rotationAxes"}], "]"}], ">", "1"}], ",", 
            "\n", "\t", "\t\t\t\t", 
            RowBox[{"(*", 
             RowBox[{"2", "+", " ", 
              RowBox[{"unique", " ", "C4", " ", "axes"}]}], "*)"}], "\n", 
            "\t", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{"centerOfSymmetry", ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"(*", 
               RowBox[{"Inversion", " ", "center"}], "*)"}], "\n", "\t", 
              "\t\t\t\t\t", "\"\<Oh\>\"", ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"(*", 
               RowBox[{"No", " ", "inversion", " ", "center"}], "*)"}], "\n", 
              "\t", "\t\t\t\t\t", "\"\<O\>\""}], "]"}], ",", "\n", "\t", 
            "\t\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"<", 
              RowBox[{"2", " ", "unique", " ", "C4", " ", "axes"}]}], "*)"}], 
            "\n", "\t", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "symmetryPlanes"}], ">", "0"}], ",", 
              "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"(*", 
               RowBox[{"Has", " ", "symmetry", " ", "planes"}], "*)"}], "\n", 
              "\t", "\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{"centerOfSymmetry", ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{"Inversion", " ", "center"}], "*)"}], "\n", "\t", 
                "\t\t\t\t\t\t", "\"\<Th\>\"", ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{"No", " ", "inversion", " ", "center"}], "*)"}], 
                "\n", "\t", "\t\t\t\t\t\t", "\"\<Td\>\""}], "]"}], ",", "\n", 
              "\t", "\t\t\t\t\t", 
              RowBox[{"(*", 
               RowBox[{"No", " ", "symmetry", " ", "planes"}], "*)"}], "\n", 
              "\t", "\t\t\t\t\t", "\"\<T\>\""}], "\n", "\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{"<", 
          RowBox[{"2", " ", "unique", " ", "C3", " ", "axes"}]}], "*)"}], 
        "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "rotationAxes"}], ">", "0"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"(*", 
           RowBox[{"Any", " ", "rotation", " ", "axes"}], "*)"}], "\n", 
          "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mAxes", "=", 
              RowBox[{"MaximalBy", "[", 
               RowBox[{"rotationAxes", ",", "First"}], "]"}]}], "}"}], ",", 
            "\n", "\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"n", "=", 
                 RowBox[{"First", "@", 
                  RowBox[{"First", "@", "mAxes"}]}]}], ",", 
                RowBox[{"axes", "=", 
                 RowBox[{"Last", "/@", "mAxes"}]}]}], "}"}], ",", "\n", 
              "\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"rotationAxes", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "_"}], "}"}]}], "]"}]}], 
                 "\[GreaterEqual]", "n"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{"N", " ", "distinct", " ", "C2", " ", "axes"}], 
                 "*)"}], "\n", "\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"anyPerpPlane", "[", 
                   RowBox[{
                   "center", ",", " ", "axes", ",", " ", "symmetryPlanes"}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"(*", 
                   RowBox[{"Horizontal", " ", "reflection", " ", "plane"}], 
                   "*)"}], "\n", "\t\t\t\t\t\t", 
                  RowBox[{"\"\<D\>\"", "<>", 
                   RowBox[{"ToString", "@", "n"}], "<>", "\"\<h\>\""}], ",", 
                  "\n", "\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "symmetryPlanes"}], 
                    "\[GreaterEqual]", "n"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{"N", "+", " ", 
                    RowBox[{"planes", " ", "of", " ", "symmetry"}]}], "*)"}], 
                    "\n", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"\"\<D\>\"", "<>", 
                    RowBox[{"ToString", "@", "n"}], "<>", "\"\<d\>\""}], ",", 
                    "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{"<", 
                    RowBox[{
                    "N", " ", "planes", " ", "of", " ", "symmetry"}]}], " ", 
                    "*)"}], "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<D\>\"", "<>", 
                    RowBox[{"ToString", "@", "n"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], 
                ",", "\n", "\t\t\t\t\t", 
                RowBox[{"(*", " ", 
                 RowBox[{"<", 
                  RowBox[{"N", " ", "distinct", " ", "C2", " ", "axes"}]}], 
                 "*)"}], "\n", "\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"anyPerpPlane", "[", 
                   RowBox[{
                   "center", ",", " ", "axes", ",", " ", "symmetryPlanes"}], 
                   "]"}], ",", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"(*", 
                   RowBox[{"Horizontal", " ", "reflection", " ", "plane"}], 
                   "*)"}], "\n", "\t\t\t\t\t\t", 
                  RowBox[{"\"\<C\>\"", "<>", 
                   RowBox[{"ToString", "@", "n"}], "<>", "\"\<h\>\""}], ",", 
                  "\n", "\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "symmetryPlanes"}], 
                    "\[GreaterEqual]", "n"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{"N", "+", " ", 
                    RowBox[{"planes", " ", "of", " ", "symmetry"}]}], "*)"}], 
                    "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<C\>\"", "<>", 
                    RowBox[{"ToString", "@", "n"}], "<>", "\"\<v\>\""}], ",", 
                    "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"screwAxes", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "*", "n"}], ",", "_"}], "}"}]}], "]"}]}], 
                    ">", "0"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{"2", "N", " ", "screw", " ", "axis"}], "*)"}], 
                    "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<S\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"2", "*", "n"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<C\>\"", "<>", 
                    RowBox[{"ToString", "@", "n"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                   "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t",
                "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
           "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"(*", 
           RowBox[{"No", " ", "rotation", " ", "axes"}], "*)"}], "\n", 
          "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "symmetryPlanes"}], ">", "0"}], ",", "\n",
             "\t\t\t\t\t", "\"\<Cs\>\"", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
             "centerOfSymmetry", ",", "\n", "\t\t\t\t\t\t", "\"\<Ci\>\"", ",",
               "\n", "\t\t\t\t\t\t", "\"\<C1\>\""}], "\n", "\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], 
       "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6938774689415083`*^9, 3.693877602861011*^9}, {
   3.693877694087281*^9, 3.693877744776412*^9}, {3.6938777772341213`*^9, 
   3.693877778648922*^9}, {3.6938780146917543`*^9, 3.6938780683037786`*^9}, {
   3.6938781546972733`*^9, 3.693878402331056*^9}, {3.6938784396237707`*^9, 
   3.693878513004435*^9}, {3.693878700167564*^9, 3.69387912867187*^9}, {
   3.693879234240706*^9, 3.6938792826291647`*^9}, {3.6938793625857983`*^9, 
   3.693879577686117*^9}, {3.693879741362903*^9, 3.693879832769576*^9}, {
   3.6938798636002073`*^9, 3.693879981933215*^9}, {3.6938801094127398`*^9, 
   3.6938804174828167`*^9}, {3.693880493952877*^9, 3.693880526901781*^9}, {
   3.693882692350452*^9, 3.693882716915156*^9}, {3.6938827748813*^9, 
   3.6938828114938183`*^9}, {3.693883074878456*^9, 3.693883082486311*^9}, 
   3.693930637986225*^9, {3.693930735833043*^9, 3.6939307589783583`*^9}, {
   3.693930791852395*^9, 3.6939308472356863`*^9}, 3.693930908243638*^9, {
   3.693931075805193*^9, 3.6939312614431458`*^9}, {3.693931294169149*^9, 
   3.693931294610231*^9}, {3.693931637008377*^9, 3.6939316672127123`*^9}, {
   3.693931702885961*^9, 3.693931766530841*^9}, {3.6939318452091*^9, 
   3.69393186187068*^9}, {3.693931894221287*^9, 3.693931899915205*^9}, {
   3.693931932979464*^9, 3.693931933160706*^9}, {3.693932120258198*^9, 
   3.693932154413341*^9}, {3.693932254153781*^9, 3.693932284726346*^9}, 
   3.69394466313449*^9, {3.69395215338591*^9, 3.693952179578278*^9}, {
   3.6939542079202013`*^9, 3.693954211554307*^9}, 3.718772560269154*^9, {
   3.718772714746879*^9, 3.718772722621614*^9}, {3.718772820697688*^9, 
   3.718772855844173*^9}, {3.718773042493581*^9, 3.7187730541749763`*^9}, {
   3.718773143321978*^9, 3.718773150764526*^9}, {3.7187731859380283`*^9, 
   3.7187732993778477`*^9}, {3.71877335278753*^9, 3.718773370246537*^9}, {
   3.7187734227505713`*^9, 3.718773423074636*^9}, {3.718838078556663*^9, 
   3.718838084674447*^9}},ExpressionUUID->"8f4ce968-bfe4-49bc-846b-\
c2c0c4578fdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PointGroup\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.693876182943777*^9, 3.693876188254972*^9}, 
   3.693940369862885*^9},ExpressionUUID->"c80ac2a1-7cc6-40bd-a00d-\
7980510a9221"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "ChemComputePointGroup", "[", "\n", "\t", "smels_Association", "\n", "\t", 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"ChemUtilsIdentifyPointGroup", "@@", "\n", "\t\t", 
    RowBox[{"Lookup", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"smels", "[", "\"\<Elements\>\"", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
       "\"\<Center\>\"", ",", " ", "\n", "\t\t\t\t", 
        "\"\<CenterSymmetric\>\"", ",", "\n", "\t\t\t\t", 
        "\"\<RotationAxes\>\"", ",", "\n", "\t\t\t\t", 
        "\"\<SymmetryPlanes\>\"", ",", "\n", "\t\t\t\t", 
        "\"\<ScrewAxes\>\""}], "\n", "\t\t\t\t", "}"}]}], "\n", "\t\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ChemComputePointGroup", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "ChemComputeSymmetryElements"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ChemComputePointGroup", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"atoms", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_String", ",", "__"}], "}"}], ".."}], "}"}]}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"ChemComputePointGroup", "@", "\n", "\t\t", 
    RowBox[{"ChemComputeSymmetryElements", "[", 
     RowBox[{"atoms", ",", " ", "ops"}], "]"}]}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"a002e106-e605-4c3d-893e-77f52b76a00a"]\

}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"78c1cb48-0087-4f25-9d70-\
6d431fd55347"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"dc4409cc-9853-4c92-92ac-\
5e425a199eac"]
},
NotebookEventActions->{{"MenuCommand", "Save"} :> 
  EasyIDE`Notebooks`Manipulation`IDESave[
    EvaluationNotebook[]], PassEventsDown -> True, EvaluationOrder -> After},
WindowSize->{808, 755},
WindowMargins->{{316, Automatic}, {Automatic, 50}},
WindowTitle->"EasyIDE: ChemTools",
TaggingRules->{
 "EasyIDE" -> {
   "Project" -> {
     "Directory" -> 
      "/Users/Mark/Documents/Wolfram Mathematica/Applications/ChemTools/"}, 
    "Tabs" -> {
     "All" -> {
       "File" -> 
        "/Users/Mark/Documents/Wolfram \
Mathematica/Applications/ChemTools/All.m"}, 
      "WavefunctionTools" -> {
       "File" -> 
        "/Users/Mark/Documents/Wolfram \
Mathematica/Applications/ChemTools/Packages/Wavefunctions/Package/\
WavefunctionTools.nb"}, 
      "Symmetry" -> {
       "File" -> 
        "/Users/Mark/Documents/Wolfram \
Mathematica/Applications/ChemTools/Packages/Compute/Symmetry.nb"}, 
      "Structural" -> {
       "File" -> 
        "/Users/Mark/Documents/Wolfram \
Mathematica/Applications/ChemTools/Packages/Compute/Structural.nb"}, 
      "Utilities" -> {
       "File" -> 
        "/Users/Mark/Documents/Wolfram \
Mathematica/Applications/ChemTools/Packages/Utilities/Utilities.nb"}}, 
    "FileViewer" -> {"Visible" -> False}, "Toolbars" -> {"Column" -> GridBox[{{
          GridBox[{{
             PaneBox["", ImageSize -> {0, 15}], 
             ButtonBox[
             "", BaseStyle -> "ToolbarShowButton", ButtonData -> 
              "CodePackage"]}}, BaseStyle -> "ToolbarCell"]}}, BaseStyle -> 
        "Toolbars"], "Tags" -> {}, "Cells" -> {}}, "ActiveTab" -> "Symmetry", 
    "StyleSheet" -> 
    FrontEnd`FileName[{"EasyIDE", "Extensions", "LightMode"}, 
      "CodePackage.nb"], "FileToolbar" -> "CodePackage", 
    "Options" -> {
     WindowSize -> {808, 755}, 
      WindowMargins -> {{173, Automatic}, {Automatic, 36}}, FrontEndVersion -> 
      "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
      StyleDefinitions -> 
      FrontEnd`FileName[{"BTools"}, "CodePackage.nb", CharacterEncoding -> 
        "UTF-8"]}, "AutoGeneratePackage" -> True, "SavingAction" -> None, 
    "MainStyleName" -> "LightMode"}, "IndentCharacter" -> "  "},
DynamicUpdating->Automatic,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"EasyIDE", "Extensions", "LightMode"}, 
       "CodePackage.nb"]]]}, Visible -> False, 
  TaggingRules -> {
   "MyRule" -> 2, "EasyIDE" -> {"FileViewer" -> {"Visible" -> False}}}, 
  FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]

