Notebook[{

Cell[CellGroupData[{
Cell["Cartesian 2D DVR", "CodeSection",
 CellChangeTimes->{
  3.718940038219771*^9},ExpressionUUID->"e82db05c-d73c-473a-8637-\
165a589313c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRBegin", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{
  3.699240055548855*^9, {3.707066346532316*^9, 
   3.707066357022255*^9}},ExpressionUUID->"0539e320-48cc-4d02-9a07-\
7bf39b90707d"],

Cell["\<\
A one dimensional DVR as reported by Colbert and Miller for the \
(-\[Infinity],\[Infinity]) range\
\>", "Text",ExpressionUUID->"b5153e79-adb4-4b8f-b746-0ba9ac1e0e2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cartesian2DDVRFormatGrid", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRPoints", "::", "usage"}], "=", "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRKineticMatrix", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRPotentialMatrix", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRWavefunctions", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRPlotFunction", "::", "usage"}], "=", 
  "\"\<\>\""}]}], "CodeInput",
 CellChangeTimes->{{3.718940038029428*^9, 
  3.718940038053405*^9}},ExpressionUUID->"d646a94e-5a43-4ce4-bd20-\
e3bc2003b68a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRNeeds", "/@", 
   RowBox[{"{", "\"\<Cartesian1DDVR\>\"", "}"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699240131188299*^9, 3.699240167062263*^9}, 
   3.6992402436302977`*^9, 3.707066387059753*^9, {3.71898352035047*^9, 
   3.718983527395515*^9}},ExpressionUUID->"2d11891c-63a6-49d3-b823-\
2260ea96fad0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"bfbb51ae-b9cd-4ee1-a530-\
674953ebeba0"],

Cell[CellGroupData[{

Cell["Grid Points Function", \
"CodeSubsubsection",ExpressionUUID->"9dcbb1e6-36e5-49bc-8c7c-0b7e0095d83c"],

Cell["\<\
This function should take the number of grid points for each coordinate\
\>", "Text",ExpressionUUID->"7ae732d9-a106-4f4d-ba40-c00268a8f44f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cartesian2DDVRPoints", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"points", ":", 
     RowBox[{"{", 
      RowBox[{"_Integer", ",", " ", "_Integer"}], "}"}]}], ",", "\n", "\t", 
    RowBox[{"X", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "}"}], ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}]}], "\n", "\t", 
   "]"}], ":=", "\n", "\t", 
  RowBox[{"Table", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "y"}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", 
      RowBox[{"Subdivide", "@@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"X", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}]}]}]}], "}"}], 
    ",", "\n", "\t\t", 
    RowBox[{"{", 
     RowBox[{"y", ",", " ", 
      RowBox[{"Subdivide", "@@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"X", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}]}]}], 
     "}"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{
  3.699200045278949*^9, {3.69920008501616*^9, 3.6992000920807247`*^9}, {
   3.699200124968298*^9, 3.699200133406434*^9}, {3.6992074474542017`*^9, 
   3.699207450724925*^9}, {3.699211747970565*^9, 3.699211787049007*^9}, {
   3.69921185461567*^9, 3.6992119283628674`*^9}, {3.699212533676085*^9, 
   3.6992125341066017`*^9}, {3.69922854340968*^9, 3.699228545982193*^9}, {
   3.699234968992999*^9, 3.699234969751259*^9}, {3.718940038062653*^9, 
   3.718940123790215*^9}},ExpressionUUID->"5b122caf-413f-4b04-be9d-\
789fc99f84b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic Matrix Function", \
"CodeSubsubsection",ExpressionUUID->"3a9cfae4-6754-4c56-9bb6-f653f5495f36"],

Cell[" Using the CM extension to multi-dim", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.718940131840122*^9, 3.718940152900567*^9}, {
  3.718940817354295*^9, 3.718940826466213*^9}, {3.718983645643561*^9, 
  3.718983659607955*^9}},ExpressionUUID->"d2659771-e943-4864-8191-\
db9d352e2346"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Cartesian2DDVRKineticMatrix", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"FilterRules", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Options", "[", "Cartesian1DDVRKineticMatrix", "]"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"Except", "@", "\"\<Mass\>\""}]}], "\n", "\t\t\t", "]"}], ",", 
     "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Mass1\>\"", "\[Rule]", "1"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<Mass2\>\"", "\[Rule]", "1"}]}], "\n", "\t\t\t", "}"}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRKineticMatrix", "[", 
   RowBox[{"grid_", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"cartDVR1", "=", "\n", "\t\t\t\t", 
       RowBox[{"Cartesian1DDVRKineticMatrix", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", "\n", "\t\t\t\t\t", 
         RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
             "\"\<Mass\>\"", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{"OptionValue", "[", "\"\<Mass1\>\"", "]"}]}], ",", "\n",
              "\t", "\t\t\t\t\t\t", "ops"}], "\n", "\t", "\t\t\t\t\t\t", 
            "}"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Options", "[", "Cartesian1DDVRKineticMatrix", "]"}]}], 
          "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"cartDVR2", "=", "\n", "\t\t\t\t", 
       RowBox[{"Cartesian1DDVRKineticMatrix", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"\"\<Mass\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"OptionValue", "[", "\"\<Mass2\>\"", "]"}]}], ",", "\n",
              "\t", "\t\t\t\t\t\t", "ops"}], "\n", "\t", "\t\t\t\t\t\t", 
            "}"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Options", "[", "Cartesian1DDVRKineticMatrix", "]"}]}], 
          "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"ptsX", "=", 
       RowBox[{"Length", "@", "grid"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"ptsY", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"grid", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\n", "\t\t\t", 
      "k1SparseRules", ",", "\n", "\t\t\t", "k2SparseRules"}], "\n", "\t\t\t",
      "}"}], ",", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"k1SparseRules", "=", "\n", "\t\t\t\t", 
      RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Band", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "*", "ptsY"}], "+", "1"}], 
               ",", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}], "*", "ptsY"}], "+", "1"}]}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "*", "ptsY"}], ",", " ", 
               RowBox[{"j", "*", "ptsY"}]}], "}"}]}], "]"}], "\[Rule]", "\n", 
           "\t", "\t", "\t", "\t", "\t\t", 
           RowBox[{"cartDVR1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", " ", "j"}], "]"}], "]"}]}], ",", "\n", "\t", 
          "\t", "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "ptsX"}], "}"}], ",", "\n", "\t", "\t", 
          "\t", "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "ptsX"}], "}"}]}], "\n", "\t", "\t", "\t", 
         "\t", "\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t", "1"}], "\n", 
       "\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t", 
     RowBox[{"k2SparseRules", "=", "\n", "\t\t\t\t", 
      RowBox[{"{", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}], "]"}], "\[Rule]", "\n", 
        "\t\t\t\t\t\t", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"cartDVR2", ",", " ", "ptsX"}], "]"}]}], "\n", "\t\t\t\t\t", 
       "}"}]}], ";", "\n", "\t\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k3", "=", 
         RowBox[{"SparseArray", "[", "k2SparseRules", "]"}]}], "}"}], ",", 
       "\n", "\t", "\t", "\t", "\t", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{"k1SparseRules", ",", " ", 
          RowBox[{"Dimensions", "[", "k3", "]"}]}], "]"}], "+", "k3"}]}], 
      "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.699200204109901*^9, 3.6992002446128483`*^9}, {
   3.699201703464225*^9, 3.699201842336369*^9}, 3.7189400380777807`*^9, {
   3.718940199321683*^9, 3.718940273048107*^9}, {3.7189403292162657`*^9, 
   3.718940537639037*^9}, {3.718940612280304*^9, 3.718940623848082*^9}, {
   3.718940732281986*^9, 3.7189407932704287`*^9}, {3.718941857598061*^9, 
   3.71894190549535*^9}, {3.71894241980433*^9, 3.71894246972014*^9}, {
   3.718942541871771*^9, 3.71894254757507*^9}, {3.7189425986287317`*^9, 
   3.718942606348271*^9}, {3.7189429494720783`*^9, 3.718942966087562*^9}, {
   3.718943237749342*^9, 3.718943239936226*^9}, {3.718943922365725*^9, 
   3.718943946292486*^9}, {3.718944200439361*^9, 3.7189442115146217`*^9}, {
   3.718983625289404*^9, 3.718983636301114*^9}, {3.71898367513409*^9, 
   3.718983733654351*^9}, {3.718983909955647*^9, 3.718983915202002*^9}, {
   3.7189840005193*^9, 3.7189840143290043`*^9}, {3.7189843994921207`*^9, 
   3.718984466081663*^9}, {3.718985736653406*^9, 3.718985758194933*^9}, {
   3.71901360882934*^9, 3.7190136203863707`*^9}, {3.719013674713336*^9, 
   3.71901367775624*^9}, {3.7239939041070147`*^9, 3.7239939048238087`*^9}, {
   3.7239945167936983`*^9, 3.723994530580879*^9}, {3.723995668567136*^9, 
   3.723995679397496*^9}, {3.723995973069849*^9, 3.723995973395005*^9}, {
   3.724001662873167*^9, 3.7240016694864063`*^9}, {3.724623779143531*^9, 
   3.724623779754765*^9}, {3.724623852516251*^9, 3.7246238686985197`*^9}, {
   3.724624732724074*^9, 3.724624735488986*^9}, {3.724624973514244*^9, 
   3.7246249750465927`*^9}, {3.7246261119680643`*^9, 3.724626113619842*^9}, {
   3.724790821037664*^9, 3.724790855960103*^9}, {3.724792328697731*^9, 
   3.724792330558495*^9}, {3.7247932829420033`*^9, 3.724793322698197*^9}, 
   3.727547721116929*^9, {3.7275657197882023`*^9, 3.7275657741451797`*^9}, {
   3.72756581313594*^9, 3.727565865368951*^9}, {3.727565914876684*^9, 
   3.72756594802414*^9}, {3.7275660002955723`*^9, 3.727566022787538*^9}, {
   3.727566575473068*^9, 3.727566618732327*^9}, {3.72756694196278*^9, 
   3.7275670204856443`*^9}, {3.72756713843058*^9, 3.7275671448017073`*^9}, {
   3.727567356270418*^9, 3.727567361727285*^9}, {3.727568220748768*^9, 
   3.727568236524228*^9}, {3.727570994778459*^9, 3.72757099726826*^9}, {
   3.7276322954372253`*^9, 3.7276323003061943`*^9}, {3.727632380444655*^9, 
   3.7276324982534227`*^9}, {3.727674431747594*^9, 3.727674434357292*^9}, {
   3.727711404676024*^9, 3.7277114115299473`*^9}, 
   3.729142569312962*^9},ExpressionUUID->"83694f47-d13a-4c3e-99f9-\
61a940272020"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{"(*", "\n", "\t", 
   RowBox[{
    RowBox[{"This", " ", "was", " ", "my", " ", "old", " ", 
     RowBox[{"n", "^", "4"}], " ", 
     RowBox[{"implementation", ".", " ", "Much"}]}], ",", " ", 
    RowBox[{"much", " ", 
     RowBox[{"worse", "."}]}]}], "\n", "\t", "*)"}], "\n", "\t", 
  RowBox[{"(*", 
   RowBox[{"Developer`ToPackedArray", "@", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ptsX", "*", "ptsY"}], ")"}], ">", "100000"}], ",", "\n", 
       "\t\t\t", "ParallelTable", ",", "\n", "\t\t\t", "Table"}], "\n", 
      "\t\t\t", "]"}], "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"With", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"ix", "=", 
           RowBox[{"1", "+", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "/", 
              RowBox[{"(", "ptsY", ")"}]}], "]"}]}]}], ",", " ", 
          RowBox[{"jx", "=", 
           RowBox[{"1", "+", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "/", 
              RowBox[{"(", "ptsY", ")"}]}], "]"}]}]}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"iy", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", " ", "ptsY", ",", " ", "1"}], "]"}]}], ",", " ", 
          RowBox[{"jy", "=", 
           RowBox[{"Mod", "[", 
            RowBox[{"j", ",", " ", "ptsY", ",", " ", "1"}], "]"}]}]}], "\n", 
         "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"iy", "!=", "jy"}], ",", "\n", "\t\t\t\t\t\t", "0.", ",", 
           "\n", "\t\t\t\t\t\t", 
           RowBox[{"cartDVR1", "[", 
            RowBox[{"[", 
             RowBox[{"ix", ",", " ", "jx"}], "]"}], "]"}]}], "\n", 
          "\t\t\t\t\t\t", "]"}], "+", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ix", "!=", "jx"}], ",", "\n", "\t\t\t\t\t\t", "0.", ",", 
           "\n", "\t\t\t\t\t\t", 
           RowBox[{"cartDVR2", "[", 
            RowBox[{"[", 
             RowBox[{"iy", ",", " ", "jy"}], "]"}], "]"}]}], "\n", 
          "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", 
        RowBox[{"ptsX", "*", "ptsY"}]}], "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", 
        RowBox[{"ptsX", "*", "ptsY"}]}], "}"}]}], "\n", "\t\t\t", "]"}]}], 
   "*)"}]}]], "CodeInput",
 CellChangeTimes->{{3.7276744400748*^9, 
  3.7276744548363028`*^9}},ExpressionUUID->"3cbe645b-4628-4b8b-9e0c-\
7b139a56fbaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Potential Matrix Function", \
"CodeSubsubsection",ExpressionUUID->"ac455a5a-7803-46bc-95c1-a36ef259f5d5"],

Cell["\<\
This should take the grid generated in grid points function and turn it into \
the potential energy matrix for the DVR\
\>", "Text",ExpressionUUID->"6cfb555d-d3e1-4868-baa2-8544bfaba1e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Cartesian2DDVRPotentialMatrix", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"Function", "->", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/", "2"}], ")"}], "^", "2"}], "]"}], "&"}], ")"}]}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRPotentialMatrix", "[", 
   RowBox[{"grid_", ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"func", "=", 
      RowBox[{"OptionValue", "@", "Function"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A", "=", 
        RowBox[{"func", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"grid", ",", "1"}], "]"}]}]}], "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", "A"}], "]"}]}], "\n", 
     "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6992002609897614`*^9, 3.699200262978724*^9}, {
  3.7189411952173033`*^9, 3.71894125048838*^9}, {3.727632505161215*^9, 
  3.7276325125388393`*^9}, {3.729142574254582*^9, 
  3.729142575403521*^9}},ExpressionUUID->"8dfb8177-62cb-4a94-b296-\
e199ad76c2bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ListPlot", "CodeSubsubsection",
 CellChangeTimes->{{3.7247947784722023`*^9, 
  3.724794779655734*^9}},ExpressionUUID->"4a3d412c-1af1-4308-86e9-\
860a98bb849f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Cartesian2DDVRListPlot", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\"\<WavefunctionSelection\>\"", "\[Rule]", "Automatic"}], ",",
        "\n", "\t", "\t", 
       RowBox[{"AxesOrigin", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\n", "\t\t", 
       RowBox[{"Scaled", "\[Rule]", "1"}], ",", "\n", "\t\t", 
       RowBox[{"\"\<ShowEnergy\>\"", "\[Rule]", "True"}], ",", "\n", "\t\t", 
       RowBox[{"\"\<PotentialStyle\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t", 
       RowBox[{"\"\<EnergyDigits\>\"", "->", "3"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<ZeroPointEnergy\>\"", "->", "0"}], ",", "\n", "\t", "\t", 
       
       RowBox[{"LabelingFunction", "->", "Automatic"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<CutOff\>\"", "\[Rule]", "Automatic"}], ",", "\n", "\t\t", 
       
       RowBox[{"Manipulate", "->", "True"}], ",", "\n", "\t\t", 
       RowBox[{"PlotRange", "->", "Automatic"}], ",", "\n", "\t\t", 
       RowBox[{"\"\<PlotList\>\"", "\[Rule]", "\n", "\t\t\t", "Automatic"}], 
       ",", "\n", "\t\t", 
       RowBox[{"\"\<SquareWavefunction\>\"", "->", "False"}], ",", "\n", 
       "\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"Options", "[", "ListPlot3D", "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"Except", "[", 
          RowBox[{"AxesOrigin", "|", "PlotRange", "|", "LabelingFunction"}], 
          "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "}"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cartesian2DDVRListPlot", "[", "\n", "\t", 
    RowBox[{
    "solutions_", ",", "\n", "\t", "grid2D_", ",", "\n", "\t", 
     "potentialMatrix_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalLambda]", ",", "X", ",", "\[Psi]", ",", "\n", "\t\t", 
       RowBox[{"scale", "=", 
        RowBox[{"OptionValue", "[", "Scaled", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"num", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<WavefunctionSelection\>\"", "]"}], 
          ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{"Automatic", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "@", 
               RowBox[{"OptionValue", "@", "Manipulate"}]}], ",", " ", "All", 
              ",", " ", "1"}], "]"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], 
       ",", "\n", "\t\t", "dataRange", ",", "\n", "\t\t", 
       RowBox[{"potential", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"potentialMatrix", "//", "MatrixQ"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Diagonal", "@", "potentialMatrix"}], ",", "\n", "\t\t\t\t",
           "potentialMatrix"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"squared", "=", 
        RowBox[{"OptionValue", "@", "\"\<SquareWavefunction\>\""}]}], ",", 
       "\n", "\t\t", 
       RowBox[{"lf", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "@", "LabelingFunction"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"Automatic", "->", 
             RowBox[{"(", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<\[Psi]\>\"", ",", "#1"}], "]"}], ",", 
                  "\"\<: E=\>\"", ",", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"1.", 
                   RowBox[{"Round", "[", 
                    RowBox[{"#2", ",", " ", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", 
                    RowBox[{
                    "OptionValue", "[", "\"\<EnergyDigits\>\"", "]"}]}], 
                    ")"}]}]}], "]"}]}]}], "}"}]}], "&"}], ")"}]}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"None", "->", "False"}]}], "}"}]}], "]"}]}], ",", "\n", 
       "\t\t", "plotWave", ",", "\n", "\t\t", "waveSet", ",", "\n", "\t\t", 
       RowBox[{"Ec", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<CutOff\>\"", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t", 
           RowBox[{"10", "^", 
            RowBox[{"-", 
             RowBox[{"(", "\n", "\t\t\t\t\t\t", 
              RowBox[{"RealExponent", "[", 
               RowBox[{
                RowBox[{"Length", "[", "grid2D", "]"}], "*", 
                RowBox[{"Length", "[", 
                 RowBox[{"grid2D", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\n", 
              "\t\t\t\t\t\t", ")"}]}]}]}]}], "\n", "\t\t\t\t", "]"}]}], ",", 
       "\n", "\t\t", "wavePlot", ",", "potentialPlot", ",", "\n", "\t\t", 
       "\[Lambda]Plot", ",", "plotRange", ",", "len", ",", "\n", "\t\t", 
       RowBox[{"grid", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"grid2D", ",", " ", "1"}], "]"}]}]}], "\n", "\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalLambda]", ",", "X"}], "}"}], "=", "solutions"}], 
      ";", "\n", "\t\t", 
      RowBox[{"len", "=", 
       RowBox[{"Length", "@", "X"}]}], ";", "\n", "\t\t", 
      RowBox[{"num", "=", "\n", "\t\t\t", 
       RowBox[{"Flatten", "@", 
        RowBox[{"List", "@", 
         RowBox[{"Replace", "[", 
          RowBox[{"num", ",", "\n", "\t\t\t\t", 
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"All", ":>", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", "len"}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"_List", ":>", "num"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"_Integer", ":>", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", "num"}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"_", "\[Rule]", 
              RowBox[{"{", "1", "}"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], 
          "]"}]}]}]}], ";", "\n", "\t\t", 
      RowBox[{"\[Psi]", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#1", ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{"squared", ",", 
               RowBox[{"#2", "^", "2"}], ",", "#2"}], "]"}]}], "]"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"grid", ",", " ", 
            RowBox[{"X", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{
       RowBox[{"plotWave", "[", "n_", "]"}], ":=", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"psiReal", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"\[Psi]", "[", "n", "]"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], ">=", "Ec"}], "&"}]}],
             "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], "//", 
            "TrueQ"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"s", "=", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "1", ",", " ", "scale"}], "}"}]}], 
               ",", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"\[Lambda]", "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", " ", 
                  RowBox[{"\[CapitalLambda]", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}]}], "\n", "\t", 
              "\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Lambda]", "+", 
                RowBox[{"s", "*", "#"}]}], "&"}], "/@", "psiReal"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", "=", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "1", ",", "scale"}], "}"}]}], ",", 
               RowBox[{"\[Lambda]", "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"\[CapitalLambda]", "[", 
                   RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
             "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"s", "*", "#"}], "&"}], "/@", "psiReal"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"waveSet", "=", 
       RowBox[{"\[Psi]", "/@", "num"}]}], ";", "\n", "\t\t", 
      RowBox[{"dataRange", "=", "\n", "\t\t\t", 
       RowBox[{"CoordinateBounds", "@", "\n", "\t\t\t\t", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"waveSet", ",", "1"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ">=", "Ec"}], "&"}]}], 
         "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"waveSet", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"dataRange", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "<=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
              RowBox[{"dataRange", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&&", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"dataRange", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "<=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
              RowBox[{"dataRange", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}]}], "\n", 
          "\t\t\t\t", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"plotWave", "/@", "num"}], ")"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"wavePlot", "[", 
        RowBox[{"sel_", ",", " ", 
         RowBox[{"lFunc_:", "lf"}]}], "]"}], ":=", "\n", "\t\t\t", 
       RowBox[{"ListPlot3D", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"waveSet", "[", 
          RowBox[{"[", "sel", "]"}], "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{"ops", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"PlotRange", "->", "\n", "\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dataRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"dataRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", "All"}], "}"}]}], 
             ",", "\n", "\t\t\t\t\t", 
             RowBox[{"PlotLegends", "->", "\n", "\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"lFunc", "===", "False"}], ",", "\n", "\t", 
                "\t\t\t\t\t\t", "None", ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"lFunc", "@@", "#"}], ")"}], "&"}], "/@", "\n", 
                 "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Thread", "@", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"num", "[", 
                    RowBox[{"[", " ", "sel", " ", "]"}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", " ", "sel", " ", "]"}], "]"}], " ", "]"}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "}"}]}]}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"ClippingStyle", "\[Rule]", "None"}]}], "\n", 
            "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Options", "@", "ListPlot3D"}]}], "\n", "\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"potentialPlot", "=", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"op", "=", 
           RowBox[{"OptionValue", "[", "\"\<PotentialStyle\>\"", "]"}]}], 
          "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"op", "===", "None"}], ",", "\n", "\t\t\t\t\t", "Nothing", 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{"ListPlot3D", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{"Append", ",", " ", 
               RowBox[{"{", 
                RowBox[{"grid", ",", " ", "potential"}], "}"}]}], "]"}], ",", 
             "\n", "\t\t\t\t\t\t", 
             RowBox[{"PlotStyle", "->", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{"op", ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Automatic", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Directive", "[", 
                  RowBox[{
                   RowBox[{"Opacity", "[", ".1", "]"}], ",", " ", "Gray"}], 
                  "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
             "ClippingStyle", "\[Rule]", "\n", "\t\t\t\t\t\t\t", "None"}]}], 
            "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\[Lambda]Plot", "[", "sel_", "]"}], ":=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ListPlot3D", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Append", ",", " ", 
             RowBox[{"{", 
              RowBox[{"grid", ",", " ", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"Length", "[", "grid", "]"}]}], "]"}]}], "}"}]}], 
            "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"PlotStyle", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Opacity", "[", ".1", "]"}], ",", " ", "Red"}], "]"}]}],
            ",", "\n", "\t\t\t\t", 
           RowBox[{"ClippingStyle", "\[Rule]", "\n", "\t\t\t\t\t", "None"}]}],
           "\n", "\t\t\t\t", "]"}], "&"}], "/@", 
        RowBox[{"\[CapitalLambda]", "[", 
         RowBox[{"[", " ", 
          RowBox[{"num", "[", 
           RowBox[{"[", "sel", "]"}], "]"}], " ", "]"}], "]"}]}]}], ";", "\n",
       "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "num"}], ">", "1"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "@", "Manipulate"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"wp", "=", "wavePlot"}], ",", 
              RowBox[{"N", "=", "num"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"lF", "=", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"f", "=", 
                   RowBox[{"lf", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}], "}"}], ",", 
                 RowBox[{"f", "&"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"potPlot", "=", "potentialPlot"}], ",", 
              RowBox[{"L", "=", "\[CapitalLambda]"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"\[Lambda]P", "=", "\[Lambda]Plot"}], ",", " ", 
              RowBox[{"pl", "=", 
               RowBox[{"TrueQ", "@", 
                RowBox[{"OptionValue", "@", "\"\<PlotList\>\""}]}]}]}], "\n", 
             "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Manipulate", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"!", "pl"}], "||", "pl"}], " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "just", " ", "here", " ", "for", " ", "when", " ", "I", " ", 
                  "decided", " ", "what", " ", "to", " ", "do", " ", "with", 
                  " ", "it"}], " ", "*)"}], ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Show", "[", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"wp", "[", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "lF"}], "]"}], ",", 
                  "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"potPlot", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], "//",
                     "TrueQ"}], ",", 
                    RowBox[{"\[Lambda]P", "[", 
                    RowBox[{"{", "i", "}"}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}]}], "]"}]}], "\n", "\t", "\t", 
                   "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"FilterRules", "[", 
                   RowBox[{
                    RowBox[{"{", "ops", "}"}], ",", " ", 
                    RowBox[{"Options", "[", "Graphics3D", "]"}]}], "]"}]}], 
                 "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
               "]"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                ",", 
                RowBox[{"Length", "@", "N"}], ",", "1"}], "}"}]}], "\n", "\t",
              "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "@", "\"\<PlotList\>\""}], "===", 
             "False"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Show", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"wavePlot", "[", "All", "]"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"potentialPlot", ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], "//",
                    "TrueQ"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{"\[Lambda]Plot", "[", "All", "]"}], ",", "\n", "\t",
                   "\t\t\t\t\t\t\t", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"{", "}"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t", 
                 "]"}]}], "\n", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"Options", "[", "Graphics3D", "]"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Show", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"wavePlot", "[", 
                 RowBox[{"#", ",", " ", "lf"}], "]"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"potentialPlot", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], "//",
                     "TrueQ"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"\[Lambda]Plot", "[", "All", "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t", 
                   "]"}]}], "\n", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", 
                "\t", "\t\t\t\t\t", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{
                  RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                  
                  RowBox[{"Options", "[", "Graphics3D", "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], 
              "&"}], "/@", "num"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"Show", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"wavePlot", "[", "All", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{"potentialPlot", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], "//", 
               "TrueQ"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"\[Lambda]Plot", "[", "All", "]"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
           "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{"PlotRange", "->", "plotRange"}]}], "*)"}], "}"}], ",",
             "\n", "\t\t\t\t\t", 
            RowBox[{"Options", "[", "Graphics3D", "]"}]}], "\n", "\t\t\t\t\t",
            "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}]}], 
    "\n", "\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.707079133599949*^9, 3.707079165555623*^9}, {
   3.707079245500482*^9, 3.707079264996385*^9}, {3.707079435368559*^9, 
   3.707079461465197*^9}, {3.707079497021113*^9, 3.7070795551391993`*^9}, {
   3.707079614281602*^9, 3.70707962113295*^9}, {3.707079651941841*^9, 
   3.707079660821377*^9}, {3.70707973649951*^9, 3.707079741983705*^9}, {
   3.707079831675027*^9, 3.707079841565547*^9}, 3.707080175293795*^9, 
   3.707081124397023*^9, {3.70708116183797*^9, 3.707081180900281*^9}, {
   3.7070812352564774`*^9, 3.707081301439883*^9}, {3.7070813431527653`*^9, 
   3.707081378769888*^9}, {3.7070814646478252`*^9, 3.707081485289687*^9}, {
   3.7070815430080643`*^9, 3.707081606751402*^9}, {3.707081645885*^9, 
   3.707081668002983*^9}, {3.707081887309559*^9, 3.7070819335900087`*^9}, {
   3.7070821550594063`*^9, 3.707082203727014*^9}, {3.707082233986767*^9, 
   3.707082297709743*^9}, 3.7070823692314796`*^9, {3.707082524335957*^9, 
   3.707082535634412*^9}, 3.7070826022741337`*^9, {3.707249849136451*^9, 
   3.7072499231820707`*^9}, {3.707249995688854*^9, 3.707250024695369*^9}, {
   3.707505670928403*^9, 3.7075057007597637`*^9}, {3.718940038126451*^9, 
   3.718940038138031*^9}, {3.718940843685855*^9, 3.718940915601253*^9}, {
   3.718940949565364*^9, 3.718941121098143*^9}, {3.71894133873146*^9, 
   3.71894137747665*^9}, {3.71894141072609*^9, 3.7189414780205307`*^9}, {
   3.718941593257783*^9, 3.718941601233632*^9}, {3.718941680354855*^9, 
   3.7189416883284082`*^9}, 3.718941748488102*^9, {3.718942696501453*^9, 
   3.718942701452344*^9}, {3.718942738251157*^9, 3.7189427524115477`*^9}, {
   3.718943127224469*^9, 3.718943127450245*^9}, {3.7189431696341953`*^9, 
   3.718943170974093*^9}, {3.7189435749643087`*^9, 3.7189437268307257`*^9}, {
   3.718943759570388*^9, 3.718943796378583*^9}, {3.718943862148252*^9, 
   3.7189438622983007`*^9}, {3.7189440402213593`*^9, 3.718944061756403*^9}, {
   3.719011191746941*^9, 3.719011203404339*^9}, {3.719011247597262*^9, 
   3.71901128023638*^9}, {3.7190113902391653`*^9, 3.719011398738497*^9}, {
   3.719013514799097*^9, 3.719013527637911*^9}, {3.719013764268981*^9, 
   3.719013771936273*^9}, {3.71901383750039*^9, 3.719013850927299*^9}, {
   3.719013912737817*^9, 3.719013920241035*^9}, {3.719013977833475*^9, 
   3.719014036014546*^9}, {3.719014067650538*^9, 3.7190140813549128`*^9}, {
   3.719014121086254*^9, 3.719014250670309*^9}, {3.7190143066724987`*^9, 
   3.719014350179557*^9}, {3.7190144236046457`*^9, 3.719014506147109*^9}, 
   3.719014542443886*^9, {3.719014590721224*^9, 3.7190145925457897`*^9}, {
   3.7190162281404667`*^9, 3.719016241653448*^9}, {3.719016289577042*^9, 
   3.7190164106581163`*^9}, {3.719016478470875*^9, 3.719016548993223*^9}, 
   3.719016598358151*^9, {3.71901663678335*^9, 3.719016641930848*^9}, {
   3.724794769414925*^9, 3.724794790055175*^9}, {3.7270502593139153`*^9, 
   3.727050440608327*^9}, {3.727050486134428*^9, 3.727050531910137*^9}, {
   3.727050564657452*^9, 
   3.7270505921966248`*^9}},ExpressionUUID->"8edcee07-92a4-4a7d-a5a8-\
f10be9cb805d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["DensityPlot", "CodeSubsubsection",
 CellChangeTimes->{{3.724794877263399*^9, 
  3.7247948787660837`*^9}},ExpressionUUID->"643aaf91-94c9-4e97-b0af-\
fbbf201fbbf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cartesian2DDVRPlotFunction", "::", "inpfl"}], "=", "\n", "\t", 
   "\"\<Failed to construct appropriate InterpolatingFunctions\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.725808784940391*^9, 
  3.725808810510077*^9}},ExpressionUUID->"26ec5aff-d7db-4da4-8969-\
d817c044aa2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Cartesian2DDVRDensityPlot", "]"}], "=", "\n", 
   "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\"\<WavefunctionSelection\>\"", "\[Rule]", "Automatic"}], ",",
        "\n", "\t\t", 
       RowBox[{"\"\<InterpolatingWavefunctions\>\"", "\[Rule]", "Automatic"}],
        ",", "\n", "\t\t", 
       RowBox[{"Scaled", "\[Rule]", "1"}], ",", "\n", "\t\t", 
       RowBox[{"\"\<ShowEnergy\>\"", "\[Rule]", "True"}], ",", "\n", "\t\t", 
       RowBox[{"\"\<PotentialStyle\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t", 
       RowBox[{"\"\<EnergyDigits\>\"", "->", "3"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<ZeroPointEnergy\>\"", "->", "0"}], ",", "\n", "\t", "\t", 
       
       RowBox[{"LabelingFunction", "->", "Automatic"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<CutOff\>\"", "\[Rule]", "Automatic"}], ",", "\n", "\t\t", 
       
       RowBox[{"Manipulate", "->", "True"}], ",", "\n", "\t\t", 
       RowBox[{"PlotRange", "->", "Automatic"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<SquareWavefunction\>\"", "->", "False"}], ",", "\n", 
       "\t\t", 
       RowBox[{"\"\<PlotList\>\"", "\[Rule]", "\n", "\t\t\t", "Automatic"}], 
       ",", "\n", "\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"Options", "[", "DensityPlot", "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"Except", "[", 
          RowBox[{"AxesOrigin", "|", "PlotRange", "|", "LabelingFunction"}], 
          "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "}"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRDensityPlot", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid2D_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Module", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"engs", ",", "\n", "\t\t\t", "funcs", ",", "\n", "\t\t\t", 
      RowBox[{"cutoff", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<CutOff\>\"", "]"}], ",", " ", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "ColorFunctionScaling", "]"}], "=!=",
              "False"}], ",", "\n", "\t\t\t\t\t\t\t", ".1", ",", "\n", 
            "\t\t\t\t\t\t\t", 
            RowBox[{"10", "^", 
             RowBox[{"-", 
              RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"RealExponent", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "grid2D", "]"}], "*", 
                 RowBox[{"Length", "[", 
                  RowBox[{"grid2D", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "\n", "\t",
                "\t", "\t\t\t\t\t\t", ")"}]}]}]}], "\n", "\t\t\t\t\t\t\t", 
           "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"cf", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<ColorFunction\>\"", "]"}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Automatic", "->", 
            RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"s", ":", 
             RowBox[{"_String", "|", "_List"}]}], "\[RuleDelayed]", 
            RowBox[{"ColorData", "[", "s", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
          "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", "oppp", 
      ",", "\n", "\t\t\t", 
      RowBox[{"listup", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<PlotList\>\"", "]"}], ",", "\n", 
         "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Except", "[", 
           RowBox[{"True", "|", "False"}], "]"}], ":>", "\n", "\t\t\t\t\t\t", 
          
          RowBox[{"!", 
           RowBox[{"TrueQ", "@", 
            RowBox[{"OptionValue", "[", "Manipulate", "]"}]}]}]}]}], "\n", 
        "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"funcs", "=", "\n", "\t\t\t", 
      RowBox[{"Flatten", "@", 
       RowBox[{"List", "@", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{
          "OptionValue", "[", "\"\<InterpolatingWavefunctions\>\"", "]"}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"_", "\[Rule]", "_InterpolatingFunction"}], ")"}], 
                "|", "_InterpolatingFunction"}], ")"}], ".."}], "}"}], "]"}], 
           ":>", "\n", "\t\t\t\t\t", 
           RowBox[{
           "ChemDVRDefaultInterpolatingWavefunctions", "[", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{
            "grid2D", ",", "\n", "\t\t\t\t\t\t", "solutions", ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{
               "Options", "@", "ChemDVRDefaultInterpolatingWavefunctions"}]}],
               "\n", "\t", "\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t", 
            "]"}]}]}], "\n", "\t\t\t\t", "]"}]}]}]}], ";", "\n", "\t\t", 
     RowBox[{"oppp", "=", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NumberQ", "@", "cutoff"}], ",", "\n", "\t\t\t\t\t\t\t", 
             
             RowBox[{"ColorFunction", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"cut", "=", "cutoff"}], ",", " ", 
                  RowBox[{"col", "=", "cf"}]}], "}"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"Function", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"#", ">", "cut"}], ",", " ", 
                   RowBox[{"col", "[", "##", "]"}], ",", " ", "White"}], 
                  RowBox[{"(*", 
                   RowBox[{"GrayLevel", "[", 
                    RowBox[{"1", ",", " ", "0"}], "]"}], "*)"}], "]"}], "\n", 
                 "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
               "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
             "ColorFunction", "->", "\n", "\t\t\t\t\t\t\t\t", "cf"}]}], "\n", 
            "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", "ops", ",", 
           "\n", "\t\t\t\t\t\t", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\n", "\t\t\t\t\t\t", 
          "}"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Options", "@", "DensityPlot"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}]}], ";", "\n", "\t\t", 
     RowBox[{"engs", "=", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"funcs", ",", "\n", "\t\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"e_", "\[Rule]", "_InterpolatingFunction"}], ")"}], 
           "\[RuleDelayed]", "e"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"_", "->", "Indeterminate"}]}], "\n", "\t\t\t\t\t", "}"}], 
        ",", "\n", "\t\t\t\t", "1"}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
     "\t\t", 
     RowBox[{"funcs", "=", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
       RowBox[{"funcs", ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "\[Rule]", "f_InterpolatingFunction"}], ")"}], 
         "\[RuleDelayed]", "f"}], ",", "\n", "\t\t\t\t", "1"}], "\n", 
       "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"funcs", ",", " ", 
         RowBox[{"{", "__InterpolatingFunction", "}"}]}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"reg", "=", 
            RowBox[{"funcs", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"opp", "=", "oppp"}], ",", " ", 
           RowBox[{"funs", "=", "funcs"}]}], "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TrueQ", "@", 
            RowBox[{"OptionValue", "[", "Manipulate", "]"}]}], ",", "\n", 
           "\t", "\t\t\t\t", 
           RowBox[{"Manipulate", "[", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"DensityPlot", "[", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"funs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "//", 
                "Evaluate"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"x", ",", " ", 
                 RowBox[{"reg", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"reg", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", "\n", 
               "\t", "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"y", ",", " ", 
                 RowBox[{"reg", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"reg", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", "\n", 
               "\t", "\t", "\t\t\t\t\t", "opp"}], "\n", "\t", "\t\t\t\t\t\t", 
              "]"}], ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "1", ",", " ", "\"\<\>\""}], "}"}], 
               ",", " ", "1", ",", " ", 
               RowBox[{"Length", "@", "funs"}], ",", " ", "1"}], "}"}]}], 
            "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "#"}], ">", "0"}], ",", "\n", 
               "\t\t\t\t\t\t", "#", ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "\n", "\t\t\t\t\t\t", "]"}],
              "&"}], "@", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"DensityPlot", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], 
                  RowBox[{"(*", 
                   RowBox[{"//", "Echo"}], "*)"}], "//", "Evaluate"}], ",", 
                 "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", " ", 
                   RowBox[{"reg", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
                   RowBox[{"reg", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"//", "Echo"}], "//", "Evaluate"}], "*)"}], ",", 
                 "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{"y", ",", " ", 
                   RowBox[{"reg", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
                   RowBox[{"reg", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"//", "Echo"}], "//", "Evaluate"}], "*)"}], ",", 
                 "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"oppp", 
                  RowBox[{"(*", 
                   RowBox[{"//", "Echo"}], "*)"}], "//", "Evaluate"}]}], "\n",
                 "\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", 
              "\t\t\t\t\t\t\t", "funcs"}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], 
          "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"Cartesian2DDVRPlotFunction", "::", "inpfl"}], "]"}], ";", 
        "\n", "\t\t\t", "$Failed"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", 
   "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.724794715173092*^9, 3.724794747583218*^9}, {
   3.724794799254076*^9, 3.724794837802801*^9}, {3.7247951117446737`*^9, 
   3.7247952450868187`*^9}, {3.7247953650343227`*^9, 
   3.7247958060767403`*^9}, {3.724796367258533*^9, 3.724796392084696*^9}, {
   3.724796478625587*^9, 3.7247966169803257`*^9}, {3.724796842221827*^9, 
   3.724796969597621*^9}, {3.724797009666197*^9, 3.724797012232161*^9}, {
   3.7247970734918337`*^9, 3.724797078852879*^9}, 3.724797206825906*^9, {
   3.72479727315348*^9, 3.72479733611228*^9}, 3.724797367793026*^9, {
   3.7247974394928637`*^9, 3.7247974411763277`*^9}, {3.724797492449691*^9, 
   3.724797503842125*^9}, {3.724797607103725*^9, 3.7247977538371696`*^9}, {
   3.724797929180122*^9, 3.724797956402113*^9}, {3.724798160853787*^9, 
   3.724798171808107*^9}, {3.7247982141949778`*^9, 3.724798315802967*^9}, {
   3.724798370527616*^9, 3.7247984639773893`*^9}, {3.724798590761261*^9, 
   3.724798622144909*^9}, {3.7258087638126907`*^9, 3.725808766311441*^9}, 
   3.725808816019209*^9, {3.725808873048218*^9, 3.7258089985787783`*^9}, {
   3.725809107884494*^9, 
   3.72580910882515*^9}},ExpressionUUID->"9d1af65e-b6db-45c4-9738-\
03172ad46387"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting Function", \
"CodeSubsubsection",ExpressionUUID->"bdeb4030-dec5-424e-8fab-f3ccb4fc7b29"],

Cell["\<\
Should take the wavefunctions and a scad of options to make a nice plot. \
Generally reusing some prewritten code works best\
\>", "Text",ExpressionUUID->"7fd1f38d-b8a5-459e-a1d1-dd0fe4018161"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cartesian2DDVRPlotFunction", "::", "nomet"}], "=", "\n", "\t", 
   "\"\<Method `` not understood\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.724794962175741*^9, 
  3.724794973086423*^9}},ExpressionUUID->"c9172b14-2ed5-44f3-93e4-\
6ee85bf5877b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Cartesian2DDVRPlotFunction", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "Cartesian2DDVRListPlot", "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Options", "[", "Cartesian2DDVRDensityPlot", "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<PlotMethod\>\"", "\[Rule]", "ListPlot3D"}], "\n", "\t\t\t",
       "}"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Cartesian2DDVRPlotFunction", "[", "\n", "\t", 
   RowBox[{
   "solutions_", ",", "\n", "\t", "grid2D_", ",", "\n", "\t", 
    "potentialMatrix_", ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "=", 
      RowBox[{"OptionValue", "[", "\"\<PlotMethod\>\"", "]"}]}], "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{"Switch", "[", 
     RowBox[{"m", ",", "\n", "\t\t\t", "ListPlot3D", ",", "\n", "\t\t\t\t", 
      RowBox[{"Cartesian2DDVRListPlot", "[", 
       RowBox[{
       "solutions", ",", " ", "grid2D", ",", " ", "potentialMatrix", ",", 
        "\n", "\t\t\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Options", "[", "Cartesian2DDVRListPlot", "]"}]}], "\n", 
         "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
      "\t\t\t", "DensityPlot", ",", "\n", "\t\t\t\t", 
      RowBox[{"Cartesian2DDVRDensityPlot", "[", 
       RowBox[{
       "solutions", ",", " ", "grid2D", ",", " ", "potentialMatrix", ",", 
        "\n", "\t\t\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Options", "[", "Cartesian2DDVRDensityPlot", "]"}]}], "\n", 
         "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
      "\t\t\t", "_", ",", "\n", "\t\t\t\t", 
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"Cartesian2DDVRPlotFunction", "::", "nomet"}], ",", " ", 
        "m"}], "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.724794776553524*^9, 3.724794776809849*^9}, {
  3.7247948538577003`*^9, 
  3.724795076163619*^9}},ExpressionUUID->"425ad7d9-e436-407c-9d34-\
04c9b046da4c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"4ef3b0ab-7ea1-4b25-94ee-\
109a5b74243a"],

Cell[BoxData[
 RowBox[{"$Cartesian2DDVR", "=", "\n", "\t", 
  RowBox[{"<|", "\n", "\t\t", 
   RowBox[{
    RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<Cartesian 2D\>\""}], ",", "\n", 
    "\t", "\t", 
    RowBox[{"\"\<Dimension\>\"", "\[Rule]", "2"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<PointLabels\>\"", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<x\>\"", "|", "\"\<y\>\"", "|", "\"\<z\>\""}], ",", " ", 
       RowBox[{"\"\<x\>\"", "|", "\"\<y\>\"", "|", "\"\<z\>\""}]}], "}"}]}], 
    ",", "\n", "\t\t", 
    RowBox[{"\"\<Range\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "10"}], ",", " ", "10"}], "}"}]}], "}"}]}], ",", "\n", 
    "\t\t", 
    RowBox[{"\"\<Grid\>\"", "->", "Cartesian2DDVRPoints"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<KineticEnergy\>\"", "->", "Cartesian2DDVRKineticMatrix"}], 
    ",", "\n", "\t\t", 
    RowBox[{
    "\"\<PotentialEnergy\>\"", "->", "Cartesian2DDVRPotentialMatrix"}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<View\>\"", "->", "Cartesian2DDVRPlotFunction"}]}], "\n", 
   "\t\t", "|>"}]}]], "CodeInput",
 CellChangeTimes->{{3.699200278013855*^9, 3.6992003570101633`*^9}, {
   3.699200549451913*^9, 3.699200572585655*^9}, {3.699201461131833*^9, 
   3.6992014765432796`*^9}, {3.699206458337839*^9, 3.699206479116613*^9}, {
   3.699241987640071*^9, 3.699241995817466*^9}, {3.718048606105678*^9, 
   3.7180486086994123`*^9}, {3.718940038142994*^9, 3.718940038168366*^9}, {
   3.718940566265512*^9, 3.71894058093381*^9}, 
   3.718941224883973*^9},ExpressionUUID->"8aceb883-c792-425d-ba7c-\
f5d9c3311e15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVREnd", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{{3.69923997837263*^9, 3.699240000757471*^9}, 
   3.707066369415279*^9},ExpressionUUID->"e090bdbe-9685-418f-9ec7-\
1f9e76f250e7"],

Cell[BoxData["$Cartesian2DDVR"], "CodeInput",
 CellChangeTimes->{3.699241967016337*^9, 3.6992420067672653`*^9, 
  3.718940038176752*^9},ExpressionUUID->"d11ffbaa-fdfa-4a29-9963-71defe6f979f"]
}, Open  ]]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"175b9d87-ebdf-4990-abf4-\
f2e40fb52d02"]
},
WindowSize->{713, 755},
WindowMargins->{{Automatic, 287}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"BTools"}, "CodePackagePlain.nb", CharacterEncoding -> 
       "UTF-8"]]]}, Visible -> False, FrontEndVersion -> 
  "11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 10, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]

