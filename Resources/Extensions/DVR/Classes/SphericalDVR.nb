Notebook[{

Cell[CellGroupData[{
Cell["Spherical DVR", \
"CodeSection",ExpressionUUID->"c1904742-c1ad-42aa-88a6-7fa78dc9e878"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRBegin", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{
  3.699240055548855*^9, {3.699244912756119*^9, 3.6992449131533833`*^9}, 
   3.7070663809178753`*^9},ExpressionUUID->"75100ab0-f98d-4f1f-a7b9-\
34c435c3841e"],

Cell[CellGroupData[{

Cell["Functions", \
"Subsubsection",ExpressionUUID->"34572893-759b-48f3-a6c6-f9e3f70f48d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRFormatGrid", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Formats a grid appropriately for a DVR\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRPoints", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Constructs the spherical DVR grid with the appropriate Legendre \
tranformation\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRK", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Constructs the kinetic matrix\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRV", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Constructs the potential energy matrix\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRWavefunctions", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Computes the wavefunctions\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRWavefunctionGrid", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the wavefuntions on the DVR grid\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRPotentialObjectFunction", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Returns a function to generate the potential plot object\>\""}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRWavefunctionPlotFunction", "::", "usage"}], "=", "\n",
    "\t", "\"\<Returns a function to plot the wave function and \
potential\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRPlot", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Plot function\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$SphericalDVR", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The output class association\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6992375810222893`*^9, 3.699237690240848*^9}, {
   3.699238046426855*^9, 3.699238050519471*^9}, {3.6993037756342573`*^9, 
   3.699303788180822*^9}, {3.6998029051281776`*^9, 3.699802929492042*^9}, 
   3.71599784277496*^9, {3.716045367661171*^9, 
   3.716045381742364*^9}},ExpressionUUID->"e0436ba2-cb59-44cf-a51b-\
fafe52c91dbc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting Options", \
"Subsubsection",ExpressionUUID->"09a4a1b3-a431-400a-8a3d-b0046d0a60e2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"SynchronousAdjustment", "::", "usage"}], "=", 
    RowBox[{
     RowBox[{"\"\<(boolean) Option name for SphericalDVRPlot\>\"", "\n", 
      RowBox[{"\"\<PotentialPointSize\>\"", "::", "usage"}]}], "=", 
     RowBox[{
      RowBox[{
      "\"\<(graphics size specifier) Option name for SphericalDVRPlot\>\"", 
       "\n", "\n", 
       RowBox[{"\"\<EnergyDigits\>\"", "::", "usage"}]}], "=", 
      RowBox[{
       RowBox[{"\"\<(integer) Option name for SphericalDVRPlot\>\"", "\n", 
        RowBox[{"\"\<Interactivity\>\"", "::", "usage"}]}], "=", 
       RowBox[{
        RowBox[{
        "\"\<(None,Less,Normal,More) Option name for SphericalDVRPlot\>\"", 
         "\n", 
         RowBox[{"\"\<PotentialMode\>\"", "::", "usage"}]}], "=", "\n", "\t", 
        
        RowBox[{
         RowBox[{
         "\"\<(True,False,Point,Line,'Dispersed',Blend) Option name for \
SphericalDVRPlot\>\"", "\n", 
          RowBox[{"\"\<PotentialColoring\>\"", "::", "usage"}]}], "=", "\n", 
         "\t", "\"\<The coloring function to use for the \
potential\>\""}]}]}]}]}]}], ";", "\n", 
   RowBox[{
    RowBox[{"\"\<WavefunctionValueMin\>\"", "::", "usage"}], "=", 
    RowBox[{
     RowBox[{"\"\<(0<x<=1) Option name for SphericalDVRPlot\>\"", "\n", 
      RowBox[{"\"\<WavefunctionValueMax\>\"", "::", "usage"}]}], "=", 
     RowBox[{
      RowBox[{"\"\<(0<x<=1) Option name for SphericalDVRPlot\>\"", "\n", "\n", 
       RowBox[{"\"\<WavefunctionPointSize\>\"", "::", "usage"}]}], "=", 
      RowBox[{
       RowBox[{
       "\"\<(graphics size specifier) Option name for SphericalDVRPlot\>\"", 
        "\n", 
        RowBox[{"\"\<WavefunctionStyle\>\"", "::", "usage"}]}], "=", 
       RowBox[{
        RowBox[{"\"\<(Point,Line) Option name for SphericalDVRPlot\>\"", "\n", 
         RowBox[{"\"\<ManipulatorStep\>\"", "::", "usage"}]}], "=", 
        RowBox[{
         RowBox[{"\"\<Option name for SphericalDVRPlot\>\"", "\n", 
          RowBox[{"\"\<WavefunctionSelection\>\"", "::", "usage"}]}], "=", 
         RowBox[{
          RowBox[{
          "\"\<(All,Integer,List) Option name for SphericalDVRPlot\>\"", "\n", 
           RowBox[{"\"\<RadialPointSelection\>\"", "::", "usage"}]}], "=", 
          RowBox[{
           RowBox[{
           "\"\<(All,Integer,List) Option name for SphericalDVRPlot\>\"", 
            "\n", 
            RowBox[{"\"\<AzimuthalPointSelection\>\"", "::", "usage"}]}], "=", 
           RowBox[{
            RowBox[{
            "\"\<(All,Integer,List) Option name for SphericalDVRPlot\>\"", 
             "\n", 
             RowBox[{"\"\<PolarPointSelection\>\"", "::", "usage"}]}], "=", 
            RowBox[{
             RowBox[{
             "\"\<(All,Integer,List) Option name for SphericalDVRPlot\>\"", 
              "\n", 
              RowBox[{"\"\<ZeroPointEnergy\>\"", "::", "usage"}]}], "=", 
             RowBox[{
              RowBox[{"\"\<(Number) Option for SphericalDVRPlot\>\"", "\n", 
               RowBox[{"\"\<PotentialSelection\>\"", "::", "usage"}]}], "=", 
              "\"\<(All,Integer,'Radial','Azimuthal','Polar',List) Option \
name for SphericalDVRPlot\>\""}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6997469961832542`*^9, 3.699747007594399*^9}, 
   3.699801721628878*^9, {3.699801799646559*^9, 3.69980194588848*^9}, {
   3.699810949350697*^9, 
   3.6998109569331093`*^9}},ExpressionUUID->"f33dadc1-8155-483b-93bd-\
4b73459e93a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Complex Options", \
"Subsubsection",ExpressionUUID->"ff9513b7-f029-4e8a-a238-85c3a5eb5eb9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"\"\<RotationalA\>\"", "::", "usage"}], "=", 
    "\"\<Specifies the A rotational constant for a PlanePointDVR\>\""}], "\n", 
   RowBox[{
    RowBox[{"\"\<RotationalB\>\"", "::", "usage"}], "=", 
    "\"\<Specifies the B rotational constant for a PlanePointDVR\>\""}], "\n", 
   RowBox[{
    RowBox[{"\"\<RotationalC\>\"", "::", "usage"}], "=", 
    "\"\<Specifies the C rotational constant for a PlanePointDVR\>\""}], "\n", 
   RowBox[{
    RowBox[{"\"\<ReducedMass\>\"", "::", "usage"}], "=", 
    "\"\<Specifies the reduced mass of the complex\>\""}]}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.699237547711256*^9, 
  3.699237564514523*^9}},ExpressionUUID->"575e9d24-312a-4011-a465-\
d02fa78e64bd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting Option Values", \
"Subsubsection",ExpressionUUID->"11790fa2-d8dc-4960-a9b9-83aab4e6749d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"\"\<More\>\"", "::", "usage"}], "=", 
    "\"\<Option value for \\\"Interactivity\\\" in SphericalDVRPlot\>\""}], 
   "\n", 
   RowBox[{
    RowBox[{"\"\<Sparse\>\"", "::", "usage"}], "=", 
    "\"\<Option value for \\\"WavefunctionPointSize\\\" in SphericalDVRPlot\>\
\""}], "\n", 
   RowBox[{
    RowBox[{"\"\<Blobby\>\"", "::", "usage"}], "=", 
    "\"\<Option value for \\\"WavefunctionPointSize\\\" in SphericalDVRPlot\>\
\""}], "\n", 
   RowBox[{
    RowBox[{"\"\<Dense\>\"", "::", "usage"}], "=", 
    "\"\<Option value for \\\"WavefunctionPointSize\\\" in SphericalDVRPlot\>\
\""}], "\n", 
   RowBox[{
    RowBox[{"\"\<Ultrafine\>\"", "::", "usage"}], "=", 
    "\"\<Option value for \\\"ManipulatorStep\\\" in \
SphericalDVRPlot\>\""}]}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6998018498289547`*^9, 3.699801871825212*^9}, 
   3.699801904024785*^9, {3.699802022853724*^9, 3.6998020979038258`*^9}, {
   3.69980214032784*^9, 
   3.699802142110029*^9}},ExpressionUUID->"6151c187-d315-4982-a369-\
b930154c1a79"]
}, Closed]],

Cell[CellGroupData[{

Cell["Public Gets", "CodeSubsubsection",
 CellChangeTimes->{{3.699239001919134*^9, 
  3.699239003951262*^9}},ExpressionUUID->"cc2827dc-a234-49be-9451-\
6d479f20a7a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRNeeds", "/@", 
   RowBox[{"{", 
    RowBox[{
    "\"\<LegendreDVR\>\"", ",", "\"\<MeyerDVR\>\"", ",", 
     "\"\<RadialDVR\>\""}], "}"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699240131188299*^9, 3.699240167062263*^9}, 
   3.6992402436302977`*^9, 
   3.707066387059753*^9},ExpressionUUID->"80bd3241-8074-45d6-91a2-\
2f2850009238"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"3bcc494c-d476-4f83-a910-\
bce0d73f882e"],

Cell[CellGroupData[{

Cell["Useful functions", \
"Subsubsection",ExpressionUUID->"6f185629-af25-46a7-a24c-0099ca14ab7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sph2orth", "=", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"FromSphericalCoordinates", "[", 
      RowBox[{"{", 
       RowBox[{"#", ",", "#2", ",", "#3"}], "}"}], "]"}], "]"}], "&"}]}], 
  ";"}], "\n", 
 RowBox[{"orth2sph", "=", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"ToSphericalCoordinates", "[", 
     RowBox[{"{", 
      RowBox[{"#", ",", "#2", ",", "#3"}], "}"}], "]"}], "]"}], 
   "&"}]}]}], "CodeInput",
 CellChangeTimes->{{3.699237763449925*^9, 3.699237771560752*^9}, {
  3.699238113199684*^9, 3.699238114205427*^9}, {3.715975823812714*^9, 
  3.715975859952063*^9}, {3.715977045311755*^9, 
  3.715977048269492*^9}},ExpressionUUID->"c2b39361-7a02-4081-a8d0-\
b9ad3c810a58"],

Cell["\<\
Indexing functions for constructing the kinetic energy matrix\
\>", "Text",ExpressionUUID->"d79f7821-a4fd-4fe6-aaf0-7c55fec84e5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rIndex", "[", 
    RowBox[{"rN_", ",", "\[Phi]N_", ",", "\[Theta]N_"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", "=", 
         RowBox[{"Function", "[", 
          RowBox[{"k", ",", 
           RowBox[{"1", "+", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"k", "-", "1"}], ")"}], "/", "\[Phi]N"}], "]"}], 
               "+", "1"}], ",", "rN"}], "]"}]}]}], "]"}]}], "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", "i", "]"}], ",", 
         RowBox[{"f", "[", "j", "]"}]}], "}"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]Index", "[", 
    RowBox[{"rN_", ",", "\[Phi]N_", ",", "\[Theta]N_"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", "=", 
         RowBox[{"Function", "[", 
          RowBox[{"k", ",", 
           RowBox[{"1", "+", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"k", "-", "1"}], ",", "\[Phi]N"}], "]"}]}]}], "]"}]}], 
        "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "[", "i", "]"}], ",", 
         RowBox[{"f", "[", "j", "]"}]}], "}"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Theta]Index", "[", 
   RowBox[{"rN_", ",", "\[Phi]N_", ",", "\[Theta]N_"}], "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"k", ",", 
          RowBox[{"1", "+", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k", "-", "1"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"rN", "*", "\[Phi]N"}], ")"}]}], "]"}]}]}], "]"}]}], 
       "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", "i", "]"}], ",", 
        RowBox[{"f", "[", "j", "]"}]}], "}"}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.715975863271161*^9, 
  3.7159759070215397`*^9}},ExpressionUUID->"1043cd25-16ee-4fa2-8ba6-\
71c1dd368ede"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid Formatting", \
"Subsubsection",ExpressionUUID->"05958c14-439d-4273-848d-afbe60b7397b"],

Cell["\<\
Takes the grid and maybe the gridpoints to return the grid and the \
transformation matrix to the DVR basis in the Legendre term\
\>", "Text",ExpressionUUID->"e371b76a-5963-4a46-88a4-ab51d33aa29c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SphericalDVRFormatGrid", "[", 
   RowBox[{"grid_", ",", 
    RowBox[{"points_:", "None"}]}], "]"}], ":=", "\n", "\t", 
  "grid"}]], "CodeInput",
 CellChangeTimes->{
  3.699237827173822*^9, 3.699238124737154*^9, {3.6992381615419893`*^9, 
   3.699238178626234*^9}, {3.699238309500594*^9, 
   3.699238310234631*^9}},ExpressionUUID->"b42c53cb-d172-4e08-a7b7-\
fe1eef226d59"]
}, Closed]],

Cell[CellGroupData[{

Cell["Grid Points", \
"Subsubsection",ExpressionUUID->"a3b098f9-efcd-47f5-bf41-ca3b53d6130f"],

Cell["\<\
Takes the number of radial, angular, and azimuthal points and optionally \
their ranges and generates a 3D grid\
\>", "Text",ExpressionUUID->"0eb8cbeb-6f10-4026-9502-987989855a51"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRPoints", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rpoints_Integer", ",", "\[Theta]points_Integer", ",", 
       "\[Phi]points_Integer"}], "}"}], ",", "\n", "\t", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"rrange", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ":", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], ",", "\n", "\t\t", 
       RowBox[{"\[Theta]range", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ":", 
        RowBox[{"{", 
         RowBox[{"0", ",", "\[Pi]"}], "}"}]}], ",", "\n", "\t\t", 
       RowBox[{"\[Phi]range", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], ":", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}]}]}], "\n", "\t\t", "}"}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"R", "=", 
        RowBox[{"RadialDVRPoints", "[", 
         RowBox[{
          RowBox[{"{", "rpoints", "}"}], ",", 
          RowBox[{"{", "rrange", "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"\[CapitalPhi]", "=", 
        RowBox[{"MeyerDVRPoints", "[", 
         RowBox[{
          RowBox[{"{", "\[Phi]points", "}"}], ",", 
          RowBox[{"{", "\[Phi]range", "}"}]}], "]"}]}]}], "\n", "\t\t", "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LTransfANDgrid", "=", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], ",", 
              RowBox[{"Ordering", "@", 
               RowBox[{"First", "@", "#"}]}]}], "]"}], "]"}], "&"}], "@", 
          RowBox[{"LegendreDVRPoints", "[", 
           RowBox[{
            RowBox[{"{", "\[Theta]points", "}"}], ",", 
            RowBox[{"{", "\[Theta]range", "}"}]}], "]"}]}]}], "}"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r", ",", " ", "\[Theta]", ",", " ", "\[Phi]"}], "}"}], 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"r", ",", "R"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "\[CapitalPhi]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", 
             RowBox[{"LTransfANDgrid", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "\n", "\t", 
          "\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"LTransfANDgrid", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "\n", "\t", "\t\t\t", "}"}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6992381861186743`*^9, 3.699238249618026*^9}, {
   3.699242261354084*^9, 3.699242266777059*^9}, {3.6992423404785233`*^9, 
   3.699242344020516*^9}, 3.699242384675152*^9, {3.699242482965176*^9, 
   3.699242502811798*^9}, {3.69924257528745*^9, 3.6992426313774557`*^9}, {
   3.699242703853281*^9, 3.699242732553996*^9}, 3.69924278332268*^9, {
   3.71597796980544*^9, 3.715977972287244*^9}, {3.7159786646785803`*^9, 
   3.715978665905562*^9}, {3.7159787066836777`*^9, 3.7159787083462057`*^9}, {
   3.715997847882419*^9, 3.715997848855361*^9}, {3.716001212614173*^9, 
   3.716001214175577*^9}, {3.7160646373369713`*^9, 
   3.716064642092373*^9}},ExpressionUUID->"38c9572d-9bab-42a3-9cd1-\
afcca4baad44"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic Energy Matrix (not implemented)", \
"Subsubsection",ExpressionUUID->"c109acdd-b74e-4be0-8025-f3bf36e0bf00"],

Cell["\<\
Should, eventually, take the DVR grid and turn it into a kinetic energy \
matrix. But this involves getting a matrix for the standard spherical system\
\>", "Text",ExpressionUUID->"4445f038-e7c4-441b-9f65-99a51665be8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SphericalDVRK", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\"\<\[HBar]\>\"", "->", "1"}], ",", 
       RowBox[{"\"\<m\>\"", "->", "1"}], ",", "\n", "\t\t", 
       RowBox[{"Options", "[", "LegendreDVRK", "]"}], ",", "\n", "\t\t", 
       RowBox[{"Options", "[", "RadialDVRK", "]"}], ",", "\n", "\t\t", 
       RowBox[{"Options", "[", "MeyerDVRK", "]"}]}], "}"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Clear", "[", "\"\<SphericalDVRK\>\"", "]"}], "\n", "\t", 
     RowBox[{"SphericalDVRK", "[", 
      RowBox[{"grid_", ",", 
       RowBox[{"ops", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", "\n", "\t\t", 
    RowBox[{"Module", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "T", ",", "X", ",", "\n", "\t\t\t\t", "rX", ",", "\[Phi]X", ",", 
        "\[Theta]X", ",", "\n", "\t\t\t\t", "rK", ",", "\[Phi]K", ",", 
        "\[Theta]K", ",", "\n", "\t\t\t\t", "rN", ",", "\[Phi]N", ",", 
        "\[Theta]N", ",", "\n", "\t\t\t\t", "rind", ",", "\[Phi]ind", ",", 
        "\[Theta]ind", ",", "\n", "\t\t\t\t", "\[Delta]r", ",", 
        "\[Delta]\[Phi]", ",", "\[Delta]\[Theta]", ",", "\n", "\t\t\t\t", 
        "Kel", ",", "K"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", "T"}], "}"}], "=", "grid"}], ";", "\n", "\t\t\t", 
       RowBox[{"X", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"X", ",", "2"}], "]"}]}], ";", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rX", ",", "\[Phi]X", ",", "\[Theta]X"}], "}"}], "=", 
        RowBox[{"DeleteDuplicates", "/@", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "#"}], "]"}], "]"}], "&"}], ",", "3"}], 
          "]"}]}]}], ";", "\n", "\t\t\t", 
       RowBox[{"rK", "=", 
        RowBox[{"RadialDVRK", "[", "rX", "]"}]}], ";", 
       RowBox[{"\[Phi]K", "=", 
        RowBox[{"MeyerDVRK", "[", "\[Phi]X", "]"}]}], ";", 
       RowBox[{"\[Theta]K", "=", 
        RowBox[{"LegendreDVRK", "[", 
         RowBox[{"{", 
          RowBox[{"\[Theta]X", ",", "T"}], "}"}], "]"}]}], ";", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rN", ",", "\[Phi]N", ",", "\[Theta]N"}], "}"}], "=", 
        RowBox[{"Length", "/@", 
         RowBox[{"{", 
          RowBox[{"rK", ",", "\[Phi]K", ",", "\[Theta]K"}], "}"}]}]}], ";", 
       RowBox[{
        RowBox[{"rind", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", "=", 
            RowBox[{"Function", "[", 
             RowBox[{"k", ",", 
              RowBox[{"1", "+", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}], "/", "\[Phi]N"}], "]"}], 
                 ",", "rN"}], "]"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "[", "i", "]"}], ",", 
            RowBox[{"f", "[", "j", "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"\[Phi]ind", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", "=", 
            RowBox[{"Function", "[", 
             RowBox[{"k", ",", 
              RowBox[{"1", "+", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"k", "-", "1"}], ",", "\[Phi]N"}], "]"}]}]}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "[", "i", "]"}], ",", 
            RowBox[{"f", "[", "j", "]"}]}], "}"}]}], "]"}]}], ";", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"\[Theta]ind", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", "=", 
            RowBox[{"Function", "[", 
             RowBox[{"k", ",", 
              RowBox[{"1", "+", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"k", "-", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"rN", "*", "\[Phi]N"}], ")"}]}], "]"}]}]}], "]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f", "[", "i", "]"}], ",", 
            RowBox[{"f", "[", "j", "]"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"\[Delta]r", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"KroneckerDelta", "@@", 
         RowBox[{"rind", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"\[Delta]\[Phi]", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"KroneckerDelta", "@@", 
         RowBox[{"\[Phi]ind", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"\[Delta]\[Theta]", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"KroneckerDelta", "@@", 
         RowBox[{"\[Theta]ind", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"Kel", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{"(", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Delta]\[Phi]", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "*", 
              RowBox[{"\[Delta]\[Theta]", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}], 
            RowBox[{"rK", "[", 
             RowBox[{"[", " ", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"rind", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}], " ", "]"}], "]"}]}], ")"}], 
          "+", "\n", "\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Delta]r", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "*", 
              RowBox[{"\[Delta]\[Theta]", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}], 
            RowBox[{"\[Phi]K", "[", 
             RowBox[{"[", " ", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"\[Phi]ind", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}], " ", "]"}], "]"}]}], ")"}], 
          "+", "\n", "\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Delta]\[Phi]", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "*", 
              RowBox[{"\[Delta]r", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], ")"}], 
            RowBox[{"\[Theta]K", "[", 
             RowBox[{"[", " ", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"\[Theta]ind", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}], " ", "]"}], "]"}]}], 
           ")"}]}], "\n", "\t\t\t\t", ")"}]}], ";", "\n", "\t\t\t", 
       RowBox[{"K", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"Kel", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"rN", "*", "\[Phi]N", "*", "\[Theta]N"}], ",", 
            RowBox[{"rN", "*", "\[Phi]N", "*", "\[Theta]N"}]}], "}"}]}], 
         "]"}]}]}]}], "\n", "\t\t", "]"}]}], "*)"}]}]}], "CodeInput",
 CellChangeTimes->{{3.699238327709178*^9, 3.699238345468281*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"26d1fd07-278c-4786-b30a-9483bfa8912a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Potential Energy Matrix", \
"Subsubsection",ExpressionUUID->"f49e383e-4bb7-4185-9d01-518c6f7b83d5"],

Cell["\<\
Takes the grid points and options (critically a PotentialFunction) to create \
a potential energy matrix.\
\>", "Text",ExpressionUUID->"8da64862-0895-424c-9ed9-c6a1a3affe8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SphericalDVRV", "]"}], "=", "\n", "\t", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"Function", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"r", "<", 
           RowBox[{"10", "^", 
            RowBox[{"-", "10"}]}]}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"r", "^", "2"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"r", "^", "2"}]}], ")"}]}]}], "]"}]}], "]"}]}], "\n", 
     "\t", "\t", "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SphericalDVRV", "[", 
   RowBox[{"gridpoints_", ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"P", "=", 
       RowBox[{"OptionValue", "[", "Function", "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"X", "=", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2", ",", 
            RowBox[{"ArcCos", "[", "#3", "]"}]}], "}"}], "&"}], "@@@", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"First", "@", "gridpoints"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}], ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[Infinity]"}], 
          "]"}]}], "//", 
        RowBox[{"SortBy", "[", "Last", "]"}]}]}]}], "\n", "\t\t\t", "}"}], 
    ",", "\n", "\t\t", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"Band", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
      RowBox[{"P", "@@@", "X"}]}], "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6992383640684643`*^9, 3.699238505291438*^9}, 
   3.6992385547356577`*^9, {3.699242938060371*^9, 
   3.69924294140342*^9}},ExpressionUUID->"eebe0787-a340-4902-9282-\
6a285c052105"]
}, Closed]],

Cell[CellGroupData[{

Cell["Wavefunctions", \
"Subsubsection",ExpressionUUID->"c8c3dbad-2e90-46a8-ac9e-98a1d77b1d7f"],

Cell["\<\
Generates the wavefunctions from the Kinetic and Potential matrices\
\>", "Text",ExpressionUUID->"b5eb89a5-5b28-436b-95f5-863e1401ea45"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRWavefunctions", "[", 
    RowBox[{"T_", ",", "V_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], ",", 
            RowBox[{"Ordering", "[", 
             RowBox[{"First", "@", "#"}], "]"}]}], "]"}], "]"}], "&"}], "@", 
        RowBox[{"Eigensystem", "[", 
         RowBox[{"T", "+", "V"}], "]"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"phase", "=", 
         RowBox[{"Sign", "@", 
          RowBox[{"S", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"First", "@", "S"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"phase", "*", "#"}], "&"}], "/@", 
          RowBox[{"Last", "@", "S"}]}]}], "}"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699238543201284*^9, 
  3.69923855149296*^9}},ExpressionUUID->"582b3965-38bd-401f-b9f5-33147f928e4e"]
}, Closed]],

Cell[CellGroupData[{

Cell["WavefunctionsGrid", "CodeSubsubsection",
 CellChangeTimes->{{3.716045201982253*^9, 
  3.71604520462071*^9}},ExpressionUUID->"bc75e579-7cfa-4a22-a68b-\
c8972d899856"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRWavefunctionGrid", "[", 
    RowBox[{"gridAndT_", ",", "wfs_", ",", "___"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"coreGridPoints", "=", "\n", "\t\t\t", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{
             RowBox[{"Depth", "[", "#", "]"}], "-", "3"}]}], "]"}], "&"}], 
         "@", 
         RowBox[{"gridAndT", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "\n", "\t\t", "}"}], ",",
      "\n", "\t\t", 
     RowBox[{"MapThread", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "->", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"coreGridPoints", ",", "#2"}], "}"}], "]"}]}], "&"}], ",", 
       "\n", "\t\t\t", "wfs"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7160452800256577`*^9, 3.7160453622226048`*^9}, {
   3.7160458834030323`*^9, 3.7160459129321012`*^9}, {3.71604600259068*^9, 
   3.716046002722238*^9}, 
   3.716052903793654*^9},ExpressionUUID->"c4baf640-32f9-4ce7-9f6a-\
4d99945f5055"]
}, Closed]],

Cell[CellGroupData[{

Cell["Wavefunction Plotting Function", \
"Subsubsection",ExpressionUUID->"870ac85a-1385-4a76-a073-d0c5bf2df812"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SphericalDVRWavefunctionPlotFunction", "]"}], "=",
    "\n", "\t", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Verbose", "->", "False"}], ",", 
      RowBox[{"AddTo", "->", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"Options", "[", "Graphics3D", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRWavefunctionPlotFunction", "[", 
    RowBox[{"(*", 
     RowBox[{"Should", " ", "have", " ", "16", " ", "arguments"}], "*)"}], 
    "\n", "\t", 
    RowBox[{
    "Gridpoints_", ",", "WavefunctionFunction_", ",", "EnergyLevelFunction_", 
     ",", "\n", "\t", "PointColoringFunction_", ",", "PointFunction_", ",", 
     "FieldPoints_", ",", "\n", "\t", 
     RowBox[{"radialGridpoints_:", "None"}], ",", 
     RowBox[{"angularGridpoints_:", "None"}], ",", 
     RowBox[{"azimuthalGridpoints_:", "None"}], ",", "\n", "\t", 
     RowBox[{"radialSelectionDefault_:", "All"}], ",", "\n", "\t\t", 
     RowBox[{"angularSelectionDefault_:", "All"}], ",", 
     RowBox[{"azimuthalSelectionDefault_:", "All"}], ",", "\n", "\t", 
     RowBox[{"waveFunctionDigits_:", "10"}], ",", 
     RowBox[{"boxSize_:", "None"}], ",", "\n", "\t\t", 
     RowBox[{"pointSpec_:", "Small"}], ",", 
     RowBox[{"axes_:", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"WavefunctionGraphics", ",", 
       RowBox[{"X", "=", "Gridpoints"}], ",", 
       RowBox[{"\[Psi]", "=", "WavefunctionFunction"}], ",", "\n", "\t\t", 
       RowBox[{"\[CapitalLambda]", "=", "EnergyLevelFunction"}], ",", 
       RowBox[{"coFunc", "=", "PointColoringFunction"}], ",", 
       RowBox[{"pointFunc", "=", "PointFunction"}], ",", "\n", "\t\t", 
       RowBox[{"verb", "=", 
        RowBox[{"OptionValue", "@", "Verbose"}]}], ",", 
       RowBox[{"epi", "=", 
        RowBox[{"OptionValue", "@", "AddTo"}]}], ",", "\n", "\t\t", 
       RowBox[{"sph2orth", "=", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"CoordinateTransform", "[", 
           RowBox[{
            RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "]"}], 
         "&"}]}], ",", "\n", "\t\t", 
       RowBox[{"rX", "=", "radialGridpoints"}], ",", 
       RowBox[{"\[Phi]X", "=", "angularGridpoints"}], ",", 
       RowBox[{"\[Theta]X", "=", "azimuthalGridpoints"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rX", "==", "None"}], ",", 
        RowBox[{"rX", "=", 
         RowBox[{"Gridpoints", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Phi]X", "==", "None"}], ",", 
        RowBox[{"\[Phi]X", "=", 
         RowBox[{"Gridpoints", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Theta]X", "==", "None"}], ",", 
        RowBox[{"\[Theta]X", "=", 
         RowBox[{"Gridpoints", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", "\n", "\t\t", 
      RowBox[{
       RowBox[{"WavefunctionGraphics", "[", "\n", "\t\t\t\t", 
        RowBox[{
        "wavefunctionNumber_", ",", "minimumValue_", ",", "maximumValue_", 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"potentialBarLegend_:", "None"}], ",", 
         RowBox[{"wavefunctionValueBarLegend_:", "None"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"colorFunction_:", "coFunc"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"showFieldPoints_:", "True"}], ",", 
         RowBox[{"showWaveFunction_:", "True"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"radialSelection_:", "radialSelectionDefault"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"angularSelection_:", "angularSelectionDefault"}], ",", "\n",
          "\t\t\t\t", 
         RowBox[{"azimuthalSelection_:", "azimuthalSelectionDefault"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"pointSize_:", "pointSpec"}], ",", 
         RowBox[{"axThing_:", "axes"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"fieldPoints_:", "FieldPoints"}], ",", 
         RowBox[{"verbose_:", "verb"}], ",", 
         RowBox[{"epilog_:", "epi"}]}], "]"}], ":=", "\n", "\t\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"n", "=", "wavefunctionNumber"}], ",", 
           RowBox[{"c", "=", "minimumValue"}], ",", 
           RowBox[{"cs", "=", "maximumValue"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"pot", "=", "potentialBarLegend"}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"wvv", "=", "wavefunctionValueBarLegend"}], ",", 
           RowBox[{"cpF", "=", "showFieldPoints"}], ",", 
           RowBox[{"grF", "=", "showWaveFunction"}], ",", "\n", "\t\t\t\t\t", 
           
           RowBox[{"colorPoints", "=", "fieldPoints"}]}], "}"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Module", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"\[Phi]", "=", 
              RowBox[{"\[Psi]", "[", "n", "]"}]}], ",", 
             RowBox[{"\[Lambda]", "=", "0"}], ",", "\n", "\t", "\t\t\t\t\t", 
             "graphic", ",", 
             RowBox[{"R", "=", "radialSelection"}], ",", 
             RowBox[{"F", "=", "angularSelection"}], ",", 
             RowBox[{"Q", "=", "azimuthalSelection"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"coP", "=", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"csn", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"cs", "===", "0"}], ",", "1", ",", "cs"}], 
                   "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Function", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"colorFunction", "[", 
                   RowBox[{"Rescale", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "csn"}], "}"}]}], "]"}], "]"}]}], 
                 "]"}]}], "]"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"\[Psi]m", "=", "None"}], ",", 
             RowBox[{"\[CapitalPsi]M", "=", "None"}], ",", 
             RowBox[{"\[Psi]T", "=", "0"}]}], "\n", "\t", "\t\t\t\t\t", "}"}],
            ",", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"R", ",", "All"}], "]"}], ",", 
              RowBox[{"R", "=", 
               RowBox[{"rX", "[", 
                RowBox[{"[", "All", "]"}], "]"}]}], ",", 
              RowBox[{"R", "=", 
               RowBox[{"rX", "[", 
                RowBox[{"[", "R", "]"}], "]"}]}]}], "]"}], ";", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"F", ",", "All"}], "]"}], ",", 
              RowBox[{"F", "=", 
               RowBox[{"\[Phi]X", "[", 
                RowBox[{"[", "All", "]"}], "]"}]}], ",", 
              RowBox[{"F", "=", 
               RowBox[{"\[Phi]X", "[", 
                RowBox[{"[", "F", "]"}], "]"}]}]}], "]"}], ";", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"Q", ",", "All"}], "]"}], ",", 
              RowBox[{"Q", "=", 
               RowBox[{
                RowBox[{"Sort", "[", "\[Theta]X", "]"}], "[", 
                RowBox[{"[", "All", "]"}], "]"}]}], ",", 
              RowBox[{"Q", "=", 
               RowBox[{
                RowBox[{"Sort", "[", "\[Theta]X", "]"}], "[", 
                RowBox[{"[", "Q", "]"}], "]"}]}]}], "]"}], ";", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"graphic", "=", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Graphics3D", "[", 
               RowBox[{
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"TrueQ", "@", "cpF"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PointSize", "[", "Small", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"colorPoints", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", "axThing", ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Opacity", "[", "0", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Line", "[", 
                    RowBox[{"boxSize", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"(*", 
                   RowBox[{
                   "The", " ", "actual", " ", "wavefunction", " ", "points"}],
                    "*)"}], "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"Not", "@", "grF"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ps", "=", 
                    RowBox[{"Switch", "[", 
                    RowBox[{"pointSize", ",", 
                    RowBox[{"_", "?", "NumberQ"}], ",", 
                    RowBox[{"PointSize", "@", "pointSize"}], ",", "_", ",", 
                    "pointSize"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"\[Psi]m", "=", "\[Infinity]"}], ";", 
                    RowBox[{"\[CapitalPsi]M", "=", 
                    RowBox[{"-", "\[Infinity]"}]}], ";", 
                    RowBox[{"\[Psi]T", "=", "0"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", "=", 
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"\[Psi]m", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Psi]m", ",", "p"}], "}"}], "]"}]}], ";", 
                    RowBox[{"\[CapitalPsi]M", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalPsi]M", ",", "p"}], "}"}], "]"}]}]}]}], 
                    "]"}], ";", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Which", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Not", "@", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"R", ",", 
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "||", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Not", "@", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"F", ",", 
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "||", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Not", "@", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"Q", ",", 
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", ")"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "the", " ", "point", " ", 
                    RowBox[{"shouldn", "'"}], "t", " ", "be", " ", 
                    "displayed"}], "*)"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "Null", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", "\[Lambda]"}], 
                    "]"}], ">", "cs"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "wavefunction", " ", "value", " ", 
                    "is", " ", "greater", " ", "than", " ", "the", " ", "max",
                     " ", "there"}], "*)"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", ".5", "]"}], ",", "ps", ",", 
                    "Black", ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"sph2orth", "@@", 
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}]}], "}"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", "\[Lambda]"}], 
                    "]"}], ">=", "c"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "wavefunction", " ", "value", " ", 
                    "is", " ", "greater", " ", "than", " ", "or", " ", 
                    "equal", " ", "to", " ", "the", " ", "minimum", " ", 
                    "there"}], "*)"}], "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"ps", ",", 
                    RowBox[{"coP", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", "\[Lambda]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"pointFunc", "[", 
                    RowBox[{"\[CurlyPhi]", ",", "\[Lambda]"}], "]"}]}], "}"}],
                     ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "True", ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Otherwise", " ", "have", " ", "no", " ", "point"}], 
                    "*)"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "Null"}], 
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"\[CurlyPhi]", ",", "\[Phi]"}], "}"}]}], 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{"epilog", ",", 
                    RowBox[{
                    RowBox[{"Graphics3D", "[", "l_", "]"}], ":>", "l"}]}], 
                   "]"}]}], "\n", "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{"Graphics", " ", "options"}], "*)"}], "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{
                  RowBox[{"{", "ops", "}"}], ",", 
                  RowBox[{"Except", "[", 
                   RowBox[{"AddTo", "|", "Verbose", "|", "Axes"}], "]"}]}], 
                 "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Axes", "->", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"axThing", "===", 
                    RowBox[{"{", "}"}]}], ",", "False", ",", "True"}], 
                  "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}], "//", 
              RowBox[{
               RowBox[{"Legended", "[", 
                RowBox[{"#", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Panel", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<E\>\"", ",", 
                    RowBox[{"ToString", "[", "n", "]"}]}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", "\"\<: \>\"", ",", 
                    RowBox[{"1.", "*", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalLambda]", "[", "n", "]"}], ",", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "waveFunctionDigits"}], ")"}]}]}], "]"}]}]}],
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], "]"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"grF", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Psi]-value\>\"", ",", "wvv"}], "}"}], 
                    "]"}], ",", "\"\<\>\""}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Not", "@", 
                    RowBox[{"TrueQ", "[", 
                    RowBox[{"pot", "==", "Null"}], "]"}]}], "&&", "cpF"}], 
                    ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\< Potential\>\"", ",", "pot"}], "}"}], "]"}], 
                    ",", "\"\<\>\""}], "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], "]"}], ",", "\n", "\t",
                     "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[Psi]\>\"", ",", "\"\<min\>\""}], "]"}], 
                    ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"\[Psi]m", ",", "waveFunctionDigits"}], "]"}]}], 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], 
                    "]"}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Spacer", "[", "10", "]"}], ",", "\n", "\t", "\t",
                     "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[Psi]\>\"", ",", "\"\<max\>\""}], "]"}], 
                    ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"\[CapitalPsi]M", ",", "waveFunctionDigits"}], 
                    "]"}]}], "}"}], "]"}]}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "}"}], "]"}]}], "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dividers", "->", "Center"}]}], "]"}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                "\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}]}]}]}]}], "\n", 
          "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ";", "\n", 
      "\t\t", "WavefunctionGraphics"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6992386518670177`*^9, 3.6992386731857862`*^9}, {
   3.699746940221263*^9, 3.699746951827736*^9}, {3.699802929508565*^9, 
   3.699802929552019*^9}, {3.699810392436318*^9, 3.699810801956222*^9}, {
   3.69981605734804*^9, 3.699816074398382*^9}, 3.69981688801831*^9, {
   3.699824831180011*^9, 3.699824846096902*^9}, {3.699825511392242*^9, 
   3.69982553339881*^9}, {3.699825753296258*^9, 
   3.6998257590442753`*^9}},ExpressionUUID->"544be9e0-c3a1-463b-bcad-\
607ae3dc72bc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Potential Graphics Objects", \
"CodeSubsubsection",ExpressionUUID->"53c430d6-c9c8-4de9-a5fd-254823ac4b85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$cont", "=", "$Context"}], 
  ";"}]], "CodeInput",ExpressionUUID->"58d035cb-aadd-4803-b3b7-093a8daf7b6d"],

Cell[CellGroupData[{

Cell["GeneratePointPotential", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6998040444054823`*^9, 3.699804050324006*^9}, {
  3.699804217554789*^9, 3.699804221752088*^9}, {3.6998086956096067`*^9, 
  3.699808697174885*^9}},ExpressionUUID->"7bc686dd-391a-4dfa-8471-\
341a4b71df1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GeneratePointPotentialFuncion", "[", 
    RowBox[{
    "Gridpoints_", ",", "\n", "\t", "rGrid_", ",", "fGrid_", ",", "qGrid_", 
     ",", "\n", "\t", "DefaultCutoff_", ",", "DefaultSize_"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"pointF", "=", 
        RowBox[{"Unique", "[", 
         RowBox[{"$cont", "<>", "\"\<pointF\>\""}], "]"}]}], ",", "\n", 
       "\t\t", 
       RowBox[{"sph2orth", "=", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"CoordinateTransform", "[", 
           RowBox[{
            RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "]"}], 
         "&"}]}], ",", "\n", "\t\t", 
       RowBox[{"splineCircle", "=", "\n", "\t\t\t", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "r", ",", "angles"}], "}"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", "=", "\n", "\t", "\t", "\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"angles", "//", "N"}], ",", 
                  RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", "\n", "\t", "\t",
                 "\t\t\t\t", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s_", ",", "e_"}], "}"}], "/;", 
                   RowBox[{"e", "<=", "s"}]}], ")"}], ":>", "\n", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", 
                   RowBox[{"e", "+", 
                    RowBox[{"2", "\[Pi]"}]}]}], "}"}]}]}], "\n", "\t", "\t", 
               "\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t", "\t", "\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t", 
               RowBox[{
                RowBox[{"seg", "=", "\n", "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "4"}], 
                   ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", "3", ",", "\n", 
                   "\t", "\t", "\t", "\t", "\t\t\t\t", 
                   RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "]"}]}], ",", 
                "\n", "\t", "\t", "\t", "\t\t\t", 
                RowBox[{"\[Phi]", "=", "\n", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "4"}], 
                   ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{"\[Pi]", "/", "2"}], ",", "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "\n", "\t", "\t", 
                  "\t", "\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", "\t", 
               "\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", "\t\t\t", 
              RowBox[{"BSplineCurve", "[", "\n", "\t", "\t", "\t", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"m", "+", "#"}], "&"}], "/@", "\n", "\t", "\t", 
                 "\t", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",",
                     "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "Identity", ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "@", "#"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}], "&"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t", "]"}],
                   "@", 
                  RowBox[{"Dot", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"r", "*", 
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"First", "@", "angles"}], "]"}]}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{
                    "Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", "seg"}], "+", "1"}]}], "]"}], ",", "\n",
                     "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"seg", " ", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}], "&"}], "/@", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "}"}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    "}"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    "]"}]}]}], "]"}]}]}], ",", "\n", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"SplineDegree", "->", "2"}], ",", "\n", "\t", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"SplineKnots", "->", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\n", "\t",
                    "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Riffle", "[", 
                    RowBox[{"#", ",", "#"}], "]"}], "&"}], "@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"seg", "+", "1"}], "]"}]}], ",", "\n", "\t", "\t",
                    "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"seg", "+", "1"}], "}"}]}], "]"}]}], ",", "\n", 
                "\t", "\t", "\t\t\t\t\t", 
                RowBox[{
                "SplineWeights", "->", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"2", " ", "seg"}], "+", "1"}]}], "]"}], ",", "\n",
                    "\t", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}], ",", "1"}], "}"}]}], 
                  "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
               "\t", "\t", "\t\t\t\t\t\t", "\n", "\t", "\t", "\t\t\t\t\t", 
               "]"}]}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], "\n", "\t", 
           "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t", "\t\t", "]"}]}]}], "\n",
       "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"SetAttributes", "[", 
       RowBox[{"pointF", ",", "Temporary"}], "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"pointF", "[", 
        RowBox[{"A_", ",", "F_", ",", "\n", "\t\t\t\t", 
         RowBox[{"X_:", "Gridpoints"}], ",", 
         RowBox[{"rX_:", "rGrid"}], ",", 
         RowBox[{"\[Phi]X_:", "fGrid"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"\[Theta]X_:", "qGrid"}], ",", 
         RowBox[{"mode_:", "All"}], ",", 
         RowBox[{"function_:", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Point", "[", "#1", "]"}], ",", 
              RowBox[{"PointSize", "[", "#2", "]"}]}], "}"}], "&"}], ")"}]}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"cutOff_:", "DefaultCutoff"}], ",", 
         RowBox[{"op_:", "1"}], ",", 
         RowBox[{"size_:", "DefaultSize"}]}], "\n", "\t\t\t\t", "]"}], ":=", 
       "\n", "\t\t\t", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"selection", ",", 
           RowBox[{"ordering", "=", 
            RowBox[{"{", 
             RowBox[{"rX", ",", 
              RowBox[{"Sort", "@", "\[Phi]X"}], ",", 
              RowBox[{"Sort", "@", "\[Theta]X"}]}], "}"}]}], ",", 
           RowBox[{"choices", "=", "mode"}]}], "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{"choices", ",", 
              RowBox[{"Except", "[", 
               RowBox[{
               "_List", "|", "_Integer", "|", "_String", "|", "_Rule"}], 
               "]"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"choices", "=", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Points\>\"", ",", "\"\<Radial\>\"", ",", 
               "\"\<Azimuthal\>\"", ",", "\"\<Polar\>\""}], "}"}]}]}], "]"}], 
          ";", "\n", "\t\t\t\t", 
          RowBox[{"selection", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], "}"}]}], ";", "\n", "\t\t\t\t", 
          
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"repPattern", "=", "\n", "\t\t\t\t\t", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", "v"}], "}"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"y", "=", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"v", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"_Integer", ":>", 
                    RowBox[{"Range", "[", "v", "]"}]}], ",", 
                    RowBox[{"_List", ":>", "v"}], ",", 
                    RowBox[{"_", ":>", 
                    RowBox[{"{", "v", "}"}]}]}], "}"}]}], "]"}]}], "}"}], ",",
                   "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], "/.", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"n", ":>", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    "_Integer", "|", "All", "|", "None", "|", "_Spacings", 
                    "|", "_Select"}]}], "]"}], "/.", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"l", ":", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ".."}], "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "None", ",", "___"}], "}"}], "->", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"o", ":", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"r_", "?", 
                    RowBox[{"(", 
                    RowBox[{"0", "<", "#", "<=", "1"}], ")"}]}], "&"}], "]"}],
                     "|", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rm_", ",", "rM_"}], "}"}], "/;", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0", "<", "rm", "<", "1"}], "&&", 
                    RowBox[{"rm", "<", "rM", "<=", "1"}]}], ")"}]}], "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Floor", "/@", 
                    RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"o", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}]}], ")"}]}], 
                    ")"}]}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Spacings", "[", "i_", "]"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"R", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"i", "*", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"R", "/", "i"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"o_", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ")"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}], ")"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"n2_Integer", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n2", "->", "l_"}], ")"}], ":>", "l"}]}], "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "}"}], "|", 
                    RowBox[{"{", "All", "}"}]}], ")"}], "->", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"o", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"r_", "/;", 
                    RowBox[{"0", "<", "r", "<=", "1"}]}], "]"}], "|", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rm_", ",", "rM_"}], "}"}], "/;", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0", "<", "rm", "<", "1"}], "&&", 
                    RowBox[{"rm", "<", "rM", "<=", "1"}]}], ")"}]}], "]"}]}], 
                    "}"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Floor", "/@", 
                    RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"o", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}]}], "}"}]}], ")"}]}], 
                    ")"}]}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Spacings", "[", "i_", "]"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"R", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"i", "*", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"R", "/", "i"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"c_", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "c", "}"}]}], "]"}], "]"}]}]}], "}"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}]}]}], "]"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{
              RowBox[{"choices", "/.", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<Radial\>\"", "->", "1"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"\"\<Azimuthal\>\"", "->", "2"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"\"\<Polar\>\"", "->", "3"}]}], "}"}]}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"i2", ":", 
                    RowBox[{"(", 
                    RowBox[{"1", "|", "2", "|", "3"}], ")"}]}], "->", "x_"}], 
                  ")"}], ":>", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"selection", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], "=", 
                   RowBox[{"repPattern", "[", 
                    RowBox[{"i2", ",", "x"}], "]"}]}], ")"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"c", ":", 
                  RowBox[{"(", 
                   RowBox[{"1", "|", "2", "|", "3"}], ")"}]}], ":>", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"selection", "[", 
                    RowBox[{"[", "c", "]"}], "]"}], "=", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}], ")"}]}]}], "\n", 
               "\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t\t\t", "]"}], 
          ";", "\n", "\t\t\t\t", 
          RowBox[{"selection", "=", "\n", "\t\t\t\t\t", 
           RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Intersection", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "/.", 
                 RowBox[{
                  RowBox[{"{", "}"}], "->", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Max", "@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "]"}]}], 
                   "]"}]}]}], ")"}]}], "&"}], ",", "\n", "\t\t\t\t\t\t", 
             "selection"}], "]"}]}], ";", "\n", "\t\t\t\t", 
          RowBox[{"selection", "=", "\n", "\t\t\t\t\t", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "[", 
               RowBox[{"[", "#2", "]"}], "]"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"ordering", ",", "selection"}], "}"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"cutOff", "[", "#1", "]"}], "=!=", "False"}], ")"}],
                 " ", "&&", "\n", "\t\t\t\t\t\t", 
                RowBox[{"AllTrue", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", "3", "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l", "=", "#2"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"selection", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                    RowBox[{"l", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], " ", "]"}], "&"}]}], 
                   "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                 "]"}]}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Opacity", "[", "op", "]"}], ",", 
                 RowBox[{"F", "[", "#1", "]"}], ",", 
                 RowBox[{"function", "[", 
                  RowBox[{
                   RowBox[{"sph2orth", "@@", "#2"}], ",", "size"}], "]"}]}], 
                "}"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"{", "}"}]}], "]"}], "&"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"A", ",", "X"}], "}"}]}], "]"}]}]}], "\n", "\t\t\t\t", 
        "]"}]}], ";", "\n", "\t\t\t", "pointF"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6998042241991673`*^9, 3.699804248908592*^9}, {
   3.699804531759091*^9, 3.699804629285263*^9}, {3.699808585186626*^9, 
   3.699808586001399*^9}, {3.699810298016336*^9, 3.699810302948022*^9}, 
   3.699814402313725*^9, {3.699816084530374*^9, 3.699816086529224*^9}, 
   3.699824858691826*^9, 
   3.6998249224234943`*^9},ExpressionUUID->"498fadcc-04aa-42a4-b98b-\
f4c7468e96a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["GenerateBlobPotential", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6998040444054823`*^9, 3.699804050324006*^9}, {
  3.699808791262384*^9, 
  3.699808792260297*^9}},ExpressionUUID->"49a9d395-563a-4fe3-b6fa-\
6344dbecaaf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenerateBlobPotential", "[", 
    RowBox[{
    "Gridpoints_", ",", "rGrid_", ",", "fGrid_", ",", "qGrid_", ",", 
     "DefaultCutoff_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"blobF", "=", 
        RowBox[{"Unique", "[", 
         RowBox[{"$cont", "<>", "\"\<blobF\>\""}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"pointF", "=", "\n", "\t\t\t", 
        RowBox[{"GeneratePointPotential", "[", "\n", "\t\t\t\t", 
         RowBox[{
         "Gridpoints", ",", "rGrid", ",", "fGrid", ",", "qGrid", ",", "\n", 
          "\t\t\t\t", "DefaultCutoff", ",", ".2"}], "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"SetAttributes", "[", 
       RowBox[{"blobF", ",", "Temporary"}], "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"blobF", "[", 
        RowBox[{"A_", ",", "F_", ",", 
         RowBox[{"X_:", "Gridpoints"}], ",", 
         RowBox[{"mode_:", "All"}], ",", 
         RowBox[{"cutOff_:", "DefaultCutoff"}]}], "]"}], ":=", "\n", "\t", 
       "\t", "\t", 
       RowBox[{"pointF", "[", 
        RowBox[{
        "A", ",", "F", ",", "X", ",", "rGrid", ",", "fGrid", ",", "qGrid", 
         ",", "mode", ",", "\n", "\t", "\t", "\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Point", "[", "#1", "]"}], ",", 
             RowBox[{"PointSize", "[", "#2", "]"}]}], "}"}], "&"}], ")"}], 
         ",", "cutOff", ",", ".1", ",", ".2"}], "]"}]}], ";", "\n", "\t\t", 
      "blobF"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699809238810467*^9, 3.699809376260984*^9}, {
  3.699810311625511*^9, 
  3.699810314858677*^9}},ExpressionUUID->"ffaa5d30-8adb-46e2-9268-\
f423c93249fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["GenerateLinePotential", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6998040444054823`*^9, 
  3.699804050324006*^9}},ExpressionUUID->"cfdba86a-1d51-4892-b4cd-\
ab7adb5d01f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GenerateLinePotentialFunction", "[", "\n", "\t", 
    RowBox[{
    "Gridpoints_", ",", "rGrid_", ",", "fGrid_", ",", "qGrid_", ",", "\n", 
     "\t", "DefaultCutoff_", ",", "DefaultSize_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"lineF", "=", 
        RowBox[{"Unique", "[", 
         RowBox[{"$cont", "<>", "\"\<lineF\>\""}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"sph2orth", "=", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"CoordinateTransform", "[", 
           RowBox[{
            RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "]"}], 
         "&"}]}], ",", "\n", "\t\t", 
       RowBox[{"splineCircle", "=", "\n", "\t\t\t", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "r", ",", "angles"}], "}"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", "=", "\n", "\t", "\t", "\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"angles", "//", "N"}], ",", 
                  RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", "\n", "\t", "\t",
                 "\t\t\t\t", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s_", ",", "e_"}], "}"}], "/;", 
                   RowBox[{"e", "<=", "s"}]}], ")"}], ":>", "\n", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", 
                   RowBox[{"e", "+", 
                    RowBox[{"2", "\[Pi]"}]}]}], "}"}]}]}], "\n", "\t", "\t", 
               "\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t", "\t", "\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t", 
               RowBox[{
                RowBox[{"seg", "=", "\n", "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "4"}], 
                   ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", "3", ",", "\n", 
                   "\t", "\t", "\t", "\t", "\t\t\t\t", 
                   RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "]"}]}], ",", 
                "\n", "\t", "\t", "\t", "\t\t\t", 
                RowBox[{"\[Phi]", "=", "\n", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "4"}], 
                   ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{"\[Pi]", "/", "2"}], ",", "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "\n", "\t", "\t", 
                  "\t", "\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", "\t", 
               "\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", "\t\t\t", 
              RowBox[{"BSplineCurve", "[", "\n", "\t", "\t", "\t", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"m", "+", "#"}], "&"}], "/@", "\n", "\t", "\t", 
                 "\t", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",",
                     "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "Identity", ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "@", "#"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}], "&"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t", "]"}],
                   "@", 
                  RowBox[{"Dot", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"r", "*", 
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"First", "@", "angles"}], "]"}]}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{
                    "Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", "seg"}], "+", "1"}]}], "]"}], ",", "\n",
                     "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"seg", " ", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}], "&"}], "/@", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "}"}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    "}"}]}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    "]"}]}]}], "]"}]}]}], ",", "\n", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"SplineDegree", "->", "2"}], ",", "\n", "\t", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"SplineKnots", "->", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\n", "\t",
                    "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Riffle", "[", 
                    RowBox[{"#", ",", "#"}], "]"}], "&"}], "@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"seg", "+", "1"}], "]"}]}], ",", "\n", "\t", "\t",
                    "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"seg", "+", "1"}], "}"}]}], "]"}]}], ",", "\n", 
                "\t", "\t", "\t\t\t\t\t", 
                RowBox[{
                "SplineWeights", "->", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"2", " ", "seg"}], "+", "1"}]}], "]"}], ",", "\n",
                    "\t", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}], ",", "1"}], "}"}]}], 
                  "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
               "\t", "\t", "\t\t\t\t\t\t", "\n", "\t", "\t", "\t\t\t\t\t", 
               "]"}]}], "\n", "\t", "\t", "\t\t\t\t", "]"}]}], "\n", "\t", 
           "\t", "\t\t\t", "]"}]}], "\n", "\t", "\t", "\t\t", "]"}]}]}], "\n",
       "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"SetAttributes", "[", 
       RowBox[{"lineF", ",", "Temporary"}], "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"lineF", "[", 
        RowBox[{"A_", ",", "F_", ",", "\n", "\t\t\t", 
         RowBox[{"X_:", "Gridpoints"}], ",", 
         RowBox[{"rX_:", "rGrid"}], ",", 
         RowBox[{"\[Phi]X_:", "fGrid"}], ",", 
         RowBox[{"\[Theta]X_:", "qGrid"}], ",", "\n", "\t\t\t", 
         RowBox[{"mode_:", "All"}], ",", 
         RowBox[{"function_:", "Line"}], ",", 
         RowBox[{"cutOff_:", "DefaultCutoff"}], ",", 
         RowBox[{"op_:", "1"}], ",", "\n", "\t\t\t", 
         RowBox[{"size_:", "DefaultSize"}]}], "]"}], ":=", "\n", "\t\t\t\t", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"switchPattern", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "2"}], ",", 
              RowBox[{"-", "2"}], ",", 
              RowBox[{"-", "3"}], ",", 
              RowBox[{"-", "3"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]}], ",", 
           RowBox[{"choices", "=", "mode"}], ",", 
           RowBox[{"points", "=", "False"}], ",", "\n", "\t\t\t\t\t", 
           "basecount", ",", "ordering", ",", "selection", ",", "lengths", 
           ",", "angles"}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"ordering", "=", 
           RowBox[{"{", 
            RowBox[{"rX", ",", " ", "\[Phi]X", ",", 
             RowBox[{"Sort", "@", "\[Theta]X"}]}], "}"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"lengths", "=", 
           RowBox[{"Length", "/@", "ordering"}]}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{"angles", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"\[Pi]", "/", 
               RowBox[{"lengths", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
             RowBox[{"\[Pi]", "/", 
              RowBox[{"lengths", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{"choices", ",", 
              RowBox[{"Except", "[", 
               RowBox[{
               "_List", "|", "_Integer", "|", "_String", "|", "_Rule"}], 
               "]"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"choices", "=", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Points\>\"", ",", "\"\<Radial\>\"", ",", 
               "\"\<Azimuthal\>\"", ",", "\"\<Polar\>\""}], "}"}]}]}], "\n", 
           "\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{"selection", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], "}"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"repPattern", "=", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", "v"}], "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"y", "=", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"v", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"_Integer", ":>", 
                    RowBox[{"Range", "[", "v", "]"}]}], ",", 
                    RowBox[{"_List", ":>", "v"}], ",", 
                    RowBox[{"_", ":>", 
                    RowBox[{"{", "v", "}"}]}]}], "}"}]}], "]"}]}], "}"}], ",",
                   "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], "/.", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"n", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ReplaceAll", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    "_Integer", "|", "All", "|", "None", "|", "_Spacings", 
                    "|", "_Select"}]}], "]"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"l", ":", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ".."}], "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "None", ",", "___"}], "}"}], "->", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"o", ":", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"r_", "/;", 
                    RowBox[{"0", "<", "r", "<=", "1"}]}], "]"}], "|", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rm_", ",", "rM_"}], "}"}], "/;", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0", "<", "rm", "<", "1"}], "&&", 
                    RowBox[{"rm", "<", "rM", "<=", "1"}]}], ")"}]}], "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"Range", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Floor", "/@", 
                    RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"o", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}]}], ")"}]}], 
                    ")"}]}], ")"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Spacings", "[", "i_", "]"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"R", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"i", "*", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"R", "/", "i"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"o_", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ")"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "n2_Integer", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n2", "->", "l_"}], ")"}], ":>", "l"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "}"}], "|", 
                    RowBox[{"{", "All", "}"}]}], ")"}], "->", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"o", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"r_", "/;", 
                    RowBox[{"0", "<", "r", "<=", "1"}]}], "]"}], "|", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rm_", ",", "rM_"}], "}"}], "/;", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0", "<", "rm", "<", "1"}], "&&", 
                    RowBox[{"rm", "<", "rM", "<=", "1"}]}], ")"}]}], "]"}]}], 
                    "}"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "@@", 
                    RowBox[{"(", 
                    RowBox[{"Floor", "/@", 
                    RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"o", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}]}], "}"}]}], ")"}]}], 
                    ")"}]}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Spacings", "[", "i_", "]"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"R", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"i", "*", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"R", "/", "i"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"c_", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "n2", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "c", "}"}]}], "]"}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t",
                  "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{
              RowBox[{"choices", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Radial\>\"", "->", "1"}], ",", 
                 RowBox[{"\"\<Azimuthal\>\"", "->", "2"}], ",", 
                 RowBox[{"\"\<Polar\>\"", "->", "3"}]}], "}"}]}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"i2", ":", 
                    RowBox[{"(", 
                    RowBox[{"1", "|", "2", "|", "3"}], ")"}]}], "->", "x_"}], 
                  ")"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"selection", "[", 
                    RowBox[{"[", "i2", "]"}], "]"}], "=", 
                   RowBox[{"repPattern", "[", 
                    RowBox[{"i2", ",", "x"}], "]"}]}], ")"}]}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"c", ":", 
                  RowBox[{"(", 
                   RowBox[{"1", "|", "2", "|", "3"}], ")"}]}], ":>", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"selection", "[", 
                    RowBox[{"[", "c", "]"}], "]"}], "=", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "@", 
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", ")"}]}]}], "\n", "\t\t\t\t\t\t\t\t",
                "}"}]}], "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"points", "=", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"choices", ",", 
             RowBox[{"(", 
              RowBox[{"\"\<Points\>\"", "|", "0"}], ")"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"R", "=", 
              RowBox[{
               RowBox[{"Reap", "[", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Px", "=", "#1"}], ",", 
                    RowBox[{"r", "=", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"f", "=", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"q", "=", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                    RowBox[{"x", "=", 
                    RowBox[{"sph2orth", "@@", "#2"}]}], ",", 
                    RowBox[{"tx", "=", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}]}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cutOff", "[", "Px", "]"}], "=!=", "False"}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", 
                    "p6", ",", 
                    RowBox[{"counter", "=", "1"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"p1", "=", 
                    RowBox[{"tx", "+", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ";", 
                    RowBox[{"p2", "=", 
                    RowBox[{"tx", "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], ";", 
                    RowBox[{"p3", "=", 
                    RowBox[{"tx", "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"p4", "=", 
                    RowBox[{"tx", "-", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ";", 
                    RowBox[{"p5", "=", 
                    RowBox[{"tx", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], ";", 
                    RowBox[{"p6", "=", 
                    RowBox[{"tx", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", 
                    RowBox[{"lengths", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                    RowBox[{"lengths", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", 
                    RowBox[{"lengths", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"p3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                    RowBox[{"lengths", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
                    RowBox[{
                    RowBox[{"p4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"p6", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "==", "0"}], ",", 
                    RowBox[{
                    RowBox[{"p6", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{"points", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sow", "@", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"F", "[", "Px", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"PointSize", "[", 
                    RowBox[{"Switch", "[", 
                    RowBox[{"size", ",", 
                    RowBox[{"_", "?", "NumberQ"}], ",", 
                    RowBox[{"size", "+", ".05"}], ",", "_", ",", "size"}], 
                    "]"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Point", "[", "x", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Do", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"reps", "=", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"1", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"y", "=", 
                    RowBox[{"sph2orth", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ordering", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ")"}]}]}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cp", "=", 
                    RowBox[{"x", "+", 
                    RowBox[{
                    RowBox[{"Normalize", "[", 
                    RowBox[{"y", "-", "x"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"y", "-", "x"}], "]"}], "/", "2"}]}]}]}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thickness", "[", "size", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Opacity", "[", "op", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"F", "[", "Px", "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "cp"}], "}"}], "]"}]}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"2", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "y", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "splineCircle", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Norm", "@", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "=", 
                    RowBox[{"angles", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"n", "=", 
                    RowBox[{"tx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"m", "=", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"{", 
                    RowBox[{"f", ",", 
                    RowBox[{"f", "+", 
                    RowBox[{
                    RowBox[{"a", "/", "2"}], "*", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"m", "-", "n"}], "]"}]}]}]}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "}"}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thickness", "[", "size", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Opacity", "[", "op", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"F", "[", "Px", "]"}], ",", "y"}], "}"}]}], "}"}],
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"3", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"y", "=", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "splineCircle", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "r", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"q", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                    RowBox[{"tx", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", 
                    RowBox[{
                    RowBox[{"angles", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "2"}]}]}]}], 
                    "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "]"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"r1", "=", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"GeometricTransformation", "[", 
                    RowBox[{
                    "#", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"RotationTransform", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], "/", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", ")"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"r2", "=", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"GeometricTransformation", "[", 
                    RowBox[{
                    "#", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    "RotationTransform", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"f", "-", 
                    RowBox[{
                    RowBox[{"angles", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"lengths", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "4"}]}]}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", ")"}]}]}],
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sow", "[", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"CapForm", "[", "\"\<Butt\>\"", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thickness", "[", "size", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Opacity", "[", "op", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"F", "[", "Px", "]"}], ",", 
                    RowBox[{"r2", "[", 
                    RowBox[{"r1", "[", "y", "]"}], "]"}]}], "}"}]}], "}"}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "}"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"p", "!=", "tx"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"AllTrue", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "3", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"selection", "[", 
                    RowBox[{"[", 
                    RowBox[{"counter", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"counter", ",", "reps"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"counter", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"++", "counter"}], ",", "3", ",", "1"}], "]"}]}], 
                    ";"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", 
                    "p6"}], "}"}]}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t",
                     "]"}], "&"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", "X"}], "}"}]}], "\n", "\t", 
                  "\t\t\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t\t\t", "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "\n", "\t\t\t\t\t", "}"}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "R"}], ">", "0"}], ",", 
              RowBox[{"R", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "R"}], "]"}]}], "\n", 
           "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
      "\t\t", "lineF"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699804053081524*^9, 3.6998042114067574`*^9}, {
   3.699804664966494*^9, 3.699804681100938*^9}, {3.699808472890674*^9, 
   3.699808531134697*^9}, 3.69980916253827*^9, {3.6998103224410267`*^9, 
   3.6998103250208597`*^9}, {3.6998134149161167`*^9, 3.699813422816935*^9}, {
   3.6998143625265102`*^9, 3.6998143716006823`*^9}, {3.699816093556761*^9, 
   3.699816095397463*^9}, 3.6998248587241497`*^9, 
   3.699824922454108*^9},ExpressionUUID->"2b5f70ce-7f51-4c9e-ae2b-\
abf17c5adb3c"]
}, Closed]],

Cell[CellGroupData[{

Cell["GenerateBlendPotential", "CodeSubsubsubsection",
 CellChangeTimes->{{3.6998040444054823`*^9, 3.699804050324006*^9}, {
  3.699808801781719*^9, 3.699808803003961*^9}, {3.699809037526896*^9, 
  3.6998090391726713`*^9}},ExpressionUUID->"e1311cbc-5af0-4c2a-bf64-\
116584b5b46d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateBlendPotentialFuncion", "[", 
   RowBox[{
   "Gridpoints_", ",", "\n", "\t", "rGrid_", ",", "fGrid_", ",", "qGrid_", 
    ",", "\n", "\t", "DefaultCutoff_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"blendF", "=", 
       RowBox[{"Unique", "[", 
        RowBox[{"$cont", "<>", "\"\<blendF\>\""}], "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"lineF", "=", "\n", "\t\t\t", 
       RowBox[{"GenerateLinePotentialFunction", "[", "\n", "\t\t\t\t", 
        RowBox[{
        "Gridpoints", ",", "rGrid", ",", "fGrid", ",", "qGrid", ",", "\n", 
         "\t\t\t\t", "DefaultCutoff", ",", ".01"}], "]"}]}]}], "\n", "\t\t", 
     "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"SetAttributes", "[", 
      RowBox[{"blendF", ",", "Temporary"}], "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"blendF", "[", 
       RowBox[{"A_", ",", "F_", ",", "\n", "\t\t\t", 
        RowBox[{"X_:", "Gridpoints"}], ",", 
        RowBox[{"rX_:", "rGrid"}], ",", 
        RowBox[{"\[Phi]X_:", "fGrid"}], ",", 
        RowBox[{"\[Theta]X_:", "qGrid"}], ",", "\n", "\t\t\t", 
        RowBox[{"mode_:", "All"}], ",", 
        RowBox[{"function_:", "Line"}], ",", 
        RowBox[{"cutOff_:", "DefaultCutoff"}]}], "]"}], ":=", "\n", 
      "\t\t\t\t", 
      RowBox[{"lineF", "[", 
       RowBox[{
       "A", ",", "F", ",", "X", ",", "rX", ",", "\[Phi]X", ",", "\[Theta]X", 
        ",", "mode", ",", "function", ",", "cutOff", ",", "1", ",", ".01"}], 
       "]"}]}], ";", "\n", "\t\t", "blendF"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6998090565593033`*^9, 3.699809194523193*^9}, {
  3.69981033339285*^9, 
  3.699810336348052*^9}},ExpressionUUID->"8d22f45e-59f2-492b-ba55-\
66d31264fce3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Main", "CodeSubsubsubsection",
 CellChangeTimes->{{3.699804068830165*^9, 
  3.699804069235384*^9}},ExpressionUUID->"35a01ecb-c9cd-44f6-b8a6-\
2bef6704e963"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SphericalDVRPotentialObjectFunction", "[", 
   RowBox[{"Gridpoints_", ",", "PotentialArray_", ",", "\n", "\t\t", 
    RowBox[{"radialGridpoints_:", "None"}], ",", 
    RowBox[{"angularGridpoints_:", "None"}], ",", 
    RowBox[{"azimuthalGridpoints_:", "None"}], ",", "\n", "\t\t", 
    RowBox[{"DefaultDrawMode_:", "Point"}], ",", 
    RowBox[{"DefaultColorFunction_:", "\"\<FuschiaTones\>\""}], ",", "\n", 
    "\t\t", 
    RowBox[{"DefaultSize_:", "Small"}], ",", 
    RowBox[{"DefaultMode_:", "All"}], ",", 
    RowBox[{"DefaultCutoff_:", 
     RowBox[{"(", 
      RowBox[{"True", "&"}], ")"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"PotentialGraphics", ",", "\n", "\t\t\t", 
      RowBox[{"rGrid", "=", "radialGridpoints"}], ",", 
      RowBox[{"fGrid", "=", "angularGridpoints"}], ",", 
      RowBox[{"qGrid", "=", "azimuthalGridpoints"}]}], "}"}], ",", "\n", 
    "\t\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rGrid", "==", "None"}], ",", 
       RowBox[{"rGrid", "=", 
        RowBox[{"Gridpoints", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"fGrid", "==", "None"}], ",", 
       RowBox[{"fGrid", "=", 
        RowBox[{"Gridpoints", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"qGrid", "==", "None"}], ",", 
       RowBox[{"qGrid", "=", 
        RowBox[{"Gridpoints", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], "]"}], ";", "\n", 
     "\t\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"pointF", "=", "\n", "\t\t\t\t\t", 
          RowBox[{
          "GeneratePointPotentialFunction", "[", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
           "Gridpoints", ",", "rGrid", ",", "fGrid", ",", "qGrid", ",", "\n", 
            "\t", "\t", "\t\t\t\t", "DefaultCutoff", ",", "DefaultSize"}], 
           "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"blobF", "=", "\n", "\t\t\t\t\t", 
          RowBox[{
          "GenerateBlobPotentialFunction", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "Gridpoints", ",", "rGrid", ",", "fGrid", ",", "qGrid", ",", "\n", 
            "\t\t\t\t\t\t", "DefaultCutoff"}], "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"lineF", "=", "\n", "\t\t\t\t\t", 
          RowBox[{
          "GenerateLinePotentialFunction", "[", "\t\t\t", "\n", "\t", 
           "\t\t\t\t\t", 
           RowBox[{
           "Gridpoints", ",", "rGrid", ",", "fGrid", ",", "qGrid", ",", "\n", 
            "\t", "\t", "\t\t\t\t", "DefaultCutoff", ",", "DefaultSize"}], 
           "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"blendF", "=", "\n", "\t\t\t\t\t", 
          RowBox[{
          "GeneratBlendPotentialFunction", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "Gridpoints", ",", "rGrid", ",", "fGrid", ",", "qGrid", ",", "\n", 
            "\t\t\t\t\t\t", "DefaultCutoff"}], "]"}]}]}], "\n", "\t\t\t\t", 
        "}"}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"PotentialGraphics", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"X_:", "Gridpoints"}], ",", 
          RowBox[{"V_:", "PotentialArray"}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"FP_:", "DefaultDrawMode"}], ",", 
          RowBox[{"potCo_:", "DefaultColorFunction"}], ",", "\n", "\t", 
          "\t\t\t\t", 
          RowBox[{"rX_:", "rGrid"}], ",", 
          RowBox[{"fX_:", "fGrid"}], ",", 
          RowBox[{"qX_:", "qGrid"}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"mode_:", "DefaultMode"}], ",", 
          RowBox[{"cutOffFunction_:", "DefaultCutoff"}]}], "]"}], ":=", "\n", 
        "\t", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"FP", ",", 
            RowBox[{"False", "|", "None"}]}], "]"}], ",", "\n", "\t", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"Null", ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"A", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatrixQ", "@", "V"}], ",", 
                 RowBox[{"Diagonal", "[", "V", "]"}], ",", "V"}], "]"}]}], 
              ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"R", "=", 
               RowBox[{"MinMax", "@", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatrixQ", "@", "V"}], ",", 
                  RowBox[{"Diagonal", "[", "V", "]"}], ",", "V"}], "]"}]}]}], 
              ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"potF", "=", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{"potCo", ",", 
                 RowBox[{
                  RowBox[{"_String", "|", "_List"}], "\[RuleDelayed]", 
                  RowBox[{"ColorData", "[", "potCo", "]"}]}]}], "]"}]}]}], 
             "\n", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
            "\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"BarLegend", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"potF", "@", 
                   RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", "R"}], "]"}]}], "&"}], ",", "R"}], 
                "}"}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{"FP", ",", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Point", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"pointF", "[", 
                    RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{"potF", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", "R"}], "]"}]}], "&"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "X", ",", "rX", ",", "fX", ",", 
                    "qX", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "mode", 
                    ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Point", "[", "#1", "]"}], ",", 
                    RowBox[{"PointSize", "[", "#2", "]"}]}], "}"}], "&"}], 
                    ")"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    "cutOffFunction"}], "]"}]}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Line", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"lineF", "[", 
                    RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{"potF", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", "R"}], "]"}]}], "&"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "X", ",", "rX", ",", "fX", ",", 
                    "qX", ",", "mode", ",", "Line", ",", "cutOffFunction"}], 
                    "]"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Blend", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"blendF", "[", 
                    RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{"potF", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", "R"}], "]"}]}], "&"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "X", ",", "rX", ",", "fX", ",", 
                    "qX", ",", "mode", ",", "Line", ",", "cutOffFunction"}], 
                    "]"}]}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                  "\"\<Blobby\>\"", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"blobF", "[", 
                    RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{"potF", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", "R"}], "]"}]}], "&"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "X", ",", "rX", ",", "fX", ",", 
                    "qX", ",", "mode", ",", "cutOffFunction"}], "]"}]}], ",", 
                  "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Point", ",", "f_"}], "}"}], ":>", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"pointF", "[", 
                    RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{"potF", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", "R"}], "]"}]}], "&"}], ",", "X", ",", 
                    "rX", ",", "fX", ",", "qX", ",", "mode", ",", "f", ",", 
                    "cutOffFunction"}], "]"}]}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"f_", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"f", "[", 
                    RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{"potF", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", "R"}], "]"}]}], "&"}], ",", "X", ",", 
                    "rX", ",", "fX", ",", "qX", ",", "mode", ",", 
                    "cutOffFunction"}], "]"}]}]}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t", 
             "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t", "\t\t\t\t\t", 
         "]"}]}]}], "\n", "\t", "\t\t\t\t", "]"}], ";", "\n", "\t\t", 
     "PotentialGraphics"}]}], "\t\t", "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699238584749978*^9, 3.699238640873135*^9}, {
   3.699746797832932*^9, 3.699746848676927*^9}, {3.69974689694827*^9, 
   3.699746902259396*^9}, {3.699802151326085*^9, 3.69980215315703*^9}, {
   3.6998022487282543`*^9, 3.699802398905613*^9}, {3.699802431057301*^9, 
   3.699802633261031*^9}, {3.699802712554421*^9, 3.699802863229649*^9}, {
   3.699802905052628*^9, 3.699802905088684*^9}, {3.699802959482093*^9, 
   3.699803865067048*^9}, {3.699803955881019*^9, 3.699803982919343*^9}, {
   3.699804015558515*^9, 3.699804033423492*^9}, 3.699804236719016*^9, {
   3.699804583578835*^9, 3.699804584834149*^9}, {3.699808618161707*^9, 
   3.699808623262752*^9}, {3.699808657517517*^9, 3.699808778419413*^9}, {
   3.699809424889333*^9, 3.699809526435746*^9}, {3.699809557149274*^9, 
   3.6998099632186832`*^9}, {3.699809999890642*^9, 
   3.6998102427770147`*^9}},ExpressionUUID->"18912a29-daba-43e4-9ecb-\
3a2e25f3132e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Graphics Code", \
"Subsubsection",ExpressionUUID->"6f4f459b-f9ea-41da-916a-00f14f94493c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"splineCircle", "::", "usage"}], "=", 
  "\"\<Constructs a circle based on spline points. Comes from StackOverflow\>\
\""}], "\n", 
 RowBox[{
  RowBox[{"VariableSetBar", "::", "usage"}], "=", 
  "\"\<A SetterBar which has a paired slider so that it can display many \
values compactly\>\""}], "\n", 
 RowBox[{
  RowBox[{"LabeledInterval", "::", "usage"}], "=", 
  "\"\<An IntervalSlider with editable label\>\""}]}], \
"CodeInput",ExpressionUUID->"2592e970-59f1-4a76-a6a3-066b0b832854"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`graphicsStuff`\>\"", "]"}], 
  ";"}]], "CodeInput",ExpressionUUID->"7c5bf580-d222-4ca8-aad6-caf38cb5fb0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "splineCircle", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"splineCircle", "[", 
   RowBox[{"m_List", ",", "r_", ",", 
    RowBox[{"angles_List:", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "seg", ",", "\[Phi]", ",", "start", ",", "end", ",", "pts", ",", "w", 
       ",", "k"}], "}"}], ",", "\n", "\t", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"start", ",", "end"}], "}"}], "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"angles", "//", "N"}], ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], ";", "\n", "\t", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"end", "<=", "start"}], ",", 
        RowBox[{"end", "+=", 
         RowBox[{"2", " ", "\[Pi]"}]}]}], "]"}], ";", "\n", "\t", "\t", 
      RowBox[{"seg", "=", 
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"end", "-", "start"}], "//", "N"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", "\n", "\t", "\t", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"end", "-", "start"}], "//", "N"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", "\n", "\t", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"seg", "==", "4"}], ",", 
        RowBox[{
         RowBox[{"seg", "=", "3"}], ";", 
         RowBox[{"\[Phi]", "=", 
          RowBox[{"\[Pi]", "/", "2"}]}]}]}], "]"}], ";", "\n", "\t", "\t", 
      RowBox[{"pts", "=", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "*", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", "start", "]"}], ".", "#"}]}], "&"}],
         "/@", "\n", "\t", "\t\t", 
        RowBox[{"Join", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\n", "\t", 
            "\t\t\t\t", 
            RowBox[{
             RowBox[{"2", "*", "seg"}], "+", "1"}]}], "]"}], ",", "\n", "\t", 
          "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"seg", " ", 
               RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}], "&"}], "/@", 
           
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], "}"}]}]}], 
         "]"}]}]}], ";", "\n", "\t", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "m", "]"}], "==", "2"}], ",", "\n", "\t", 
        "\t\t", 
        RowBox[{"pts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "+", "#"}], "&"}], "/@", "pts"}]}], ",", "\n", "\t", 
        "\t\t", 
        RowBox[{"pts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "+", "#"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "pts", "]"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", "pts", "]"}]}], "]"}]}], "]"}], 
           "]"}]}]}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"w", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1"}], "}"}], ",", 
           RowBox[{
            RowBox[{"2", " ", "seg"}], "+", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "/", "2"}], "]"}], ",", "1"}], "}"}]}], "]"}]}],
       ";", "\n", "\t", "\t", 
      RowBox[{"k", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{"#", ",", "#"}], "]"}], "&"}], "@", 
          RowBox[{"Range", "[", 
           RowBox[{"seg", "+", "1"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"seg", "+", "1"}], "}"}]}], "]"}]}], ";", "\n", "\t", "\t", 
      
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"pts", ",", 
        RowBox[{"SplineDegree", "->", "2"}], ",", 
        RowBox[{"SplineKnots", "->", "k"}], ",", 
        RowBox[{"SplineWeights", "->", "w"}]}], "]"}]}]}], "\n", "\t", "\t", 
    "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "m", "]"}], "==", "2"}], "||", 
    RowBox[{
     RowBox[{"Length", "[", "m", "]"}], "==", "3"}]}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.6998047300055656`*^9, 
  3.699804826256802*^9}},ExpressionUUID->"29c9db6c-7a8b-4902-9337-\
5b84a2b75523"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "LabeledInterval", "]"}], "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{
      RowBox[{"Options", "@", "IntervalSlider"}], ",", "\n", "\t", 
      RowBox[{"Options", "@", "Labeled"}], ",", "\n", "\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"Options", "@", "InputField"}], ",", 
        RowBox[{"Except", "[", "FieldSize", "]"}]}], "]"}], ",", "\n", "\t", 
      RowBox[{"FieldSize", "->", "3"}]}], "\n", "\t", "}"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"LabeledInterval", ",", "HoldFirst"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"LabeledInterval", "[", 
   RowBox[{"dynamicVar_", ",", "variableRange_List", ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"labelpos__", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "=!=", "Rule"}], "&"}], ")"}]}], 
      "|", "___"}], ")"}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"DynamicModule", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sl", ",", "lab", ",", "f1", ",", "f2", ",", "dynamset", ",", 
      RowBox[{"variable", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "@", "dynamicVar"}], "===", "Dynamic"}], ",", 
         "dynamicVar", ",", 
         RowBox[{"Dynamic", "@", "dynamicVar"}]}], "]"}]}]}], "}"}], ",", 
    "\n", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"dynamset", "[", 
       RowBox[{"var_Dynamic", ",", "val_", ",", 
        RowBox[{"part__:", "None"}]}], "]"}], ":=", "\n", "\t\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hp", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Dynamic", "=", "HoldPattern"}], "}"}], ",", "var"}], 
           "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"part", "===", "None"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Set", "[", 
           RowBox[{"hp", ",", "val"}], "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "=", 
              RowBox[{"ReleaseHold", "@", "hp"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"v", ",", "part"}], "]"}], "=", "val"}], ";", 
             RowBox[{"hp", "=", "v"}]}]}], "]"}]}], "\n", "\t\t\t\t", "]"}]}],
        "\n", "\t\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"sl", "=", 
      RowBox[{"IntervalSlider", "[", 
       RowBox[{"variable", ",", 
        RowBox[{"variableRange", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"Min", "@", 
            RowBox[{"{", 
             RowBox[{"3", ",", 
              RowBox[{"Length", "@", "variableRange"}]}], "}"}]}]}], "]"}], 
         "]"}], ",", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", 
          RowBox[{"Options", "@", "IntervalSlider"}]}], "]"}]}], "]"}]}], ";",
      "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "variableRange", "]"}], "<", "4"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"f1", "=", 
         RowBox[{
          RowBox[{"variableRange", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{".25", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"variableRange", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"variableRange", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", "\n", 
        "\t\t\t", 
        RowBox[{"f2", "=", 
         RowBox[{
          RowBox[{"variableRange", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{".25", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"variableRange", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"variableRange", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";"}], ",", "\n",
        "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"f1", ",", "f2"}], "}"}], "=", 
        RowBox[{"variableRange", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "\n", "\t\t", "]"}], ";", "\n", 
     "\t\t", 
     RowBox[{"lab", "=", 
      RowBox[{"Row", "[", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{
             RowBox[{"dynamicVar", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t\t", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", "v", "}"}], ",", 
               RowBox[{"dynamset", "[", 
                RowBox[{"variable", ",", "v", ",", "1"}], "]"}]}], "]"}]}], 
            "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"FieldSize", "->", 
            RowBox[{"OptionValue", "@", "FieldSize"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", 
             RowBox[{"Options", "[", "InputField", "]"}]}], "]"}]}], "]"}], 
         ",", "\n", "\t\t\t", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{
             RowBox[{"dynamicVar", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\n", "\t\t\t\t", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", "v", "}"}], ",", 
               RowBox[{"dynamset", "[", 
                RowBox[{"variable", ",", "v", ",", "2"}], "]"}]}], "]"}]}], 
            "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"FieldSize", "->", 
            RowBox[{"OptionValue", "@", "FieldSize"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", 
             RowBox[{"Options", "[", "InputField", "]"}]}], "]"}]}], "]"}]}], 
        "\n", "\t\t\t", "}"}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"Labeled", "[", 
      RowBox[{"sl", ",", "lab", ",", "labelpos", ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "@", "Labeled"}]}], "]"}]}], "]"}]}]}], "\n", 
   "\t", "]"}]}]}], \
"CodeInput",ExpressionUUID->"db0c1101-2508-4e27-b690-1d990d8f76e1"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<VariableSetBar\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "VariableSetBar", "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{"Options", "[", "SetterBar", "]"}], ",", 
      RowBox[{"Options", "[", "Animator", "]"}], ",", 
      RowBox[{"Context", "->", "Automatic"}], ",", 
      RowBox[{"RealVarName", "->", "Automatic"}], ",", "\n", 
      RowBox[{"AdjustmentRange", "->", "Automatic"}], ",", 
      RowBox[{"Choices", "->", "10"}], ",", 
      RowBox[{"\"\<SynchronousAdjustment\>\"", "->", "True"}]}], "}"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"VariableSetBar", ",", "HoldFirst"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vsbcontext", "=", "$Context"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"VariableSetBar", "[", 
   RowBox[{"variable_", ",", "variableRange_List", ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"(", "\n", "\t", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Begin", "[", "\"\<variableSetBarContext`\>\"", "]"}], ";"}], 
    "*)"}], "\n", "\t", 
   RowBox[{"(*", 
    RowBox[{"variableSetBarContext`dm", "="}], "*)"}], 
   RowBox[{"DynamicModule", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S1", ",", "S2", ",", "adjustrange", ",", "\n", "\t\t\t", 
       RowBox[{"varrange", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"OptionValue", "[", "Choices", "]"}]}], "}"}]}], ",", 
       RowBox[{"c", "=", "0"}], ",", "\n", "\t\t\t", "var", ",", "\n", 
       "\t\t\t", 
       RowBox[{"n", "=", 
        RowBox[{"variableRange", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "valchoices", ",", "setvar", 
       ",", "stringAssign", ",", "RET", ",", "\n", "\t\t\t", 
       RowBox[{"cont", "=", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Context", "]"}], ",", "\n", 
          "\t\t\t\t\t\t", "Automatic", ",", "$Context", ",", "\n", 
          "\t\t\t\t\t\t", "_", ",", 
          RowBox[{"OptionValue", "[", "Context", "]"}]}], "]"}]}]}], "\n", 
      "\t\t", "}"}], ",", "\n", "\t\t\t", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"adjustrange", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "AdjustmentRange", "]"}], ",", "\n", 
         "\t\t\t\t\t\t\t", "Automatic", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Head", "@", 
              RowBox[{"variableRange", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "==", "List"}], "//", 
            "TrueQ"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Max", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"variableRange", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
                 RowBox[{"OptionValue", "[", "Choices", "]"}]}], ",", "0"}], 
               "}"}], "]"}]}], "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"variableRange", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "-", 
              RowBox[{"OptionValue", "[", "Choices", "]"}]}]}], "}"}]}], "\n",
           "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
         "_Integer", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"OptionValue", "[", "AdjustmentRange", "]"}]}], "}"}], ",",
          "\n", "\t\t\t\t\t\t\t", "_", ",", 
         RowBox[{"OptionValue", "[", "AdjustmentRange", "]"}]}], "]"}]}], ";",
       "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"stringAssign", "[", 
        RowBox[{"strVar_", ",", "val_"}], "]"}], ":=", 
       RowBox[{"ToExpression", "@", 
        RowBox[{"(", 
         RowBox[{"strVar", "<>", "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "@", "val"}]}], ")"}]}]}], ";", "\n", "\t\t\t", 
      
      RowBox[{"SetAttributes", "[", 
       RowBox[{"stringAssign", ",", "HoldFirst"}], "]"}], ";", "\n", "\t\t\t", 
      RowBox[{"valchoices", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"variableRange", ",", "\n", "\t\t\t\t\t\t\t\t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_Integer", ",", "_Integer", ",", "_Integer"}], "}"}], 
           "|", 
           RowBox[{"{", 
            RowBox[{"_Integer", ",", "_Integer"}], "}"}]}], ")"}], ",", 
         RowBox[{"Range", "@@", "variableRange"}], ",", "\n", 
         "\t\t\t\t\t\t\t\t", "_", ",", "variableRange"}], "]"}]}], ";", "\n", 
      "\t\t\t", 
      RowBox[{
       RowBox[{"varrange", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "=", 
       RowBox[{"Min", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"varrange", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Length", "[", "valchoices", "]"}]}], "}"}]}]}], ";", "\n", 
      "\t\t\t", 
      RowBox[{"var", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "variable", "]"}], "==", "Dynamic"}], "//", 
          "TrueQ"}], ",", "\n", "\t\t\t\t\t", "variable", ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Dynamic", "[", "variable", "]"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], ";", "\n", "\t\t\t", 
      RowBox[{"S2", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<SynchronousAdjustment\>\"", "]"}], 
         ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Animator", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "c", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{"adjustrange", ",", "1"}], "]"}], ",", "4", ",", 
           RowBox[{"AnimationRunning", "->", "False"}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", 
             RowBox[{"Options", "[", "Animator", "]"}]}], "]"}]}], "]"}], ",",
          "\n", "\t\t\t\t\t", 
         RowBox[{"Slider", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "c", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{"adjustrange", ",", "1"}], "]"}]}], "]"}], ",", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", 
           RowBox[{"Options", "[", "Slider", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\n", "\t\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"setvar", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"ToString", "@", "var"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Dynamic[\>\"", "->", "\"\<\>\""}], ",", 
             RowBox[{"\"\<]\>\"", "->", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
        ";"}], "*)"}], "\n", "\t\t\t", 
      RowBox[{"S1", "=", 
       RowBox[{"Row", "[", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{"\"\<\[LeftArrow]\>\"", ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"ToExpression", "@", "setvar"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "-", "1"}], ">=", 
                RowBox[{
                 RowBox[{"adjustrange", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{"varrange", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
               RowBox[{"n", "+=", 
                RowBox[{"-", "1"}]}]}], "]"}], ";", "\n", "\t\t\t\t\t", 
             RowBox[{"stringAssign", "[", 
              RowBox[{"setvar", ",", "n"}], "]"}], ";", "\n", "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"n", "<", 
                RowBox[{"c", "+", 
                 RowBox[{"varrange", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
               RowBox[{"c", "+=", 
                RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"ImageSize", "->", 
             RowBox[{"{", 
              RowBox[{"Small", ",", "Medium"}], "}"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Appearance", "->", "\"\<Frameless\>\""}]}], "\n", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Dynamic", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
              "OptionValue", "[", "\"\<SynchronousAdjustment\>\"", "]"}], ",",
               "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Which", "[", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"n", "<=", 
                   RowBox[{"varrange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{"n", "=", 
                   RowBox[{
                    RowBox[{"varrange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"n", ">", 
                   RowBox[{
                    RowBox[{"adjustrange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"varrange", "[", 
                    RowBox[{"[", " ", "2", "]"}], "]"}]}]}], ",", 
                  RowBox[{"n", "=", 
                   RowBox[{
                    RowBox[{"adjustrange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"varrange", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ","}], "*)"}], "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"n", "<", 
                  RowBox[{"c", "+", 
                   RowBox[{"varrange", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"n", "+=", "1"}], ";", 
                  RowBox[{"stringAssign", "[", 
                   RowBox[{"setvar", ",", "n"}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"n", ">", 
                  RowBox[{"c", "+", 
                   RowBox[{"varrange", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"n", "+=", 
                   RowBox[{"-", "1"}]}], ";", 
                  RowBox[{"stringAssign", "[", 
                   RowBox[{"setvar", ",", "n"}], "]"}]}]}], "\n", 
                "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t", 
               RowBox[{"n", "=", 
                RowBox[{"ToExpression", "[", "setvar", "]"}]}]}]}], "\n", 
             "\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "@", "setvar"}], "==", "Symbol"}], ",", 
              RowBox[{"setvar", "=", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "@", "var"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\"\<Dynamic[\>\"", "->", "\"\<\>\""}], ",", 
                   RowBox[{"\"\<]\>\"", "->", "\"\<\>\""}]}], "}"}]}], 
                "]"}]}]}], "]"}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{"SetterBar", "[", 
             RowBox[{"var", ",", 
              RowBox[{"valchoices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"c", "+", " ", 
                  RowBox[{"varrange", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";;", 
                 RowBox[{"c", "+", 
                  RowBox[{"varrange", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "]"}], "]"}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"Appearance", "\[Rule]"}]}], "*)"}], ",", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", "ops", "}"}], ",", 
                RowBox[{"Options", "[", "SetterBar", "]"}]}], "]"}]}], 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<\[Rule]\>\"", ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"ToExpression", "@", "setvar"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "+", "1"}], "<=", 
                RowBox[{
                 RowBox[{"adjustrange", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"varrange", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}]}], ",", 
               RowBox[{"n", "+=", "1"}]}], "]"}], ";", "\n", "\t\t\t\t\t", 
             RowBox[{"stringAssign", "[", 
              RowBox[{"setvar", ",", "n"}], "]"}], ";", "\n", "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"n", ">", 
                RowBox[{"c", "+", 
                 RowBox[{"varrange", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}]}], ",", 
               RowBox[{"c", "+=", "1"}]}], "]"}]}], "\n", "\t\t\t\t\t", ",", 
            RowBox[{"ImageSize", "->", 
             RowBox[{"{", 
              RowBox[{"Small", ",", "Medium"}], "}"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Appearance", "->", "\"\<Frameless\>\""}]}], "\n", 
           "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "}"}], "]"}]}], ";", "\n",
       "\t\t", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{"S1", ",", "S2"}], "}"}], "]"}]}]}], "\n", "\t\t", "]"}], 
   RowBox[{"(*", 
    RowBox[{";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"End", "[", "]"}], "\n", "\t\t", "variableSetBarContext`dm"}]}],
     "*)"}], "\n", ")"}]}]}], "CodeInput",
 CellChangeTimes->{{3.699801745109708*^9, 
  3.6998017547880917`*^9}},ExpressionUUID->"c970a34f-6ecf-4579-ac25-\
c6ba11fc4115"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "CodeInput",ExpressionUUID->"8f77c6e6-9824-4e9f-b60c-7ce913613e1d"],

Cell[BoxData[{
 RowBox[{"VariableSetBar", "=", "`graphicsStuff`VariableSetBar"}], "\n", 
 RowBox[{"LabeledInterval", "=", "`graphicsStuff`LabeledInterval"}], "\n", 
 RowBox[{"splineCircle", "=", 
  "`graphicsStuff`splineCircle"}]}], \
"CodeInput",ExpressionUUID->"7c60ceee-69f2-4da8-9d1a-d5b4bbff1e6d"]
}, Closed]],

Cell[CellGroupData[{

Cell["DVR Plotting Function", \
"Subsubsection",ExpressionUUID->"f9222836-0c99-421c-bacb-e8b981d5f4fe"],

Cell["\<\
Takes the solutions, gridpoints, and the array of potential values to \
generate a plot of the solutions. The options are too numerous to document \
them all here.\
\>", "Text",ExpressionUUID->"3c8f0bc0-18e5-4c2e-97f9-e74c1318dbd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SphericalDVRPlot", "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{
      RowBox[{"\"\<PlotReturn\>\"", "->", "Manipulator"}], ",", "\n", "\t", 
      RowBox[{"Options", "[", "Manipulate", "]"}], ",", "\n", "\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"Options", "[", "Graphics3D", "]"}], ",", "\n", "\t\t", 
        RowBox[{"Except", "[", 
         RowBox[{"(", 
          RowBox[{
          "Axes", "|", "AxesOrigin", "|", "ImageSize", "|", "Boxed", "|", 
           "SphericalRegion", "|", "Ticks", "|", "Lighting"}], ")"}], "]"}]}],
        "]"}], ",", "\n", "\t", 
      RowBox[{"Lighting", "->", "\"\<Neutral\>\""}], ",", "\n", "\t", 
      RowBox[{"ImageSize", "->", 
       RowBox[{"{", 
        RowBox[{"350", ",", "350"}], "}"}]}], ",", "\n", "\t", 
      RowBox[{"Axes", "->", "True"}], ",", "\n", "\t", 
      RowBox[{"AxesOrigin", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "\n", "\t", 
      RowBox[{"Boxed", "->", "False"}], ",", "\n", "\t", 
      RowBox[{"SphericalRegion", "->", "True"}], ",", "\n", "\t", 
      RowBox[{"Ticks", "->", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None", ",", "None"}], "}"}]}], ",", "\n", 
      "\t", 
      RowBox[{"ColorFunction", "->", "\"\<Rainbow\>\""}], ",", "\n", "\t", 
      RowBox[{"\"\<PotentialColoring\>\"", "->", "\"\<TemperatureMap\>\""}], 
      ",", "\n", "\t", 
      RowBox[{"\"\<PotentialPointSize\>\"", "->", "Small"}], ",", "\n", "\t", 
      
      RowBox[{"\"\<EnergyDigits\>\"", "->", "3"}], ",", "\n", "\t", 
      RowBox[{"\"\<Interactivity\>\"", "->", "Normal"}], ",", "\n", "\t", 
      RowBox[{"\"\<PotentialMode\>\"", "->", "True"}], ",", "\n", "\t", 
      RowBox[{"\"\<PotentialCutOff\>\"", "->", 
       RowBox[{"(", 
        RowBox[{"True", "&"}], ")"}]}], ",", "\n", "\t", 
      RowBox[{"\"\<WavefunctionValueMin\>\"", "->", 
       RowBox[{"10", "^", 
        RowBox[{"-", "10"}]}]}], ",", "\n", "\t", 
      RowBox[{"\"\<SquareWavefunction\>\"", "->", "False"}], ",", "\n", "\t", 
      
      RowBox[{"Joined", "->", "True"}], ",", "\n", "\t", 
      RowBox[{"List", "->", "False"}], ",", "\n", "\t", 
      RowBox[{"\"\<WavefunctionPointSize\>\"", "->", "Normal"}], ",", "\n", 
      "\t", 
      RowBox[{"\"\<WavefunctionStyle\>\"", "->", "Point"}], ",", "\n", "\t", 
      RowBox[{"Opacity", "->", "1"}], ",", "\n", "\t", 
      RowBox[{"\"\<WavefunctionValueMax\>\"", "->", "Automatic"}], ",", "\n", 
      "\t", 
      RowBox[{"\"\<ManipulatorStep\>\"", "->", "Small"}], ",", "\n", "\t", 
      RowBox[{"\"\<WavefunctionSelection\>\"", "->", "All"}], ",", "\n", "\t", 
      RowBox[{"\"\<RadialPointSelection\>\"", "->", "All"}], ",", "\n", "\t", 
      
      RowBox[{"\"\<AzimuthalPointSelection\>\"", "->", "All"}], ",", "\n", 
      "\t", 
      RowBox[{"\"\<PolarPointSelection\>\"", "->", "All"}], ",", "\n", "\t", 
      RowBox[{"\"\<PotentialSelection\>\"", "->", "All"}], ",", "\n", "\t", 
      RowBox[{"\"\<ZeroPointEnergy\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
      "\t", 
      RowBox[{"Paneled", "->", "True"}], ",", "\n", "\t", 
      RowBox[{"Tooltip", "->", "True"}], ",", "\n", "\t", 
      RowBox[{"Verbose", "->", "False"}], ",", "\n", "\t", 
      RowBox[{"AddTo", "->", 
       RowBox[{"{", "}"}]}]}], "\n", "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SphericalDVRPlot", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"solutions", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"_", "?", "NumericQ"}], ")"}], ".."}], "}"}], ",", "_"}], 
        "}"}], "|", "None"}]}], ",", "\n", "\t", "gridpoints_List", ",", 
     RowBox[{"potential", ":", 
      RowBox[{"_List", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "wavefunctionPlotFunction", ",", "wavefunctionPlotWrapper", ",", "\n", 
       "\t\t\t", "potentialPlotObjectFunction", ",", 
       "potentialPlotObjectWrapper", ",", "\n", "\t\t\t", "rX", ",", 
       "\[Phi]X", ",", "\[Theta]X", ",", "\n", "\t\t\t", "X", ",", "T", ",", 
       "V", ",", "\[CapitalLambda]", ",", "\[CapitalPsi]", ",", "\[Psi]", ",",
        "axesThing", ",", "plotLab", ",", "\n", "\t\t\t", "waveSet", ",", 
       "wavePlot", ",", "potentialPlot", ",", "\n", "\t\t\t", 
       RowBox[{"maxProb", "=", 
        RowBox[{"OptionValue", "[", "\"\<WavefunctionValueMax\>\"", "]"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"Ec", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"-", "30"}]}], ",", 
           RowBox[{
           "OptionValue", "[", "\"\<WavefunctionValueMin\>\"", "]"}]}], "}"}],
          "]"}]}], ",", "\n", "\t\t\t", "FP", ",", "potentialMode", ",", "ps",
        ",", "colorPoints", ",", "boxsize", ",", "volElFactor", ",", "\n", 
       "\t\t\t", 
       RowBox[{"bg", "=", 
        RowBox[{"OptionValue", "[", "Background", "]"}]}], ",", "\n", 
       "\t\t\t", "pointFunc", ",", 
       RowBox[{"coFunc", "=", 
        RowBox[{"OptionValue", "[", "ColorFunction", "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"potCo", "=", 
        RowBox[{"OptionValue", "[", "\"\<PotentialColoring\>\"", "]"}]}], ",",
        "\n", "\t\t\t", 
       RowBox[{"zpe", "=", 
        RowBox[{"OptionValue", "@", "\"\<ZeroPointEnergy\>\""}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"num", "=", 
        RowBox[{
        "OptionValue", "[", "\"\<WavefunctionSelection\>\"", "]"}]}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", "\t\t", 
     RowBox[{"(*", 
      RowBox[{
      "Calculates", " ", "box", " ", "size", " ", "and", " ", "figures", " ", 
       "out", " ", "what", " ", "axes", " ", "elements", " ", "to", " ", 
       "put", " ", "in"}], "*)"}], "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X", ",", "T"}], "}"}], "=", "gridpoints"}], ";", "\n", 
      "\t\t", 
      RowBox[{"X", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", 
           RowBox[{"ArcCos", "[", "#2", "]"}], ",", "#3"}], "}"}], "&"}], "@@@", 
        RowBox[{"Cases", "[", 
         RowBox[{"X", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}], ",", "\[Infinity]"}], 
         "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"X", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"X", ",", "Last"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"V", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"potential", ",", 
         RowBox[{"None", "->", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "@", "X"}]}], "]"}]}]}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rX", ",", "\[Theta]X", ",", "\[Phi]X"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"plotLab", "=", 
       RowBox[{"OptionValue", "[", "PlotLabel", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "Gets", " ", "the", " ", "label", " ", "for", " ", "the", " ", 
        "plot"}], "*)"}], "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "potential", " ", "is", " ", "assumed", " ", "to", " ", 
        "be", " ", "an", " ", "array", " ", "or", " ", "sparse", " ", "array",
         " ", "representing", " ", "the", " ", "potential", " ", "at", " ", 
        "the", " ", "gridpoints"}], "*)"}], "\n", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalLambda]", ",", "\[CapitalPsi]"}], "}"}], "=", "\n", 
       "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"solutions", ",", "\n", "\t\t\t\t", 
         RowBox[{"None", ":>", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "@", "X"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
            
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"Length", "@", "X"}]}], "]"}], ",", 
              RowBox[{"Length", "@", "X"}]}], "]"}]}], "\n", "\t\t\t\t\t", 
           "}"}]}]}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{"zpe", ",", "Automatic", ",", 
        RowBox[{"zpe", "=", 
         RowBox[{"-", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "None", ",", "0"}], "]"}],
       ";", "\n", "\t\t", 
      RowBox[{"\[CapitalLambda]", "=", 
       RowBox[{"zpe", "+", "\[CapitalLambda]"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "These", " ", "are", " ", "the", " ", "components", " ", "which", " ", 
        "come", " ", "out", " ", "of", " ", "SphericalDVRWavefunctions"}], 
       "*)"}], "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Gets", " ", "the", " ", "actual", " ", "values", " ", "of", " ", 
         "r"}], ",", "\[Phi]", ",", " ", 
        RowBox[{
        "and", " ", "\[Theta]", " ", "for", " ", "use", " ", "later", " ", 
         "in", " ", "the", " ", "variable", " ", "trace"}]}], "*)"}], "\n", 
      "\t\t", 
      RowBox[{"boxsize", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "box", " ", "has", " ", "a", " ", "size", " ", "of", " ", 
        "max", " ", "r"}], "*)"}], "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{"splineCircle", "=", "\n", "\t\t\t\t", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m", ",", "r", ",", "angles"}], "}"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", "=", "\n", "\t", "\t", "\t", "\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"angles", "//", "N"}], ",", 
                    RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", "\n", "\t", 
                  "\t", "\t", "\t\t\t\t", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s_", ",", "e_"}], "}"}], "/;", 
                    RowBox[{"e", "<=", "s"}]}], ")"}], ":>", "\n", "\t", "\t",
                    "\t", "\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"e", "+", 
                    RowBox[{"2", "\[Pi]"}]}]}], "}"}]}]}], "\n", "\t", "\t", 
                 "\t", "\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t", "\t", 
              "\t", "\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"seg", "=", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "4"}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", "3", ",",
                     "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "]"}]}], ",", 
                  "\n", "\t", "\t", "\t", "\t", "\t\t\t", 
                  RowBox[{
                  "\[Phi]", "=", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "4"}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{"\[Pi]", "/", "2"}], ",", "\n", "\t", "\t", "\t", 
                    "\t", "\t\t\t\t\t", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "a"}], "-", 
                    RowBox[{"First", "@", "a"}]}], "]"}], "//", "N"}], ",", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", 
                 "\t", "\t", "\t\t\t", "}"}], ",", "\n", "\t", "\t", "\t", 
                "\t", "\t\t\t", 
                RowBox[{
                "BSplineCurve", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"m", "+", "#"}], "&"}], "/@", "\n", "\t", "\t", 
                   "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",",
                     "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", "Identity",
                     ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "@", "#"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}], "&"}]}], "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    "]"}], "@", 
                    RowBox[{
                    "Dot", "[", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"r", "*", 
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"First", "@", "angles"}], "]"}]}], ",", "\n", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{
                    "Join", "[", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", "seg"}], "+", "1"}]}], "]"}], ",", "\n",
                     "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{"seg", " ", 
                    RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}], "&"}], "/@", 
                    RowBox[{
                    "{", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "}"}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t", "}"}]}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "]"}]}]}], ",", "\n", 
                  "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{"SplineDegree", "->", "2"}], ",", "\n", "\t", "\t", 
                  "\t", "\t\t\t\t\t", 
                  RowBox[{
                  "SplineKnots", "->", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                   RowBox[{
                   "Join", "[", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\n", "\t",
                     "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Riffle", "[", 
                    RowBox[{"#", ",", "#"}], "]"}], "&"}], "@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"seg", "+", "1"}], "]"}]}], ",", "\n", "\t", "\t",
                     "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"seg", "+", "1"}], "}"}]}], "]"}]}], ",", "\n", 
                  "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                  "SplineWeights", "->", "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t\t", 
                   RowBox[{
                   "Join", "[", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"2", " ", "seg"}], "+", "1"}]}], "]"}], ",", "\n",
                     "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}], ",", "1"}], "}"}]}], 
                    "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}]}]}], 
                 "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "\n", "\t", "\t", 
                 "\t", "\t\t\t\t\t", "]"}]}], "\n", "\t", "\t", "\t", 
               "\t\t\t\t", "]"}]}], "\n", "\t", "\t", "\t", "\t\t\t", "]"}]}],
            "\n", "\t", "\t", "\t", "\t\t", "]"}]}], "\n", "\t\t\t", "}"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"axesThing", "=", "\n", "\t\t\t\t", 
         RowBox[{"Which", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"TrueQ", "[", 
            RowBox[{"Not", "[", 
             RowBox[{"OptionValue", "[", "Axes", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", "}"}], ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"(*", 
            RowBox[{"If", " ", "\"\<Axes\>\"", " ", "is", " ", "False"}], 
            "*)"}], "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"TrueQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Axes", "]"}], "==", "None"}], "]"}],
            ",", 
           RowBox[{"{", "}"}], ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"(*", 
            RowBox[{"If", " ", "\"\<Axes\>\"", " ", "is", " ", "None"}], 
            "*)"}], "\n", "\t", "\t", "\t\t\t", "True", ",", "\n", "\t", "\t",
            "\t\t\t", 
           RowBox[{"(*", "else", "*)"}], "\n", "\t", "\t", "\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"u", "=", 
                RowBox[{"1", "+", "boxsize"}]}], ",", 
               RowBox[{"shift", "=", "1.5"}]}], "}"}], ",", "\n", "\t", "\t", 
             "\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"c", "=", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"splineCircle", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "u", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"text", "=", 
                  RowBox[{"Inset", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", "\"\<\[Pi]\>\"", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "u"}], ",", "shift", ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t", 
               "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{
                "c", ",", "text", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", "\"\<\[CurlyPhi]=0\>\"", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "shift", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "\n", "\t", 
                 "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{"Text", "[", "\"\<\[Theta]=0\>\"", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "shift", ",", "u"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "\n", "\t", 
                 "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{
                   "Text", "[", 
                    "\"\<\\!\\(\\*FractionBox[\\(\[Pi]\\), \\(2\\)]\\)\>\"", 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "u", ",", "shift"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "\n", "\t", 
                 "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Inset", "[", 
                  RowBox[{
                   RowBox[{
                   "Text", "[", 
                    "\"\<3\\!\\(\\*FractionBox[\\(\[Pi]\\), \\(2\\)]\\)\>\"", 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "u"}], ",", "shift"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "\n", "\t", 
                 "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"c", ",", "text"}], "}"}], ",", 
                   RowBox[{"RotationTransform", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "/", "2"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], 
                  "]"}]}], "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "}"}]}], 
              "\n", "\t", "\t", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}], 
      ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "Puts", " ", "the", " ", "wave", " ", "functions", " ", "in", " ", 
        "plottable", " ", "form"}], "*)"}], "\n", "\t\t", 
      RowBox[{"num", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"num", ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"All", ":>", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "\[CapitalLambda]", "]"}]}], "]"}]}], 
           ",", "\n", "\t\t\t\t", 
           RowBox[{"_Integer", ":>", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "num"}], "]"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"_List", ":>", "num"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"_", "->", 
            RowBox[{"{", "1", "}"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], 
      ";", "\n", "\t\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "Selects", " ", "the", " ", "number", " ", "of", " ", "wavefunctions", 
        " ", "to", " ", "be", " ", "plotted"}], "*)"}], "\n", "\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"coFunc", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"_String", "|", "_List"}], ":>", "\n", "\t\t\t\t", 
         RowBox[{"(", 
          RowBox[{"coFunc", "=", 
           RowBox[{"ColorData", "[", "coFunc", "]"}]}], ")"}]}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"volElFactor", "[", 
        RowBox[{"r_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"r", "^", "2"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\[Psi]", "[", "n_", "]"}], ":=", "\n", "\t\t\t", 
       RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<SquareWavefunction\>\"", "]"}],
               ",", 
              RowBox[{"#2", "^", "2"}], ",", "#2"}], "]"}]}], "]"}], "&"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"X", ",", 
           RowBox[{"\[CapitalPsi]", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}], "\n", "\t\t\t\t", 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"maxProb", "==", "Automatic"}], "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "/@", " ", 
              RowBox[{
               RowBox[{"\[Psi]", "[", 
                RowBox[{"num", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "4"}], "]"}], "]"}]}], "]"}]}], "}"}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"maxProb", "=", 
           RowBox[{"Ceiling", "[", "  ", 
            RowBox[{"m", ",", 
             RowBox[{"10", "^", 
              RowBox[{"-", "2"}]}]}], " ", "]"}]}]}], "\n", "\t", "\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "Gets", " ", "the", " ", "max", " ", "probability", " ", "used", " ", 
        "in", " ", "coloring", " ", "the", " ", "gridpoints", " ", "and", " ",
         "calculates", " ", "the", " ", "values", " ", "to", " ", "be", " ", 
        "plotted"}], "*)"}], "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "Deals", " ", "with", " ", "the", " ", "potential", " ", "field", " ", 
        "points", " ", 
        RowBox[{"(", 
         RowBox[{
         "if", " ", "any", " ", "are", " ", "to", " ", "be", " ", "used"}], 
         ")"}]}], "*)"}], "\n", "\t\t", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"OptionValue", "[", "\"\<PotentialMode\>\"", "]"}]}], ",", 
          "m"}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"p", "=", "\n", "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{"baseReplacements", "=", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"\"\<Network\>\"", "->", "Line"}], ",", "\n", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"\"\<Traces\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Line", ",", 
                   RowBox[{"{", "1", "}"}]}], "}"}]}], ",", "\n", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"\"\<Circles\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Line", ",", 
                   RowBox[{"{", "2", "}"}]}], "}"}]}], ",", "\n", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"\"\<Arcs\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Line", ",", 
                   RowBox[{"{", "3", "}"}]}], "}"}]}], ",", "\n", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"\"\<Fan\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Line", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], ",", "\n", 
                "\t", "\t\t\t\t\t", 
                RowBox[{"\"\<Cone\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Line", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], ",", "\n", 
                "\t", "\t\t\t\t\t", 
                RowBox[{"\"\<Curves\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Line", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"\"\<BroadNetwork\>\"", "->", "Blend"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"\"\<BroadTraces\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Blend", ",", 
                   RowBox[{"{", "1", "}"}]}], "}"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"\"\<BroadCircles\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Blend", ",", 
                   RowBox[{"{", "2", "}"}]}], "}"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"\"\<BroadArcs\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Blend", ",", 
                   RowBox[{"{", "3", "}"}]}], "}"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"\"\<BroadFan\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Blend", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"\"\<BroadCone\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Blend", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"\"\<BroadCurves\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"Blend", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}]}], "\n", 
               "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"p", ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"s", ":", 
                    RowBox[{"(", 
                    RowBox[{"_String", "|", "_Rule"}], ")"}]}], ",", "v__"}], 
                  "}"}], ":>", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Replace", "[", 
                    RowBox[{"s", ",", "baseReplacements"}], "]"}], "->", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "v", "}"}]}], ">", "1"}], ",", 
                    RowBox[{"{", "v", "}"}], ",", "v"}], "]"}]}], ")"}]}], 
                ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"s", ":", 
                  RowBox[{"(", 
                   RowBox[{"_String", "|", "_Rule"}], ")"}]}], ":>", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", 
                  RowBox[{"s", ",", "baseReplacements"}], "]"}]}]}], "\n", 
               "\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
         ";", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", "m"}], "}"}], "=", "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"p", ",", 
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x_", ",", "y__"}], "}"}], ":>", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"{", "y", "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t\t", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"l", ":", "_List", ":", 
                   RowBox[{"None", "|", "v_"}]}], ")"}], "->", "c_"}], ")"}], 
               ":>", "\n", "\t\t\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"cho", "=", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"Replace", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "->", 
                    RowBox[{"{", "c", "}"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], 
                    "}"}], "->", "c"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_List", "|", "_Rule", "|", "_RuleDelayed"}], 
                    ")"}], ".."}], "}"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"MapIndexed", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"(", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}]}], "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", "#1", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", "#1"}]}], "]"}], 
                    "&"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "c"}], "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"o_", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"1", "->", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"2", "->", "o"}], ",", 
                    RowBox[{"3", "->", "o"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"2", "->", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"1", "->", "o"}], ",", 
                    RowBox[{"3", "->", "o"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"3", "->", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{"1", "->", "o"}], ",", 
                    RowBox[{"2", "->", "o"}]}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"l", "===", "None"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"v", ",", "cho"}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"l", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "cho"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"l", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ")"}], "->", "_"}], 
                    "]"}]}], ")"}]}], "]"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "~", "Join", "~", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"l", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Except", "@", 
                    RowBox[{"(", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"First", "/@", "cho"}]}], ")"}]}]}], "]"}]}]}], 
                    "}"}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"a", ":", 
                  RowBox[{"(", 
                   RowBox[{"_", "->", "_"}], ")"}]}], "->", "b_"}], ")"}], ":>", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"_", ":>", 
               RowBox[{"{", 
                RowBox[{"p", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}]}], "\n",
              "\t\t\t\t\t", "}"}]}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"FP", "=", "\n", "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"p", ",", 
            RowBox[{"{", "\n", "\t", "\t", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"False", "|", "None", "|", "\"\<None\>\""}], ")"}], "->",
                "\n", "\t", "\t\t\t\t\t", "False"}], ",", "\n", "\t", 
              "\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"True", "|", "Point"}], ")"}], "->", "\n", "\t", 
               "\t\t\t\t\t", "Point"}], ",", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Joined", "|", "Line"}], ")"}], "->", "\n", "\t", 
               "\t\t\t\t\t", "Line"}], ",", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\"\<Field\>\"", "|", "Blend"}], ")"}], "->", "\n", 
               "\t", "\t\t\t\t\t", "Blend"}], ",", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                "\"\<Dispersed\>\"", "|", "\"\<Spread\>\"", "|", 
                 "\"\<Blobby\>\""}], ")"}], "\[Rule]", "\n", "\t", 
               "\t\t\t\t\t", "\"\<Blobby\>\""}], ",", "\n", "\t", "\t\t\t\t", 
              
              RowBox[{"_String", "->", "\n", "\t", "\t\t\t\t\t", "Point"}], 
              ",", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a_", "->", "b_"}], ")"}], ":>", "\n", "\t", 
               "\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}]}]}], "\n", "\t", "\t\t\t\t", 
             "}"}]}], "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"potentialMode", "=", "m"}]}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"ps", "=", "\n", "\t\t\t", 
       RowBox[{"PointSize", "[", "\n", "\t\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"ws", "=", 
             RowBox[{
             "OptionValue", "[", "\"\<WavefunctionPointSize\>\"", "]"}]}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"D", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Max", "@", "rX"}], "-", 
                RowBox[{"Min", "@", "rX"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "@", "rX"}], "*", "boxsize"}], ")"}]}]}]}], 
           "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Switch", "[", 
           RowBox[{"ws", ",", "\n", "\t\t\t\t\t\t", "\"\<Sparse\>\"", ",", 
            RowBox[{"D", "/", "2"}], ",", "\n", "\t\t\t\t\t\t", "Small", ",", 
            
            RowBox[{".85", "*", "D"}], ",", "\n", "\t\t\t\t\t\t", "Normal", 
            ",", "D", ",", "\n", "\t\t\t\t\t\t", "\"\<Dense\>\"", ",", 
            RowBox[{"1.25", "*", "D"}], ",", "\n", "\t\t\t\t\t\t", 
            "\"\<Blobby\>\"", ",", 
            RowBox[{"2", "*", "D"}], ",", "\n", "\t\t\t\t\t\t", "_", ",", 
            "ws"}], "]"}]}], "\n", "\t\t\t\t\t", "]"}], "\n", "\t\t\t\t", 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{"sph2orth", "=", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"CoordinateTransform", "[", 
             RowBox[{
              RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#2", ",", "#3"}], "}"}]}], "]"}], "]"}], 
           "&"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "@", 
           RowBox[{"OptionValue", "[", "Tooltip", "]"}]}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"pointFunc", "[", 
            RowBox[{"\[CurlyPhi]_", ",", "\[Lambda]_"}], "]"}], ":=", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Tooltip", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Point", "[", 
              RowBox[{"sph2orth", "@@", 
               RowBox[{"\[CurlyPhi]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"Column", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"r", ",", "j", ",", "q", ",", "y"}], "}"}], ",", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<R: \>\"", ",", "r"}], "}"}], "]"}], ",", 
                   "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Phi]: \>\"", ",", "j"}], "}"}], "]"}], ",",
                    "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Theta]: \>\"", ",", "q"}], "}"}], "]"}], 
                   ",", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Psi](R,\[Phi],\[Theta]): \>\"", ",", "y"}],
                     "}"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", "}"}]}], "]"}],
                "@@", 
               RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    "OptionValue", "[", "\"\<EnergyDigits\>\"", "]"}]}], 
                   "]"}], "&"}], "@@@", 
                 RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"#2", " ", 
                    RowBox[{"180", "/", "\[Pi]"}]}], ",", 
                    RowBox[{"#3", " ", 
                    RowBox[{"180", "/", "\[Pi]"}]}], ",", 
                    RowBox[{"#4", "-", "\[Lambda]"}]}], "}"}], "&"}], "@@", 
                   "\[CurlyPhi]"}], "\n", "\t\t\t\t\t\t\t\t\t", ")"}]}], "\n",
                 "\t\t\t\t\t\t\t\t", ")"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}],
             "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"pointFunc", "[", 
            RowBox[{"\[CurlyPhi]_", ",", "\[Lambda]_"}], "]"}], ":=", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Point", "[", 
            RowBox[{"sph2orth", "@@", 
             RowBox[{"\[CurlyPhi]", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}]}]}], "\n", 
         "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "This", " ", "function", " ", "formats", " ", "a", " ", "gridpoint", 
         " ", "as", " ", "a", " ", "tooltip"}], ",", " ", 
        RowBox[{
        "allowing", " ", "precise", " ", "information", " ", "to", " ", "be", 
         " ", "gotten", " ", "about", " ", "it"}]}], "*)"}], "\n", "\n", "\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"potCo", ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"_String", "|", "_List"}], "\[RuleDelayed]", "\n", "\t\t\t", 
         
         RowBox[{"(", 
          RowBox[{"potCo", "=", 
           RowBox[{"ColorData", "[", "potCo", "]"}]}], ")"}]}]}], "\n", 
       "\t\t", "]"}], ";", "\n", "\t", 
      RowBox[{"potentialPlotObjectFunction", "=", "\n", "\t\t", 
       RowBox[{"SphericalDVRPotentialObjectFunction", "[", 
        RowBox[{
        "X", ",", "V", ",", "\n", "\t\t\t", "rX", ",", "\[Phi]X", ",", 
         "\[Theta]X", ",", "FP", ",", "\n", "\t\t\t", "potCo", ",", 
         RowBox[{"OptionValue", "[", "\"\<PotentialPointSize\>\"", "]"}], ",",
          "\n", "\t\t\t", "potentialMode", ",", 
         RowBox[{"OptionValue", "[", "\"\<PotentialCutOff\>\"", "]"}]}], "\n",
         "\t\t\t", "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"Options", "[", "potentialPlotObjectWrapper", "]"}], "=", 
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"\"\<PotentialMode\>\"", "->", "FP"}], ",", "\n", "\t\t", 
         RowBox[{"\"\<PotentialColoring\>\"", "->", "potCo"}], ",", "\n", 
         "\t\t", 
         RowBox[{"\"\<PotentialPointSize\>\"", "->", 
          RowBox[{"OptionValue", "[", "\"\<PotentialPointSize\>\"", "]"}]}], 
         ",", "\n", "\t\t", 
         RowBox[{"\"\<PotentialCutOff\>\"", "->", 
          RowBox[{"OptionValue", "[", "\"\<PotentialCutOff\>\"", "]"}]}], ",",
          "\n", "\t\t", 
         RowBox[{"Mode", "->", "potentialMode"}]}], "\n", "\t\t", "}"}]}], 
      ";", "\n", "\t", 
      RowBox[{
       RowBox[{"potentialPlotObjectWrapper", "[", 
        RowBox[{"pOps", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", "\n", "\t\t", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"mode", "=", 
            RowBox[{"OptionValue", "@", "Mode"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"potentialColoring", "=", 
            RowBox[{"OptionValue", "@", "\"\<PotentialColoring\>\""}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"drawMode", "=", "\n", "\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "\"\<PotentialMode\>\""}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"False", "|", "None", "|", "\"\<None\>\""}], ")"}], 
                 "->", "False"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"True", "|", "Point"}], ")"}], "->", "Point"}], ",",
                 "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Joined", "|", "Line"}], ")"}], "->", "Line"}], ",",
                 "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\"\<Field\>\"", "|", "Blend"}], ")"}], "->", 
                 "Blend"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "\"\<Dispersed\>\"", "|", "\"\<Spread\>\"", "|", 
                   "\"\<Blobby\>\""}], ")"}], "\[Rule]", "\"\<Blobby\>\""}], 
                ",", "\n", "\t\t\t\t\t", 
                RowBox[{"_String", "->", "Point"}]}], "\n", "\t\t\t\t\t", 
               "}"}]}], "]"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"cutOff", "=", 
            RowBox[{"OptionValue", "@", "\"\<PotentialCutOff\>\""}]}]}], "\n",
           "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"potentialColoring", ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"_String", "|", "_List"}], ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"(", 
              RowBox[{"potentialColoring", "=", 
               RowBox[{"ColorData", "[", "potentialColoring", "]"}]}], 
              ")"}]}]}], "\n", "\t\t\t\t", "]"}], ";", "\n", "\t\t\t", 
          RowBox[{"potentialPlotObjectFunction", "[", 
           RowBox[{
           "X", ",", "V", ",", "drawMode", ",", "potentialColoring", ",", 
            "rX", ",", "\[Phi]X", ",", "\[Theta]X", ",", "mode", ",", 
            "cutOff"}], "]"}]}]}], "\n", "\t\t\t", "]"}]}], ";", "\n", "\t", 
      RowBox[{"colorPoints", "=", 
       RowBox[{"potentialPlotObjectFunction", "[", "]"}]}], ";", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"This", " ", "produces", " ", "the", " ", 
         RowBox[{"fieldpoints", ".", " ", "\n", "\t\t", "Should"}], " ", "be",
          " ", "rewritten", " ", "to", " ", "format", " ", "them", " ", "as", 
         " ", "lines", " ", "between", " ", "adjacent", " ", "field", " ", 
         "points"}], ",", " ", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"giving", " ", "a", " ", "spider"}], "-", 
         RowBox[{"web", " ", "form", " ", "of", " ", "the", " ", 
          RowBox[{"potential", ".", "\n", "\t\t", "Find"}], " ", "same", " ", 
          "\[CurlyPhi]"}]}], ",", 
        RowBox[{"\[Theta]", " ", "closest", " ", "r"}], ",", " ", 
        RowBox[{"same", " ", "r"}], ",", 
        RowBox[{
        "\[CurlyPhi]", " ", "closest", " ", "\[Theta]", " ", "and", " ", 
         "same", " ", "r"}], ",", 
        RowBox[{"\[Theta]", " ", "closest", " ", 
         RowBox[{"\[CurlyPhi]", ".", "\n", "\t\t", "Draw"}], " ", "as", " ", 
         "average", " ", "color", " ", 
         RowBox[{"(", 
          RowBox[{
          "as", " ", "average", " ", "values", " ", "colored", " ", "by", " ",
            "the", " ", "coloring", " ", "function"}], ")"}]}]}], "*)"}], 
      "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
       "Does", " ", "the", " ", "actual", " ", "dirty", " ", "work", " ", 
        "of", " ", "plotting"}], "*)"}], "\n", "\t\t\t", 
      RowBox[{"(*", 
       RowBox[{
       "takes", " ", "the", " ", "points", " ", "and", " ", "makes", " ", "a",
         " ", "graph", " ", "out", " ", "of", " ", "them"}], "*)"}], " ", 
      "\n", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eFunc", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "n", "}"}], ",", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], "}"}], ",", "\n", 
        "\n", "\t", 
        RowBox[{
         RowBox[{"wavefunctionPlotFunction", "=", "\n", "\t\t", 
          RowBox[{"SphericalDVRWavefunctionPlotFunction", "[", 
           RowBox[{
           "X", ",", "\[Psi]", ",", "eFunc", ",", "\n", "\t\t\t", "coFunc", 
            ",", "pointFunc", ",", "colorPoints", ",", "\n", "\t\t\t", "rX", 
            ",", "\[Phi]X", ",", "\[Theta]X", ",", "\n", "\t\t\t", 
            RowBox[{"OptionValue", "[", "\"\<RadialPointSelection\>\"", "]"}],
             ",", "\n", "\t\t\t\t", 
            RowBox[{
            "OptionValue", "[", "\"\<AzimuthalPointSelection\>\"", "]"}], ",",
             "\n", "\t\t\t\t", 
            RowBox[{"OptionValue", "[", "\"\<PolarPointSelection\>\"", "]"}], 
            ",", "\n", "\t\t\t", 
            RowBox[{"OptionValue", "[", "\"\<EnergyDigits\>\"", "]"}], ",", 
            "boxsize", ",", "axesThing", ",", "ps", ",", "\n", "\t\t\t", 
            RowBox[{"FilterRules", "[", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"pops", "=", 
                  RowBox[{
                   RowBox[{"Alternatives", "@@", 
                    RowBox[{"Keys", "@", 
                    RowBox[{"{", "ops", "}"}]}]}], "//", "Except"}]}], "}"}], 
                ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"PlotLabel", "->", "plotLab"}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{"FilterRules", "[", 
                    RowBox[{
                    RowBox[{"Options", "[", "SphericalDVRPlot", "]"}], ",", 
                    "pops"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", "ops"}], 
                  "\n", "\t\t\t\t\t\t\t", "}"}], "\n", "\t\t\t\t\t\t", 
                 "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{
              "Options", "[", "SphericalDVRWavefunctionPlotFunction", "]"}]}],
              "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", 
         "\n", "\t", 
         RowBox[{
          RowBox[{"Options", "[", "wavefunctionPlotWrapper", "]"}], "=", "\n",
           "\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"base", "=", 
              RowBox[{"{", "\n", "\t\t\t", 
               RowBox[{
                RowBox[{"\"\<PotentialMode\>\"", "->", "colorPoints"}], ",", 
                "\n", "\t\t\t", 
                RowBox[{"Number", "->", 
                 RowBox[{"num", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t\t\t", 
                RowBox[{"Axes", "->", "axesThing"}], ",", "\n", "\t\t\t", 
                RowBox[{"Min", "->", 
                 RowBox[{"1.", "Ec"}]}], ",", "\n", "\t\t\t", 
                RowBox[{"Max", "->", "maxProb"}], ",", "\n", "\t\t\t", 
                RowBox[{"PointSize", "->", "ps"}], ",", "\n", "\t\t\t", 
                RowBox[{"AddTo", "->", 
                 RowBox[{"OptionValue", "@", "AddTo"}]}], ",", "\n", "\t\t\t", 
                RowBox[{"\"\<PotentialColoring\>\"", "->", "potCo"}], ",", 
                "\n", "\t\t\t", 
                RowBox[{"ColorFunction", "->", "coFunc"}], ",", "\n", 
                "\t\t\t", 
                RowBox[{"BarLegend", "->", 
                 RowBox[{"colorPoints", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t\t\t", 
                RowBox[{"PlotLegends", "->", 
                 RowBox[{"{", 
                  RowBox[{"True", ",", "True"}], "}"}]}], ",", "\n", "\t\t\t", 
                RowBox[{"\"\<RadialPointSelection\>\"", "->", 
                 RowBox[{
                 "OptionValue", "@", "\"\<RadialPointSelection\>\""}]}], ",", 
                "\n", "\t\t\t", 
                RowBox[{"\"\<AzimuthalPointSelection\>\"", "->", 
                 RowBox[{
                 "OptionValue", "@", "\"\<AzimuthalPointSelection\>\""}]}], 
                ",", "\n", "\t\t\t", 
                RowBox[{"\"\<PolarPointSelection\>\"", "->", 
                 RowBox[{
                 "OptionValue", "@", "\"\<PolarPointSelection\>\""}]}]}], 
               "}"}]}], "}"}], ",", "\n", "\t\t", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", "\n", "\t\t\t", 
              RowBox[{"base", ",", "\n", "\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"Alternatives", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "base"}], 
                    ")"}]}], "]"}]}], "]"}]}], "\n", "\t\t\t", "}"}], "]"}]}],
            "\n", "\t\t", "]"}]}], ";", "\n", "\t", 
         RowBox[{
          RowBox[{"wavefunctionPlotWrapper", "[", 
           RowBox[{"wPlotOps", ":", 
            RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", "\n", "\t", 
          "\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t", "\t\t\t", 
             RowBox[{
              RowBox[{"potentialColoring", "=", "\n", "\t", "\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"OptionValue", "@", "\"\<PotentialColoring\>\""}], 
                 ",", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"p", ":", 
                   RowBox[{"_String", "|", "_List"}]}], ":>", "\n", "\t", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"ColorData", "[", "p", "]"}]}]}], "\n", "\t", 
                "\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t\t\t", 
              RowBox[{"colFunc", "=", "\n", "\t", "\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"OptionValue", "@", "ColorFunction"}], ",", "\n", 
                 "\t", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"p", ":", 
                   RowBox[{"_String", "|", "_List"}]}], ":>", "\n", "\t", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"ColorData", "[", "p", "]"}]}]}], "\n", "\t", 
                "\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t\t\t", 
              RowBox[{"pSize", "=", 
               RowBox[{"OptionValue", "@", "PointSize"}]}], ",", "\n", "\t", 
              "\t\t\t", 
              RowBox[{"legends", "=", 
               RowBox[{"OptionValue", "@", "PlotLegends"}]}], ",", "\n", "\t",
               "\t\t\t", 
              RowBox[{"n", "=", 
               RowBox[{"OptionValue", "@", "Number"}]}], ",", 
              RowBox[{"min", "=", 
               RowBox[{"OptionValue", "@", "Min"}]}], ",", 
              RowBox[{"max", "=", 
               RowBox[{"OptionValue", "@", "Max"}]}], ",", "\n", "\t", 
              "\t\t\t", 
              RowBox[{"rSel", "=", 
               RowBox[{"OptionValue", "@", "\"\<RadialPointSelection\>\""}]}],
               ",", "\n", "\t", "\t\t\t", 
              RowBox[{"\[Phi]Sel", "=", 
               RowBox[{
               "OptionValue", "@", "\"\<AzimuthalPointSelection\>\""}]}], ",",
               "\n", "\t", "\t\t\t", 
              RowBox[{"\[Theta]Sel", "=", 
               RowBox[{"OptionValue", "@", "\"\<PolarPointSelection\>\""}]}], 
              ",", "\n", "\t\t\t\t", 
              RowBox[{"epi", "=", 
               RowBox[{"OptionValue", "@", "AddTo"}]}], ",", "\n", "\t", 
              "\t\t\t", 
              RowBox[{"ax", "=", 
               RowBox[{"OptionValue", "@", "Axes"}]}], ",", "\n", "\t", 
              "\t\t\t", 
              RowBox[{"dops", "=", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "wPlotOps", "}"}], ",", 
                 RowBox[{"Options", "[", "Graphics3D", "]"}]}], "]"}]}], ",", 
              "\n", "\t", "\t\t\t", 
              RowBox[{"pm", "=", 
               RowBox[{"OptionValue", "@", "\"\<PotentialMode\>\""}]}]}], 
             "}"}], ",", "\n", "\t", "\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"s", "=", "\n", "\t", "\t\t\t\t", 
                RowBox[{"Sequence", "[", 
                 RowBox[{
                 "n", ",", "min", ",", "max", ",", "\n", "\t", "\t\t\t\t\t", 
                  RowBox[{"OptionValue", "@", "BarLegend"}], ",", "\n", 
                  "\t\t\t\t\t\t", 
                  RowBox[{"BarLegend", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"colFunc", "[", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "max"}], "}"}]}], "]"}], "]"}]}], "]"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "max"}], "}"}]}], "}"}], "]"}], ",", 
                  "\n", "\t\t\t\t\t\t", "colFunc", ",", "\n", "\t\t\t\t\t\t", 
                  
                  RowBox[{"TrueQ", "@", 
                   RowBox[{"legends", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{"TrueQ", "@", 
                   RowBox[{"legends", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
                  "\t\t\t\t\t", "rSel", ",", "\[Phi]Sel", ",", "\[Theta]Sel", 
                  ",", "\n", "\t", "\t\t\t\t\t", "pSize", ",", "ax", ",", 
                  "pm", ",", "epi"}], "]"}]}], "}"}], ",", "\n", "\t", 
              "\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Length", "@", "dops"}], ")"}], ">", "0"}], ",", 
                "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"wavefunctionPlotFunction", "[", 
                 RowBox[{"s", ",", "dops"}], "]"}], ",", "\n", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"wavefunctionPlotFunction", "[", "s", "]"}]}], "\n", 
               "\t", "\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t", "]"}]}], 
           "\n", "\t", "\t\t\t", "]"}]}]}]}], "\n", "\t", "\t\t", "]"}], ";", 
      "\n", "\t", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<PlotReturn\>\"", "]"}], ",", "\n", 
        "\t\t", "\"\<Inputs\>\"", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"ClearAttributes", "[", 
          RowBox[{"\[Psi]", ",", "Temporary"}], "]"}], ";", "\n", "\t\t\t", 
         RowBox[{"{", 
          RowBox[{"X", ",", "V", ",", "\[Psi]"}], "}"}]}], ",", "\n", "\t\t", 
        "\"\<Functions\>\"", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s", "=", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
              "wavefunctionPlotFunction", ",", "wavefunctionPlotWrapper", ",",
                "\n", "\t\t\t\t", "potentialPlotObjectFunction", ",", 
               "potentialPlotObjectWrapper"}], "\n", "\t\t\t\t", "}"}]}], 
            "}"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"ClearAttributes", "[", 
            RowBox[{"s", ",", "Temporary"}], "]"}]}], "\n", "\t\t\t\t", "]"}],
          ";", "\n", "\t\t\t", 
         RowBox[{"<|", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
           "\"\<WavefunctionFull\>\"", "->", "wavefunctionPlotFunction"}], 
           ",", "\n", "\t\t\t\t", 
           RowBox[{"\"\<Wavefunctions\>\"", "->", "wavefunctionPlotWrapper"}],
            ",", "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<PotentialFull\>\"", "->", "potentialPlotObjectFunction"}], 
           ",", "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<Potential\>\"", "->", "potentialPlotObjectWrapper"}]}], "\n", 
          "\t\t\t\t", "|>"}]}], ",", "\n", "\t\t", "\"\<Potential\>\"", ",", 
        "\n", "\t\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"g", "=", "colorPoints"}], "}"}], ",", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"Boxed", "->", 
             RowBox[{"OptionValue", "@", "Boxed"}]}]}], "]"}]}], " ", "]"}], 
        ",", "\n", "\t\t", "\"\<Wavefunction\>\"", ",", "\n", "\t\t\t", 
        RowBox[{"wavefunctionPlotWrapper", "[", "]"}], ",", "\n", "\t\t", "_",
         ",", "\n", "\t\t\t", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pstep", "=", 
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<ManipulatorStep\>\"", "]"}], 
              ",", "\n", "\t\t\t\t\t\t\t", "\"\<Ultrafine\>\"", ",", ".00001",
               ",", "\n", "\t\t\t\t\t\t\t", "Fine", ",", ".0001", ",", "\n", 
              "\t\t\t\t\t\t\t", "Small", ",", ".005", ",", "\n", 
              "\t\t\t\t\t\t\t", "Medium", ",", ".01", ",", "\n", 
              "\t\t\t\t\t\t\t", "Coarse", ",", ".1", ",", "\n", 
              "\t\t\t\t\t\t\t", "_", ",", 
              RowBox[{"1.", 
               RowBox[{
               "OptionValue", "[", "\"\<ManipulatorStep\>\"", "]"}]}]}], 
             "]"}]}], "\n", "\t\t\t", 
           RowBox[{"(*", "dofunc", "*)"}], "}"}], ",", "\n", "\t\t\t", 
          RowBox[{"(*", 
           RowBox[{"dofunc", "=", "wavefunctionPlotFunction"}], "*)"}], "\n", 
          "\t\t\t", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"manipulate", "=", "True"}], ",", "args", ",", 
              "drawops"}], "}"}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "\"\<Interactivity\>\"", "]"}], 
               ",", "\n", "\t\t\t\t\t", "None", ",", 
               RowBox[{"(*", 
                RowBox[{"Provides", " ", "just", " ", "the", " ", "graphic"}],
                 "*)"}], "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"manipulate", "=", "False"}], ";", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"args", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"HoldComplete", "@", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Sequence", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"num", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"1.", "Ec"}], ",", "maxProb", ",", 
                    RowBox[{"colorPoints", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BarLegend", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"coFunc", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "maxProb"}], "}"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "maxProb"}], "}"}]}], "}"}], "]"}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t", "coFunc", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "True", ",", "True"}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "]"}]}]}]}], ",", "\n", "\t\t\t\t\t",
                "Less", ",", 
               RowBox[{"(*", 
                RowBox[{
                "Lets", " ", "the", " ", "\[Psi]", " ", "number", " ", "vary",
                  " ", "and", " ", "the", " ", "minimum", " ", 
                 "probability"}], "*)"}], "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"args", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"HoldComplete", "@", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Sequence", "[", 
                   RowBox[{"n", ",", 
                    RowBox[{"1.", "Ec"}], ",", "maxProb", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"colorPoints", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BarLegend", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"coFunc", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "maxProb"}], "}"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "maxProb"}], "}"}]}], "}"}], "]"}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t", "coFunc", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "fF", ",", "gF"}], "]"}]}]}], ";", 
                "\n", "\t\t\t\t\t\t", 
                RowBox[{"drawops", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\[Psi]\>\""}], 
                    "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"VariableSetBar", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "num", "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<SynchronousAdjustment\>\"", "->", "False"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "->", "Small"}]}], "]"}], "&"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlPlacement", "->", "Top"}]}], "}"}]}], ",",
                    "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "fF", ",", "True", ",", "\"\<Show Potential   \>\""}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "gF", ",", "True", ",", "\"\<Show Wavefunction\>\""}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"ControlPlacement", "->", "Bottom"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"Paneled", "->", "False"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t\t\t", 
               "Normal", ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Lets", " ", "the", " ", "\[Psi]", " ", "number"}], 
                 ",", " ", 
                 RowBox[{"minimum", " ", "probability"}], ",", " ", 
                 RowBox[{
                 "and", " ", "max", " ", "probability", " ", "vary"}]}], 
                "*)"}], "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"args", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"HoldComplete", "@", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Sequence", "[", 
                   RowBox[{"n", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"colorPoints", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BarLegend", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"coFunc", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "&"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t", "coFunc", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "fF", ",", "gF"}], "]"}]}]}], ";", 
                "\n", "\t\t\t\t\t\t", 
                RowBox[{"drawops", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\[Psi]\>\""}], 
                    "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"VariableSetBar", "[", 
                    RowBox[{
                    "#", ",", "num", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<SynchronousAdjustment\>\"", "->", "False"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "->", "Small"}]}], "]"}], "&"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlPlacement", "->", "Top"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.", "Ec"}], ",", 
                    RowBox[{"1.", "maxProb"}]}], "}"}], ",", 
                    "\"\<\[Psi]-Bounds\>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"LabeledInterval", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "pstep"}], "}"}], ",", 
                    "Bottom", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FieldSize", "->", "10"}], ",", 
                    RowBox[{"Appearance", "->", "Frameless"}], ",", 
                    RowBox[{"Method", "->", "\"\<Stop\>\""}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}]}], "}"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"fF", ",", "True", ",", 
                    "\"\<Show Potential   \>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "gF", ",", "True", ",", "\"\<Show Wavefunction\>\""}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"ControlPlacement", "->", "Bottom"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"Paneled", "->", "False"}]}], "]"}]}]}], ",", "\n",
                "\t\t\t\t\t", "\"\<More\>\"", ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Lets", " ", "the", " ", "\[Psi]", " ", "number"}], 
                 ",", " ", 
                 RowBox[{"min", " ", "prob"}], ",", " ", 
                 RowBox[{"max", " ", "prob"}], ",", " ", 
                 RowBox[{"and", " ", "r"}], ",", " ", "\[Phi]", ",", " ", 
                 RowBox[{"\[Theta]", " ", "selections", " ", "vary"}]}], 
                "*)"}], "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"args", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"HoldComplete", "@", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Sequence", "[", 
                   RowBox[{"n", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"colorPoints", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BarLegend", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"coFunc", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "&"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t", "coFunc", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "fF", ",", "gF", ",", "r", ",", "f",
                     ",", "q"}], "]"}]}]}], ";", "\n", "\t\t\t\t\t\t", 
                RowBox[{"drawops", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\[Psi]\>\""}], 
                    "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"VariableSetBar", "[", 
                    RowBox[{
                    "#", ",", "num", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<SynchronousAdjustment\>\"", "->", "False"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "->", "Small"}]}], "]"}], "&"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlPlacement", "->", "Top"}]}], "}"}]}], ",",
                    "\n", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.", "Ec"}], ",", 
                    RowBox[{"1.", "maxProb"}]}], "}"}], ",", 
                    "\"\<\[Psi]-Bounds\>\""}], "}"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"LabeledInterval", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "pstep"}], "}"}], ",", 
                    "Bottom", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FieldSize", "->", "10"}], ",", 
                    RowBox[{"Appearance", "->", "Frameless"}], ",", 
                    RowBox[{"Method", "->", "\"\<Stop\>\""}]}], "]"}], 
                    "&"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "OptionValue", "[", "\"\<RadialPointSelection\>\"", "]"}],
                     "}"}]}], ",", "\"\<R Selection\>\""}], "}"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "rX", "]"}]}], "]"}], ",", "All"}],
                     "]"}], ",", 
                    RowBox[{"ControlType", "->", "TogglerBar"}]}], "}"}]}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "fF", ",", "True", ",", "\"\<Show Potential   \>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "OptionValue", "[", "\"\<AzimuthalPointSelection\>\"", 
                    "]"}], "}"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "\"\<\[Phi] Selection\>\""}], 
                    "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "\[Phi]X", "]"}]}], "]"}], ",", 
                    "All"}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "->", "TogglerBar"}]}], "}"}]}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "gF", ",", "True", ",", "\"\<Show Wavefunction\>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "OptionValue", "[", "\"\<PolarPointSelection\>\"", "]"}], 
                    "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<\[Theta] Selection\>\""}], "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "\[Theta]X", "]"}]}], "]"}], ",", 
                    "All"}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "->", "TogglerBar"}]}], "}"}]}]}], 
                    " ", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alignment", "->", "Left"}]}], "]"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"ControlPlacement", "->", "Bottom"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Paneled", "->", "False"}]}], "]"}]}]}], ",", "\n",
                "\t\t\t\t\t", "Most", ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"args", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"HoldComplete", "@", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cps", "=", 
                    RowBox[{"potentialPlotObjectWrapper", "[", 
                    RowBox[{
                    RowBox[{"\"\<PotentialMode\>\"", "->", "mo"}], ",", 
                    RowBox[{"Mode", "->", "ms"}]}], "]"}]}], "}"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "=", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"List", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"cps", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BarLegend", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"coFunc", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "&"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", "coFunc", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "fF", ",", "gF", ",", "r", ",", 
                    "f", ",", "q", ",", "pos", ",", "ax", ",", "cps"}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Sequence", "@@", "s"}]}], "]"}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "]"}]}]}], ";", "\n", "\t\t\t\t\t\t", 
                RowBox[{"drawops", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\[Psi]\>\""}], 
                    "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"VariableSetBar", "[", 
                    RowBox[{
                    "#", ",", "num", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<SynchronousAdjustment\>\"", "->", "False"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "->", "Small"}]}], "]"}], "&"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlPlacement", "->", "Top"}]}], "}"}]}], ",",
                    "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.", "Ec"}], ",", 
                    RowBox[{"1.", "maxProb"}]}], "}"}], ",", 
                    "\"\<\[Psi]-Bounds\>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"LabeledInterval", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "pstep"}], "}"}], ",", 
                    "Bottom", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FieldSize", "->", "10"}], ",", 
                    RowBox[{"Appearance", "->", "Frameless"}], ",", 
                    RowBox[{"Method", "->", "\"\<Stop\>\""}]}], "]"}], 
                    "&"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"r", ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "OptionValue", "[", "\"\<RadialPointSelection\>\"", "]"}],
                     "}"}]}], ",", "\"\<R Selection\>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "rX", "]"}]}], "]"}], ",", "All"}],
                     "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "->", "TogglerBar"}]}], "}"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pos", ",", "ps", ",", "\"\<Point Size\>\""}], 
                    "}"}], ",", "0", ",", ".2"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"f", ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "OptionValue", "[", "\"\<AzimuthalPointSelection\>\"", 
                    "]"}], "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<\[Phi] Selection\>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "\[Phi]X", "]"}]}], "]"}], ",", 
                    "All"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "->", "TogglerBar"}]}], "}"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "fF", ",", "True", ",", "\"\<Show Potential\>\""}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "gF", ",", "True", ",", "\"\<Show Wavefunction\>\""}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}]}], 
                    "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"q", ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "OptionValue", "[", "\"\<PolarPointSelection\>\"", "]"}], 
                    "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<\[Theta] Selection\>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Length", "[", "\[Theta]X", "]"}]}], "]"}], ",", 
                    "All"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "->", "TogglerBar"}]}], "}"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mo", ",", 
                    RowBox[{"OptionValue", "@", "\"\<PotentialMode\>\""}], 
                    ",", "\"\<Potential Mode\>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Point", "->", "\"\<Points\>\""}], ",", 
                    RowBox[{"\"\<Blobby\>\"", "->", "\"\<Dispersed\>\""}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Line", "->", "\"\<Network\>\""}], ",", 
                    RowBox[{"Blend", "->", "\"\<BroadNetwork\>\""}]}], 
                    "}"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ms", ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "OptionValue", "@", "\"\<PotentialSelection\>\""}], 
                    "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<Potential Selection\>\""}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Points\>\"", ",", "\"\<Radial\>\"", ",", 
                    "\"\<Azimuthal\>\"", ",", "\"\<Polar\>\""}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "->", "TogglerBar"}]}], "}"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Control", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "ax", ",", "axesThing", ",", "\"\<Show Axes\>\""}], "}"}],
                     ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", "axesThing"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ControlType", "->", "Checkbox"}]}], "}"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alignment", "->", "Left"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"ControlPlacement", "->", "Bottom"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"Paneled", "->", "False"}]}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t\t\t", "_", 
               ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"args", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"HoldComplete", "@", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Sequence", "[", 
                   RowBox[{"n", ",", 
                    RowBox[{"1.", "Ec"}], ",", "maxProb", ",", 
                    RowBox[{"colorPoints", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"BarLegend", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"coFunc", "@", 
                    RowBox[{"Rescale", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "maxProb"}], "}"}]}], "]"}]}], "&"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "maxProb"}], "}"}]}], "}"}], "]"}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t", "coFunc", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "True", ",", "True"}], "]"}]}]}], 
                ";", "\n", "\t\t\t\t\t\t", 
                RowBox[{"drawops", "=", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Control", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\[Psi]\>\""}], 
                    "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"VariableSetBar", "[", 
                    RowBox[{
                    "#", ",", "num", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<SynchronousAdjustment\>\"", "->", "False"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "->", "Small"}]}], "]"}], "&"}]}], 
                    "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"Paneled", "->", "False"}]}], "\n", "\t", 
                  "\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t\t\t", "]"}], 
             ";", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"TrueQ", "@", 
                 RowBox[{"OptionValue", "[", "Paneled", "]"}]}], ",", "\n", 
                "\t\t\t\t\t", "Panel", ",", "\n", "\t\t\t\t\t", "Identity"}], 
               "]"}], "@", "\n", "\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"d", "=", "wavefunctionPlotFunction"}], ",", 
                  RowBox[{"a", "=", "args"}], ",", 
                  RowBox[{"o", "=", "drawops"}]}], "}"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"manipulate", "==", "True"}], ",", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"Manipulate", "[", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sub", "=", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[Psi]\>\"", ",", "n"}], "]"}]}], "}"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\"\<SquareWavefunction\>\"", "]"}], 
                    ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"sub", ",", "\"\<\[Conjugate]\>\"", ",", "sub"}], 
                    "}"}], "]"}], ",", "sub"}], "]"}]}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"d", "[", 
                    RowBox[{"ReleaseHold", "@", "a"}], "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "o"}], "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sub", "=", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<\[Psi]\>\"", ",", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\"\<SquareWavefunction\>\"", "]"}], 
                    ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"sub", ",", "\"\<\[Conjugate]\>\"", ",", "sub"}], 
                    "}"}], "]"}], ",", "sub"}], "]"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"d", "[", 
                    RowBox[{"ReleaseHold", "@", "a"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}]}],
            "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
       "]"}]}]}], "\n", "\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699237783487438*^9, 3.6992378145449333`*^9}, {
   3.699238815953288*^9, 3.6992388533950853`*^9}, {3.699801756468096*^9, 
   3.699801945952113*^9}, 3.699802030649124*^9, {3.6998020840221853`*^9, 
   3.699802110680397*^9}, {3.699802154439138*^9, 3.6998021744085827`*^9}, {
   3.699802905120612*^9, 3.699802929609816*^9}, {3.699810816221313*^9, 
   3.6998108488640842`*^9}, {3.6998109678313093`*^9, 3.699810988738351*^9}, {
   3.6998110266211853`*^9, 3.699811046493889*^9}, {3.6998110951677647`*^9, 
   3.699811347364122*^9}, {3.699811378041491*^9, 3.699811452545828*^9}, {
   3.699811579098771*^9, 3.69981169798011*^9}, {3.699811734518569*^9, 
   3.69981184687322*^9}, {3.699811891417845*^9, 3.699812017485611*^9}, {
   3.6998120596025*^9, 3.6998128562160254`*^9}, {3.6998128868199787`*^9, 
   3.6998130590638313`*^9}, {3.6998130977670813`*^9, 3.699813187540415*^9}, {
   3.6998133558890057`*^9, 3.6998133734542627`*^9}, {3.699813431971917*^9, 
   3.699813437757609*^9}, {3.6998144306453743`*^9, 3.699814433982985*^9}, {
   3.699814874015667*^9, 3.699814899646987*^9}, {3.699814987924734*^9, 
   3.699814994162324*^9}, 3.699815176218822*^9, {3.699815272763883*^9, 
   3.6998152845060873`*^9}, {3.699816101432967*^9, 3.699816102056819*^9}, {
   3.69981621811273*^9, 3.699816252601314*^9}, {3.6998178449272947`*^9, 
   3.699817860489229*^9}, 3.699824858768353*^9, 3.699824922518436*^9, {
   3.699825098028371*^9, 3.6998251002041903`*^9}, {3.699825365546402*^9, 
   3.699825396325602*^9}, {3.6998255913787117`*^9, 3.699825669950732*^9}, {
   3.716064675313856*^9, 
   3.71606468573698*^9}},ExpressionUUID->"939a356e-ed54-403b-b51e-\
9d0a95bb1c48"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"a72e8f46-2fb1-477d-ade5-\
5d5aa34999c6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVREnd", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{{3.6992402912297707`*^9, 3.699240291711342*^9}, 
   3.7070663758174257`*^9},ExpressionUUID->"2f4d1ff8-24d1-46a7-aa2d-\
b685beabb00b"],

Cell[BoxData[
 RowBox[{"$SphericalDVR", "=", "\n", "\t", 
  RowBox[{"<|", "\n", "\t\t", 
   RowBox[{
    RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<Spherical\>\""}], ",", "\n", 
    "\t\t", 
    RowBox[{"\"\<Dimension\>\"", "\[Rule]", "3"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<FormatGrid\>\"", "\[Rule]", "SphericalDVRFormatGrid"}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<PointLabels\>\"", "\[Rule]", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$RadialDVR", ",", "$MeyerDVR", ",", "$LegendreDVR"}], "}"}],
         ",", "\"\<PointLabels\>\""}], "]"}]}]}], ",", "\n", "\t\t", 
    RowBox[{"\"\<Range\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "}"}]}], ",", "\n", "\t\t", 
    RowBox[{"\"\<Grid\>\"", "->", "SphericalDVRPoints"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<KineticEnergy\>\"", "->", "SphericalDVRK"}], ",", "\n", 
    "\t\t", 
    RowBox[{"\"\<PotentialEnergy\>\"", "->", "SphericalDVRV"}], ",", "\n", 
    "\t\t", 
    RowBox[{"\"\<Wavefunctions\>\"", "->", "SphericalDVRWavefunctions"}], ",",
     "\n", "\t\t", 
    RowBox[{
    "\"\<WavefunctionGrid\>\"", "->", "SphericalDVRWavefunctionGrid"}], ",", 
    "\n", "\t\t", 
    RowBox[{"\"\<View\>\"", "->", "SphericalDVRPlot"}]}], "\n", "\t\t", 
   "|>"}]}]], "CodeInput",
 CellChangeTimes->{
  3.699303819188716*^9, {3.709486541166502*^9, 3.7094865426452723`*^9}, {
   3.7159787172118387`*^9, 3.715978719073337*^9}, {3.7159978518660097`*^9, 
   3.715997853006763*^9}, {3.716045393949298*^9, 
   3.7160453989343023`*^9}},ExpressionUUID->"e4fc719d-66d4-4078-9c7c-\
d7212064d2ed"]
}, Open  ]]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"326716c6-415f-45d7-9ba8-\
c5c48ef122f5"]
},
WindowSize->{808, 755},
WindowMargins->{{80, Automatic}, {27, Automatic}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

