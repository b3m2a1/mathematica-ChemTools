Notebook[{

Cell[CellGroupData[{
Cell["Cartesian 1D DVR", \
"CodeSection",ExpressionUUID->"e82db05c-d73c-473a-8637-165a589313c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRBegin", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{
  3.699240055548855*^9, {3.707066346532316*^9, 
   3.707066357022255*^9}},ExpressionUUID->"0539e320-48cc-4d02-9a07-\
7bf39b90707d"],

Cell["\<\
A one dimensional DVR as reported by Colbert and Miller for the \
(-\[Infinity],\[Infinity]) range\
\>", "Text",ExpressionUUID->"b5153e79-adb4-4b8f-b746-0ba9ac1e0e2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cartesian1DDVRFormatGrid", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian1DDVRPoints", "::", "usage"}], "=", "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian1DDVRKineticMatrix", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian1DDVRPotentialMatrix", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian1DDVRWavefunctions", "::", "usage"}], "=", 
  "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{"Cartesian1DDVRPlotFunction", "::", "usage"}], "=", 
  "\"\<\>\""}]}], \
"CodeInput",ExpressionUUID->"d646a94e-5a43-4ce4-bd20-e3bc2003b68a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"bfbb51ae-b9cd-4ee1-a530-\
674953ebeba0"],

Cell[CellGroupData[{

Cell["Grid Points Function", \
"CodeSubsubsection",ExpressionUUID->"9dcbb1e6-36e5-49bc-8c7c-0b7e0095d83c"],

Cell["\<\
This function should take the number of grid points for each coordinate\
\>", "Text",ExpressionUUID->"7ae732d9-a106-4f4d-ba40-c00268a8f44f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cartesian1DDVRPoints", "[", 
   RowBox[{
    RowBox[{"points", ":", 
     RowBox[{"{", "_Integer", "}"}]}], ",", "\n", "\t", 
    RowBox[{"X", ":", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}], "}"}], ":", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", "10"}], "}"}], "}"}]}]}], "]"}], ":=", "\n",
   "\t", 
  RowBox[{"Subdivide", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N", "@", "X"}], ",", 
      RowBox[{"points", "-", "1"}]}], "}"}]}]}]}]], "CodeInput",
 CellChangeTimes->{
  3.699200045278949*^9, {3.69920008501616*^9, 3.6992000920807247`*^9}, {
   3.699200124968298*^9, 3.699200133406434*^9}, {3.6992074474542017`*^9, 
   3.699207450724925*^9}, {3.699211747970565*^9, 3.699211787049007*^9}, {
   3.69921185461567*^9, 3.6992119283628674`*^9}, {3.699212533676085*^9, 
   3.6992125341066017`*^9}, {3.69922854340968*^9, 3.699228545982193*^9}, {
   3.699234968992999*^9, 
   3.699234969751259*^9}},ExpressionUUID->"5b122caf-413f-4b04-be9d-\
789fc99f84b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinetic Matrix Function", \
"CodeSubsubsection",ExpressionUUID->"3a9cfae4-6754-4c56-9bb6-f653f5495f36"],

Cell["\<\
This should take the grid generated in grid points function and turn it into \
the kinetic energy matrix for the DVR\
\>", "Text",ExpressionUUID->"d2659771-e943-4864-8191-db9d352e2346"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Cartesian1DDVRKineticMatrix", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Mass\>\"", "->", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<HBar\>\"", "->", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ScalingFactor\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<UseExact\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Cartesian1DDVRKineticMatrix", "[", 
   RowBox[{"grid_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xmin", "=", 
       RowBox[{"Min", "@", "grid"}]}], ",", 
      RowBox[{"xmax", "=", 
       RowBox[{"Max", "@", "grid"}]}], ",", 
      RowBox[{"points", "=", 
       RowBox[{"Length", "@", "grid"}]}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"dx", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"xmax", "-", "xmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"points", "-", "1"}], ")"}]}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"m", "=", 
         RowBox[{"OptionValue", "@", "\"\<Mass\>\""}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"\[HBar]", "=", 
         RowBox[{"OptionValue", "@", "\"\<HBar\>\""}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"scl", "=", 
         RowBox[{"OptionValue", "@", "\"\<ScalingFactor\>\""}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"ex", "=", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"OptionValue", "@", "\"\<UseExact\>\""}]}]}]}], "\n", 
       "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"With", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{"f", "=", "\n", "\t\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"ex", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"scl", "*", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "#2"}], ",", " ", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\[Pi]", "^", "2"}], "/", "3"}], ",", " ", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"2", "/", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "-", "#2"}], ")"}], "^", "2"}]}]}], "\n", 
               "\t\t\t\t\t\t\t\t\t", "]"}], "*", "\n", "\t\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[HBar]", "^", "2"}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "#2"}], ")"}]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "m", " ", 
                 RowBox[{"dx", "^", "2"}]}], ")"}]}]}], "&"}], ",", "\n", 
            "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"scl", "*", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "#2"}], ",", " ", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\[Pi]", "^", "2."}], "/", "3."}], ",", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"2.", "/", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "-", "#2"}], ")"}], "^", "2"}]}]}], "\n", 
               "\t", "\t\t\t\t\t\t\t\t", "]"}], "*", "\n", "\t", 
              "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[HBar]", "^", "2."}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "#2"}], ")"}]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2.", "m", " ", 
                 RowBox[{"dx", "^", "2"}]}], ")"}]}]}], "&"}]}], "\n", 
           "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"points", ">", "100000"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "points"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "points"}], "}"}]}], "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "points"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "points"}], "}"}]}], "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7189844853755617`*^9, 3.7189844912631063`*^9}, {
  3.7244491081828423`*^9, 3.72444911751787*^9}, {3.7246247484855757`*^9, 
  3.724624764853821*^9}, {3.724625185443568*^9, 3.724625190914751*^9}, {
  3.724791261263809*^9, 3.724791269588675*^9}, {3.724793070638556*^9, 
  3.72479321673199*^9}, {3.72479325502118*^9, 3.724793261051444*^9}, {
  3.7247941140713863`*^9, 3.7247941145870037`*^9}, {3.724794249611946*^9, 
  3.724794250601122*^9}, {3.727710917819077*^9, 3.727710950346139*^9}, {
  3.7277112596699533`*^9, 
  3.72771128348699*^9}},ExpressionUUID->"fe5264fe-f177-458d-9031-007a765679e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting Function", \
"CodeSubsubsection",ExpressionUUID->"bdeb4030-dec5-424e-8fab-f3ccb4fc7b29"],

Cell["\<\
Should take the wavefunctions and a scad of options to make a nice plot. \
Generally reusing some prewritten code works best\
\>", "Text",ExpressionUUID->"7fd1f38d-b8a5-459e-a1d1-dd0fe4018161"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "Cartesian1DDVRPlotFunction", "]"}], "=", "\n", 
   "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\"\<WavefunctionSelection\>\"", "\[Rule]", "Automatic"}], ",",
        "\n", "\t", "\t", 
       RowBox[{"AxesOrigin", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\n", "\t\t", 
       RowBox[{"Scaled", "\[Rule]", "1"}], ",", "\n", "\t\t", 
       RowBox[{"\"\<ShowEnergy\>\"", "\[Rule]", "True"}], ",", "\n", "\t\t", 
       RowBox[{"\"\<PotentialStyle\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t", 
       RowBox[{"\"\<EnergyDigits\>\"", "->", "3"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<ZeroPointEnergy\>\"", "->", "0"}], ",", "\n", "\t", "\t", 
       
       RowBox[{"LabelingFunction", "->", "Automatic"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<CutOff\>\"", "->", 
        RowBox[{"10", "^", 
         RowBox[{"-", "5"}]}]}], ",", "\n", "\t", "\t", 
       RowBox[{"Manipulate", "->", "True"}], ",", "\n", "\t", "\t", 
       RowBox[{"PlotRange", "->", "Automatic"}], ",", "\n", "\t", "\t", 
       RowBox[{"\"\<SquareWavefunction\>\"", "->", "False"}], ",", "\n", "\t",
        "\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"Options", "[", "ListLinePlot", "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"Except", "[", 
          RowBox[{"AxesOrigin", "|", "PlotRange", "|", "LabelingFunction"}], 
          "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "}"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cartesian1DDVRPlotFunction", "[", 
    RowBox[{"solutions_", ",", "grid_", ",", "potentialMatrix_", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalLambda]", ",", "X", ",", "\[Psi]", ",", "\n", "\t\t", 
       RowBox[{"scale", "=", 
        RowBox[{"OptionValue", "[", "Scaled", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"num", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<WavefunctionSelection\>\"", "]"}], 
          ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{"Automatic", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "@", 
               RowBox[{"OptionValue", "@", "Manipulate"}]}], ",", "All", ",", 
              "5"}], "]"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
       "\t\t", "dataRange", ",", "\n", "\t\t", 
       RowBox[{"potential", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"potentialMatrix", "//", "MatrixQ"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Diagonal", "@", "potentialMatrix"}], ",", "\n", "\t\t\t\t",
           "potentialMatrix"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"squared", "=", 
        RowBox[{"OptionValue", "@", "\"\<SquareWavefunction\>\""}]}], ",", 
       "\n", "\t\t", 
       RowBox[{"lf", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "@", "LabelingFunction"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"Automatic", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<\[Psi]\>\"", ",", "#1"}], "]"}], ",", 
                  "\"\<: E=\>\"", ",", "\n", "\t\t\t\t\t", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#2", ",", 
                    RowBox[{
                    "OptionValue", "[", "\"\<EnergyDigits\>\"", "]"}]}], 
                   "]"}]}], "}"}]}], "&"}], ")"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{"None", "->", "False"}]}], "}"}]}], "]"}]}], ",", "\n", 
       "\t\t", "plotWave", ",", "waveSet", ",", 
       RowBox[{"Ec", "=", 
        RowBox[{"OptionValue", "[", "\"\<CutOff\>\"", "]"}]}], ",", "\n", 
       "\t\t", "wavePlot", ",", "potentialPlot", ",", "\n", "\t\t", 
       "\[Lambda]Plot", ",", "plotRange", ",", "len"}], "\n", "\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[CapitalLambda]", ",", "X"}], "}"}], "=", "solutions"}], 
      ";", "\n", "\t\t", 
      RowBox[{"len", "=", 
       RowBox[{"Length", "@", "X"}]}], ";", "\n", "\t\t", 
      RowBox[{"num", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"num", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"All", ":>", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "len"}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"_List", ":>", "num"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"_Integer", ":>", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "num"}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"_", "->", "1"}]}], "\n", "\t\t\t\t\t", "}"}]}], "]"}]}], 
      ";", "\n", "\t\t", 
      RowBox[{"\[Psi]", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", 
             RowBox[{"If", "[", 
              RowBox[{"squared", ",", 
               RowBox[{"#2", "^", "2"}], ",", "#2"}], "]"}]}], "}"}], "&"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"grid", ",", 
            RowBox[{"X", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"waveSet", "=", 
       RowBox[{"\[Psi]", "/@", "num"}]}], ";", "\n", "\t\t", 
      RowBox[{"dataRange", "=", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[CurlyPhi]", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"waveSet", ",", "1"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ">=", "Ec"}], "&"}]}],
             "]"}]}], "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"\[CurlyPhi]", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{"\[CurlyPhi]", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], "\n",
         "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"plotWave", "[", "n_", "]"}], ":=", "\n", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], "//", 
          "TrueQ"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"s", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", "scale"}], "}"}]}], ",", 
             RowBox[{"\[Lambda]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"\[CapitalLambda]", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "+", 
              RowBox[{"s", "*", "#"}]}], "&"}], "/@", 
            RowBox[{"\[Psi]", "[", "n", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"s", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", "scale"}], "}"}]}], ",", 
             RowBox[{"\[Lambda]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"\[CapitalLambda]", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "*", "#"}], "&"}], "/@", 
            RowBox[{"\[Psi]", "[", "n", "]"}]}]}], "\n", "\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"waveSet", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"Between", "[", "dataRange", "]"}], "@*", "First"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"plotWave", "/@", "num"}], ")"}]}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"wavePlot", "[", 
        RowBox[{"sel_", ",", 
         RowBox[{"lFunc_:", "lf"}]}], "]"}], ":=", "\n", "\t\t\t", 
       RowBox[{"ListLinePlot", "[", " ", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"waveSet", "[", 
          RowBox[{"[", "sel", "]"}], "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{"ops", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Min", "@", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"waveSet", "[", 
                    RowBox[{"[", 
                    RowBox[{"sel", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
                   "0"}], "]"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"Max", "@", 
                 RowBox[{"waveSet", "[", 
                  RowBox[{"[", 
                   RowBox[{"sel", ",", "All", ",", "2"}], "]"}], "]"}]}]}], 
               "\n", "\t", "\t\t\t\t\t", "}"}]}], ",", "\n", "\t", "\t\t\t\t", 
             RowBox[{"PlotLegends", "->", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"lFunc", "===", "False"}], ",", "\n", "\t", 
                "\t\t\t\t\t\t", "None", ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"lFunc", "@@", "#"}], ")"}], "&"}], "/@", "\n", 
                 "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Thread", "@", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"num", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"IntegerQ", "@", "sel"}], ",", 
                    RowBox[{"{", "sel", "}"}], ",", "sel"}], "]"}], " ", 
                    "]"}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"num", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerQ", "@", "sel"}], "===", "0"}], ",", 
                    RowBox[{"{", "sel", "}"}], ",", "sel"}], "]"}], " ", 
                    "]"}], "]"}], " ", "]"}], "]"}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t", "}"}]}]}]}], "\n", "\t\t\t\t\t\t\t", 
               "]"}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
           
           RowBox[{"Options", "@", "ListLinePlot"}]}], "\n", "\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"potentialPlot", "=", "\n", "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"op", "=", 
           RowBox[{"OptionValue", "[", "\"\<PotentialStyle\>\"", "]"}]}], 
          "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"op", "===", "None"}], ",", "\n", "\t\t\t\t\t", "Nothing", 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{"ListLinePlot", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"grid", ",", "potential"}], "}"}], "]"}], ",", "\n", 
             "\t", "\t", "\t\t\t\t", 
             RowBox[{"PlotStyle", "->", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{"op", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{"Automatic", "->", 
                 RowBox[{"{", 
                  RowBox[{"Gray", ",", 
                   RowBox[{"Dashing", "[", 
                    RowBox[{"{", 
                    RowBox[{".01", ",", ".025", ",", ".02", ",", ".025"}], 
                    "}"}], "]"}]}], "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
               "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\[Lambda]Plot", "[", "sel_", "]"}], ":=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ListLinePlot", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"grid", ",", "#"}], "}"}], "]"}], ",", "\n", "\t\t\t\t", 
           
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Red", ",", "Dotted"}], "}"}]}]}], "\n", "\t\t\t\t", 
          "]"}], "&"}], "/@", 
        RowBox[{"\[CapitalLambda]", "[", 
         RowBox[{"[", " ", 
          RowBox[{"num", "[", 
           RowBox[{"[", "sel", "]"}], "]"}], " ", "]"}], "]"}]}]}], ";", "\n",
       "\t\t", 
      RowBox[{"plotRange", "=", "Automatic"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "num"}], ">", "1"}], ",", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "@", "Manipulate"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"wp", "=", "wavePlot"}], ",", 
              RowBox[{"N", "=", "num"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"lF", "=", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"f", "=", 
                   RowBox[{"lf", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}], "}"}], ",", 
                 RowBox[{"f", "&"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"potPlot", "=", "potentialPlot"}], ",", 
              RowBox[{"L", "=", "\[CapitalLambda]"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"\[Lambda]P", "=", "\[Lambda]Plot"}], ",", 
              RowBox[{"pR", "=", "plotRange"}]}], "}"}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"Manipulate", "[", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Show", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"wp", "[", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "lF"}], "]"}], ",", 
                "\n", "\t\t\t\t\t\t", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"potPlot", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], 
                    "//", "TrueQ"}], ",", 
                    RowBox[{"\[Lambda]P", "[", 
                    RowBox[{"{", "i", "}"}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}]}], "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                 "}"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ops", ",", 
                    RowBox[{"PlotRange", "->", "pR"}]}], "}"}], ",", 
                  RowBox[{"Options", "[", "Plot", "]"}]}], "]"}]}], "\n", 
               "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "1", 
                ",", 
                RowBox[{"Length", "@", "N"}], ",", "1"}], "}"}]}], "\n", 
             "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"wavePlot", "[", "All", "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"potentialPlot", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"OptionValue", "[", "\"\<ShowEnergy\>\"", "]"}], "//",
                  "TrueQ"}], ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"\[Lambda]Plot", "[", "All", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
             "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ops", ",", 
                RowBox[{"PlotRange", "->", "plotRange"}]}], "}"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Options", "[", "Plot", "]"}]}], "\n", "\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ",",
         "\n", "\t\t\t", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"wavePlot", "[", "All", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"potentialPlot", ",", 
            RowBox[{"\[Lambda]Plot", "[", "All", "]"}]}], "}"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ops", ",", 
              RowBox[{"PlotRange", "->", "plotRange"}]}], "}"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Options", "[", "Plot", "]"}]}], "\n", "\t\t\t\t\t", 
           "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}]}], 
    "\n", "\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.707079133599949*^9, 3.707079165555623*^9}, {
   3.707079245500482*^9, 3.707079264996385*^9}, {3.707079435368559*^9, 
   3.707079461465197*^9}, {3.707079497021113*^9, 3.7070795551391993`*^9}, {
   3.707079614281602*^9, 3.70707962113295*^9}, {3.707079651941841*^9, 
   3.707079660821377*^9}, {3.70707973649951*^9, 3.707079741983705*^9}, {
   3.707079831675027*^9, 3.707079841565547*^9}, 3.707080175293795*^9, 
   3.707081124397023*^9, {3.70708116183797*^9, 3.707081180900281*^9}, {
   3.7070812352564774`*^9, 3.707081301439883*^9}, {3.7070813431527653`*^9, 
   3.707081378769888*^9}, {3.7070814646478252`*^9, 3.707081485289687*^9}, {
   3.7070815430080643`*^9, 3.707081606751402*^9}, {3.707081645885*^9, 
   3.707081668002983*^9}, {3.707081887309559*^9, 3.7070819335900087`*^9}, {
   3.7070821550594063`*^9, 3.707082203727014*^9}, {3.707082233986767*^9, 
   3.707082297709743*^9}, 3.7070823692314796`*^9, {3.707082524335957*^9, 
   3.707082535634412*^9}, 3.7070826022741337`*^9, {3.707249849136451*^9, 
   3.7072499231820707`*^9}, {3.707249995688854*^9, 3.707250024695369*^9}, {
   3.707505670928403*^9, 
   3.7075057007597637`*^9}},ExpressionUUID->"8edcee07-92a4-4a7d-a5a8-\
f10be9cb805d"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"4ef3b0ab-7ea1-4b25-94ee-\
109a5b74243a"],

Cell[BoxData[
 RowBox[{"$Cartesian1DDVR", "=", "\n", "\t", 
  RowBox[{"<|", "\n", "\t\t", 
   RowBox[{
    RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<Cartesian 1D\>\""}], ",", "\n", 
    "\t", "\t", 
    RowBox[{"\"\<Dimension\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<PointLabels\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<x\>\"", "|", "\"\<y\>\"", "|", "\"\<z\>\""}], "}"}]}], ",",
     "\n", "\t", "\t", 
    RowBox[{"\"\<Range\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", "10"}], "}"}], "}"}]}], ",", "\n", "\t", 
    "\t", 
    RowBox[{"\"\<Grid\>\"", "->", "Cartesian1DDVRPoints"}], ",", "\n", "\t", 
    "\t", 
    RowBox[{"\"\<KineticEnergy\>\"", "->", "Cartesian1DDVRKineticMatrix"}], 
    ",", "\n", "\t\t", 
    RowBox[{"\"\<View\>\"", "->", "Cartesian1DDVRPlotFunction"}], ",", "\n", 
    "\t\t", 
    RowBox[{"\"\<Defaults\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{
      "\"\<PotentialFunction\>\"", "\[Rule]", "\"\<HarmonicOscialltor\>\""}], 
      "\n", "\t\t\t\t", "}"}]}]}], "\n", "\t\t", "|>"}]}]], "CodeInput",
 CellChangeTimes->{{3.699200278013855*^9, 3.6992003570101633`*^9}, {
   3.699200549451913*^9, 3.699200572585655*^9}, {3.699201461131833*^9, 
   3.6992014765432796`*^9}, {3.699206458337839*^9, 3.699206479116613*^9}, {
   3.699241987640071*^9, 3.699241995817466*^9}, {3.718048606105678*^9, 
   3.7180486086994123`*^9}, {3.731159533317487*^9, 3.731159534046062*^9}, 
   3.7311595651250877`*^9, {3.731159647016672*^9, 
   3.731159651542239*^9}},ExpressionUUID->"8aceb883-c792-425d-ba7c-\
f5d9c3311e15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVREnd", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{{3.69923997837263*^9, 3.699240000757471*^9}, 
   3.707066369415279*^9},ExpressionUUID->"e090bdbe-9685-418f-9ec7-\
1f9e76f250e7"],

Cell[BoxData["$Cartesian1DDVR"], "CodeInput",
 CellChangeTimes->{3.699241967016337*^9, 
  3.6992420067672653`*^9},ExpressionUUID->"d11ffbaa-fdfa-4a29-9963-\
71defe6f979f"]
}, Open  ]]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"175b9d87-ebdf-4990-abf4-\
f2e40fb52d02"]
},
WindowSize->{713, 755},
WindowMargins->{{154, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackagePlain.nb", 
  CharacterEncoding -> "UTF-8"]
]

