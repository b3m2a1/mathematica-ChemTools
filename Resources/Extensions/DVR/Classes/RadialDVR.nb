Notebook[{

Cell[CellGroupData[{
Cell["Radial DVR (Colbert and Miller (0,\[Infinity]) range DVR)", \
"CodeSection",ExpressionUUID->"fc4cedbb-1f6e-4454-94a4-fe827adb8e59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVRBegin", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{3.699240055548855*^9, 
  3.707066404725416*^9},ExpressionUUID->"fe0a6118-608c-495e-aa15-\
8a73b87902ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RadialDVRPoints", "::", "usage"}], "=", 
  "\"\<Returns the radial DVR grid/array\>\""}], "\n", 
 RowBox[{
  RowBox[{"RadialDVRK", "::", "usage"}], "=", 
  "\"\<Returns the radial DVR kinetic energy matrix\>\""}]}], "CodeInput",
 CellChangeTimes->{
  3.699235814204474*^9, {3.6992370430571823`*^9, 3.6992370521161327`*^9}, {
   3.731972688971364*^9, 3.7319727189346046`*^9}, {3.732009221848545*^9, 
   3.7320092220274963`*^9}},ExpressionUUID->"8bb521bd-a059-472c-90cb-\
d64d19ca721a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"0cf52129-8ce7-4078-a8b9-\
8e33bdbd56a4"],

Cell[CellGroupData[{

Cell["Grid Points Function", \
"Subsubsection",ExpressionUUID->"a0de3828-3ca9-4c37-8a2e-750452de7182"],

Cell["\<\
This function should take the number of grid points for each coordinate\
\>", "Text",ExpressionUUID->"192ec1fc-09d3-418b-ba6d-fe567c6ad5e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RadialDVRPoints", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"points", ":", 
     RowBox[{"{", "_Integer", "}"}]}], ",", "\n", "\t", 
    RowBox[{"X", ":", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}], "}"}], ":", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "10"}], "}"}], "}"}]}]}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"Subdivide", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N", "@", "X"}], ",", " ", 
      RowBox[{"points", "-", "1"}]}], "}"}]}]}]}]], "CodeInput",
 CellChangeTimes->{
  3.699200045278949*^9, {3.69920008501616*^9, 3.6992000920807247`*^9}, {
   3.699200124968298*^9, 3.699200133406434*^9}, {3.6992074474542017`*^9, 
   3.699207450724925*^9}, {3.699211747970565*^9, 3.699211787049007*^9}, {
   3.69921185461567*^9, 3.6992119283628674`*^9}, {3.699212533676085*^9, 
   3.6992125341066017`*^9}, {3.69922854340968*^9, 3.699228545982193*^9}, {
   3.699234968992999*^9, 3.699234969751259*^9}, {3.699235849889851*^9, 
   3.6992358540458612`*^9}, {3.715977649986927*^9, 3.715977652250744*^9}, 
   3.731972698557321*^9},ExpressionUUID->"96ea46e4-9950-4039-89d1-\
e8b271dac36b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinetic Energy Matrix", \
"Subsubsection",ExpressionUUID->"f83b9ebe-42da-4346-924d-26f1480f128c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RadialDVRK", "]"}], "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Mass\>\"", "->", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<HBar\>\"", "->", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ScalingFactor\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<UseExact\>\"", "\[Rule]", "False"}]}], "\n", "\t\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RadialDVRK", "[", 
   RowBox[{"grid_", ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rmin", "=", 
       RowBox[{"Min", "@", "grid"}]}], ",", 
      RowBox[{"rmax", "=", 
       RowBox[{"Max", "@", "grid"}]}], ",", 
      RowBox[{"points", "=", 
       RowBox[{"Length", "@", "grid"}]}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"dr", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rmax", "-", "rmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"points", "-", "1"}], ")"}]}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"m", "=", 
         RowBox[{"OptionValue", "@", "\"\<Mass\>\""}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"\[HBar]", "=", 
         RowBox[{"OptionValue", "@", "\"\<HBar\>\""}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"scl", "=", 
         RowBox[{"OptionValue", "@", "\"\<ScalingFactor\>\""}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"ex", "=", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"OptionValue", "@", "\"\<UseExact\>\""}]}]}]}], "\n", 
       "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"With", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{"f", "=", "\n", "\t\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"ex", ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"scl", "*", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "#2"}], ",", " ", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Pi]", "^", "2."}], "/", "3."}], "-", 
                 RowBox[{"1", "/", 
                  SuperscriptBox["#", "2"]}]}], ",", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"2.", "/", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "-", "#2"}], ")"}], "^", "2"}]}], "-", 
                 RowBox[{"2.", "/", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "+", "#2"}], ")"}], "^", "2"}]}]}]}], "\n", 
               "\t\t\t\t\t\t\t\t\t", "]"}], "*", "\n", "\t\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[HBar]", "^", "2."}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "#2"}], ")"}]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2.", "m", " ", 
                 RowBox[{"dr", "^", "2"}]}], ")"}]}]}], "&"}], ",", "\n", 
            "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"scl", "*", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "#2"}], ",", " ", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Pi]", "^", "2."}], "/", "3."}], "-", 
                 RowBox[{"1", "/", 
                  SuperscriptBox["#", "2"]}]}], ",", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"2.", "/", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "-", "#2"}], ")"}], "^", "2"}]}], "-", 
                 RowBox[{"2.", "/", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"#", "+", "#2"}], ")"}], "^", "2"}]}]}]}], "\n", 
               "\t\t\t\t\t\t\t\t\t", "]"}], "*", "\n", "\t\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[HBar]", "^", "2."}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "#2"}], ")"}]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2.", "m", " ", 
                 RowBox[{"dr", "^", "2"}]}], ")"}]}]}], "&"}]}], "\n", 
           "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"points", ">", "100000"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "points"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "points"}], "}"}]}], "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "points"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "points"}], "}"}]}], "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
     "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.6992358674736557`*^9, 3.699235965180313*^9}, {
  3.731087319996853*^9, 
  3.731087341376301*^9}},ExpressionUUID->"33e19602-d690-474a-b4dc-\
2d55a7647148"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"ad841fd4-e3d0-415e-ae7e-\
a44bd51c9abb"],

Cell[BoxData[
 RowBox[{"$RadialDVR", "=", "\n", "\t", 
  RowBox[{"<|", "\n", "\t\t", 
   RowBox[{
    RowBox[{"\"\<Name\>\"", "\[Rule]", "\"\<Radial 1D\>\""}], ",", "\n", "\t",
     "\t", 
    RowBox[{"\"\<Dimension\>\"", "\[Rule]", "1"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<PointLabels\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"(", 
       RowBox[{"\"\<r\>\"", "|", "\"\<R\>\"", "|", "\"\<radial\>\""}], ")"}], 
      "}"}]}], ",", "\n", "\t", "\t", 
    RowBox[{"\"\<Range\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "10"}], "}"}], "}"}]}], ",", "\n", "\t", "\t", 
    RowBox[{"\"\<Grid\>\"", "->", "RadialDVRPoints"}], ",", "\n", "\t\t", 
    RowBox[{"\"\<KineticEnergy\>\"", "->", "RadialDVRK"}], ",", "\n", "\t\t", 
    
    RowBox[{"\"\<Defaults\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{
       "\"\<PotentialFunction\>\"", "\[Rule]", "\"\<MorseOscillator\>\""}], 
       ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<PlotMode\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Cartesian\>\"", ",", " ", "1"}], "}"}]}]}], "\n", 
      "\t\t\t\t", "}"}]}]}], "\n", "\t\t", "|>"}]}]], "CodeInput",
 CellChangeTimes->{{3.699236923511825*^9, 3.6992369555077667`*^9}, {
   3.699237949531838*^9, 3.699237954564919*^9}, 3.7310917258452806`*^9, {
   3.731972724114958*^9, 3.731972751612996*^9}, {3.731989625498749*^9, 
   3.731989650996195*^9}},ExpressionUUID->"7c275231-ae55-49d8-8da5-\
ba36a018a3cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemDVREnd", "[", "]"}], ";"}]], "InputSection",
 CellChangeTimes->{{3.69923997837263*^9, 3.699240000757471*^9}, 
   3.707066410893405*^9},ExpressionUUID->"247e4052-5d8d-4fda-bcce-\
3be397b318c5"],

Cell[BoxData["$RadialDVR"], "CodeInput",
 CellChangeTimes->{
  3.699241967016337*^9},ExpressionUUID->"062e096f-efca-46ac-b513-7188deb4cf23"]
}, Open  ]]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"3bc90092-197f-4b10-9566-\
9cd9c4936cec"]
},
WindowSize->{808, 755},
WindowMargins->{{85, Automatic}, {47, Automatic}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackagePlain.nb", 
  CharacterEncoding -> "UTF-8"]
]

